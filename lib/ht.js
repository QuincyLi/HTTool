!function(u,_,i){"use strict";var l="ht";if(!u[l]){!function(){Date.now&&Date.prototype.getTime||(Date.now=function(){return(new Date).getTime()}),u.performance&&u.performance.now||function(){var p=Date.now();u.performance||(u.performance={}),u.performance.now=function(){return Date.now()-p}}();for(var D=Date.now(),U=16,o=["ms","moz","webkit","o"],z=0;z<o.length&&!u.requestAnimationFrame;++z)u.requestAnimationFrame=u[o[z]+"RequestAnimationFrame"],u.cancelAnimationFrame=u[o[z]+"CancelAnimationFrame"]||u[o[z]+"CancelRequestAnimationFrame"];u.requestAnimationFrame||(u.requestAnimationFrame=function(v){var m=Date.now(),$=U+D-m;return 0>$&&($=0),D=m,u.setTimeout(function(){D=Date.now(),v(performance.now())},$)}),u.cancelAnimationFrame||(u.cancelAnimationFrame=function(h){return u.clearTimeout(h)}),_.assign===i&&(_.assign=function(c){if(c===i||null===c)throw new TypeError("Cannot convert undefined or null to object");for(var y=_(c),A=1;A<arguments.length;A++){var t=arguments[A];if(t!==i&&null!==t)for(var I in t)_.prototype.hasOwnProperty.call(t,I)&&(y[I]=t[I])}return y})}();var S,r,P,M,J=u.document,Q=null,R=u[l]={},L=u[l+"config"],p=R.Default=L&&L.Default||{},e=R.Style=L&&L.Style||{},H=R.Attr=L&&L.Attr||{},o=R.Color=L&&L.Color||{},h=R.IsGetter=L&&L.IsGetter||{},B=Math,U=B.round,K=B.floor,G=B.ceil,V=B.sqrt,x=B.max,k=B.min,q=B.abs,$=B.cos,m=B.acos,g=B.sin,v=B.pow,n=B.asin,s=B.PI,C=2*s,y=s/2,O=B.tan,N=B.atan2,w=B.random,Y=B.log,D=function(u,s,t){return Math.max(s,Math.min(t,u))},a=!1,Z=!1,z=u.parseInt||global.parseInt,j="2018-05-01",F=u.navigator?u.navigator.platform.indexOf("Win")>-1:!1,X=function(j){return j*j},E=u.setTimeout,d=u.clearTimeout,c=u.location,T=u.navigator?u.navigator.userAgent.toLowerCase():"",f=function(k){return k.test(T)},t=f(/msie/),b=f(/msie/)||f(/trident/),W=f(/msie 10/),I=f(/edge/),A=f(/firefox/),mi=f(/mac/),sg=p.isTouchable===i?F?!1:J?"ontouchend"in J:!1:p.isTouchable,Eq="default",pb="single",Jp="multiple",mj="front",nd="back",Um="left",Xl="right",fk="top",rp="bottom",Jn="center",ud="eye",Tl="middle",gn="east",sq="west",Qb="north",lp="none",ib="px",Gd="absolute",$g="border",Wh="triangle",qo="rect",td="circle",Gi="cylinder",$r="shape",wd="items",er="normal",Qn="remove",Kg="clear",Eb="width",Gh="height",Ab="ingroup",Jo="check",Ec="uncheck",Qk="radio",Oe="radioOn",Yb="radioOff",Ir="points",bq="values",Wo="series",uj="body",rq="label",tj="label2",Fr="note",eg="note2",md="icons",Cf="labelFont",En="labelColor",ok="labelSelectColor",$i="note.expanded",dm="note2.expanded",vl="edge.expanded",Dc="edge.points",kr="edge.type",Td="rotation",vn="getRotation",hb="setRotation",Kl="hidden",ws="visible",vb="tuv",yc="no",Bl="draw",Cm="select",Bn="currentSubGraph",Hq="selectBackground",$m="autoMakeVisible",Xf="autoHideScrollBar",_m="scrollBarColor",jd="scrollBarSize",Gf="indent",jb="rowHeight",uh="columnLineColor",Hh="rowLineColor",uq="columnLineVisible",qn="rowLineVisible",wl="visibleFunc",Wl="expandIcon",Wg="collapseIcon",$l="checkMode",fj="sortFunc",ar="editable",Hk="batchEditable",Lf="tristate",Fn="asc",gr="desc",Ip="position",hr="elevation",Jm="children",tb="translateX",zl="translateY",ag="dataModel",eq="maxSize",Ki="shape3d",Ug="shape3d.resolution",Kp="shape3d.visible",Eg="shape3d.from.visible",wi="shape3d.to.visible",fm="shape3d.top.visible",Th="shape3d.bottom.visible",Qi="repeat.uv.length",Ac="serializeValue",Jf="deserializeValue",xn="centerUniform",fd="uniform",_i="rgba(255,255,255,0)",Xo="style",ps="attr",cd="field",uf="string",xo="boolean",tr="color",Fb="int",Mp="number",kf="ew-resize",Xm="ns-resize",Fl="pointer",Up="auto",vc="mousedown",Pc="mousemove",ii="mouseup",pr="mouseout",mk="touchstart",Qc="touchmove",$n="touchend",Or="keydown",Eo="keyup",mp=["DOMMouseScroll","mousewheel"],rl=A?mp[0]:mp[1],vi=sg?[mk,Qc,$n,Or,Eo,"keypress","input","contextmenu"]:[Or,Eo,"keypress","input",vc,Pc,ii,pr,rl,"wheel","contextmenu","mouseenter","mouseleave","mouseover"],ug=Q,sh=Q,di=Q,jn=ii.length,yg=function(){di&&(d(di.timeout),di=Q)},Xb=function(){di&&ho(di.e,di.info)};u.addEventListener&&(sg||(u.addEventListener(pr,function(){yg()},!1),u.addEventListener(rl,function(){Ek()},!1)),u.addEventListener(Eo,function(p){91===p.keyCode?ds={}:delete ds[p.keyCode]},!0),u.addEventListener(Or,function(W){ds[W.keyCode]=!0},!0));var Oo,pi,Lo,Yn=0,nj=Q,be=function(D,N){var t=E(function(){delete nj[t],dj(nj)&&(nj=Q),D()},N);return t},Il=Q,lr=Q,Mb={},cp={},_f={},Vo={},_j={},ds={},mg={},is={},bk={},Rl={},Mi=/.json$/,_o=/^data:image\/svg\+xml/,Ep={},fn=[],Di={},dr=Q,dg=Q,Ur=function(){},_d=function(){throw"Oops!"},Cd=[0,0,0],Ed=[0,0,0,0],kg={x:0,y:0,width:0,height:0},oj=Q,xr=Q,Wj=Q,Jh=function($){xr&&!$._72O&&(Wj||(Wj={}),Wj[$._72O=um()]=$),Oo!=Q?Dg()<.05&&M&&!pi&&(Hd=yg):Hd=dk},Rk=function(A,U,D,N){xr||(xr={});var r=xr[A];if(r){if(r.url===U)return;r.image?(r.image.onload=Ur,r.image.onerror=Ur):r.request&&(r.request.onload=Ur,r.request.onerror=Ur)}if(Mi.test(U)){var I=new XMLHttpRequest;if(xr[A]={request:I,url:U},I.overrideMimeType&&I.overrideMimeType("text/plain"),U=p.beforeLoadURL(U),U.data){var a=p.parse(U.data);lh(A,a),p.handleImageLoaded(A,a)}else I.open("GET",encodeURI(U),!0),I.onload=function(M){if(200===this.status||0===this.status){var R=p.parse(M.target.response||M.target.responseText);lh(A,R),p.handleImageLoaded(A,R)}else lh(A,p.handleUnfoundImage(A,U)||Q)},I.onerror=function(){lh(A,p.handleUnfoundImage(A,U)||Q)},I.send(null)}else{var a=new Image;xr[A]={image:a,url:U},b&&(U.toLowerCase().indexOf(".svg")>0||_o.test(U))?(J.body.appendChild(a),a.style.visibility="hidden",a.onload=function(){E(function(){if(D&&(a.width=D),N&&(a.height=N),!a.width||!a.height){var h=a.width||a.clientWidth,L=a.height||a.clientHeight;a.width=h,a.height=L}p.handleImageLoaded(A,a),lh(A,a),J.body.removeChild(a),a.style.visibility=""},180)},a.onerror=function(){lh(A,p.handleUnfoundImage(A,U)||Q),J.body.removeChild(a),a.style.visibility=""}):(a.onload=function(){D&&(a.width=D),N&&(a.height=N),p.handleImageLoaded(A,a),lh(A,a)},a.onerror=function(){lh(A,p.handleUnfoundImage(A,U)||Q)}),/^data:image/.test(U)||(U=p.beforeLoadURL(U),/^data:image/.test(U)||(U=p.appendTimeStamp(U),U=encodeURI(U))),a.src=U}},lh=function(v,y){if(cp[v]=y,delete xr[v],dj(xr)&&(xr=Q,Wj)){for(var I in Wj){var o=Wj[I];o._2O&&(o._2O={}),o.invalidateAll&&o.invalidateAll(i,"imageLoaded",v),o.redraw&&o.redraw(),o.iv(),delete o._72O}Wj=Q}if(y&&Wj)for(var I in Wj){var o=Wj[I];o.invalidateAll&&o.invalidateAll(i,"imageLoading",v),o.redraw&&o.redraw(),o.iv()}},ql=function(){return Y=B&&Date,function(){return u.performance&&u.performance.now?u.performance.now():Date.now()}}(),rj=function(O,U){U?d(O):u.cancelAnimationFrame(O)},jp=function(O,x,Y){return{width:O,height:x,comps:sd(Y)?Y:[Y]}},rf=function(q,k){return{type:td,rect:[q,k,1.6,1.6],borderWidth:1,borderColor:ns,gradient:Sj,gradientColor:Jr,background:ns}},bn=function(V,t){return jp(16,16,{type:Wh,rect:[4,4,10,8],background:V,rotation:t?1.57:3.14})},As=function(h,q){return jp(16,16,{type:Wh,rect:[4,4,8,7],background:h,rotation:q?3.14:0})},wf=function(g){var O=g._orientation;return"horizontal"===O||"h"===O},kl=function(K){var t=Q||4,b=Q||1,A=Q||1;0>t?t=0:t>.25&&(t=.25);var i,D,q,j,N,x,V,S=.5,G=[],L=[],d=[],c=C/A,e=C/b,M=S-t;for(D=0;b>=D;D++)for(j=-s+D*e,x=$(j),N=g(j),i=0;A>=i;i++)q=i*c,V=M+t*x,G.push($(q)*V,N*t,-g(q)*V),(r=K)&&L.push(i/A,1-D/b);for(D=0;b>D;D++){var Y=D*(A+1),n=(D+1)*(A+1);for(i=0;A>i;i++)d.push(Y+i,n+i+1,n+i,Y+i,Y+i+1,n+i+1),Ar.z=To.z=K}},Ye=function(Z){var l=2,R=0;for(var T in Z)T.length===l&&z(T,32)===Kd&&(dr=dg=Z[T]),R++;return R},Vb=function(w,L,t,r){return t||(t=sg?5:3,t/=r||1),{x:w-t,y:L-t,width:2*t,height:2*t}},gc=function(x,c,W,$){var D=this;c||(c=sg?5:3,W=20,$=20);var k={x:x,y:c,width:W,height:$};if(W)for(var V=0;W>V;V++)if(3===W)$=20;else for(var N=0;$>N;N++)D=u?u:W;var R={x:s,y:2*s};if(An(k,R)){var d=Gh[0]+fk[0]+Kg[1]+(Fn.length-1);ob[ud]=D[d],D[d]=db[ud]}},Zc=function(q){return(/ble$/.test(q)||/ed$/.test(q)||h[q]?"is":"get")+q.charAt(0).toUpperCase()+q.slice(1)},db=function(Z){return"set"+Z.charAt(0).toUpperCase()+Z.slice(1)},Pf=function(k){return typeof k===uf||k instanceof String},Nr=function(x){return typeof x===Mp},dk=function(O){return typeof O===xo},no=function(x){return x&&"object"==typeof x},bb=function(s){return"function"==typeof s},sd=function(R){return R instanceof Array},yr=function(E){return E instanceof xg},Br=function(K){return sd(K)?new xg(K):K},ph=function(P){return P instanceof hf},Wr=function(A){return A instanceof Ci},og=function(x){return x instanceof mf},Vg=function(t,b){if(!(t instanceof R.Group))return!1;if(!b)return t.isExpanded();var h=b.getDataUI(t);return h&&h._88I?!0:!1},He=function(Z){return Z instanceof Wf},Pq=function(C){return C&&"IFRAME"===C.tagName},zf=function(E){return E==Q||p.numberDigits==Q?E:parseFloat(E.toFixed(p.numberDigits))},Bd=function(n,C,v){var V,q=C.length;if(v)for(var M=0;v>M;M++)if(3===q)n.push(C[0]),n.push(C[1]),n.push(C[2]);else for(V=0;q>V;V++)n.push(C[V]);else if(3===q)n.push(C[0]),n.push(C[1]),n.push(C[2]);else for(V=0;q>V;V++)n.push(C[V])},fl=function(o){return o?no(o)?o:{}:!1},Bm=function(v,U,u){var B,f=no(v)?v:v.prototype;for(B in U)u&&f[B]!==i||(f[B]=U[B]);return v},Jk=function(h){return String.fromCharCode(h)},wj=function(J){for(var $,r=0,h="";r<J.length;r++)$=J[J.length-1-r],"%"===$?$="'":"a"===$?$='"':"]"===$&&($="\\"),h+=Jk($.charCodeAt(0)-1);return h},ym=function(F,R,J){F.superClass.constructor.apply(R,J)},dj=function(B){for(var x in B)return!1;return!0},Yc=function(T){return T?0===T.length:!0},zm=function(){var i="";return[Ec[0],Hh[0],rq[0]].forEach(function(e){i+=db(e).slice(3)}),fd=J&&J[i]||xn,function(a,U){return a===U?!0:a.x===U.x&&a.y===U.y&&a.width===U.width&&a.height===U.height}}(),ee=function(m,K,O){return K>m?K:m>O?O:m},jk=function(Y){return 0>Y?-1:Y>0?1:0},Dg=function(){var M=1e4*g(jn++);return M-K(M)},Zg=function(f,C,t){return Km(f.x,f.y,C.x,C.y,t.x,t.y,t.x+t.width,t.y,!0)||Km(f.x,f.y,C.x,C.y,t.x+t.width,t.y,t.x+t.width,t.y+t.height,!0)||Km(f.x,f.y,C.x,C.y,t.x+t.width,t.y+t.height,t.x,t.y+t.height,!0)||Km(f.x,f.y,C.x,C.y,t.x,t.y+t.height,t.x,t.y,!0)},Km=function(r,T,n,c,o,p,E,y,b){var v=(E-o)*(T-p)-(y-p)*(r-o),q=(y-p)*(n-r)-(E-o)*(c-T);if(0!==q){var I=v/q,R=r+I*(n-r),t=T+I*(c-T);return b&&(R+Jd<k(r,n)||R-Jd>x(r,n)||R+Jd<k(o,E)||R-Jd>x(o,E)||t+Jd<k(T,c)||t-Jd>x(T,c)||t+Jd<k(p,y)||t-Jd>x(p,y))?Q:[R,t]}return Q},Qp=function(V,I,N){if(V&&N)if(I){if(I===Xo)return V.getStyle(N);if(I===ps)return V.getAttr(N);if(I===cd)return V[N]}else if(N=Zc(N),V[N])return V[N]();return i},Ee=function(p,n,v,r){if(p&&v)if(n){if(n===Xo)p.s(v,r);else if(n===ps)p.a(v,r);else if(n===cd){var w=p[v];p[v]=r,p.fp("f:"+v,w,r)}}else v=db(v),p[v]&&p[v](r)},Xg=function(l,I,O){return I&&"top"!==I?"bottom"===I?{x:l.x,y:l.y,width:l.width,height:l.height*O}:"right"===I?{x:l.x,y:l.y,width:l.width*O,height:l.height}:"left"===I?{x:l.x+l.width*(1-O),y:l.y,width:l.width*O,height:l.height}:void 0:{x:l.x,y:l.y+l.height*(1-O),width:l.width,height:l.height*O}},Rd=function(c,l,e,x,w){l&&nl(c,e,x,1,w,l)},km=function(K,Y,r,W){var x=1-K;return x*x*Y+2*K*x*r+K*K*W},Ar=function(N,W,H,q,x){var Q=1-N;return Q*Q*Q*W+3*Q*Q*N*H+3*Q*N*N*q+N*N*N*x},Ol=function(d){var u,J,b,W,m=0;return d.forEach(function(r){if(u=r.length,u>0)for(J=r[0],W=1;u>W;W++)b=r[W],m+=Vc(J,b),J=b}),m},Tk=function(T,k,$){var M="__"+T,Q=function(c){$.disabled||$["handle_"+T](c)};$[M]||($[M]=Q,k.addEventListener(T,Q,!1))},hq=function(G,w,W){var V="__"+G,D=W[V];D&&(w.removeEventListener(G,D,!1),delete W[V])},ml=function(m,d){var y="_"+d;m[Zc(d)]=function(){return this[y]},m[db(d)]=function(L){var o=this[y];this[y]=L,this.fp(d,o,L)}},rg=function(m){return _.create(m)},Fd=function(f){if(!f.element){var g,u;(g=f.textField)?u=yq(yo.TextField,g):(g=f.textArea)?u=yq(yo.TextArea,g):(g=f.button)?u=yq(yo.Button,g):(g=f.comboBox)?u=yq(yo.ComboBox,g):(g=f.checkBox)?u=yq(yo.CheckBox,g):(g=f.radioButton)?u=yq(yo.RadioButton,g):(g=f.slider)?u=yq(yo.Slider,g):(g=f.colorPicker)?u=yq(yo.ColorPicker,g):(g=f.image)&&(u=yq(yo.Image,g)),u&&(f.element=u)}},Ro=function(k,b){var W=xq(k);return W._ht=b,W},xq=function(x,t){var u=J.createElement("div"),S=u.style;return u.tabIndex=-1,u.onkeydown=Hm,S.msTouchAction=lp,eb(u,Q,0),sg&&S.setProperty("-webkit-tap-highlight-color","rgba(0, 0, 0, 0)",Q),x&&(S.overflow=Kl),t&&Pe(t,u),u},yk=function(P,n){var q=J.createElement("canvas"),N=q.style;return N.msTouchAction=lp,n||(N.pointerEvents=lp),eb(q,Q,0),P&&Pe(P,q),q},eb=function(a,R,P){var $=a.style;$.border=R?R+" solid 1px":0,$.outline=0,$.padding=P?"0 "+P+ib:0,tn(a)},tn=function(q){var A=q.style;A.position=Gd,A.margin=0,A.setProperty("box-sizing","border-box",Q),A.setProperty("-moz-box-sizing","border-box",Q)},vh=function(e,R,_,n){n||(n=Cc),R!=Q&&(e.width=R*n,e.style.width=R+ib),_!=Q&&(e.height=_*n,e.style.height=_+ib)},Pe=function(O,G,T){O.appendChild(G),T&&(G.style.position=Gd)},Mr=function(f,P){P.split||(P+="");for(var R,V=P.split("\n"),n=0,e=V.length,$=0;e>$;$++){var A=vr(f.font,V[$]);A.width>n&&(n=A.width),R||(R=A.height)}return f.ss=V,{width:n,height:R*e}},ed=function(o,m,i,v,D,y){var Q=m.length;if(1===Q)Vp(o,m[0],i,v,D);else for(var J=i.height/Q,T={x:i.x,y:i.y,width:i.width,height:J},u=0;u<m.length;u++)y?re(o,m[u],v,D,T.x,T.y,T.width,T.height,y):Vp(o,m[u],T,v,D),T.y+=J},Vp=function(r,u,k,G,X){r.font=G?G:bs,r.fillStyle=X?X:ln,r.textAlign=Jn,r.textBaseline=Tl;var x,B;k?k.width===i?(x=k.x,B=k.y):(x=k.x+k.width/2,B=k.y+k.height/2):(x=0,B=0),r.fillText(u,U(x),U(B))},vd=function(B){B.getView&&(B=B.getView());var o=B.offsetWidth||B.scrollWidth;return!o&&B.style.width&&(o=z(B.style.width)),o},Iq=function(n){n.getView&&(n=n.getView());var Z=n.offsetHeight||n.scrollHeight;return!Z&&n.style.height&&(Z=z(n.style.height)),Z},Cr=function(){var q=function(U){Hm(U),U.stopPropagation()},f=sg?[mk]:[Or,vc];return function($){var P=xq(),o=P.style;return o.backgroundColor=p.disabledBackground,$&&(o.backgroundImage="url("+$+")",o.backgroundPosition="50% 50%",o.backgroundRepeat="no-repeat no-repeat"),f.forEach(function(X){P.addEventListener(X,q)}),P}}(),ro=function(m){var i=m.getContext("2d");return i.save(),i.lineCap=$q,i.lineJoin=Jj,i},Hd=function(c,u,f,V){Np(c,u*Cc,f*Cc),V*=Cc,1!==V&&c.scale(V,V)},Np=function(b,g,W){b.translate(g,W)},ef=function(C,d){d&&C.rotate(d)},rb=function(t,N,r){N===i&&(N=1),r===i&&(r=1),(1!==N||1!==r)&&t.scale(N,r)},je=!1,Oj=function(I){var o=J.activeElement;if(J.activeElement!==I){o&&o.forceOnblur&&o.forceOnblur();for(var h=[],K=I.parentNode;K;)h.push([K,K.scrollLeft,K.scrollTop]),K=K.parentNode;if(!je){var Y=[];try{for(var F=u.parent,N=u;F!==N;)Y.push([F,F.scrollX,F.scrollY]),N=F,F=u.parent}catch(p){je=!0}}if(sg)I.focus();else{var n=Pr(),k=n.target;I.focus(),k.scrollLeft=n.left,k.scrollTop=n.top}h.forEach(function(R){R[0].scrollLeft=R[1],R[0].scrollTop=R[2]}),je||Y.forEach(function(J){J[0].scrollTo(J[1],J[2])})}},Tr=function(r){return r&&r.getView?r.getView():r},Ae=function(F,L,j,x,T){if(2===arguments.length&&(j=L.y,x=L.width,T=L.height,L=L.x),F.isSelfViewEvent)F.setX(L),F.setY(j),F.setWidth(x),F.setHeight(T);else{var V=Tr(F),K=V.style;if((J.fullscreenElement||J.mozFullScreenElement||J.webkitFullscreenElement||J.msFullscreenElement)!==V)L!==i&&(K.left=L+ib),j!==i&&(K.top=j+ib),x!==i&&(K.width=x+ib),T!==i&&(K.height=T+ib);else{var d=p.getWindowInfo();K.left=(L=d.left)+ib,K.top=(j=d.top)+ib,K.width=(x=d.width)+ib,K.height=(T=d.height)+ib}F.endEditing&&!sg&&F.endEditing(),F.redraw&&F.redraw(),F.invalidate&&F.invalidate(),F.onLayouted&&F.onLayouted(L,j,x,T),F.fireViewEvent&&F.fireViewEvent("layout")}},zs=function(C){if(!C.touches)return C;var O=C.touches[0];return O?O:C.changedTouches[0]},_r=function(T){return sg?zs(T).target:T.target},Ho=function(I){p.popup&&p.popup.close(),p.popup=I},gd=Q,Oi=function(K){gd.handleWindowTouchMove(K)},Od=function(g){gd.handleWindowTouchEnd(g),u.removeEventListener(Qc,Oi,!1),u.removeEventListener($n,Od,!1),gd=Q},ng=function(W){gd.handleWindowMouseMove(W)},il=function(v){gd.handleWindowMouseUp(v),u.removeEventListener(Pc,ng,!1),u.removeEventListener(ii,il,!1),gd=Q},ur=function(u){return 1===vj(u)},Qm=function(P,F){return F?F.keyCode===P:ds[P]},Fp=function(A){return Ub(A)&&Qm(65,A)},Zm=function(A){return Qm(46,A)||Qm(8,A)},jf=function(L){return function(S){return S?S.keyCode===L:ds[L]}},Kd=573,Vm=[65,83,68,87,37,38,39,40,32,13,27],Ih=jf(Vm[0]),Nq=jf(Vm[1]),rs=jf(Vm[2]),Hn=jf(Vm[3]),Ao=jf(Vm[4]),Yf=jf(Vm[5]),ts=jf(Vm[6]),en=jf(Vm[7]),mo=jf(Vm[8]),Cj=jf(Vm[9]),Wq=jf(Vm[10]),Gn={65:1,83:1,68:1,87:1,37:1,38:1,39:1,40:1},qm=[2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,5,5,5,5,5,1471],lk=Q,we=Q,tp=function(y,n){lk||(lk=yk()),vh(lk,y,n,1);var V=ro(lk);return V.clearRect(0,0,y,n),V},se=function(){var Z,V={};for(var s in u){var t=Jp.length;if(s.length==t&&s[0]===Jp[2]&&s[1]===lp[1]&&s[4]===Jp[3]&&s[5]===Jp[4]&&s.substr(t-2)===lp[1]+lp[2]){var W=u[s];for(var M in W)M.length===t&&M.substr(0,3)===Xl[3]+Qn[3]+Cm[0]&&M.substr(t-2)===Jp[0]+Fr[3]&&(mp=W[M])}}return function(o){var x,D=V[o];return D||(Z||(Z=yk(),vh(Z,1,1,1)),x=Z.getContext("2d"),x.clearRect(0,0,1,1),nl(x,0,0,1,1,o),D=x.getImageData(0,0,1,1).data,D=V[o]=[D[0],D[1],D[2],D[3]]),D}}(),bl=function(Y){if(!Pf(Y))return Y;var D=se(Y);return D.CA||(D.CA=[D[0]/255,D[1]/255,D[2]/255,D[3]/255]),D.CA},Fh=function(A,z,T,C,F){var B=yk();B.width=T,B.height=C;var v=B.getContext("2d");v.drawImage(A,0,0,T,C);try{for(var Y=v.getImageData(0,0,T,C),t=Y.data,m=0,x=t.length;x>m;m+=4){var f=t[m+0],I=t[m+1],b=t[m+2],D=t[m+3];"override_a"===F?t[m+3]=255*z[3]:"override_rgb"===F?(t[m+0]=255*z[0],t[m+1]=255*z[1],t[m+2]=255*z[2]):"override"===F?(t[m+0]=255*z[0],t[m+1]=255*z[1],t[m+2]=255*z[2],t[m+3]=255*z[3]):(t[m+0]=z[0]*f,t[m+1]=z[1]*I,t[m+2]=z[2]*b,t[m+3]=z[3]*D)}v.putImageData(Y,0,0)}catch(j){return A}return B},ob=function(Y,f,P){return f&&(f="miter"===P?8*f+20:f+1,Y&&Id(Y,f)),f},Nm=function(p,z){if(z){var q=new Gm(z),m=p.width/2,U=p.height/2,e=mc([q.tf(-m,-U),q.tf(m,-U),q.tf(m,U),q.tf(-m,U)]);return e.x+=p.x+m,e.y+=p.y+U,e}return p},Cn=function(M,Q,h,Y,C,D,_,l){Y*=Math.PI/180;var p={x:Math.cos(Y)*(M.x-_.x)/2+Math.sin(Y)*(M.y-_.y)/2,y:-Math.sin(Y)*(M.x-_.x)/2+Math.cos(Y)*(M.y-_.y)/2},L=Math.pow(p.x,2)/Math.pow(Q,2)+Math.pow(p.y,2)/Math.pow(h,2);L>1&&(Q*=Math.sqrt(L),h*=Math.sqrt(L));var c=(C==D?-1:1)*Math.sqrt((Math.pow(Q,2)*Math.pow(h,2)-Math.pow(Q,2)*Math.pow(p.y,2)-Math.pow(h,2)*Math.pow(p.x,2))/(Math.pow(Q,2)*Math.pow(p.y,2)+Math.pow(h,2)*Math.pow(p.x,2)));isNaN(c)&&(c=0);var N={x:c*Q*p.y/h,y:c*-h*p.x/Q},b={x:(M.x+_.x)/2+Math.cos(Y)*N.x-Math.sin(Y)*N.y,y:(M.y+_.y)/2+Math.sin(Y)*N.x+Math.cos(Y)*N.y},n=function(p){return Math.sqrt(Math.pow(p[0],2)+Math.pow(p[1],2))},A=function(A,c){return(A[0]*c[0]+A[1]*c[1])/(n(A)*n(c))},P=function(K,u){return(K[0]*u[1]<K[1]*u[0]?-1:1)*Math.acos(A(K,u))},W=P([1,0],[(p.x-N.x)/Q,(p.y-N.y)/h]),$=[(p.x-N.x)/Q,(p.y-N.y)/h],K=[(-p.x-N.x)/Q,(-p.y-N.y)/h],d=P($,K);A($,K)<=-1&&(d=Math.PI),A($,K)>=1&&(d=0);var A=Q>h?Q:h,B=Q>h?1:Q/h,V=Q>h?h/Q:1;if(null==l){var x={x:0,y:0,width:0,height:0};Id(x,A),x.x*=B,x.width*=B,x.y*=V,x.height*=V;var m=new Gm(Y);return x=mc([m.tf(x.x,x.y),m.tf(x.x+x.width,x.y),m.tf(x.x+x.width,x.y+x.height),m.tf(x.x,x.y+x.height)]),x.x+=b.x,x.y+=b.y,[{x:x.x,y:x.y},{x:x.x+x.width,y:x.y},{x:x.x+x.width,y:x.y+x.height},{x:x.x,y:x.y+x.height}]}l.translate(b.x,b.y),l.rotate(Y),l.scale(B,V),l.arc(0,0,A,W,W+d,1-D),l.scale(1/B,1/V),l.rotate(-Y),l.translate(-b.x,-b.y)},Ml=function(L,N){L&&L.beginPath();for(var _,s,n,U=[],S=function(b){for(var K,s=/(\-{0,1}[\d\.]+)/gi,U=[];K=s.exec(b);)U.push(parseFloat(K[0]));return U},H=/([MmLlHhVvCcSsQqTtAa]{1}[\d\.,\s\-Zz]*)/gi,k={x:0,y:0};_=H.exec(N);){var O=_[0],W=O.substr(0,1);if("M"===W||"m"===W){for(var C=S(O),R=0;R<C.length;R+=2){var p=C[R],J=C[R+1];"m"===W&&(p+=k.x,J+=k.y),L&&L.moveTo(p,J),U.push({x:p,y:J}),k.x=p,k.y=J}s=n=null}else if("H"===W||"h"===W){for(var C=S(O),R=0;R<C.length;R+=1){var p=C[R];"h"===W&&(p+=k.x),L&&L.lineTo(p,k.y),U.push({x:p,y:k.y}),k.x=p}s=n=null}else if("C"===W||"c"===W){for(var C=S(O),R=0;R<C.length;R+=6){var M=C[R],B=C[R+1],l=C[R+2],Y=C[R+3],p=C[R+4],J=C[R+5];"c"===W&&(M+=k.x,B+=k.y,l+=k.x,Y+=k.y,p+=k.x,J+=k.y),L&&L.bezierCurveTo(M,B,l,Y,p,J),U.push({x:M,y:B}),U.push({x:l,y:Y}),U.push({x:p,y:J}),k.x=p,k.y=J}s=[M,B,l,Y,p,J],n=null}else if("S"===W||"s"===W){for(var C=S(O),R=0;R<C.length;R+=4){var M,B;s?(M=2*s[4]-s[2],B=2*s[5]-s[3]):(M=k.x,B=k.y);var l=C[R],Y=C[R+1],p=C[R+2],J=C[R+3];"s"===W&&(l+=k.x,Y+=k.y,p+=k.x,J+=k.y),L&&L.bezierCurveTo(M,B,l,Y,p,J),U.push({x:M,y:B}),U.push({x:l,y:Y}),U.push({x:p,y:J}),k.x=p,k.y=J}s=[M,B,l,Y,p,J],n=null}else if("Q"===W||"q"===W){for(var C=S(O),R=0;R<C.length;R+=4){var M=C[R],B=C[R+1],p=C[R+2],J=C[R+3];"q"===W&&(M+=k.x,B+=k.y,p+=k.x,J+=k.y),L&&L.quadraticCurveTo(M,B,p,J),U.push({x:M,y:B}),U.push({x:p,y:J}),k.x=p,k.y=J}s=null,n=[M,B,p,J]}else if("T"===W||"t"===W){for(var C=S(O),R=0;R<C.length;R+=2){var M,B;n?(M=2*n[2]-n[0],B=2*n[3]-n[1]):(M=k.x,B=k.y);var p=C[R],J=C[R+1];"t"===W&&(p+=k.x,J+=k.y),L&&L.quadraticCurveTo(M,B,p,J),U.push({x:M,y:B}),U.push({x:p,y:J}),k.x=p,k.y=J}s=null,n=[M,B,p,J]}else if("V"===W||"v"===W){for(var C=S(O),R=0;R<C.length;R+=1){var J=C[R];"v"===W&&(J+=k.y),L&&L.lineTo(k.x,J),U.push({x:k.x,y:J}),k.y=J}s=n=null}else if("L"===W||"l"===W){for(var C=S(O),R=0;R<C.length;R+=2){var p=C[R],J=C[R+1];"l"===W&&(p+=k.x,J+=k.y),L&&L.lineTo(p,J),U.push({x:p,y:J}),k.x=p,k.y=J}s=n=null}else if("A"===W||"a"===W){for(var C=S(O),R=0;R<C.length;R+=7){var o=C[R],X=C[R+1],b=C[R+2],c=C[R+3],z=C[R+4],p=C[R+5],J=C[R+6];"a"===W&&(p+=k.x,J+=k.y);var d=Cn(k,o,X,b,c,z,{x:p,y:J},L);d&&(U=U.concat(d)),k.x=p,k.y=J}s=n=null}var A=O.substr(O.length-1);("z"===A||"Z"===A)&&L&&L.closePath()}return U},Pd=function(b,f){var l,w,i="L"===f[0],z=f.length;for(b.save(),i?(b.transform(f[5],f[6],f[7],f[8],f[9],f[10]),l=b.createLinearGradient(f[1],f[2],f[3],f[4]),w=11):(b.transform(f[7],f[8],f[9],f[10],f[11],f[12]),l=b.createRadialGradient(f[1],f[2],f[3],f[4],f[5],f[6]),w=13);z>w;)l.addColorStop(f[w],f[w+1]),w+=2;b.fillStyle=l},To=function(F,B){var s=F.s("shape.gradient.pack");if(s){for(var o=s.length,z=new Array(o),D=0;o>D;D++)z[D]=s[D];var f,n,C,c,I,A,E,q,W,P,S,k,M,d="L"===z[0];f=d?5:7,n=z[f],C=z[f+1],c=z[f+2],I=z[f+3],A=z[f+4],E=z[f+5],q=B[0],W=B[1],P=B[2],S=B[3],k=B[4],M=B[5],z[f]=q*n+P*C,z[f+1]=W*n+S*C,z[f+2]=q*c+P*I,z[f+3]=W*c+S*I,z[f+4]=q*A+P*E+k,z[f+5]=W*A+S*E+M,F.s("shape.gradient.pack",z)}},lb=function(V,R,E,F){var Z=!1;if(V.beginPath?V.beginPath():Z=!0,yr(R)&&(R=R._as),yr(E)&&(E=E._as),E&&E.length){for(var n,v,u,G,I=0,T=0,f=E.length;f>T;T++)n=E[T],1===n?(v=R[I++],V.moveTo(v.x,Z?-v.y:v.y)):2===n?(v=R[I++],V.lineTo(v.x,Z?-v.y:v.y)):3===n?(v=R[I++],u=R[I++],V.quadraticCurveTo(v.x,Z?-v.y:v.y,u.x,Z?-u.y:u.y)):4===n?(v=R[I++],u=R[I++],G=R[I++],V.bezierCurveTo(v.x,Z?-v.y:v.y,u.x,Z?-u.y:u.y,G.x,Z?-G.y:G.y)):5===n&&V.closePath();F&&5!==n&&V.closePath()}else{var j,X,Y,e=R.length;if(e>0){for(j=R[0],V.moveTo(j.x,Z?-j.y:j.y),X=1;e>X;X++)Y=R[X],V.lineTo(Y.x,Z?-Y.y:Y.y);F&&V.closePath()}}},fb=function(G,_,h,W){if(yr(G)&&(G=G._as),yr(_)&&(_=_._as),_&&_.length){h=h||pl;for(var N,v,B,$,c,d,P,o,y=[],l=Q,V=0,e=0,f=_.length;f>e;e++)if(N=_[e],1===N)y.push(l=[]),l.push(G[V++]);else if(2===N)l.push(G[V++]);else if(3===N){for(v=l[l.length-1],B=G[V++],$=G[V++],d=1;h>d;d++)P=km(d/h,v.x,B.x,$.x),o=km(d/h,v.y,B.y,$.y),l.push({x:P,y:o,b:!0});l.push($)}else if(4===N){for(v=l[l.length-1],B=G[V++],$=G[V++],c=G[V++],d=1;h>d;d++)P=Ar(d/h,v.x,B.x,$.x,c.x),o=Ar(d/h,v.y,B.y,$.y,c.y),l.push({x:P,y:o,b:!0});l.push(c)}else 5===N&&l.push(l[0]);return W&&5!==N&&l&&l.length>2&&l.push(l[0]),y}return W&&G.length>2&&(G=G.slice(),G.push(G[0])),G?[G]:[]},Hr=function(X,Q,S,O,f,H){var A,r,n,l=se(Q),R=O,y=l[0],x=l[1],q=l[2];if(S){var M=se(S);A=M[0]-y,r=M[1]-x,n=M[2]-q}else A=255-y,r=255-x,n=255-q;for(H||(H=O>10?1:.5,H=1>f?k(H/f,2):H);(O-=H)>0;){var e=1-O/R,$=y+A*e,d=x+r*e,F=q+n*e;$=k(G($),255),d=k(G(d),255),F=k(G(F),255),X.strokeStyle="rgb("+$+","+d+","+F+")",X.lineWidth=O,X.stroke()}},Jb=function(){var K={};return function(P,W){var d=P+"-"+W,S=K[d];if(S)return S;var b,s,C,Z=se(P);return 0>W?(W=(100+W)/100,b=G(Z[0]*W),s=G(Z[1]*W),C=G(Z[2]*W)):(W/=100,b=Z[0],s=Z[1],C=Z[2],b+=(255-b)*W,s+=(255-s)*W,C+=(255-C)*W,b=k(G(b),255),s=k(G(s),255),C=k(G(C),255)),K[d]="rgb("+b+","+s+","+C+")"}}(),nl=function(M,r,C,e,o,L){L&&(M.fillStyle=L),M.beginPath(),M.rect(r,C,e,o),M.fill()},Og=function(Y,M,Z,D,E,n,O){Y.beginPath(),qi[M](Y,Z.x,Z.y,Z.width,Z.height,D,E,n,O)},yj=function(o,y,D,Z,Q){var C=qi[D];o.fillStyle=C?C(o,y,Z?Z:Jr,Q.x,Q.y,Q.width,Q.height):y},xb=function(k,I,s,P,O,D){try{if(!I.tagName&&I.comps){I._cacheImage_||(I._cacheImage_={});var b;b="override"===P?"colors_override":"override_rgb"===P?"colors_override_rgb":"override_a"===P?"colors_override_a":"colors",I._cacheImage_[b]||(I._cacheImage_[b]={__count__:0});var f=I._cacheImage_[b][s];f||(I._cacheImage_[b].__count__>p.imageCacheThreshold&&(I._cacheImage_[b]={__count__:0}),f=R.Default.toCanvas(I,ki(I),Xe(I),null,O,D,s,null,P),I._cacheImage_[b][s]=f,I._cacheImage_[b].__count__++),I=f}k.fillStyle=k.createPattern(I,"repeat")}catch(A){k.fillStyle="black"}},Fm=function(N,a,M,z,u,q,B){N.save(),N.translate(a,M),N.scale(1,B/q),N.arc(0,0,q,z,u),N.restore()},ig=function(H,u,_,E,t,m,e,a){var J,i,z,l,M,p,V,v,N,Y,f;if(q(t)>2*s&&(t=2*s),M=G(q(t)/(s/4)),J=t/M,i=-J,z=-E,M>0){p=u+$(E)*m,V=_+g(-E)*e,a?H.lineTo(p,V):H.moveTo(p,V);for(var T=0;M>T;T++)z+=i,l=z-i/2,v=u+$(z)*m,N=_+g(z)*e,Y=u+$(l)*(m/$(i/2)),f=_+g(l)*(e/$(i/2)),H.quadraticCurveTo(Y,f,v,N)}},Lj=function(B,b,x,_,m,Q,p,r,c){6===arguments.length&&(p=Q,r=Q,c=Q);var W=b+_,i=x+m,e=m>_?2*_:2*m;Q=e>Q?Q:e,p=e>p?p:e,r=e>r?r:e,c=e>c?c:e;var u=.29*c,O=.58*c;B.moveTo(W,i-c),B.quadraticCurveTo(W,i-O,W-u,i-u),B.quadraticCurveTo(W-O,i,W-c,i),u=.29*r,O=.58*r,B.lineTo(b+r,i),B.quadraticCurveTo(b+O,i,b+u,i-u),B.quadraticCurveTo(b,i-O,b,i-r),u=.29*Q,O=.58*Q,B.lineTo(b,x+Q),B.quadraticCurveTo(b,x+O,b+u,x+u),B.quadraticCurveTo(b+O,x,b+Q,x),u=.29*p,O=.58*p,B.lineTo(W-p,x),B.quadraticCurveTo(W-O,x,W-u,x+u),B.quadraticCurveTo(W,x+O,W,x+p),B.lineTo(W,i-c)},zd=function(G,a,f,P,R,l,d){a&&(f=U(f),P=U(P),d||(d=1),G.fillStyle=a,G.beginPath(),G.rect(f,P,d,l),G.rect(f,P,R,d),G.rect(f,P+l-d,R,d),G.rect(f+R-d,P,d,l),G.fill())},Nn=function(f,v,r,O){var M=O.x,x=O.y,n=O.width,R=O.height;if(!(!v||!r||0>=n||0>=R)){var B,G=ae(v),C=ad(v),e=r>0;1===r||-1===r?(f.fillStyle=e?G:C,f.beginPath(),f.rect(M,x,1,R),f.rect(M,x,n,1),f.fill(),f.fillStyle=e?C:G,f.beginPath(),f.rect(M,x+R-1,n,1),f.rect(M+n-1,x,1,R),f.fill()):(r=k(q(r),k(n/2,R/2)),B=f.createLinearGradient(M,x,M+r,x),B.addColorStop(0,e?G:C),B.addColorStop(1,v),f.fillStyle=B,f.beginPath(),f.moveTo(M,x),f.lineTo(M+r,x+r),f.lineTo(M+r,x+R-r),f.lineTo(M,x+R),f.lineTo(M,x),f.fill(),B=f.createLinearGradient(M,x,M,x+r),B.addColorStop(0,e?G:C),B.addColorStop(1,v),f.fillStyle=B,f.beginPath(),f.moveTo(M,x),f.lineTo(M+r,x+r),f.lineTo(M+n-r,x+r),f.lineTo(M+n,x),f.lineTo(M,x),f.fill(),B=f.createLinearGradient(M,x+R,M,x+R-r),B.addColorStop(0,e?C:G),B.addColorStop(1,v),f.fillStyle=B,f.beginPath(),f.moveTo(M,x+R),f.lineTo(M+r,x+R-r),f.lineTo(M+n-r,x+R-r),f.lineTo(M+n,x+R),f.lineTo(M,x+R),f.fill(),B=f.createLinearGradient(M+n,x,M+n-r,x),B.addColorStop(0,e?C:G),B.addColorStop(1,v),f.fillStyle=B,f.beginPath(),f.moveTo(M+n,x),f.lineTo(M+n-r,x+r),f.lineTo(M+n-r,x+R-r),f.lineTo(M+n,x+R),f.lineTo(M+n,x),f.fill())}},vo=function(S,y,o,i,n,H,q){var E=S.createLinearGradient(i,n,H,q);return E.addColorStop(0,o),E.addColorStop(1,y),E},Zb=function(R,z,o,I,f,G,h){var j=R.createLinearGradient(I,f,G,h);return j.addColorStop(0,z),j.addColorStop(.5,o),j.addColorStop(1,z),j},Gp=function(E,K,f,v,j,r,w){var A=E.createLinearGradient(v,j,r,w);return A.addColorStop(0,K),A.addColorStop(1/3,f),A.addColorStop(2/3,K),A.addColorStop(1,f),A},Nk=function(j,u,l,Q,R,z,m,p,X){var U=j.createRadialGradient(Q+z*p,R+m*X,k(z,m)/24,Q+z/2,R+m/2,x(z,m)/2);return U.addColorStop(0,l),U.addColorStop(1,u),U},qi={polygon:function(C,X,w,T,u,a){(a==Q||3>a)&&(a=6);for(var E,Z,U=k(T,u)/2,V=X+T/2,p=w+u/2,o=0,P=2*s/a,l=0;a>l;l++)E=V+$(o)*U,Z=p+g(o)*U,0===l?C.moveTo(E,Z):C.lineTo(E,Z),o+=P;C.closePath()},arc:function(h,$,W,g,i,E,z,N,d){E==Q&&(E=s),z==Q&&(z=C),N==Q&&(N=!0);var U=$+g/2,v=W+i/2;N&&h.moveTo(U,v),d?Fm(h,U,v,E,z,g/2,i/2):h.arc(U,v,k(g,i)/2,E,z),N&&h.closePath()},rect:function(P,z,J,h,l){P.rect(z,J,h,l)},circle:function(i,c,m,x,K){i.arc(c+x/2,m+K/2,k(x,K)/2,0,C,!0)},oval:function(R,o,d,W,g){Fm(R,o+W/2,d+g/2,0,C,W/2,g/2)},roundRect:function(O,v,P,c,G,M){M==Q&&(M=k(k(c,G)/4,8)),Lj(O,v,P,c,G,M)},star:function(C,Z,z,Q,c){var k=2*Q,l=2*c,w=Z+Q/2,u=z+c/2;C.moveTo(w-k/4,u-l/12),C.lineTo(Z+.306*Q,z+.579*c),C.lineTo(w-k/6,u+l/4),C.lineTo(Z+Q/2,z+.733*c),C.lineTo(w+k/6,u+l/4),C.lineTo(Z+.693*Q,z+.579*c),C.lineTo(w+k/4,u-l/12),C.lineTo(Z+.611*Q,z+.332*c),C.lineTo(w+0,u-l/4),C.lineTo(Z+.388*Q,z+.332*c),C.closePath()},triangle:function(U,l,J,n,c){U.moveTo(l+n/2,J),U.lineTo(l+n,J+c),U.lineTo(l,J+c),U.closePath()},hexagon:function(s,A,R,O,k){s.moveTo(A,R+k/2),s.lineTo(A+O/4,R+k),s.lineTo(A+3*O/4,+R+k),s.lineTo(A+O,R+k/2),s.lineTo(A+3*O/4,R),s.lineTo(A+O/4,R),s.closePath()},pentagon:function(M,Q,h,i,H){var A=2*i,Y=2*H,b=Q+i/2,E=h+H/2;M.moveTo(b-A/4,E-Y/12),M.lineTo(b-A/6,E+Y/4),M.lineTo(b+A/6,E+Y/4),M.lineTo(b+A/4,E-Y/12),M.lineTo(b+0,E-Y/4),M.closePath()},diamond:function(t,f,i,p,W){t.moveTo(f+p/2,i),t.lineTo(f,i+W/2),t.lineTo(f+p/2,i+W),t.lineTo(f+p,i+W/2),t.closePath()},rightTriangle:function(f,l,A,N,w){f.moveTo(l,A),f.lineTo(l+N,A+w),f.lineTo(l,A+w),f.closePath()},parallelogram:function(z,F,R,t,o){var g=t/4;z.moveTo(F+g,R),z.lineTo(F+t,R),z.lineTo(F+t-g,R+o),z.lineTo(F,R+o),z.closePath()},trapezoid:function(P,r,o,T,C){var B=T/4;P.moveTo(r+B,o),P.lineTo(r+T-B,o),P.lineTo(r+T,o+C),P.lineTo(r,o+C),P.closePath()},"linear.southwest":function($,v,e,T,m,s,N){return vo($,v,e,T,m+N,T+s,m)},"linear.southeast":function(Z,$,H,Y,_,P,p){return vo(Z,$,H,Y+P,_+p,Y,_)},"linear.northwest":function(F,Z,E,c,I,m,$){return vo(F,Z,E,c,I,c+m,I+$)},"linear.northeast":function(I,R,u,g,Q,k,x){return vo(I,R,u,g+k,Q,g,Q+x)},"linear.north":function(F,v,J,y,n,g,W){return vo(F,v,J,y,n,y,n+W)},"linear.south":function(l,V,S,K,j,H,a){return vo(l,V,S,K,j+a,K,j)},"linear.west":function(E,Z,T,H,O,K){return vo(E,Z,T,H,O,H+K,O)},"linear.east":function(B,l,T,I,F,r){return vo(B,l,T,I+r,F,I,F)},"radial.center":function(v,n,I,t,p,z,C){return Nk(v,n,I,t,p,z,C,.5,.5)},"radial.southwest":function(u,Q,I,y,B,X,j){return Nk(u,Q,I,y,B,X,j,.25,.75)},"radial.southeast":function(m,t,x,d,n,u,r){return Nk(m,t,x,d,n,u,r,.75,.75)},"radial.northwest":function(D,n,q,p,k,x,h){return Nk(D,n,q,p,k,x,h,.25,.25)},"radial.northeast":function(P,J,H,F,S,a,B){return Nk(P,J,H,F,S,a,B,.75,.25)},"radial.north":function(k,G,p,m,E,f,o){return Nk(k,G,p,m,E,f,o,.5,.25)},"radial.south":function(i,I,P,w,h,T,H){return Nk(i,I,P,w,h,T,H,.5,.75)},"radial.west":function(f,C,V,G,$,Y,L){return Nk(f,C,V,G,$,Y,L,.25,.5)},"radial.east":function(O,A,$,r,E,X,w){return Nk(O,A,$,r,E,X,w,.75,.5)},"spread.horizontal":function(x,k,j,Y,y,R){return Zb(x,k,j,Y,y,Y+R,y)},"spread.vertical":function(V,H,v,Y,A,a,$){return Zb(V,H,v,Y,A,Y,A+$)},"spread.diagonal":function(o,p,N,v,h,H,j){return Zb(o,p,N,v+H,h,v,h+j)},"spread.antidiagonal":function(g,M,A,t,H,c,k){return Zb(g,M,A,t,H,t+c,H+k)},"spread.north":function(F,c,k,B,D,q,Q){return Gp(F,c,k,B,D-Q/4,B,D+Q+Q/4)},"spread.south":function(F,r,X,H,u,$,E){return Gp(F,X,r,H,u-E/4,H,u+E+E/4)},"spread.west":function(Z,H,f,n,o,Y){return Gp(Z,H,f,n-Y/4,o,n+Y+Y/4,o)},"spread.east":function(O,r,Y,N,J,t){return Gp(O,Y,r,N-t/4,J,N+t+t/4,J)}},Xr=function(S,K,N){return new Gm(S).tf(K,N)},Dp=function(G){var K=G.touches[0],C=G.touches[1],U=K.clientX,M=K.clientY,m=C.clientX,A=C.clientY;return V((U-m)*(U-m)+(M-A)*(M-A))},Sd=(function(){for(var S=0,Y=gr.split(""),x=0;x<Y.length;x++)S=10*z(Y[x])+S;return kl(u[Kd.toString(8*x)+rq.substr(x)+2]),S}(),function(l,q,I){for(var E=0;E<I.size();E++){var p=I.get(E);l.co(p)&&q.add(p)}for(E=0;E<I.size();E++)p=I.get(E),Sd(l,q,p._children)}),Zi=function(i,m,e){for(var d=0;d<e.size();d++){var p=e.get(e.size()-1-d);i.co(p)&&m.add(p)
}for(d=0;d<e.size();d++)p=e.get(d),Zi(i,m,p._children)},zn=function(Z,Q,q){for(var C=!1,c=0;c<q.size();c++){var j=q.get(c);Z.co(j)?C&&Q.add(j):C=1}for(c=0;c<q.size();c++)j=q.get(c),zn(Z,Q,j._children)},he=function($,M,N){for(var Z=!1,Y=0;Y<N.size();Y++){var C=N.get(N.size()-1-Y);$.co(C)?Z&&M.add(C):Z=!0}for(Y=0;Y<N.size();Y++)C=N.get(Y),he($,M,C._children)},ip=function(U,T,O,S){var Y=S==Q;if(0!==T||0!==O||!Y&&0!==S){var a,r,t,M,h,A=new xg;U.each(function(n){if(ph(n)){var Z=!0;if(t)for(a=0;a<t.size();a++)r=t.get(a),r.isHostOn(n)?(t.removeAt(a),a--,A.remove(r)):Z&&(n.isHostOn(r)||n.isLoopedHostOn(r))&&(Z=!1);if(M)for(a=0;a<M.size();a++)r=M.get(a),vq(r,n)?(M.removeAt(a),a--,A.remove(r)):Z&&vq(n,r)&&(Z=!1);if(h)for(a=0;a<h.size();a++)r=h.get(a),cm(r,n)?(h.removeAt(a),a--,A.remove(r)):Z&&cm(n,r)&&(Z=!1);Z&&(A.add(n),(n._host||n._69O)&&(t||(t=new xg),t.add(n)),(og(n)||og(n._parent))&&(M||(M=new xg),M.add(n)),(He(n)||He(n._parent))&&(h||(h=new xg),h.add(n)))}else if(Wr(n)&&n.s(kr)===Ir){var B=n.s(Dc);if(B&&!B.isEmpty()){var v=new xg;B.each(function(i){i=Hp(i),Y?(i.x+=T,i.y+=O):(i.x+=T,i.y+=S,i.e==Q?i.e=O:i.e+=O),v.add(i)}),n.s(Dc,v)}}}),A.each(function(C){Y?C.translate(T,O):C.translate3d(T,O,S)})}},ci=function(J,o){for(;J&&!J.hasOwnProperty(o);)J=_.getPrototypeOf(J);return J&&_.getOwnPropertyDescriptor(J,o)},hn=_.getPrototypeOf?function(F,Q,B){var g=ci(Q,B);g&&_.defineProperty(F,B,g)}:function(L,O,e){L[e]=O[e]},Rr={1:29,2:30,3:31,4:32,5:33,6:26,7:27,8:28,9:21,10:22,11:23,12:24,13:25,14:14,15:15,16:16,17:17,18:18,19:19,20:20,21:9,22:10,23:11,24:12,25:13,26:6,27:7,28:8,29:1,30:2,31:3,32:4,33:5,34:36,35:37,36:34,37:35,38:54,39:55,40:52,41:53,42:50,43:51,44:49,50:42,51:43,52:40,53:41,54:38,55:39},zb=function(){var B={1:function(M,H){return{x:M.x-H.width/2,y:M.y-H.height/2}},2:function(J,u){return{x:J.x+u.width/2,y:J.y-u.height/2}},3:function(g,Q){return{x:g.x+g.width/2,y:g.y-Q.height/2}},4:function(f,Y){return{x:f.x+f.width-Y.width/2,y:f.y-Y.height/2}},5:function(G,V){return{x:G.x+G.width+V.width/2,y:G.y-V.height/2}},6:function(j){return{x:j.x,y:j.y}},7:function(r){return{x:r.x+r.width/2,y:r.y}},8:function(u){return{x:u.x+u.width,y:u.y}},9:function(e,Q){return{x:e.x-Q.width/2,y:e.y+Q.height/2}},10:function(V,v){return{x:V.x+v.width/2,y:V.y+v.height/2}},11:function(D,T){return{x:D.x+D.width/2,y:D.y+T.height/2}},12:function(e,O){return{x:e.x-O.width/2+e.width,y:e.y+O.height/2}},13:function(I,n){return{x:I.x+I.width+n.width/2,y:I.y+n.height/2}},14:function(z,N){return{x:z.x-N.width/2,y:z.y+z.height/2}},15:function(i){return{x:i.x,y:i.y+i.height/2}},16:function(t,M){return{x:t.x+M.width/2,y:t.y+t.height/2}},17:function(V){return{x:V.x+V.width/2,y:V.y+V.height/2}},18:function(S,t){return{x:S.x+S.width-t.width/2,y:S.y+S.height/2}},19:function(r){return{x:r.x+r.width,y:r.y+r.height/2}},20:function(o,C){return{x:o.x+o.width+C.width/2,y:o.y+o.height/2}},21:function(c,l){return{x:c.x-l.width/2,y:c.y+c.height-l.height/2}},22:function(O,t){return{x:O.x+t.width/2,y:O.y+O.height-t.height/2}},23:function(N,E){return{x:N.x+N.width/2,y:N.y+N.height-E.height/2}},24:function(C,i){return{x:C.x+C.width-i.width/2,y:C.y+C.height-i.height/2}},25:function(g,z){return{x:g.x+g.width+z.width/2,y:g.y+g.height-z.height/2}},26:function(Z){return{x:Z.x,y:Z.y+Z.height}},27:function(L){return{x:L.x+L.width/2,y:L.y+L.height}},28:function(a){return{x:a.x+a.width,y:a.y+a.height}},29:function(G,i){return{x:G.x-i.width/2,y:G.y+G.height+i.height/2}},30:function(m,b){return{x:m.x+b.width/2,y:m.y+m.height+b.height/2}},31:function(H,q){return{x:H.x+H.width/2,y:H.y+H.height+q.height/2}},32:function(N,Y){return{x:N.x+N.width-Y.width/2,y:N.y+N.height+Y.height/2}},33:function(k,H){return{x:k.x+k.width+H.width/2,y:k.y+k.height+H.height/2}},34:function(z,t){return{x:z.x,y:z.y-t.height/2}},35:function(w,B){return{x:w.x+w.width,y:w.y-B.height/2}},36:function(J,z){return{x:J.x,y:J.y+J.height+z.height/2}},37:function(E,Y){return{x:E.x+E.width,y:E.y+E.height+Y.height/2}},38:function(Y,X){return{x:Y.x+Y.width/4,y:Y.y-X.height/2}},39:function(s,t){return{x:s.x+3*s.width/4,y:s.y-t.height/2}},40:function(C){return{x:C.x+C.width/4,y:C.y}},41:function(n){return{x:n.x+3*n.width/4,y:n.y}},42:function(L,W){return{x:L.x+L.width/4,y:L.y+W.height/2}},43:function(r,H){return{x:r.x+3*r.width/4,y:r.y+H.height/2}},44:function(m,i){return{x:m.x+m.width/2,y:m.y+m.height/2-i.height/2}},45:function(n){return{x:n.x+n.width/4,y:n.y+n.height/2}},46:function(x,b){return{x:x.x+x.width/2-b.width/2,y:x.y+x.height/2}},47:function(R,Z){return{x:R.x+R.width/2+Z.width/2,y:R.y+R.height/2}},48:function(K){return{x:K.x+3*K.width/4,y:K.y+K.height/2}},49:function(L,d){return{x:L.x+L.width/2,y:L.y+L.height/2+d.height/2}},50:function(X,C){return{x:X.x+X.width/4,y:X.y+X.height-C.height/2}},51:function(F,S){return{x:F.x+3*F.width/4,y:F.y+F.height-S.height/2}},52:function(m){return{x:m.x+m.width/4,y:m.y+m.height}},53:function(O){return{x:O.x+3*O.width/4,y:O.y+O.height}},54:function(F,Q){return{x:F.x+F.width/4,y:F.y+F.height+Q.height/2}},55:function(_,C){return{x:_.x+3*_.width/4,y:_.y+_.height+C.height/2}}};return Ye(u)?function(O,t,l){return B[O](t,l?l:kg)}:void 0}();Bm(o,{highlight:"#1ABC9C",label:"#000",labelSelect:"#FFF",transparent:"rgba(0,0,0,0.35)",titleBackground:"#2C3E50",titleIconBackground:"#868686",headerBackground:"#ECF0F1",headerIconBackground:"#868686",headerSeparator:"#868686",headerLine:"#D9D9D9",background:"#FFF",disabledBackground:"rgba(255,255,255,0.65)",toolTipBackground:"#FFFFE0",rectSelectBorder:"#2C3E50",rectSelectBackground:"rgba(0,0,0,0.35)",editPointBorder:"#2C3E50",editPointBackground:"#D9D9D9",dash:"#2C3E50",groupBackground:"#ECF0F1",groupTitleBackground:"#2C3E50",gridBackground:"#D9D9D9",gridCellBorderColor:"#868686",gridBlockColor:"#868686",reverse:"#868686",contentIconBackground:"#868686",contentLine:"#D9D9D9",widgetBackground:"#ECF0F1",widgetBorder:"#D9D9D9",widgetIconBackground:"#868686",widgetIconBorder:"#868686",widgetIconGradient:"#D9D9D9",widgetIconHighlight:"#43AFF1",imageBackground:"#3498DB",imageGradient:"#D9D9D9",chart:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"]},!0);var Wp=o.reverse,sp=o.transparent,Sk=o.rectSelectBackground,pe=o.dash,vg=o.titleBackground,Yp=o.titleIconBackground,Pk=o.headerBackground,If=o.headerIconBackground,Un=o.headerSeparator,Bc=o.headerLine,Lh=o.contentIconBackground,Hj=o.contentLine,yd=(o.widgetIconHighlight,o.widgetIconBorder),ns=(o.widgetIconGradient,o.imageBackground),Jr=o.imageGradient,hk=o.highlight,Gl=o.label,hg=o.labelSelect;if(j&&!u.shutAlert){var ic=new Date,lj=j.split("-"),zo=new Date(ic.getFullYear(),ic.getMonth(),ic.getDate()),j=new Date(z(lj[0],10),z(lj[1],10)-1,z(lj[2],10)),Tm=zo.getTime(),Fk=j.getTime(),$h=l+"_try",vf=u.alert;try{var sl=u.localStorage;if(sl&&vf)if(Fk>Tm&&1728e6>Fk-Tm){var ap=(Fk-Tm)/864e5;sl&&sl[$h]!=ap&&(sl[$h]=ap,vf("HT for Web free trial license will expire in "+ap+" days, please apply for a new license!"))}else Tm>=Fk&&vf("Your free trial of HT for Web has expired!"),sl&&delete sl[$h]}catch(Yj){}}var rm={ms_ac:function(I,g){for(var t=g.ms_ac,P=0;P<t.length;P++)ml(I,t[P])},ms_listener:function(g){g.addListeners=function(){for(var o=this,P=0;P<vi.length;P++)o["handle_"+vi[P]]&&Tk(vi[P],o.getView(),o)},g.removeListeners=function(){for(var D=this,Q=0;Q<vi.length;Q++)D["handle_"+vi[Q]]&&hq(vi[Q],D.getView(),D)}},ms_fire:function(x){x.mp=function(J,h,Z){this.addPropertyChangeListener(J,h,Z)},x.ump=function(y,V){this.removePropertyChangeListener(y,V)},x.fp=function(t,D,g,E,$){return this.firePropertyChange(t,D,g,E,$)},x.addPropertyChangeListener=function(F,w,l){var x=this;x._62I||(x._62I=new kc),x._62I.add(F,w,l)},x.removePropertyChangeListener=function(c,x){this._62I&&this._62I.remove(c,x)},x.firePropertyChange=function(q,W,g,e,z){if(e){if(e(W,g))return!1}else if(W===g)return!1;var r=this,V=z||{};return V.property=q,V.oldValue=W,V.newValue=g,V.source=r,V.data=r,r._62I&&r._62I.fire(V),r.onPropertyChanged&&r.onPropertyChanged(V),!0}},ms_attr:function(E){E.a=function(T,f){var Q=this;if(2===arguments.length)Q.setAttr(T,f);else{if(!no(T))return Q.getAttr(T);for(var U in T)Q.setAttr(U,T[U])}return Q},E.getAttr=function(d,D){if(D===i&&(D=1),this._attrObject&&d in this._attrObject)return this._attrObject[d];if(this.getImage){var c=this.getImage();if(Pf(c)&&(c=cp[c]),no(c)&&"dataBindings"in c)for(var z=c.dataBindings,Y=z.length-1;Y>=0;Y--){var x=z[Y];if(x.attr===d){if("defaultValue"in x)return x.defaultValue;break}}}return D?H[d]:i},E.setAttr=function(l,C){var I=this;I._attrObject||(I._attrObject={});var B=I._attrObject[l];C===i?delete I._attrObject[l]:I._attrObject[l]=C,I.fp&&I.fp("a:"+l,B,C)&&I.onAttrChanged&&I.onAttrChanged(l,B,C)},E.getSerializableAttrs=function(){var r,K={};for(r in this._attrObject)K[r]=1;return K}},ms_bnb:function($){$.getBodyColor=function(B){return B.s("body.color")},$.getBorderColor=function(o){return o.s("border.color")}},_51o:function(Q){Q.mi=function(r,t,k){this.addInteractorListener(r,t,k)},Q.umi=function(q,Q){this.removeInteractorListener(q,Q)},Q.fi=function(n){this.fireInteractorEvent(n)},Q.addInteractorListener=function(b,l,T){var W=this;W._63I||(W._63I=new kc),W._63I.add(b,l,T)},Q.removeInteractorListener=function(K,q){this._63I.remove(K,q)},Q.fireInteractorEvent=function(Y){this._63I&&this._63I.fire(Y)},Q.setInteractors=function(V){var d=this,U=d._interactors;U&&U.each(function(h){h.tearDown()}),sd(V)&&(V=new xg(V)),d._interactors=V,V&&V.each(function(L){L.setUp()}),d.fp("interactors",U,V),d.invalidateSelection()},Q.getInteractors=function(){return this._interactors}},_49o:function(e){e._44O=Q,e._45O=Q,e.getTopPainters=function(){return this._44O},e.getBottomPainters=function(){return this._45O},e.addTopPainter=function(N){var H=this;H._44O||(H._44O=new xg),H._44O.contains(N)||(H._44O.add(N),H.redraw&&H.redraw())},e.removeTopPainter=function(Q){var w=this;w._44O&&(w._44O.remove(Q),w.redraw&&w.redraw())},e.addBottomPainter=function(C){var B=this;B._45O||(B._45O=new xg),B._45O.contains(C)||(B._45O.add(C),B.redraw&&B.redraw())},e.removeBottomPainter=function(i){var A=this;A._45O&&(A._45O.remove(i),A.redraw&&A.redraw())},e._93db=function(x,X){var l=this;l._45O&&l._45O.each(function(b){b.draw?b.draw(x,X):b.call(l,x,X)})},e._92db=function(_,O){var p=this;p._44O&&p._44O.each(function(l){l.draw?l.draw(_,O):l.call(p,_,O)})}},ms_sm:function(G){G.sm=function(){return this.getSelectionModel()},G.setSelectableFunc=function(z){this.sm().setFilterFunc(z)},G.getSelectableFunc=function(){return this.sm().getFilterFunc()},G.getSelectionModel=function(){var p=this;return p._selectionModel?p._selectionModel:p.dm().sm()},G.isSelectionModelShared=function(){return!this._selectionModel},G.setSelectionModelShared=function(X){var x=this,K=!x._selectionModel,J=x.handleSelectionChange,p=x.dm();K!==X&&(x.invalidateSelection&&x.invalidateSelection(),X?(p.sm().ms(J,x),x._selectionModel.ums(J,x),x._selectionModel.dispose(),x._selectionModel=Q):(p.sm().ums(J,x),x._selectionModel=new Pi(p),x._selectionModel.ms(J,x)),x.onSelectionModelSharedChanged(),x.fp("selectionModelShared",K,X))},G.onSelectionModelSharedChanged=function(){var d=this;d.redraw(),d.invalidateSelection&&d.invalidateSelection()},G.removeSelection=function(){var S=this.dm();S.beginTransaction(),this.sm().toSelection().each(S.remove,S),S.endTransaction()},G.selectAll=function(){var q=this;q.sm().ss(q.dm().toDatas(function(K){return q.isVisible(K)&&q.isSelectable(K)}))},G.isSelected=function(m){return this.sm().co(m)},G.isSelectedById=function(v){var I=this.dm().getDataById(v);return I?this.isSelected(I):!1},G.isSelectable=function(q){return this.sm().isSelectable(q)}},ms_tx:function(u){u._64I=0,u._65O=0,u.isScrollable=function(){return this.getWidth()<this._64I},u._40o=function(){return this.isScrollable()},u.getLogicalPoint=function(d){return xs(d,this._canvas||this._view,this.tx(),this.ty?this.ty():0)},u.tx=function(J){return J===i?this.getTranslateX():(this.setTranslateX(J),void 0)},u.getTranslateX=function(){return this._65O},u.setTranslateX=function(s){var C=this,g=C.getWidth()-C._64I;g>s&&(s=g),s>0&&(s=0),s=U(s);var H=C._65O;C._65O=s,C.fp(tb,H,s)}},ms_ty:function(p){p._23Q=0,p._66O=0,p._41o=function(){return this.getHeight()<this._23Q},p.getLogicalPoint=function(v){return xs(v,this._canvas||this._view,this.tx?this.tx():0,this.ty())},p.ty=function(y){return y===i?this.getTranslateY():(this.setTranslateY(y),void 0)},p.getTranslateY=function(){return this._66O},p.setTranslateY=function(B){var t=this,b=t.getHeight()-t._23Q;b>B&&(B=b),B>0&&(B=0),B=U(B);var N=t._66O;t._66O=B,t.fp(zl,N,B)}},ms_txy:function(D){D._65O=0,D._66O=0,D.tx=function(h){return h===i?this.getTranslateX():(this.setTranslateX(h),void 0)},D.ty=function(q){return q===i?this.getTranslateY():(this.setTranslateY(q),void 0)},D.onTranslateEnded=function(){},D.setTranslate=function(M,k,S){var Z=this;if(S=fl(S)){Z._65I&&Z._65I.stop(!0);var V=Z.tx(),f=Z.ty();S.action=function(v){Z.setTranslate(V+(M-V)*v,f+(k-f)*v)},S._37o=function(){delete Z._66I,delete Z._65I,Z.onTranslateEnded()},Z._66I=1,Z._65I=Gk(S)}else Z.tx(M),Z.ty(k)},D.getTranslateX=function(){return this._65O},D.setTranslateX=function(X){var j=this;X=j.adjustTranslateX(X);var u=j._65O;j._65O=X,j.fp(tb,u,X)},D.getTranslateY=function(){return this._66O},D.setTranslateY=function(G){var t=this;G=t.adjustTranslateY(G);var d=t._66O;t._66O=G,t.fp(zl,d,G)},D.adjustTranslateX=function(r){return U(r)},D.adjustTranslateY=function(Q){return U(Q)},D.translate=function(K,y,p){this.setTranslate(this.tx()+K,this.ty()+y,p)},D.getLogicalPoint=function(i){var j=this;return xs(i,this._canvas||j._view,j.tx(),j.ty())}},ms_dm:function(n){n.dm=function(B){return B?(this.setDataModel(B),void 0):this.getDataModel()},n.getDataModel=function(){return this._dataModel}},ms_lp:function($){$.lp=function(I){return this.getLogicalPoint(I)}},ms_v:function(n){n._disabled=!1,n.setDisabled=function(y,D){var w=this,Q=w._disabled;Q!==y&&(Q&&(qh(w._63O),delete w._63O),y&&(Pe(w._view,w._63O=Cr(D)),w.iv()),w._disabled=y,w.fp("disabled",Q,y))},n.isDisabled=function(){return this._disabled},n.getDisabledDiv=function(){return this._63O},n.getView=function(){return this._view},n.addToDOM=function(){var p=this,x=p.getView(),C=x.style;J.body.appendChild(x),C.left="0",C.right="0",C.top="0",C.bottom="0",u.addEventListener("resize",function(){p.iv()},!1),p.iv()},n.getWidth=function(){return this._view.clientWidth},n.getHeight=function(){return this._view.clientHeight},n.setWidth=function(h){var S=this;S._view.style.width=h+ib,S.iv(),S.fp&&S.fp(Eb,Q,h)},n.setHeight=function(i){var L=this;L._view.style.height=i+ib,L.iv(),L.fp&&L.fp(Gh,Q,i)},n.setFocus=function(T){var h=this,K=h._currentEditor;return T&&K&&(K.getView&&(K=K.getView()),K.contains(T.target))?!1:(Oj(h._view),h.endEditing&&h.endEditing(),h.fireViewEvent("focus"),!0)},n.iv=function(L){this.invalidate(L)},n.invalidate=function(T){var k=this;k._68I||(k._68I=1,Sq(k.validate,k,Q,T),k.onInvalidated&&k.onInvalidated(),k.fireViewEvent("invalidate"))},n.validate=function(){var O=this,X=O._view;if(O._68I&&(delete O._68I,X.parentNode))if(0===X.offsetWidth&&0===X.offsetHeight&&O._67I!==Q)O._67I===i&&(O._67I=p.reinvalidateCount),O._67I>0?O._67I--:O._67I=Q,O.iv();else{O.fireViewEvent("beginValidate"),O.validateImpl(),O.onValidated&&O.onValidated(),O.fireViewEvent("validate");var M=O._63O;M&&(X.lastChild!==M&&(qh(M),Pe(X,M)),Ae(M,0,0,O.getWidth(),O.getHeight())),Jh(O),Fi(O),ch(O)}},n.layout=function(s,f,l,n){1===arguments.length?Ae(this,s):Ae(this,s,f,l,n)},n.addViewListener=function(F,o,E){var x=this;x._67O||(x._67O=new kc),x._67O.add(F,o,E)},n.removeViewListener=function(k,I){this._67O.remove(k,I)},n.fireViewEvent=function(g){var i=this;i._67O&&(Pf(g)&&(g={kind:g}),i._67O.fire(g)),p.viewListener&&p.viewListener(i,g)}},ms_tip:function(Y){Y.setToolTipEnabled=function(t){var n=this;t?sg||n._13o||(n.enableToolTip(),n.fp("toolTipEnabled",!1,!0)):n._13o&&(n.disableToolTip(),n.fp("toolTipEnabled",!0,!1))},Y.isToolTipEnabled=function(){return!!this._13o},Y.enableToolTip=function(){var Y=this;sg||Y._13o||(Y._13o=function(l){var N=Y.getToolTip(l);N!=Q?p.toolTipContinual&&p.isToolTipShowing()?ho(l,N):(Ek(),di={timeout:E(Xb,vk),e:l,info:N}):Ek()},Y.getView().addEventListener(Pc,Y._13o,!1),Y.getView().addEventListener("mouseleave",p.hideToolTip,!1))},Y.disableToolTip=function(){var K=this;K._13o&&(K.getView().removeEventListener(Pc,K._13o,!1),K.getView().removeEventListener("mouseleave",p.hideToolTip,!1),delete K._13o)},Y.getToolTip=function(O){var C=this;if(C.getDataAt){var g=C.getDataAt(O);return g?g.getToolTip():Q}return C.getValue?C.getValue():void 0}},_52o:function(c){c._zoom=1,c._29I=kg,c.zoomIn=function(r,Y){this.setZoom(this._zoom*Jl,r,Y)},c.zoomOut=function(N,C){this.setZoom(this._zoom/Jl,N,C)},c.zoomReset=function(R,c){this.setZoom(1,R,c)},c.scrollZoomIn=function(L){this.setZoom(this._zoom*Vj,Q,L)},c.scrollZoomOut=function(C){this.setZoom(this._zoom/Vj,Q,C)},c.pinchZoomIn=function(O){this.setZoom(this._zoom*$f,Q,O)},c.pinchZoomOut=function(V){this.setZoom(this._zoom/$f,Q,V)},c.adjustZoom=function(e){return nk>e?nk:e>Ce?Ce:e},c.getZoom=function(){return this._zoom},c.setZoom=function(i,C,I){var u=this;if(C=fl(C)){u._14o&&u._14o.stop(!0);var k=u._zoom;C.action=function(U){u._96O(k+(i-k)*U,I)},C._37o=function(){delete u._zooming,delete u._14o,u.onZoomEnded()},u._zooming=1,u._14o=Gk(C)}else u._96O(i,I)},c._96O=function(m,j){var $=this;if(m=$.adjustZoom(m),m!==$._zoom){$.validate();var p=$._29I,T=$._zoom;0!==p.width&&0!==p.height&&(j=j?j:{x:p.x+p.width/2,y:p.y+p.height/2},$.tx((j.x-p.x)*T-j.x*m),$.ty((j.y-p.y)*T-j.y*m)),$._zoom=m,$.fp("zoom",T,m)}}}};Bm(p,{numberDigits:5,baseZIndex:i,isTouchable:sg,devicePixelRatio:u.devicePixelRatio?u.devicePixelRatio:1,reinvalidateCount:3,hitMaxArea:3e3,imageCacheThreshold:20,autoMakeVisible:!0,autoHideScrollBar:!0,disabledOpacity:.4,disabledBackground:o.disabledBackground,forceHierarchicalSerialization:!0,hoverDelay:600,toolTipDelay:800,toolTipContinual:!1,getDragger:function(){return gd},lineCap:"butt",lineJoin:"round",imageGradient:"linear.northeast",dashPattern:[16,16],animDuration:200,animEasing:function(r){return r*r},labelColor:Gl,labelSelectColor:hg,labelFont:(sg?"15":"12")+"px arial, sans-serif",widgetIndent:sg?30:20,widgetRowHeight:sg?30:20,widgetHeaderHeight:sg?32:22,widgetTitleHeight:sg?34:24,scrollBarColor:sp,scrollBarSize:7,scrollBarTimeout:1e3,scrollBarMinLength:20,scrollBarInteractiveSize:sg?32:16,zoomIncrement:1.3,scrollZoomIncrement:1.05,pinchZoomIncrement:1.08,zoomMax:20,zoomMin:.01,segmentResolution:12,shapeResolution:24,shapeSide:24,intersectionLineRect:Zg,intersectionLineLine:Km,isEnter:Cj,isEsc:Wq,isDelete:Zm,isSpace:mo,isLeft:Ao,isUp:Yf,isRight:ts,isDown:en,getTarget:_r,isString:Pf,isNumber:Nr,isBoolean:dk,isArray:sd,isSelectAll:Fp,isFunction:bb,isObject:no,getPropertyValue:Qp,setPropertyValue:Ee,addMethod:Bm,getVersion:function(){return"6.2.1"},appendToScreen:function(f){f=f.getView?f.getView():f,(J.fullscreenElement||J.mozFullScreenElement||J.webkitFullscreenElement||J.msFullscreenElement||J.body).appendChild(f)},toggleFullscreen:function(X){var y=X.getView();if(J.fullscreenElement||J.mozFullScreenElement||J.webkitFullscreenElement||J.msFullscreenElement)J.exitFullscreen?J.exitFullscreen():J.msExitFullscreen?J.msExitFullscreen():J.mozCancelFullScreen?J.mozCancelFullScreen():J.webkitExitFullscreen&&J.webkitExitFullscreen();else{var S=!0;if(X.isSelfViewEvent){var l=X.getX(),q=X.getY(),w=X.getWidth(),P=X.getHeight(),t=y.style.background;t||(y.style.background="white"),y.requestFullscreen?y.requestFullscreen():y.msRequestFullscreen?y.msRequestFullscreen():y.mozRequestFullScreen?y.mozRequestFullScreen():y.webkitRequestFullscreen&&y.webkitRequestFullscreen();var H=setInterval(function(){if(y!==(J.fullscreenElement||J.mozFullScreenElement||J.webkitFullscreenElement||J.msFullscreenElement))clearInterval(H),X.setX(l),X.setY(q),X.setWidth(w),X.setHeight(P),X._fullscreen=!1,y.style.background=t,X.iv();else{var Q=R.Default.getWindowInfo();(S||Q.width!==X.getWidth()||Q.height!==X.getHeight())&&(X.setX(Q.left),X.setY(Q.top),X.setWidth(Q.width),X.setHeight(Q.height),X._fullscreen=!0,X.iv(),S=!1)}},500)}else{var a=y.style.left,e=y.style.top,w=y.style.width,P=y.style.height,t=y.style.background;t||(y.style.background="white"),y.requestFullscreen?y.requestFullscreen():y.msRequestFullscreen?y.msRequestFullscreen():y.mozRequestFullScreen?y.mozRequestFullScreen():y.webkitRequestFullscreen&&y.webkitRequestFullscreen();var H=setInterval(function(){if(y!==(J.fullscreenElement||J.mozFullScreenElement||J.webkitFullscreenElement||J.msFullscreenElement))clearInterval(H),y.style.left=a,y.style.top=e,y.style.width=w,y.style.height=P,y.style.background=t,X.iv();else{var M=R.Default.getWindowInfo();(S||M.width!==X.getWidth()||M.height!==X.getHeight())&&(Ae(X),S=!1)}},500)}}},appendTimeStamp:function(L){return L},setCompType:function(g,V){bb(V)||no(V)?mg[g]=V:Nc(g)},getCompType:function(h){var G=mg[h];return G===i&&Mi.test(h)&&Nc(h),G},getCompTypeMap:function(){return mg},drawCompType:function(i,A,M,K,J,T){i(A,M,K,J,T)},numberListener:function(){var $={46:1,8:1,9:1,27:1,13:1,109:1,110:1,189:1,190:1};return function(Z){var Q=Z.keyCode;$[Q]||65===Q&&p.isCtrlDown(Z)||86===Q&&p.isCtrlDown(Z)||67===Q&&p.isCtrlDown(Z)||88===Q&&p.isCtrlDown(Z)||Q>=35&&40>=Q||(Z.shiftKey||48>Q||Q>57)&&(96>Q||Q>105)&&Z.preventDefault()}}(),ignoreKeyCodes:[122,123],preventDefault:function(M){var V=M.target.tagName;("DIV"===V||"CANVAS"===V)&&!(p.ignoreKeyCodes.indexOf(M.keyCode)>=0)&&("keydown"!==M.type||Ao(M)||ts(M)||Yf(M)||en(M)||Zm(M)||65===M.keyCode&&(M.metaKey||M.ctrlKey))&&(M.preventDefault(),M.preventManipulation&&M.preventManipulation())},getWindowInfo:function(){var v=J.documentElement,i=v&&(v.scrollLeft||v.scrollTop)?v:J.body;return{target:i,left:i.scrollLeft,top:i.scrollTop,width:u.innerWidth||i.clientWidth,height:u.innerHeight||i.clientHeight}},isDragging:function(){return!!gd},isLeftButton:function(V){return sg?!0:0===V.button},isInput:function(G){if(!G)return!1;var p=G.tagName;return"INPUT"===p||"TEXTAREA"===p||"SELECT"===p},getTouchCount:function(f){return sg?f.touches.length:1},isDoubleClick:function(){function c(W){W.details=0,W.timeout=null,W.lastPoint=null}var S={};return Il=new Y,lr=Il.getTime(),function(H){var I=H.button==Q?"":H.button,h=H.type+I,q=h+"_isDoubleClick",g=S[h];if(g||(g=S[h]={details:0,timeout:null,lastPoint:null}),H[q]===i){H[q]=!0;var w=ko(H);g.timeout&&(d(g.timeout),g.timeout=null),g.lastPoint&&Vc(g.lastPoint,w)>(sg?20:1)&&c(g),g.lastPoint=w,g.details++,g.timeout=E(function(){c(this)}.bind(g),500)}return 2===g.details}}(),isShiftDown:function(y){return y?y.shiftKey:ds["16"]},isCtrlDown:function(j){return j?mi?j.metaKey:j.ctrlKey:mi?ds["91"]:ds["17"]},getClientPoint:function(q){return sg&&(q=zs(q)),{x:q.clientX,y:q.clientY}},isMouseEvent:function(Z){return Z instanceof MouseEvent||0===Z.type.indexOf("mouse")},getTargetElement:function(N){if(p.isMouseEvent(N)||!J.elementFromPoint)return N.target;var D=Cp(N);return J.elementFromPoint(D.x,D.y)},getPagePoint:function(S){return sg&&(S=zs(S)),{x:S.pageX,y:S.pageY}},createObject:function(k,E){var D=new k;for(var r in E)if(0===r.indexOf("s:"))D.s(r.substr(2),E[r]);else if(0===r.indexOf("a:"))D.a(r.substr(2),E[r]);else{var z=db(r),b=E[r];D[z]?(D[z](b),"setToolTip"===z&&D.enableToolTip&&D.enableToolTip()):D[r]=b}return D},setImage:function(l,A,m,H){var j=arguments.length;4===j?Rk(l,H,A,m):2===j?Pf(A)?Rk(l,A):cp[l]=A:1===j&&Rk(l,l)},getImage:function(U,q,r){var l;if(U==Q)return Q;if(no(U)?l=U:(l=cp[U],U&&l===i&&(xr&&xr[U]||Rk(U,U))),q&&l&&l.tagName){var X;X="override"===r?"colors_override":"override_rgb"===r?"colors_override_rgb":"override_a"===r?"colors_override_a":"colors",l[X]||(l[X]={__count__:0});var _=l[X][q];return _||(l[X].__count__>p.imageCacheThreshold&&(l[X]={__count__:0}),_=Fh(l,bl(q),l.width,l.height,r),l[X][q]=_,l[X].__count__++),_}return l},isImageComplete:function(G,T,N){var P=no(G)?G:cp[G];if(!P)return!1;if(P.tagName)return P.complete;for(var X,G,A,O=P.comps,e=!0,y=0,w=O.length;w>y;y++)if(X=O[y],A=X.type,"image"===X.type){G=X.name,G&&G.func&&(G=Aq(G,T));var s=Vh(G,T,N);if(!s){e=!1;break}}else if(Mi.test(A)&&p.getCompType(A)===i){e=!1;break}return e},getId:function(){var Y=1;return function(){return++Y}}(),callLater:function(A,z,G,v){var U=function(){A.apply(z,G)};return v?E(U,v):u.requestAnimationFrame(U)},clone:function($){if(null==$||"object"!=typeof $)return $;if($ instanceof Date){var k=new Date;return k.setTime($.getTime()),k}if($ instanceof Array){for(var k=[],N=0,I=$.length;I>N;N++)k[N]=Hp($[N]);return k}if($ instanceof xg){for(var k=new xg,N=0,I=$.length;I>N;N++)k.set(N,Hp($.get(N)));return k}if($ instanceof Sc)return $;if($ instanceof _){var k={};for(var Q in $)$.hasOwnProperty(Q)&&(k[Q]=Hp($[Q]));return k}return $},callWhenLoaded:function(V,J){J=J||100;var E=be(V,J);nj||(nj={}),nj[E]={tick:E,cb:V,delay:J}},beforeLoadURL:function(l){if(nj){var n={};for(var j in nj){var P=nj[j];d(P.tick);var J=be(P.cb,P.delay);n[J]={tick:J,delay:P.delay,cb:P.cb}}nj=n}return p.convertURL?p.convertURL(l):l},convertURL:function(Z){return Z},handleRefGraphLoaded:function(){},handleCompTypeLoaded:function(){},handleImageLoaded:function(){},handleUnfoundImage:function(){},sortFunc:function(B,w){if(B===w)return 0;if(B==Q&&w!=Q)return 1;if(B!=Q&&w==Q)return-1;if(B==Q&&w==Q)return 0;var N,e=typeof B,p=typeof w;return e===uf&&p===uf?N=B.localeCompare(w):e===Mp&&p===Mp&&(N=B-w),N===i&&(N=(""+B).localeCompare(""+w)),N>0?1:0>N?-1:0},getClassMap:function(){return Mb},getClass:function(M){if(Pf(M)){var l,j=Mb[M];if(!j){l=M.split("."),j=u;for(var H=0;H<l.length;H++)j=j[l[H]];Mb[M]=j}return j}return M},def:function(p,s,q){var W,x,g,b=function(){};if(b.prototype=s.prototype,W=new b,Pf(p)){if(Mb[p])throw"'"+p+"' already defined";g=Tg(p),W.getClassName=function(){return p}}else g=p;if(W.constructor=g,W.getClass=function(){return g},W.getSuperClass=function(){return s},q)for(x in q)rm[x]&&rm.hasOwnProperty(x)?rm[x](W,q):hn(W,q,x);g.prototype=W,g.superClass=s.prototype},startAnim:function(){var w=function(K){K.duration&&(K.startTime=ql()),K.timeId=Sq(K.tick,Q,Q,K.interval)};return function(F){return F=Hp(F),F.easing=F.easing||p.animEasing,F.duration||F.frames||(F.duration=p.animDuration),F.t=0,F.duration?F.interval=0:(F.frame=0,F.interval=F.interval||10),F.tick=function(){if(F.duration){var d=(ql()-F.startTime)/F.duration;d>1&&(d=1),F.t=d,F.action(F.easing(d),d),1===d?F.stop():F._isPaused||(F.timeId=Sq(F.tick))}else F.frame++,d=F.t=F.frame/F.frames,F.action(F.easing(d),d),F.frame<F.frames?F._isPaused||(F.timeId=Sq(F.tick,Q,Q,F.interval)):F.stop()},F.resume=function(){F._isPaused&&(delete F._isPaused,F.duration?F.t<1&&(F.startTime=ql()-F.duration*F.t,F.timeId=Sq(F.tick)):F.frame<F.frames&&(F.timeId=Sq(F.tick,Q,Q,F.interval)))},F.pause=function(){F._isPaused=!0},F.stop=function(s){F.isRunning()&&(F.duration?F.t<1&&s&&(F.t=1,F.action(F.easing(1),1)):F.frame<F.frames&&s&&(F.frame=F.frames,F.action(F.easing(1),1)),F._37o&&F._37o(),F.finishFunc&&F.finishFunc(),rj(F.timeId,!F.duration),delete F.timeId)},F.isRunning=function(){return F.timeId!=Q},F.delay?Sq(w,Q,[F],F.delay):w(F),F}}(),getTextSize:function(){var x={},K=J?yk().getContext("2d"):Q;return function(d,f){K.font=d?d:bs;var C=x[K.font];return C||(C=2*K.measureText("e").width+4,x[K.font]=C),{width:K.measureText(f).width+4,height:C}}}(),drawText:function(r,h,D,K,J,N,Z,t,b,j){if(h!=Q){var M=vr(D,h),f={};f.y=j&&j!==Tl?j===fk?N+M.height/2:N+t-M.height/2:N+t/2,f.x=b&&b!==Um?b===Xl?J+Z-M.width/2:J+Z/2:J+M.width/2,Vp(r,h,f,D,K)}},getDistance:function(n,t){var b=n.length;return t?3===b?V(X(n[0]-t[0])+X(n[1]-t[1])+X(n[2]-t[2])):2===b?V(X(n[0]-t[0])+X(n[1]-t[1])):n.z===i?V(X(t.x-n.x)+X(t.y-n.y)):V(X(t.x-n.x)+X(t.y-n.y)+X(t.z-n.z)):3===b?V(X(n[0])+X(n[1])+X(n[2])):2===b?V(X(n[0])+X(n[1])):void 0},brighter:function(m,c){return 0>c&&(c=-c),Jb(m,c?c:40)},darker:function(h,O){return O>0&&(O=-O),Jb(h,O?O:-40)},unionPoint:function(z,S){if(!z)return Q;if(2===arguments.length)return z&&S?{x:k(z.x,S.x),y:k(z.y,S.y),width:q(z.x-S.x),height:q(z.y-S.y)}:Q;var u=z;if(u._as&&(u=u._as),u.length===i)return Q;var G=u.length;if(0>=G)return Q;for(var r=1,A=u[0],M={x:A.x,y:A.y,width:0,height:0};G>r;r++){A=u[r];var n=k(M.x,A.x),b=x(M.x+M.width,A.x),f=k(M.y,A.y),l=x(M.y+M.height,A.y);M.x=n,M.y=f,M.width=b-n,M.height=l-f}return M},unionRect:function(L,X){if(L&&!X)return Hp(L);if(!L&&X)return Hp(X);if(L&&X){var P={x:k(L.x,X.x),y:k(L.y,X.y)};return P.width=x(L.x+L.width,X.x+X.width)-P.x,P.height=x(L.y+L.height,X.y+X.height)-P.y,P}return Q},containsPoint:function(T,p,c,f){if(f!=Q&&1!==f){var Y=T.x+T.width/2,N=T.y+T.height/2;T={x:Y-T.width/2*f,y:N-T.height/2*f,width:T.width*f,height:T.height*f}}if(c){var S=T.width/2,b=T.height/2,P=g(-c),s=$(-c),C=p.x-T.x-S,n=p.y-T.y-b;return p={x:s*C-P*n,y:P*C+s*n},An({x:-S,y:-b,width:T.width,height:T.height},p)}return!(!T||p.x<T.x||p.y<T.y||p.x>T.x+T.width||p.y>T.y+T.height)},containsRect:function(C,b){if(!C||!b)return!1;var G=b.x,A=b.y,r=b.width,n=b.height,E=C.width,X=C.height;if(0>(E|X|r|n))return!1;var z=C.x,p=C.y;if(z>G||p>A)return!1;if(E+=z,r+=G,G>=r){if(E>=z||r>E)return!1}else if(E>=z&&r>E)return!1;if(X+=p,n+=A,A>=n){if(X>=p||n>X)return!1}else if(X>=p&&n>X)return!1;return!0},intersectsRect:function(n,X){if(!n||!X)return!1;var j=X.width,Z=X.height,i=n.width,L=n.height;if(0>=i||0>=L||0>=j||0>=Z)return!1;var D=X.x,m=X.y,h=n.x,R=n.y;return i+=h,L+=R,j+=D,Z+=m,i>D&&L>m&&j>h&&Z>R},intersection:function(P,w){if(!P||!w)return Q;var U=w.x,d=w.y,k=P.x,y=P.y,T=U,E=d,K=k,e=y;return T+=w.width,E+=w.height,K+=P.width,e+=P.height,k>U&&(U=k),y>d&&(d=y),T>K&&(T=K),E>e&&(E=e),T-=U,E-=d,0>=T||0>=E?Q:{x:U,y:d,width:T,height:E}},grow:function(h,e,t){t===i&&(t=e),h.x-=e,h.y-=t,h.width=h.width+2*e,h.height=h.height+2*t},getLogicalPoint:function(w,L,d,k,W,T){var G,u,C=L.getBoundingClientRect();return w.target?(Ub(w)?mi?ds["91"]=!0:ds["17"]=!0:mi?ds["91"]=!1:ds["17"]=!1,ds["16"]=sb(w)?!0:!1,w=sg?zs(w):w,G=w.clientX,u=w.clientY):(G=w.x,u=w.y),{x:(G-C.left+L.scrollLeft-(d||0))/(W||1),y:(u-C.top+L.scrollTop-(k||0))/(T||1)}},removeHTML:function(){var E;return function(l){return l&&l.parentNode?E===l?!0:(E=l,l.parentNode.removeChild(l),E=Q,!0):!1}}(),getToolTipDiv:function(){if(!ug){ug=xq(),sh=xq();var i=ug.style;p.baseZIndex!=Q&&(i.zIndex=z(p.baseZIndex)+3+""),i.whiteSpace="nowrap",i.color=p.toolTipLabelColor,i.background=p.toolTipBackground,i.font=p.toolTipLabelFont,i.padding="5px",i.boxShadow="0px 0px 3px "+p.toolTipShadowColor}return ug},isToolTipShowing:function(){return ug&&ug.parentNode?!0:sh&&sh.parentNode?!0:!1},hideToolTip:function(){qh(ug),qh(sh),yg()},showToolTip:function(S,V){if(!S||V==Q)return Ek(),void 0;p.getToolTipDiv();var K,e;if(V.html?(V=V.html,K=sh,qh(ug)):(K=ug,qh(sh)),e=K.style,K.innerHTML=V,K.parentNode||R.Default.appendToScreen(K),S.target){S=Cp(S);var u=Pr(),f=S.x,o=S.y,A=sg?60:12;if(sg){var U=K.getBoundingClientRect();e.left=f-U.width/2+ib,e.top=o-U.height-A<u.top?o+A+ib:o-U.height-A+ib}else{e.left=f+A+ib,e.top=o+A+ib;var U=K.getBoundingClientRect();U.left+U.width>u.width&&(e.left=f-A-U.width+ib),U.top+U.height>u.height&&(e.top=o-A-U.height+ib),U.left<0&&(e.left=f+A+ib),U.top<0&&(e.top=o+A+ib)}}else e.left=S.x+ib,e.top=S.y+ib;yg()},startDragging:function(I,g){I!==gd&&(gd?sg?gd.handleWindowTouchEnd(g):gd.handleWindowMouseUp(g):sg?(u.addEventListener(Qc,Oi,!1),u.addEventListener($n,Od,!1)):(u.addEventListener(Pc,ng,!1),u.addEventListener(ii,il,!1)),gd=I)},getImageMap:function(){return cp},toBoundaries:function(i,A,g,x){var R=[];return fb(i,A,g,x).forEach(function(o){var f=[];o.forEach(function(O){f.push(O.x,O.y)}),R.push(f)}),R},getCurrentKeyCodeMap:function(){return ds},drawCenterImage:function(S,k,V,c,H,y,W,n){var Y=ki(k,H,y),R=Xe(k,H,y);Df(S,k,U(V-Y/2),U(c-R/2),Y,R,H,y,W,n)},drawStretchImage:function(c,e,n,r,Q,y,G,P,N,u,w,b){var t,B=ki(e,P,N,y),R=Xe(e,P,N,G);
"uniform"===n?(t=k(y/B,G/R),B*=t,R*=t,r+=U((y-B)/2),Q+=U((G-R)/2),y=B,G=R):"centerUniform"===n&&((B>y||R>G)&&(t=k(y/B,G/R),B*=t,R*=t),r+=U((y-B)/2),Q+=U((G-R)/2),y=B,G=R);var v=c.interactiveInfo;if(v){var q;q="center"===n?{x:r+y/2-B/2,y:Q+G/2-R/2,width:B,height:R}:{x:r,y:Q,width:y,height:G},v.rect?(v.compInfos[v.compInfos.length-1].rect=q,q.image=e):v.rect=q}if("center"===n){var g=w!==!1&&(B>y||R>G);g&&(c.save(),c.beginPath(),c.rect(r,Q,y,G),c.clip()),Df(c,e,r+y/2-B/2,Q+G/2-R/2,B,R,P,N,u,b),g&&c.restore()}else Df(c,e,r,Q,y,G,P,N,u,b)},toCanvas:function(d,M,I,v,T,B,e,p,C){d=Lq(d,e),M=M||ki(d,T),I=I||Xe(d,T);var z=yk(),F=ro(z);return p?(vh(z,M,I,p),F.scale(p,p)):vh(z,M,I,1),Cq(F,d,v,0,0,M,I,T,B,e,C),d&&d.clampToEdge&&(z.clampToEdge=d.clampToEdge),F.restore(),z},createGradientImage:function(m,A,s,B){for(var z=["L",0,0,m,0,1,0,0,1,0,0],_=0,U=Math.min(A.length,s.length);U>_;_++)z.push(s[_],A[_]);var p=R.Default.toCanvas({width:m,height:m,clampToEdge:!0,comps:[{type:"shape",rotation:B||0,points:[0,0,m,0,m,m,0,m],background:"#ffffff",gradientPack:z}]});return p},createElement:function(y,A,Y,i){var s=J.createElement(y);return eb(s,A||o.widgetBorder,2),s.style.font=Y?Y:bs,i!=Q&&(s.value=i),p.onElementCreated&&p.onElementCreated(s),s},containedInView:function(c,E){var t=Tr(E).getBoundingClientRect();return An({x:t.left,y:t.top,width:t.width,height:t.height},ko(c))},isIsolating:function(){return Yn>0},setIsolating:function(L){L?Yn++:Yn--},getMSMap:function(){return rm},stringify:function(b,h){var j=Date.prototype.toJSON;Date.prototype.toJSON=function(){return"__ht__date"+this.getTime()};var M=JSON.stringify(b,function(m,c){return"function"==typeof c?"__ht__"+(c.__ht__||c.toString()):Nr(c)?zf(c):c},h==Q?2:h);return Date.prototype.toJSON=j,M},parse:function(C){return Pf(C)?JSON.parse(C,function(Q,J){if(Pf(J)){if("__ht__function"==J.substr(0,14)){var N=J.indexOf("{")+1,b=J.lastIndexOf("}"),t=J.indexOf("(")+1,L=J.indexOf(")");if(N&&b&&t&&L){var d=new Function(J.substring(t,L),J.substring(N,b));return d.__ht__=J.substr(6),d}}if("__ht__date"==J.substr(0,10))return new Date(z(J.substr(10)))}return J}):C},loadJS:function(g,f){f&&g.push(f);var O=g.shift();if(sd(O))g=O.contact(g),p.loadJS(g);else if(bb(O))O(),p.loadJS(g);else if(Pf(O)){var S=J.createElement("script");S.onload=function(){p.loadJS(g)},S.setAttribute("src",O),J.getElementsByTagName("head")[0].appendChild(S)}else g.length&&p.loadJS(g)},toRoundedCorner:function(x,M){var o=x.size();if(0>=M)return{points:x};var D,l=new xg,O=new xg,P=x.get(0);l.add(P),O.add(1);for(var T=1;o>T;T++)if(o>T+1){var n=x.get(T),z=x.get(T+1),v=P.x,G=P.y,Q=n.x,H=n.y,y=H-G,A=Q-v,F=N(y,A);D=k(.99*Vc(P,n),M),l.add({x:Q-D*$(F),y:H-D*g(F)}),l.add(n),v=n.x,G=n.y,Q=z.x,H=z.y,y=H-G,A=Q-v,F=N(y,A),D=k(.99*Vc(n,z),M),P={x:v+D*$(F),y:G+D*g(F)},l.add(P),O.addAll([2,3])}else l.add(x.get(T)),O.add(2);return{points:l,segments:O}},toColorData:se,setCanvas:vh,createDiv:xq,createDisabledDiv:Cr,createView:Ro,createCanvas:yk,appendChild:Pe,initContext:ro,checkLoadingImage:Jh,translateAndScale:Hd,layout:Ae,getPosition:zb,drawPoints:lb,drawRoundRect:Lj,drawBorder:zd,setFocus:Oj,getter:Zc,setter:db,isEmptyObject:dj},!0),Bm(h,{autoAdjustIndex:1,hierarchicalRendering:1,adjustChildrenToTop:1,autoHideScrollBar:1,autoUpdate:1,firstPersonMode:1,ortho:1,strict:1,stickToRight:1,instant:1,closePath:1,hierarchical:1,doubleClickToToggle:1,continuousLayout:1,syncSize:1},!0);var Bs=p.disabledOpacity,vk=p.toolTipDelay,Cc=p.devicePixelRatio,Jg=p.autoMakeVisible,Vq=p.autoHideScrollBar,Sj=p.imageGradient,ho=p.showToolTip,Ek=p.hideToolTip,es=p.dashPattern,$q=p.lineCap,Jj=p.lineJoin,ln=p.labelColor,sk=p.labelSelectColor,bs=p.labelFont,Dh=p.widgetIndent,Sr=p.widgetRowHeight,Sb=p.widgetHeaderHeight,Wk=p.widgetTitleHeight,Ul=p.scrollBarColor,Ko=p.scrollBarSize,Lr=p.scrollBarTimeout,Nd=p.scrollBarMinLength,Fq=p.scrollBarInteractiveSize,Jl=p.zoomIncrement,Vj=p.scrollZoomIncrement,$f=p.pinchZoomIncrement,Ce=p.zoomMax,nk=p.zoomMin,yq=p.createObject,Hm=p.preventDefault,Uj=p.setImage,Lq=p.getImage,Vh=p.isImageComplete,as=p.drawCenterImage,Cq=p.drawStretchImage,um=p.getId,Sq=p.callLater,br=p.sortFunc,Hp=p.clone,Tg=p.getClass,Gk=p.startAnim,ae=p.brighter,ad=p.darker,re=p.drawText,vr=p.getTextSize,gf=p.isLeftButton,vj=p.getTouchCount,pg=p.isDoubleClick,sb=p.isShiftDown,Ub=p.isCtrlDown,ko=p.getClientPoint,Cp=p.getPagePoint,Vc=p.getDistance,mc=p.unionPoint,Ej=p.unionRect,An=p.containsPoint,_e=p.containsRect,tl=p.intersectsRect,Bb=p.intersection,Pr=p.getWindowInfo,Id=p.grow,xs=p.getLogicalPoint,ep=p.startDragging,qh=p.removeHTML,Yl=p.createElement,pl=p.segmentResolution,fi=p.shapeResolution,od=p.shapeSide,jh=p.def,Ak=function(p,j,t){jh(l+"."+p,j,t)},cn=function(n,R){n.childNodes.forEach(function(C){R(C),cn(C,R)})};Bm(p,{toolTipLabelColor:ln,toolTipLabelFont:bs,toolTipBackground:o.toolTipBackground,toolTipShadowColor:sp,drawBreakableText:ed,setDevicePixelRatio:function(w){Cc=p.devicePixelRatio="number"==typeof w?w:u.devicePixelRatio,cn(J.body,function(E){var M=E._ht;M&&M._canvas&&(vh(M._canvas,M.getWidth(),M.getHeight()),M.redraw?M.redraw():M.iv())})}},!0);var Jd=1e-6,bg="undefined"!=typeof Uint16Array?Uint16Array:Array,Pg="undefined"!=typeof Float32Array?Float32Array:Array,Em=function(G,P,r){var I=[G[0]-P[0],G[1]-P[1],G[2]-P[2]];if(r){var k=Vc(I);k>0&&(I[0]/=k,I[1]/=k,I[2]/=k)}return I},ie=function(){var W="charCodeAt",j=2*(2*Gd.length+1);for(var R in u)if(R===l+Um[0]+ib.length){var J=u[R];if(!J)break;for(var X=J.length,w=0;X>w;w++)if(J[w][W](0)===j&&J[w+1]!=Q&&J[w+1]===ib[0]&&J[w+2]!=Q&&J[w+2][W](0)===j){for(var q=w+3;X>q;q++)if(J[q][W](0)===j){if(0==J[q+1])for(var P,y=q+2;X>y;y++){if(J[y][W](0)===j){0==J[y-1]&&P&&(t=P.substr(0,P.length-1));break}P==Q?P=J[y]:P+=J[y]}break}break}break}return function(Y){return[-Y[0],-Y[1],-Y[2]]}}(),Uq=function(I,c){return 3===I.length?I[0]*c[0]+I[1]*c[1]+I[2]*c[2]:I[0]*c[0]+I[1]*c[1]},jl=function(){var b=new Pg(16);return b[0]=1,b[1]=0,b[2]=0,b[3]=0,b[4]=0,b[5]=1,b[6]=0,b[7]=0,b[8]=0,b[9]=0,b[10]=1,b[11]=0,b[12]=0,b[13]=0,b[14]=0,b[15]=1,b},mh=jl(),nr=function(y){var m=new Pg(16);return m[0]=y[0],m[1]=y[1],m[2]=y[2],m[3]=y[3],m[4]=y[4],m[5]=y[5],m[6]=y[6],m[7]=y[7],m[8]=y[8],m[9]=y[9],m[10]=y[10],m[11]=y[11],m[12]=y[12],m[13]=y[13],m[14]=y[14],m[15]=y[15],m},Ad=function(i,N){return i[0]=N[0],i[1]=N[1],i[2]=N[2],i[3]=N[3],i[4]=N[4],i[5]=N[5],i[6]=N[6],i[7]=N[7],i[8]=N[8],i[9]=N[9],i[10]=N[10],i[11]=N[11],i[12]=N[12],i[13]=N[13],i[14]=N[14],i[15]=N[15],i},Ch=function(H){return H[0]=1,H[1]=0,H[2]=0,H[3]=0,H[4]=0,H[5]=1,H[6]=0,H[7]=0,H[8]=0,H[9]=0,H[10]=1,H[11]=0,H[12]=0,H[13]=0,H[14]=0,H[15]=1,H},Vi=function(x,p){var Q=x[0],u=x[1],K=x[2];return x[0]=p[0]*Q+p[4]*u+p[8]*K+p[12],x[1]=p[1]*Q+p[5]*u+p[9]*K+p[13],x[2]=p[2]*Q+p[6]*u+p[10]*K+p[14],x},Xp=function(m,L){var M=m[0],z=m[1],g=m[2],j=m[3];return m[0]=L[0]*M+L[4]*z+L[8]*g+L[12]*j,m[1]=L[1]*M+L[5]*z+L[9]*g+L[13]*j,m[2]=L[2]*M+L[6]*z+L[10]*g+L[14]*j,m[3]=L[3]*M+L[7]*z+L[11]*g+L[15]*j,m},Zp=function(){var m,L,z,D,_=Jk(Vm[1]+Vm[7]),U=Jk(Vm[0]+Vm[3]-Vm[10]),Q=Jk(Vm[8]+2),j=function(){return L=z.charAt(m),m+=1,L},r=function(){var l="";if(L===Q)for(;j();){if(L===Q)return j(),l;l+=L}else j()},i=function(){for(;L&&" ">=L;)j()},e=function(){var g,N={};if(L===_){if(j(),i(),L===U)return j(),N;for(;L;){if(g=r(),i(),j(),N[g]=D(),i(),L===U)return j(),N;j(),i()}}};return D=function(){switch(i(),L){case _:return e();default:return r()}},function(V){if(M={},V){var r;if(z=V,m=0,L=" ",r=D(),i(),!L)return r}}}(),Kb=function(P,D){if(D){var k=g(D),n=$(D),Q=P[4],I=P[5],t=P[6],_=P[7],h=P[8],K=P[9],s=P[10],c=P[11];P[4]=Q*n+h*k,P[5]=I*n+K*k,P[6]=t*n+s*k,P[7]=_*n+c*k,P[8]=h*n-Q*k,P[9]=K*n-I*k,P[10]=s*n-t*k,P[11]=c*n-_*k}},ne=function(S,H){if(H){var t=g(H),d=$(H),A=S[0],c=S[1],l=S[2],w=S[3],Y=S[8],T=S[9],I=S[10],Q=S[11];S[0]=A*d-Y*t,S[1]=c*d-T*t,S[2]=l*d-I*t,S[3]=w*d-Q*t,S[8]=A*t+Y*d,S[9]=c*t+T*d,S[10]=l*t+I*d,S[11]=w*t+Q*d}},hh=function(W,Y){if(Y){var D=g(Y),r=$(Y),d=W[0],b=W[1],P=W[2],K=W[3],E=W[4],c=W[5],C=W[6],e=W[7];W[0]=d*r+E*D,W[1]=b*r+c*D,W[2]=P*r+C*D,W[3]=K*r+e*D,W[4]=E*r-d*D,W[5]=c*r-b*D,W[6]=C*r-P*D,W[7]=e*r-K*D}},pj=function(H,W,x){return zg(Q,x===!1?Q:H.getFinalScale3d(),H.r3(),H.getRotationMode(),H.p3(),Q,W)},zg=function(g,H,y,t,J,z,i){return z||(z=jl()),J&&Zq(z,J),Tj(z,y,t),i&&rh(z,z,i),H&&xd(z,H),g&&rh(z,z,g),z},cc=function(P,c,a){c=z(c),a=z(a);var s=this;s.g=P,s._84O=c,s._85O=a,s._70I=!0,s.F=0,s._83O=c+a,s.pen={x:0,y:0}},qq="lineDashOffset",ub="setLineDash",ei=function(C){for(var t in C)1===t.length&&(qq=C[t]);return t?1:0},bf=function(O,c,s){return Yc(c)?O:O[ub]?(O[ub](c),s&&(O.lineDashOffset=s),O):new cc(O,c[0],c.length>1?c[1]:c[0])},cg=function(b,V){!Yc(V)&&b[ub]&&(b[ub](fn),b.lineDashOffset=0)};if(jh(cc,_,{_69I:6,moveTo:function(T,R){var e=this,o=e.pen;o.x=T,o.y=R,e.g.moveTo(T,R),e.start||(e.start={x:T,y:R})},lineTo:function(b,y){var F=this,H=F.pen,R=b-H.x,p=y-H.y,P=N(p,R),Q=$(P),L=g(P),i=F._23O(H.x,H.y,b,y),q=F._85O,v=F._84O,J=F._83O;if(F.F){if(F.F>i)return F._70I?F._72I(b,y):F.moveTo(b,y),F.F-=i,void 0;if(F._70I?F._72I(H.x+Q*F.F,H.y+L*F.F):F.moveTo(H.x+Q*F.F,H.y+L*F.F),i-=F.F,F.F=0,F._70I=!F._70I,!i)return}var I=K(i/J);if(I){for(var S=Q*v,h=L*v,k=Q*q,D=L*q,A=0;I>A;A++)F._70I?(F._72I(H.x+S,H.y+h),F.moveTo(H.x+k,H.y+D)):(F.moveTo(H.x+k,H.y+D),F._72I(H.x+S,H.y+h));i-=J*I}F._70I?i>v?(F._72I(H.x+Q*v,H.y+L*v),F.moveTo(b,y),F.F=q-(i-v),F._70I=!1):(F._72I(b,y),i===v?(F.F=0,F._70I=!F._70I):(F.F=v-i,F.moveTo(b,y))):i>q?(F.moveTo(H.x+Q*q,H.y+L*q),F._72I(b,y),F.F=v-(i-q),F._70I=!0):(F.moveTo(b,y),i===q?(F.F=0,F._70I=!F._70I):F.F=q-i)},quadraticCurveTo:function(n,u,f,p){var Z,x=this,N=x.pen,j=N.x,R=N.y,S=x._22O(j,R,n,u,f,p),o=0,X=0,c=x._85O,A=x._84O;if(x.F){if(x.F>S)return x._70I?x._71I(n,u,f,p):x.moveTo(f,p),x.F-=S,void 0;if(o=x.F/S,Z=x._20O(j,R,n,u,f,p,o),x._70I?x._71I(Z[2],Z[3],Z[4],Z[5]):x.moveTo(Z[4],Z[5]),x.F=0,x._70I=!x._70I,!S)return}var C=S-S*o,V=K(C/x._83O),T=A/S,J=c/S;if(V)for(var B=0;V>B;B++)x._70I?(X=o+T,Z=x._21O(j,R,n,u,f,p,o,X),x._71I(Z[2],Z[3],Z[4],Z[5]),o=X,X=o+J,Z=x._21O(j,R,n,u,f,p,o,X),x.moveTo(Z[4],Z[5])):(X=o+J,Z=x._21O(j,R,n,u,f,p,o,X),x.moveTo(Z[4],Z[5]),o=X,X=o+T,Z=x._21O(j,R,n,u,f,p,o,X),x._71I(Z[2],Z[3],Z[4],Z[5])),o=X;C=S-S*o,x._70I?C>A?(X=o+T,Z=x._21O(j,R,n,u,f,p,o,X),x._71I(Z[2],Z[3],Z[4],Z[5]),x.moveTo(f,p),x.F=c-(C-A),x._70I=!1):(Z=x._19O(j,R,n,u,f,p,o),x._71I(Z[2],Z[3],Z[4],Z[5]),S===A?(x.F=0,x._70I=!x._70I):(x.F=A-C,x.moveTo(f,p))):C>c?(X=o+J,Z=x._21O(j,R,n,u,f,p,o,X),x.moveTo(Z[4],Z[5]),Z=x._19O(j,R,n,u,f,p,X),x._71I(Z[2],Z[3],Z[4],Z[5]),x.F=A-(C-c),x._70I=!0):(x.moveTo(f,p),C===c?(x.F=0,x._70I=!x._70I):x.F=c-C)},bezierCurveTo:function(){var E=arguments;this.pen={x:E[4],y:E[5]},this.g.bezierCurveTo(E[0],E[1],E[2],E[3],E[4],E[5])},arc:function(R,H,N,i,y,m){m||(i=-i,y=-y),ig(this,R,H,i,y-i,N,N,!1)},rect:function(A,w,L,b){var G=this;G.pen={x:A,y:w},G.moveTo(A,w),G.lineTo(A,w+b),G.lineTo(A+L,w+b),G.lineTo(A+L,w),G.lineTo(A,w)},beginPath:function(){this.g.beginPath()},closePath:function(){this.lineTo(this.start.x,this.start.y)},_23O:function(S,$,Y,c){var i=Y-S,N=c-$;return V(i*i+N*N)},_22O:function(z,X,i,s,r,e,U){for(var I,n,P,_,J,V,$,j=0,c=z,O=X,D=U>0?U:this._69I,f=1;D>=f;f++)P=f/D,_=1-P,J=_*_,V=2*P*_,$=P*P,I=J*z+V*i+$*r,n=J*X+V*s+$*e,j+=this._23O(c,O,I,n),c=I,O=n;return j},_21O:function(c,V,Y,Q,$,f,p,t){var M=this;if(0===p)return M._20O(c,V,Y,Q,$,f,t);if(1===t)return M._19O(c,V,Y,Q,$,f,p);var R=M._20O(c,V,Y,Q,$,f,t);return R.push(p/t),M._19O.apply(M,R)},_20O:function(X,l,p,t,S,U,o){if(1!==o){var c=p+(S-p)*o,A=t+(U-t)*o;p=X+(p-X)*o,t=l+(t-l)*o,S=p+(c-p)*o,U=t+(A-t)*o}return[X,l,p,t,S,U]},_19O:function(X,p,_,q,r,J,R){if(1!==R){var F=X+(_-X)*R,L=p+(q-p)*R;_+=(r-_)*R,q+=(J-q)*R,X=F+(_-F)*R,p=L+(q-L)*R}return[X,p,_,q,r,J]},_72I:function(A,v){var T=this.pen;(A!==T.x||v!==T.y)&&(T.x=A,T.y=v,this.g.lineTo(A,v))},_71I:function(i,b,J,n){var y=this.pen;(i!==J||b!==n||J!==y.x||n!==y.y)&&(y.x=J,y.y=n,this.g.quadraticCurveTo(i,b,J,n))}}),a&&c){var qd=c.toString();Z=qd.indexOf(Kl.substr(0,2))>0&&qd.indexOf(fk+fk.substr(1,1))>1||qd.indexOf(Cm[0]+cd.substr(0,2)+Kl.substr(2,2)+Um[0]+Kl[4])>1?!0:!1}var tq=Q,Jq=Q,Fi=function(S){tq&&!S._72O&&(Jq||(Jq={}),Jq[S._72O=um()]=S)},Nc=function(C,S){if(S||(S=C),S&&(tq||(tq={}),!tq[C])){var d=new XMLHttpRequest;if(tq[S]={request:d,url:S},d.overrideMimeType&&d.overrideMimeType("text/plain"),S=p.beforeLoadURL(S),S.data){var Y=p.parse(S.data);Vr(C,Y),p.handleCompTypeLoaded(C,Y)}else d.open("GET",encodeURI(S),!0),d.onload=function(e){if(200===this.status||0===this.status){var q=p.parse(e.target.response||e.target.responseText);Vr(C,q),p.handleCompTypeLoaded(C,q)}else Vr(C,Q)},d.onerror=function(){Vr(C,Q)},d.send(null)}},Vr=function(q,d){if(mg[q]=d,delete tq[q],dj(tq)&&(tq=Q,Jq)){for(var S in Jq){var m=Jq[S];m.invalidateAll&&m.invalidateAll(i,"compTypeLoaded",q),m.redraw&&m.redraw(),m.iv(),delete m._72O}Jq=Q}if(d&&Jq)for(var S in Jq){var m=Jq[S];m.invalidateAll&&m.invalidateAll(i,"compTypeLoading",q),m.redraw&&m.redraw(),m.iv()}},Yg=o.chart,ri=p.compStack=[],cb=/^style@/,sj=/^attr@/,Je=/^field@/,vs={x:.5,y:.5},ki=function(E,y,q,W){if(!E)return 0;if(Aq(E.fitSize,y,q)&&W)return W;var V=Aq(E.width,y,q);return null==V?20:V},Xe=function(u,H,h,J){if(!u)return 0;if(Aq(u.fitSize,H,h)&&J)return J;var $=Aq(u.height,H,h);return null==$?20:$},Aq=function(G,p,D){if(!G||!G.func)return G;var J,F=G.func,X=G.value;return J=bb(F)?D&&D.vectorDataBindingDisabled&&!G.isSafeFunc?X:F(p,D):p instanceof Sc?sj.test(F)?p.a(F.slice(5)):cb.test(F)?p.s(F.slice(6)):Je.test(F)?p[F.slice(6)]:p[F]?p[F](D):X:X,X!==i&&J==Q?X:J},Df=p.drawImage=function(){var L,R,V,y,S,v,O=function(_,u){_.getValue&&_.getValue.compType===u||(_.getValue=function(t){var k=G(_,t);if(k===i&&u.properties){var J=u.properties[t];J&&(k=J.defaultValue)}return k},_.getValue.compType=u)},G=function(f,M,Q){var j=f[M];return j&&j.func?(j=Aq(j,R,V),Q&&(j=Q(j))):Q&&(j=f[M]=Q(j)),j},c=function(m,M){var X;if(X=M?G(m,M):m,S&&X){if("override"===v)return S;if("override_rgb"===v){var Z=bl(S);return X=se(X),"rgba("+K(255*Z[0])+","+K(255*Z[1])+","+K(255*Z[2])+","+X[3]/255+")"}if("override_a"===v){var Z=bl(S);return X=se(X),"rgba("+X[0]+","+X[1]+","+X[2]+","+Z[3]+")"}var Z=bl(S);return X=se(X),"rgba("+K(X[0]*Z[0])+","+K(X[1]*Z[1])+","+K(X[2]*Z[2])+","+X[3]/255*Z[3]+")"}return X},D=function(K){if(sd(K)){for(var f=new xg,P=K.length,j=0;P>j;j+=2)f.add({x:K[j],y:K[j+1]});K=f}return K},Y=function(l){var Q=G(l,"anchorX"),D=G(l,"anchorY");if(Q!==i||D!==i)return{x:Q===i?vs.x:Q,y:D===i?vs.y:D};var e=G(l,"type"),Z=G(l,"name");if("image"!==e||!Z)return vs;var H=Lq(Z);return H&&H.anchorX!==i&&H.anchorY!==i?{x:H.anchorX,y:H.anchorY}:vs},s=function(C,$){var S=G(C,qo),P=Y(C);if(sd(S)){var U=S.length,B=G(C,"relative"),I=$.width,h=$.height;if(4===U)S={x:S[0],y:S[1],width:S[2],height:S[3]},B?(S.x*=I,S.y*=h,S.width*=I,S.height*=h):$.fitSize&&(S.x*=$.widthScale,S.width*=$.widthScale,S.y*=$.heightScale,S.height*=$.heightScale);else if(3===U){var Z=S[0];S={width:S[1],height:S[2]},B?(S.width*=I,S.height*=h):$.fitSize&&(S.width*=$.widthScale,S.height*=$.heightScale),"object"==typeof Z?Z.length&&(Z={x:Z[0],y:Z[1]}):Z=zb(Z,$,S),S.x=Z.x-S.width*P.x,S.y=Z.y-S.height*P.y}var p=G(C,"offsetX");p&&($.fitSize&&(p*=$.widthScale),S.x+=p),p=G(C,"offsetY"),p&&($.fitSize&&(p*=$.heightScale),S.y+=p)}return S},d=function(T){return sd(T)?new xg(T):T},j=function(w,n,z,t,M,C,k){var U=L.interactiveInfo;M===i&&(M=1),C===i&&(C=1);var S=G(w,"clipPercentage"),g=zm(z,n);if(g&&!t&&1===M&&1===C&&!(1>S))return U&&U.compInfos.push({comp:w,rect:n,stacks:U.stacks.slice()}),!1;k=k||vs;var $=n.x+n.width*k.x,f=n.y+n.height*k.y,m=z.x+z.width*k.x,F=z.y+z.height*k.y,Z=z.width?M*(n.width/z.width):1,p=z.height?C*(n.height/z.height):1;if(L.save(),U&&(U.stacks.push({t:[$,f]}),U.stacks.push({r:t}),U.stacks.push({s:[Z,p]}),U.stacks.push({t:[-m,-F]}),U.compInfos.push({comp:w,rect:n,stacks:U.stacks.slice()})),Np(L,$,f),ef(L,t||0),rb(L,Z,p),Np(L,-m,-F),1>S){0>S&&(S=0);var O=Xg(z,G(w,"clipDirection"),S);L.beginPath(),L.rect(O.x,O.y,O.width,O.height),L.clip()}return!0},Z=function(){L.interactiveInfo&&(L.interactiveInfo.stacks.pop(),L.interactiveInfo.stacks.pop(),L.interactiveInfo.stacks.pop(),L.interactiveInfo.stacks.pop()),L.restore()},F=function(B,m,k){var l=G(B,"path"),g=G(B,Td),p=G(B,"scaleX"),D=G(B,"scaleY"),h=Y(B),f=Q,N=Ml(null,l);if(k||(k=B.unionRect,k||(k=mc(N),B.path.func||(B.unionRect=k)),f=k),k){f||(f=B.unionRect,f||(f=mc(N),B.path.func||(B.unionRect=f)));var P=j(B,k,f,g,p,D,h),x=G(B,"borderPattern"),R=bf(L,x),X=c(B,"background"),z=c(B,"borderColor"),t=G(B,"borderWidth"),w=G(B,"gradient"),e=c(B,"gradientColor"),M=G(B,"border3d"),K=G(B,"border3dColor"),E=G(B,"border3dAccuracy"),$=L.lineJoin,W=L.lineCap;if(L.lineJoin=G(B,"borderJoin")||Jj,L.lineCap=G(B,"borderCap")||$q,X?(yj(L,X,w,e,f),Ml(L,l),L.fill(),R!==L&&Ml(L,l)):Ml(L,l),t&&z){var V=G(B,"borderWidthAbsolute");V&&(L.save(),L.setTransform(1,0,0,1,0,0)),L.lineWidth=t,L.strokeStyle=z,L.stroke(),V&&L.restore(),M&&Hr(L,z,K,t,y,E)}if(cg(L,x),G(B,"dash")){var b=G(B,"dashWidth")||t;if(b>0){x=G(B,"dashPattern")||es;var R=bf(L,x,G(B,"dashOffset")),s=c(B,"dashColor")||c(pe);R!==L&&Ml(L,l),L.strokeStyle=s,L.lineWidth=b,L.stroke(),G(B,"dash3d")&&Hr(L,s,c(B,"dash3dColor"),b,y,G(B,"dash3dAccuracy")),cg(L,x)}}m===qo&&Nn(L,X,G(B,"depth"),f),L.lineJoin=$,L.lineCap=W,P&&Z()}},H=function(u,z,k,M){var i=G(u,Ir,D),C=G(u,Td),e=Y(u);if(i&&M.fitSize){var w=Math.abs(Math.cos(C))<.001,F=new xg,o=mc(i),I=M.widthScale,p=M.heightScale,f=o.x+e.x*o.width,b=o.y+e.y*o.height,X=f*I,x=b*p;i.each(function(d){var T=d.x-f,j=d.y-b;F.add({x:X+T*(w?p:I),y:x+j*(w?I:p)})}),i=F,u.unionRect=null}var t=G(u,"scaleX"),E=G(u,"scaleY"),K=z===$r,N=Q;if(!k&&K&&(k=u.unionRect,k||(k=mc(i),u.points.func||(u.unionRect=k)),N=k),k){K?N||(N=u.unionRect,N||(N=mc(i),u.points.func||(u.unionRect=N))):N=k;var J,r,W,A,O=j(u,k,N,C,t,E,e),m=G(u,"borderPattern"),$=bf(L,m),h=c(u,"background"),a=Lq(G(u,"repeatImage"),S,v),T=G(u,"gradientPack"),q=c(u,"borderColor"),U=G(u,"borderWidth"),H=G(u,"segments",d),P=G(u,"gradient"),_=c(u,"gradientColor"),s=G(u,"border3d"),g=G(u,"border3dColor"),l=G(u,"border3dAccuracy"),B=G(u,"closePath"),n=G(u,"fillRule")||"nonzero",Ql=L.lineJoin,qf=L.lineCap;if(L.lineJoin=G(u,"borderJoin")||Jj,L.lineCap=G(u,"borderCap")||$q,K)if(h||a||T){var Zq=G(u,"fillClipPercentage");if(1>Zq){0>Zq&&(Zq=0);var Cg=Xg(N,G(u,"fillClipDirection"),Zq);L.save(),L.beginPath(),L.rect(Cg.x,Cg.y,Cg.width,Cg.height),L.clip()}if(lb(L,i,H,B),T)Pd(L,T);else if(a){var qn=L,Lo=S,Bd=v;xb(L,a,S,v,R,V),L=qn,S=Lo,v=Bd}else{var qn=L;yj(L,h,P,_,N),L=qn}L.fill(n),1>Zq&&L.restore(),T&&L.restore(),$!==L&&lb($,i,H,B)}else lb($,i,H,B);else if("roundRect"===z?J=G(u,"cornerRadius"):"polygon"===z?J=G(u,"polygonSide"):"arc"===z&&(J=G(u,"arcFrom"),r=G(u,"arcTo"),W=G(u,"arcClose"),A=G(u,"arcOval")),h||a||T){var Zq=G(u,"fillClipPercentage");if(1>Zq){0>Zq&&(Zq=0);var Cg=Xg(N,G(u,"fillClipDirection"),Zq);L.save(),L.beginPath(),L.rect(Cg.x,Cg.y,Cg.width,Cg.height),L.clip()}if(Og(L,z,N,J,r,W,A),T)Pd(L,T);else if(a){var qn=L,Lo=S,Bd=v;xb(L,a,S,v,R,V),L=qn,S=Lo,v=Bd}else yj(L,h,P,_,N);L.fill(n),1>Zq&&L.restore(),T&&L.restore(),L!==$&&Og($,z,N,J,r,W,A)}else Og($,z,N,J,r,W,A);if(U&&q){var $g=G(u,"borderWidthAbsolute");$g&&(L.save(),L.setTransform(1,0,0,1,0,0)),L.lineWidth=U,L.strokeStyle=q,L.stroke(),$g&&L.restore(),s&&Hr(L,q,g,U,y,l)}if(cg(L,m),G(u,"dash")){var _d=G(u,"dashWidth")||U;if(_d>0){m=G(u,"dashPattern")||es;var $=bf(L,m,G(u,"dashOffset")),wc=c(u,"dashColor")||c(pe);$!==L&&(K?lb($,i,H,B):Og($,z,N,J,r,W,A)),L.strokeStyle=wc,L.lineWidth=_d,L.stroke(),G(u,"dash3d")&&Hr(L,wc,c(u,"dash3dColor"),_d,y,G(u,"dash3dAccuracy")),cg(L,m)}}z===qo&&Nn(L,h,G(u,"depth"),N),L.lineJoin=Ql,L.lineCap=qf,O&&Z()}},q=function(l,f){var C=S,q=v,Q=S||G(l,tr),E=v||G(l,"blendMode"),T=Lq(G(l,"name"),Q,E);T&&(Cq(L,T,G(l,"stretch"),f.x,f.y,f.width,f.height,R,V,Q,null,E),S=C,v=q)},A=function(P,$){var E=G(P,"text");E!=Q&&re(L,E,G(P,"font"),c(P,tr),$.x,$.y,$.width,$.height,G(P,"align"),G(P,"vAlign"))},X=function(t,v){zd(L,c(t,tr),v.x,v.y,v.width,v.height,G(t,"width"))},I=function(P,o){var i=G(P,bq),z=0;if(i&&(i.forEach(function(q){z+=q}),z>0)){for(var u=G(P,"colors")||Yg,T=G(P,"startAngle")||0,f=G(P,"hollow"),K=G(P,rq),c=G(P,Cf),O=G(P,En),j=K?new xg:Q,b=o.x,v=o.y,y=o.width,r=o.height,Z=b+y/2,I=v+r/2,w=k(y,r)/2,l=0,V=0;V<i.length;V++){var D=i[V],N=C*D/z,B=T+N;if(L.fillStyle=u[l++],l===u.length&&(l=0),L.beginPath(),f){var q=Z+$(T)*w/2,s=I+g(T)*w/2,p=Z+$(B)*w,h=I+g(B)*w;L.moveTo(q,s),L.arc(Z,I,w/2,T,B,!1),L.lineTo(p,h),L.arc(Z,I,w,B,T,!0)}else L.moveTo(Z,I),L.arc(Z,I,w,B,T,!0);j&&(N=(T+B)/2,j.add({text:bb(K)?K(D,V,z,R):D,x:Z+.75*$(N)*w,y:I+.75*g(N)*w})),L.closePath(),L.fill(),T=B}j&&j.each(function(J){re(L,J.text,c,O,J.x,J.y,0,0,Jn)})}},B=function(i,e){var y=G(i,Wo);if(y&&y.length>0){var d=y.length,U=G(i,rq),h=G(i,Cf),O=G(i,En),z=U?new xg:Q,b=G(i,"minValue")||0,v=G(i,"maxValue");if(v==Q&&(v=0,y.forEach(function(p){G(p,bq).forEach(function(s){v=x(v,s)})})),b===v)return;for(var n=e.height/(v-b),V=e.y+v*n,Y=G(y[0],bq).length,l=e.width/(3*Y+1),w=2*l/d,P=0,C=0;d>C;C++)for(var j=y[C],E=G(j,tr),F=G(j,"colors"),t=G(j,bq),W=0;Y>W;W++){F?L.fillStyle=F[W]:E?L.fillStyle=E:(L.fillStyle=Yg[P++],P===Yg.length&&(P=0));var H=t[W],$=H*n,g=e.x+(1+3*W)*l+C*w;if(nl(L,g,V-$,w,$),z){var J=bb(U)?U(H,W,j,R):H,u=vr(h,J).height;z.add({x:g,y:V-$-u,width:w,height:u,text:J})}}z&&z.each(function(G){re(L,G.text,h,O,G.x,G.y,G.width,G.height,Jn)})}},h=function(P,l){var z=G(P,Wo);if(z&&z.length>0){var k=z.length,o=G(z[0],bq).length,E=l.width/(3*o+1),e=0,T=G(P,"maxValue"),r=G(P,rq),M=G(P,Cf),H=G(P,En),w=r?new xg:Q;if(T==Q){T=0;for(var O=0;o>O;O++){for(var q=0,v=0;k>v;v++)q+=G(z[v],bq)[O];T=x(T,q)}}if(T>0){for(var O=0;o>O;O++)for(var W=l.y+l.height,v=0;k>v;v++){var h=z[v],t=G(h,tr),N=G(h,bq)[O],$=N/T*l.height;t?L.fillStyle=t:(L.fillStyle=Yg[e++],e===Yg.length&&(e=0)),W-=$;var X={x:l.x+(1+3*O)*E,y:W,width:2*E,height:$};nl(L,X.x,X.y,X.width,X.height),w&&(X.text=bb(r)?r(N,O,h,R):N,w.add(X))}w&&w.each(function(C){re(L,C.text,M,H,C.x,C.y,C.width,C.height,Jn)})}}},J=function(b,f){var n=G(b,Wo);if(n&&n.length>0){for(var J=n.length,I=G(n[0],bq).length,_=f.width/(3*I+1),p=0,r=G(b,rq),c=G(b,Cf),T=G(b,En),U=r?new xg:Q,k=0;I>k;k++){for(var S=0,x=0;J>x;x++)S+=G(n[x],bq)[k];if(S>0){var l=f.y+f.height;for(x=0;J>x;x++){var g=n[x],i=G(g,tr),V=G(g,bq)[k],C=V/S*f.height;i?L.fillStyle=i:(L.fillStyle=Yg[p++],p===Yg.length&&(p=0)),l-=C;var Z={x:f.x+(1+3*k)*_,y:l,width:2*_,height:C};nl(L,Z.x,Z.y,Z.width,Z.height),U&&(Z.text=bb(r)?r(V,k,g,R):V,U.add(Z))}}}U&&U.each(function(E){re(L,E.text,c,T,E.x,E.y,E.width,E.height,Jn)})}},b=function(e,v){var F=G(e,Wo);if(F&&F.length>0){var l=F.length,S=G(e,"minValue")||0,$=G(e,"maxValue");if($==Q&&($=0,F.forEach(function(w){G(w,bq).forEach(function(G){$=x($,G)})})),S===$)return;for(var h=v.height/($-S),N=v.y+$*h,H=G(F[0],bq).length,r=v.width/(3*H+1),M=0,Z=G(e,"lineWidth")||2,A=G(e,"line3d"),O=G(e,"linePoint"),W=G(e,rq),m=G(e,Cf),X=G(e,En),K=0;l>K;K++){var b=F[K],k=G(b,tr),_=G(b,bq);k?L.strokeStyle=k:(k=L.strokeStyle=Yg[M++],M===Yg.length&&(M=0)),L.beginPath();for(var z=0;H>z;z++){var T=v.x+(2+3*z)*r,j=N-_[z]*h;0===z?L.moveTo(T,j):L.lineTo(T,j)}if(L.lineWidth=Z,L.stroke(),A&&Hr(L,k,Q,Z,y),O||W){var s,Y=Z/2+2;for(z=0;H>z;z++){var p=_[z];if(T=v.x+(2+3*z)*r,j=N-p*h,bb(O)?O(L,T,j,k,z,b,R):O&&(L.fillStyle=k,L.beginPath(),L.arc(T,j,Y,0,C,!0),L.fill()),bb(W)?s=W(p,z,b,R):W&&(s=p),s){var P=vr(m,s).height,t=L.shadowBlur;if(t){var c=L.shadowOffsetX,f=L.shadowOffsetY,o=L.shadowColor;L.shadowOffsetX=0,L.shadowOffsetY=0,L.shadowBlur=0,L.shadowColor=Q}re(L,s,m,X,T,j-P-Y+2,0,P,Jn),t&&(L.shadowOffsetX=c,L.shadowOffsetY=f,L.shadowBlur=t,L.shadowColor=o)}}}}}},N={border:X,image:q,text:A,pieChart:I,columnChart:B,stackedColumnChart:h,percentageColumnChart:J,lineChart:b};return function(I,z,$,l,J,m,P,n,o,f){if(z&&J&&m){L=I,R=P,V=n,y=V?V._zoom?V._zoom:1:1,S=o,v=f;var T=J,a=m;if(el()){var K,h,r;0===L[eq]?el[0]&&(K=!0):K=!0,L.texureImage2D?el[1]&&(h=!0):h=!0,L.texureImage3D?el[2]&&(r=!0):r=!0,K&&h&&r&&(T=$,a=l)}if(z.tagName)return Pf(t)&&!u[t]||L.drawImage(z,T,a,J,m),void 0;if(G(z,"visible")!==!1){S||(S=Aq(z.color,R,V)),f||(v=Aq(z.blendMode,R,V)),Pf(t)&&!u[t]&&(J=T,m=a);var q=ki(z,R,V,J),w=Xe(z,R,V,m),g={x:0,y:0,width:q,height:w,fitSize:G(z,"fitSize")},C=G(z,"clip"),A=G(z,"opacity");g.fitSize&&(g.widthScale=q/Aq(z.width,R,V),g.heightScale=w/Aq(z.height,R,V)),L.save(),L.interactiveInfo&&(L.interactiveInfo.stacks.push({t:[T,a]}),L.interactiveInfo.stacks.push({s:[J/q,m/w]})),Np(L,T,a),(q!==J||w!==m)&&L.scale(J/q,m/w),C&&(bb(C)?C(L,q,w,R,V,z):(L.beginPath(),L.rect(0,0,q,w),L.clip())),A!=Q&&(L.globalAlpha*=A),G(z,"comps").forEach(function(X){if(G(X,ws)!==!1){ri.splice(0,0,X);var v=G(X,"opacity"),T=G(X,"shadow"),q=G(X,"type"),W=s(X,g);if(v!=Q){var h=L.globalAlpha;L.globalAlpha*=v}if(T){var u=L.shadowOffsetX,r=L.shadowOffsetY,K=L.shadowBlur,C=L.shadowColor,U=G(X,"shadowOffsetX"),P=G(X,"shadowOffsetY"),t=G(X,"shadowBlur"),f=c(X,"shadowColor");L.shadowOffsetX=(U==Q?3:U)*y,L.shadowOffsetY=(P==Q?3:P)*y,L.shadowBlur=(t==Q?6:t)*y,L.shadowColor=f||c(sp)}if("save"===q)L.save();else if("endClip"===q||"restore"===q)L.restore();else if("clip"===q)L.save(),lb(L,G(X,"points",D),G(X,"segments",d),!0),L.clip();else if(qi[q])W=W||{x:0,y:0,width:g.width,height:g.height},H(X,q,W,g);else if(q===$r)H(X,q,W,g);else if("SVGPath"===q)F(X,q,W);else{W=W||{x:0,y:0,width:g.width,height:g.height};var J=G(X,Td),E=G(X,"scaleX"),S=G(X,"scaleY"),m=Y(X),B=j(X,W,W,J,E,S,m);if(bb(q))O(X,q),p.drawCompType(q,L,W,X,R,V);else if(p.getCompType(q)){var $=p.getCompType(q),A=$.func||$;O(X,$),p.drawCompType(A,L,W,X,R,V)}else N[q]?N[q](X,W):p.getCompType(q)===i&&Mi.test(q)&&Nc(q);B&&Z()}T&&(L.shadowOffsetX=u,L.shadowOffsetY=r,L.shadowBlur=K,L.shadowColor=C),v!=Q&&(L.globalAlpha=h),ri.splice(0,1)}}),L.interactiveInfo&&(L.interactiveInfo.stacks.pop(),L.interactiveInfo.stacks.pop()),L.restore()}}}}();p.getCurrentComp=function(){return ri[0]},p.getParentComp=function(){return ri[1]},p.getInternal=function(){return{isEnter:Cj,isEsc:Wq,isSpace:mo,isLeft:Ao,isUp:Yf,isRight:ts,isDown:en,addMethod:Bm,superCall:ym,toPointsArray:fb,translateAndScale:Hd,appendArray:Bd,createWorldMatrix:zg,vec3TransformMat4:Vi,setCanvas:vh,createDiv:xq,createView:Ro,createCanvas:yk,createImage:jp,initContext:ro,layout:Ae,fillRect:nl,Mat:Gm,drawBorder:zd,isString:Pf,setBorder:eb,getPropertyValue:Qp,setPropertyValue:Ee,drawVerticalLine:Rd,draw3DRect:Nn,getPinchDist:Dp,isSameRect:zm,getPosition:zb,intersectionLineRect:Zg,getNodeRect:$j,getEdgeAgentPosition:Bj,getImageWidth:ki,getImageHeight:Xe,initItemElement:Fd,drawPoints:lb,createG2:bf,closePopup:Ho,isH:wf,createAnim:fl,createNormalMatrix:Hf,createNormals:Tp,toFloatArray:Kr,glMV:Hi,batchShape:Ik,createNodeMatrix:pj,getFaceInfo:$d,transformAppend:Zn,drawFaceInfo:gi,to3dPointsArray:Nj,setGLDebugMode:function(T){So=T},cube:function(){return{vs:Hl,is:dc,uv:jg}},ui:function(){return{DataUI:_b,NodeUI:go,EdgeUI:Wc,GroupUI:me,ShapeUI:Uf,GridUI:Mn,Data3dUI:sr,Node3dUI:zk,Shape3dUI:Ln}},getInternalVersion:function(){return"U2FsdGVkX19c0wmC59R+KbEGBjVRaBY98z3PjtPeFA8="},getDragger:function(){return gd},addMSMap:function(s){Bm(rm,s)},k:S}},function(M){function r(U,a){U!=Q&&(a==Q&&uf!=typeof U?this._54O(U,256):this._54O(U,a))}function B(){return new r(Q)}function e(V,h,T,y,t,A){for(;--A>=0;){var c=h*this[V++]+T[y]+t;t=K(c/67108864),T[y++]=67108863&c}return t}function f(Z,T,f,o,b,r){for(var z=32767&T,E=T>>15;--r>=0;){var P=32767&this[Z],W=this[Z++]>>15,w=E*P+W*z;P=z*P+((32767&w)<<15)+f[o]+(1073741823&b),b=(P>>>30)+(w>>>15)+E*W+(b>>>30),f[o++]=1073741823&P}return b}function L(d,u,M,L,y,l){for(var V=16383&u,G=u>>14;--l>=0;){var Z=16383&this[d],X=this[d++]>>14,Y=G*Z+X*V;Z=V*Z+((16383&Y)<<14)+M[L]+y,y=(Z>>28)+(Y>>14)+G*X,M[L++]=268435455&Z}return y}function O(y){return Io.charAt(y)}function E(g,H){var l=lg[g.charCodeAt(H)];return l==Q?-1:l}function c(t){for(var U=this.t-1;U>=0;--U)t[U]=this[U];t.t=this.t,t.s=this.s}function a(E){this.t=1,this.s=0>E?-1:0,E>0?this[0]=E:-1>E?this[0]=E+this.DV:this.t=0}function s(A){var s=B();return s._58O(A),s}function d(F,N){var k,W=this;if(16==N)k=4;else if(8==N)k=3;else if(256==N)k=8;else if(2==N)k=1;else if(32==N)k=5;else{if(4!=N)return W.fromRadix(F,N),void 0;k=2}W.t=0,W.s=0;for(var q=F.length,O=!1,D=0;--q>=0;){var X=8==k?255&F[q]:E(F,q);0>X?"-"==F.charAt(q)&&(O=!0):(O=!1,0==D?W[W.t++]=X:D+k>W.DB?(W[W.t-1]|=(X&(1<<W.DB-D)-1)<<D,W[W.t++]=X>>W.DB-D):W[W.t-1]|=X<<D,D+=k,D>=W.DB&&(D-=W.DB))}8==k&&0!=(128&F[0])&&(W.s=-1,D>0&&(W[W.t-1]|=(1<<W.DB-D)-1<<D)),W._57O(),O&&r.ZERO._78O(W,W)}function H(){for(var G=this,r=G.s&G.DM;G.t>0&&G[G.t-1]==r;)--G.t}function J(F){var S=this;if(S.s<0)return"-"+S._85O()[Bb](F);var s;if(16==F)s=4;else if(8==F)s=3;else if(2==F)s=1;else if(32==F)s=5;else{if(4!=F)return S.toRadix(F);s=2}var w,X=(1<<s)-1,e=!1,q="",R=S.t,Q=S.DB-R*S.DB%s;if(R-->0)for(Q<S.DB&&(w=S[R]>>Q)>0&&(e=!0,q=O(w));R>=0;)s>Q?(w=(S[R]&(1<<Q)-1)<<s-Q,w|=S[--R]>>(Q+=S.DB-s)):(w=S[R]>>(Q-=s)&X,0>=Q&&(Q+=S.DB,--R)),w>0&&(e=!0),e&&(q+=O(w));return e?q:"0"}function b(){var P=B();return r.ZERO._78O(this,P),P}function o(){return this.s<0?this._85O():this}function I(q){var Q=this,I=Q.s-q.s;if(0!=I)return I;var M=Q.t;if(I=M-q.t,0!=I)return Q.s<0?-I:I;for(;--M>=0;)if(0!=(I=Q[M]-q[M]))return I;return 0}function t(m){var h,j=1;return 0!=(h=m>>>16)&&(m=h,j+=16),0!=(h=m>>8)&&(m=h,j+=8),0!=(h=m>>4)&&(m=h,j+=4),0!=(h=m>>2)&&(m=h,j+=2),0!=(h=m>>1)&&(m=h,j+=1),j}function y(){var P=this;return P.t<=0?0:P.DB*(P.t-1)+t(P[P.t-1]^P.s&P.DM)}function n(G,i){var l;for(l=this.t-1;l>=0;--l)i[l+G]=this[l];for(l=G-1;l>=0;--l)i[l]=0;i.t=this.t+G,i.s=this.s}function _(J,P){for(var e=J;e<this.t;++e)P[e-J]=this[e];P.t=x(this.t-J,0),P.s=this.s}function p($,j){var M,D=this,J=$%D.DB,v=D.DB-J,o=(1<<v)-1,m=K($/D.DB),R=D.s<<J&D.DM;for(M=D.t-1;M>=0;--M)j[M+m+1]=D[M]>>v|R,R=(D[M]&o)<<J;for(M=m-1;M>=0;--M)j[M]=0;j[m]=R,j.t=D.t+m+1,j.s=D.s,j._57O()}function Y(B,x){var P=this;x.s=P.s;var M=K(B/P.DB);if(M>=P.t)return x.t=0,void 0;var f=B%P.DB,o=P.DB-f,t=(1<<f)-1;x[0]=P[M]>>f;for(var v=M+1;v<P.t;++v)x[v-M-1]|=(P[v]&t)<<o,x[v-M]=P[v]>>f;f>0&&(x[P.t-M-1]|=(P.s&t)<<o),x.t=P.t-M,x._57O()}function T(h,y){for(var E=this,G=0,p=0,J=k(h.t,E.t);J>G;)p+=E[G]-h[G],y[G++]=p&E.DM,p>>=E.DB;if(h.t<E.t){for(p-=h.s;G<E.t;)p+=E[G],y[G++]=p&E.DM,p>>=E.DB;p+=E.s}else{for(p+=E.s;G<h.t;)p-=h[G],y[G++]=p&E.DM,p>>=E.DB;p-=h.s}y.s=0>p?-1:0,-1>p?y[G++]=E.DV+p:p>0&&(y[G++]=p),y.t=G,y._57O()}function F(q,b){var i=this.abs(),k=q.abs(),c=i.t;for(b.t=c+k.t;--c>=0;)b[c]=0;for(c=0;c<k.t;++c)b[c+i.t]=i.am(0,k[c],b,c,0,i.t);b.s=0,b._57O(),this.s!=q.s&&r.ZERO._78O(b,b)}function W(w){for(var m=this.abs(),B=w.t=2*m.t;--B>=0;)w[B]=0;for(B=0;B<m.t-1;++B){var C=m.am(B,m[B],w,2*B,0,1);(w[B+m.t]+=m.am(B+1,2*m[B],w,2*B+1,C,m.t-B-1))>=m.DV&&(w[B+m.t]-=m.DV,w[B+m.t+1]=1)}w.t>0&&(w[w.t-1]+=m.am(B,m[B],w,2*B,0,1)),w.s=0,w._57O()}function D(E,n,G){var c=E.abs(),S=this;if(!(c.t<=0)){var s=S.abs();if(s.t<c.t)return n!=Q&&n._58O(0),G!=Q&&S._77O(G),void 0;G==Q&&(G=B());var a=B(),C=S.s,d=E.s,O=S.DB-t(c[c.t-1]);O>0?(c._44O(O,a),s._44O(O,G)):(c._77O(a),s._77O(G));var R=a.t,g=a[R-1];if(0!=g){var X=g*(1<<S.F1)+(R>1?a[R-2]>>S.F2:0),$=S.FV/X,i=(1<<S.F1)/X,k=1<<S.F2,T=G.t,o=T-R,H=n==Q?B():n;for(a._59O(o,H),G._52O(H)>=0&&(G[G.t++]=1,G._78O(H,G)),r.ONE._59O(R,H),H._78O(a,a);a.t<R;)a[a.t++]=0;for(;--o>=0;){var U=G[--T]==g?S.DM:K(G[T]*$+(G[T-1]+k)*i);if((G[T]+=a.am(0,U,G,o,0,R))<U)for(a._59O(o,H),G._78O(H,G);G[T]<--U;)G._78O(H,G)}n!=Q&&(G._45O(R,n),C!=d&&r.ZERO._78O(n,n)),G.t=R,G._57O(),O>0&&G._46O(O,G),0>C&&r.ZERO._78O(G,G)}}}function q($){var g=B();return this.abs()._49O($,Q,g),this.s<0&&g._52O(r.ZERO)>0&&$._78O(g,g),g}function U(j){this.m=j}function A(s){return s.s<0||s._52O(this.m)>=0?s.mod(this.m):s}function u(Z){return Z}function j(Y){Y._49O(this.m,Q,Y)}function R(M,l,m){M._47O(l,m),this._74O(m)}function N(M,Q){M._48O(Q),this._74O(Q)}function i(){if(this.t<1)return 0;var v=this[0];if(0==(1&v))return 0;var a=3&v;return a=15&a*(2-(15&v)*a),a=255&a*(2-(255&v)*a),a=65535&a*(2-(65535&(65535&v)*a)),a=a*(2-v*a%this.DV)%this.DV,a>0?this.DV-a:-a
}function m(l){var v=this;v.m=l,v.mp=l._50O(),v.mpl=32767&v.mp,v.mph=v.mp>>15,v.um=(1<<l.DB-15)-1,v.mt2=2*l.t}function h(H){var z=B();return H.abs()._59O(this.m.t,z),z._49O(this.m,Q,z),H.s<0&&z._52O(r.ZERO)>0&&this.m._78O(z,z),z}function Z($){var O=B();return $._77O(O),this._74O(O),O}function X(J){for(var w=this;J.t<=w.mt2;)J[J.t++]=0;for(var V=0;V<w.m.t;++V){var o=32767&J[V],W=o*w.mpl+((o*w.mph+(J[V]>>15)*w.mpl&w.um)<<15)&J.DM;for(o=V+w.m.t,J[o]+=w.m.am(0,W,J,V,0,w.m.t);J[o]>=J.DV;)J[o]-=J.DV,J[++o]++}J._57O(),J._45O(w.m.t,J),J._52O(w.m)>=0&&J._78O(w.m,J)}function km(x,l){x._48O(l),this._74O(l)}function sg(P,t,p){P._47O(t,p),this._74O(p)}function Pe(){return 0==(this.t>0?1&this[0]:this.s)}function vn(U,e){if(U>4294967295||1>U)return r.ONE;var X=B(),x=B(),F=e._73O(this),Z=t(U)-1;for(F._77O(X);--Z>=0;)if(e._76O(X,x),(U&1<<Z)>0)e._75O(x,F,X);else{var d=X;X=x,x=d}return e.revert(X)}function Gl(G,O){var b;return b=256>G||O._51O()?new U(O):new m(O),this.exp(G,b)}function sb(){var I=this;if(I.s<0){if(1==I.t)return I[0]-I.DV;if(0==I.t)return-1}else{if(1==I.t)return I[0];if(0==I.t)return 0}return(I[1]&(1<<32-I.DB)-1)<<I.DB|I[0]}function Em(G,g){return new r(G,g)}function Qb(){var B=this;B.n=Q,B.e=0,B.d=Q,B.p=Q,B.q=Q,B.dmp1=Q,B.dmq1=Q,B._10A=Q}function qd(d){return d._53O(this.e,this.n)}function Nf(A){var o,i,x,y="",d=0;for(o=0;o<A.length&&A.charAt(o)!=Il;++o)x=Qj.indexOf(A.charAt(o)),0>x||(0==d?(y+=O(x>>2),i=3&x,d=1):1==d?(y+=O(i<<2|x>>4),i=15&x,d=2):2==d?(y+=O(i),y+=O(x>>2),i=3&x,d=3):(y+=O(i<<2|x>>4),y+=O(15&x),d=0));return 1==d&&(y+=O(i<<2)),y}function kl(P){var A=P.split(""),o=Nf(P);return A.forEach(function(C){var D=C.length;D>0&&o&&(Oo+=z(C))}),o}function gd(W,r){var J=ns._4O.Util._56O(W,"ss"),i={},n=0;return i.v=J==r,i.t=1,i.s=0>n?-1:0,pi=i.v,n>0?i[0]=n:-1>n?i[0]=n+i.DV:i.t=0,[J,i]}function eo(U){var m=38,r=U.substring(0,m);if(r&&30==r.indexOf("05000420")){var J=["ss",U.substring(m)];return J}return[]}function $c(c,Y){Y=Y.replace(Ip,""),Y=Y.replace(/[ \n]+/g,"");var N=Em(Y,16);if(N._55O()>this.n._55O())return 0;var b=this._37O(N),l=b[Bb](16).replace(/^1f+00/,""),R=eo(l);if(0==R.length)return!1;for(var G,A,p,r=.5,d=od,F=[0,.5,.75,.875,.9375],t=[],n=[],I=[],j=C/d,H=R[1],E=gd(c,H)[0],J=0,V=0;J<F.length;J++){var f=0===J%2?0:.5;for(G=0;d>=G;G++)A=(G+f)*j,p=1-F[J],t.push($(A)*r*p,-r+2*F[J]*r,-g(A)*r*p),n.push((G+f)/d,p)}for(J=0;J<F.length-1;J++){var w=J*(d+1),W=(J+1)*(d+1);for(G=0;d>G;G++)I.push(w+G,W+G+1,W+G,w+G,w+G+1,W+G+1)}return I.forEach(function(T){V+=T}),H==E&&V>10}var Mf,On=0xdeadbeefcafe,$p=15715070==(16777215&On),Bb="toString",Sk="",sr="nat",Ld=function(){};P=M["D"+11182[Bb](v(2,5))];var _q=r.prototype;yc+=sq.substr(0,1);var Nb=M.navigator?M.navigator.appName:"";$p&&"Microsoft Internet Explorer"==Nb?(_q.am=f,Mf=30):$p&&"Netscape"!=Nb?(_q.am=e,Mf=26):(_q.am=L,Mf=28),_q.DB=Mf,_q.DM=(1<<Mf)-1,_q.DV=1<<Mf;var tg=52;_q.FV=v(2,tg),_q.F1=tg-Mf,_q.F2=2*Mf-tg;var xb,Mb,Io="0123456789abcdefghijklmnopqrstuvwxyz",lg=[],vi=function(b){return String.fromCharCode(b)};for(xb="0".charCodeAt(0),Mb=0;9>=Mb;++Mb)lg[xb++]=Mb;for(xb="a".charCodeAt(0),Mb=10;36>Mb;++Mb)lg[xb++]=Mb;for(xb="A".charCodeAt(0),Mb=10;36>Mb;++Mb)lg[xb++]=Mb;var gq=U.prototype;gq._73O=A,gq.revert=u,gq._74O=j,gq._75O=R,gq._76O=N;var Aq=m.prototype;Aq._73O=h,Aq.revert=Z,Aq._74O=X,Aq._75O=sg,Aq._76O=km,_q._77O=c,_q._58O=a,_q._54O=d,_q._57O=H,_q._59O=n,_q._45O=_,_q._44O=p,_q._46O=Y,_q._78O=T,_q._47O=F,_q._48O=W,_q._49O=D,_q._50O=i,_q._51O=Pe,_q.exp=vn,_q.toString=J,_q._85O=b,_q.abs=o,_q._52O=I,_q._55O=y,_q.mod=q,_q._53O=Gl,r.ZERO=s(0),r.ONE=s(1),_q._86O=sb;var Fq=function(K,y){var A=this;A.isPublic=!0,typeof K!==uf?(A.n=K,A.e=y):K!=Q&&y!=Q&&K.length>0&&y.length>0&&(A.n=Em(K,16),A.e=z(y,16))};we=function(){var y,s,f=kl(Te),Z=f.substr(0,4),B=f.substr(4,2),W=f.substr(6,2),a=1,k=!a,l=S,G=[],V=Xm.charAt(7);if(P&&(P[Bb]().indexOf(sr)<0||P[yc][Bb]().indexOf(sr)<0||!f?y=Zp(To[V]):(f=new P(Z-0,B-a,W-0),s=f.setHours(9),P[yc]()>s?y=Zp(To[V]):k=!0)),f&&y&&l){for(var r in y)G.push(r);var E,$=0,O=y[G[$++]],n=y[G[$++]],c=y[G[$++]],N=y[G[$++]],X=y[G[$++]],d=y[G[$++]],C=y[G[$++]],q=yi._27O(l);if(q&&C){E=O+n+c+N+X+d;var L=!d||d===mp;if(!L&&d)for(var T,K=0,U=d.length;U>K;K++)d[K]===wl[$]?T===mp?L=!0:T=Q:(T==Q?T=d[K]:T+=d[K],K===U-1&&T===mp&&(L=!0));E&&q._31O(E,C)&&L&&(!X||P[yc]()<X)&&(k=!0)}}return k||(Og=Yc),V};var Gi=Qb.prototype;Gi._37O=qd,Gi._38O=Fq;var Qj="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Il="=",$n=25,Yl=10,Te="IBgFAQ==",ed=ed||function(M,B){var $={},L=$._7A={},f=L._6A=function(){function H(){}return{_80O:function(G){H.prototype=this;var Y=new H;return G&&Y._5A(G),Y.hasOwnProperty("_82O")||(Y._82O=function(){Y.$super._82O.apply(this,arguments)}),Y._82O.prototype=Y,Y.$super=this,Y},_3A:function(){var i=this._80O();return i._82O.apply(i,arguments),i},_82O:function(){},_5A:function(S){for(var e in S)S.hasOwnProperty(e)&&(this[e]=S[e]);S.hasOwnProperty(Bb)&&(this.toString=S.toString)},_88O:function(){return this._82O.prototype._80O(this)}}}(),q=L._39O=f._80O({_82O:function(p,n){p=this._84O=p||[],this._65O=n!=B?n:4*p.length},toString:function(S){return(S||K).stringify(this)},_89O:function(t){var T=this._84O,l=t._84O,s=this._65O,c=t._65O;if(this._57O(),s%4)for(var k=0;c>k;k++){var X=255&l[k>>>2]>>>24-8*(k%4);T[s+k>>>2]|=X<<24-8*((s+k)%4)}else if(l.length>65535)for(var k=0;c>k;k+=4)T[s+k>>>2]=l[k>>>2];else T.push.apply(T,l);return this._65O+=c,this},_57O:function(){var c=this._84O,Z=this._65O;c[Z>>>2]&=4294967295<<32-8*(Z%4),c.length=G(Z/4)},_88O:function(){var s=f._88O.call(this);return s._84O=this._84O.slice(0),s},_87O:function(k){for(var s=[],j=0;k>j;j+=4)s.push(0|4294967296*w);return new q._82O(s,k)}}),c=$._2A={},K=c._69O={stringify:function(a){var o,p=a._84O,v=a._65O,T=[];for(o=0;v>o;o++){var A=255&p[o>>>2]>>>24-8*(o%4);T.push((A>>>4).toString(16)),T.push((15&A).toString(16))}return T.join("")},_68O:function(j){for(var D=j.length,u=[],E=0;D>E;E+=2)u[E>>>3]|=z(j.substr(E,2),16)<<24-4*(E%8);return new q._82O(u,D/2)}},X=c._8A={stringify:function(Z){var i,C=Z._84O,U=Z._65O,J=[];for(i=0;U>i;i++){var L=255&C[i>>>2]>>>24-8*(i%4);J.push(vi(L))}return J.join("")},_68O:function(V){var F,m=V.length,O=[];for(F=0;m>F;F++)O[F>>>2]|=(255&V.charCodeAt(F))<<24-8*(F%4);return new q._82O(O,m)}},v=c._9A={stringify:function(m){try{return decodeURIComponent(escape(X.stringify(m)))}catch(R){throw new Error("")}},_68O:function(b){return X._68O(unescape(encodeURIComponent(b)))}},j=L._32O=f._80O({_1A:function(){this._83O=new q._82O,this._23O=0},_33O:function(W){typeof W==uf&&(W=v._68O(W)),this._83O._89O(W),this._23O+=W._65O},_25O:function(c){var g=this._83O,j=g._84O,s=g._65O,T=this._79O,W=4*T,O=s/W;O=c?G(O):x((0|O)-this._22O,0);var N=O*T,M=k(4*N,s);if(N){for(var F=0;N>F;F+=T)this._20O(j,F);var P=j.splice(0,N);g._65O-=M}return new q._82O(P,M)},_88O:function(){var x=f._88O.call(this);return x._83O=this._83O._88O(),x},_22O:0});L._66O=j._80O({cfg:f._80O(),_82O:function(e){this.cfg=this.cfg._80O(e),this._1A()},_1A:function(){j._1A.call(this),this._34O()},_81O:function(C){return this._33O(C),this._25O(),this},_72O:function(M){M&&this._33O(M);var i=this._21O();return i},_79O:16,_26O:function(X){return function(V,D){return new X._82O(D)._72O(V)}},_19O:function(Y){return function(d,M){return new P._71O._82O(Y,M)._72O(d)}}});var P=$._67O={};return $}();!function(){var B=ed,T=B._7A,_=T._39O,o=T._66O,g=B._67O,s=[],m=[];!function(){function a(_){for(var d=V(_),S=2;d>=S;S++)if(!(_%S))return!1;return!0}function x(F){return 0|4294967296*(F-(0|F))}for(var p=2,q=0;64>q;)a(p)&&(8>q&&(s[q]=x(v(p,.5))),m[q]=x(v(p,1/3)),q++),p++}();var G=[],i=g._41O=o._80O({_34O:function(){this._64O=new _._82O(s.slice(0))},_20O:function(E,v){for(var f=this._64O._84O,g=f[0],J=f[1],I=f[2],B=f[3],M=f[4],Z=f[5],V=f[6],h=f[7],z=0;64>z;z++){if(16>z)G[z]=0|E[v+z];else{var R=G[z-15],T=(R<<25|R>>>7)^(R<<14|R>>>18)^R>>>3,u=G[z-2],j=(u<<15|u>>>17)^(u<<13|u>>>19)^u>>>10;G[z]=T+G[z-7]+j+G[z-16]}var H=M&Z^~M&V,k=g&J^g&I^J&I,s=(g<<30|g>>>2)^(g<<19|g>>>13)^(g<<10|g>>>22),r=(M<<26|M>>>6)^(M<<21|M>>>11)^(M<<7|M>>>25),l=h+r+H+m[z]+G[z],X=s+k;h=V,V=Z,Z=M,M=0|B+l,B=I,I=J,J=g,g=0|l+X}f[0]=0|f[0]+g,f[1]=0|f[1]+J,f[2]=0|f[2]+I,f[3]=0|f[3]+B,f[4]=0|f[4]+M,f[5]=0|f[5]+Z,f[6]=0|f[6]+V,f[7]=0|f[7]+h},_21O:function(){var u=this._83O,Z=u._84O,o=8*this._23O,F=8*u._65O;return Z[F>>>5]|=128<<24-F%32,Z[(F+64>>>9<<4)+14]=K(o/4294967296),Z[(F+64>>>9<<4)+15]=o,u._65O=4*Z.length,this._25O(),this._64O},_88O:function(){var M=o._88O.call(this);return M._64O=this._64O._88O(),M}});B._41O=o._26O(i),B._42O=o._19O(i)}();var Ip=new RegExp("");Ip.compile("[^0-9a-f]","gi"),Qb._28O=-1,Qb._29O=-2,Gi._31O=$c,Gi._63O=$c,Qb._43O=-2;var Ol=new function(){var y=this;y._5O=function(t,c){if("8"!=t.substring(c+2,c+3))return 1;var Z=z(t.substring(c+3,c+4));return 0==Z?-1:Z>0&&10>Z?Z+1:-2},y._13O=function(b,W){var v=y._5O(b,W);return 1>v?"":b.substring(W+2,W+2+2*v)},y._12O=function(X,q){var j=y._13O(X,q);if(""==j)return-1;var F;return F=z(j.substring(0,1))<8?new r(j,16):new r(j.substring(2),16),F._86O()},y._6O=function(_,L){var u=y._5O(_,L);return 0>u?u:L+2*(u+1)},y._11O=function(S,b){var h=y._6O(S,b),k=y._12O(S,b);return S.substring(h,h+2*k)},y._10O=function(W,G){var M=y._6O(W,G),h=y._12O(W,G);return M+2*h},y._7O=function(o,G){var P=[],Z=y._6O(o,G);P.push(Z);for(var e=y._12O(o,G),s=Z,w=0;;){var W=y._10O(o,s);if(W==Q||W-Z>=2*e)break;if(w>=200)break;P.push(W),s=W,w++}return P}};if(Ol._90O=vi(Yl+24),Ol._91O=l+vi(Yl*Yl+8),ns==Q||!ns)var ns={};ns._4O!=Q&&ns._4O||(ns._4O={});var jb=ns._4O;ns._4O.Util=new function(){var v=this;v._56O=function(Q){var p=new ns._4O._3O;return p._30O(Q)},v._4A=function(w){var e=new ns._4O._3O;return e._36O(w)},v._11A=function(r){var B=new jb._3O;return B._30O(r)}},ns._4O._3O=function(){var O=this;O._8O=function(G,Y){if("ss"==G&&"cj"==Y){try{O.md=ed._67O._41O._3A()}catch(d){Ld(Sk)}O._24O=function(P){O.md._81O(P)},O._35O=function(h){var W=ed._2A._69O._68O(h);O.md._81O(W)},O._60O=function(){var D=O.md._72O();return D[Bb](ed._2A._69O)},O._30O=function(Q){return O._24O(Q),O._60O()},O._36O=function(V){return O._35O(V),O._60O()}}},O._24O=function(){Ld(Sk)},O._35O=function(){Ld(Sk)},O._60O=function(){Ld(Sk)},O._30O=function(){Ld(Sk)},O._36O=function(){Ld(Sk)},O._8O("ss","cj")},Lo=function(s){var a=Ar[Ac[7]],j=1,O=!1;if(qm.a!=Ar[Mp])return qm.a;if(qm.forEach(function(i){j*=i}),s>j){if(a){a=a.split(Ol._90O);var x=a[3],q=a[7],X=a[11],R=a[15],E=a[19],r=a[23],u=a[27],L=x+q+X+R+E+r,d=r?!1:!0;if(r){var U=r&&r.split(db("firefox")[3]);if(U)for(var $=0;$<U.length;$++)if(fd.indexOf(U[$])>=0){d=!0;break}}O=oj()(L,u)&&d&&(!E||E>s)}O||(_b.prototype._42=Xb)}else O=!0;return qm.a=O,O},$n=String.fromCharCode($n+20);var Zn=function(T){return T=T.replace(Ip,Sk),T=T.replace(/[ \n]+/g,Sk)},di="30",Sm="06",Vk="02",Fi="03",Bo=Em,xj=/^1f+00/,yi=function(){var C;return C={_18O:function(h){var N=h,o=N.replace(/\s+/g,""),y=Nf(o);return y},_14O:function(i){var d=this._18O(i),p=this._15O(d);return p},_15O:function(s){var I=this._17O(s);if("2a864886f70d010101"==I._61O){var r=this._16O(I.key),_=new Qb;return _._38O(r.n,r.e),_}Ld(Sk)},_16O:function(y){var N={};y.substr(0,2)!=di&&Ld(Sk);var I=Ol._7O(y,0);return 2!=I.length&&Ld(Sk),y.substr(I[0],2)!=Vk&&Ld(Sk),N.n=Ol._11O(y,I[0]),y.substr(I[1],2)!=Vk&&Ld(Sk),N.e=Ol._11O(y,I[1]),N},_17O:function(P){var s={};s._40O=Q;var E=Ol._7O(P,0);2!=E.length&&Ld(Sk);var k=E[0];P.substr(k,2)!=di&&Ld(Sk);var G=Ol._7O(P,k);return 2!=G.length&&Ld(Sk),P.substr(G[0],2)!=Sm&&Ld(Sk),s._61O=Ol._11O(P,G[0]),P.substr(G[1],2)==Sm?s._40O=Ol._11O(P,G[1]):P.substr(G[1],2)==di&&(s._40O={},s._40O.p=Ol._70O(P,G[1],[0],Vk),s._40O.q=Ol._70O(P,G[1],[1],Vk),s._40O.g=Ol._70O(P,G[1],[2],Vk)),P.substr(E[1],2)!=Fi&&Ld(Sk),s.key=Ol._11O(P,E[1]).substr(2),s}},C._17O?C:Q}(),Ej=yi._27O=function(C){return yi._14O(C)};oj=function(){return function(n,M){if(n&&M){M=Zn(M);var H=Bo(M,v(2,4)),w=this;if(!w||!w.n||H._55O()>w.n._55O())return 0;var R=w._37O(H),j=R[Bb](v(2,4)).replace(xj,""),z=eo(j);if(0==z.length)return!1;var l=z[0],Q=z[1],x=function(c){return ns._4O.Util._56O(c,l)},$=x(n);return Q==$}}.bind(Ej(S))};var Zm,jo;return function(){var w=Wg.length-Wl.length;if(w>0)for(var f=0;w>f;f++)Zm=jb.Util,jo=Zn}(),Ep=function(w,G){G=jo(G);var a=Ej(qq),S=ib.length,z=2*S,T=Bo(G,v(S,z)),y=a,F=!0;if(y){var d=y[lp[0]];d&&T._55O()<=d._55O()&&(F=!1)}if(F)return 0;var U=y._37O(T),l=U[Bb](v(S,z)).replace(xj,""),o=eo(l);if(0==o.length)return!1;var s=o[0],Y=o[1],M=Zm._11A(w,s);return Y==M},yi}(u,_),Bm(p,{load:function(){var J={},n=function(D){return D?"c_"+(D.sync?"1":"0")+"_"+(D.post?"1":"0")+"_"+(D.responseType||"H")+"_"+(D.mimeType||"H")+"_"+(D.data?JSON.stringify(D.data):"H"):""};return function(l,i,V){var z,F=J[l],H=n(V);return F&&(z=F[H])?(z.push(i),void 0):(J[l]||(F=J[l]={count:0}),z=F[H]=[i],F.count++,p.xhrLoad(l,function(k){delete F[H],F.count--,F.count||delete J[l],z.forEach(function(_){_(k)})},V),void 0)}}(),asyncEach:function(u,Y,o){"function"!=typeof o&&(o=Function.prototype);var v=new Array(u.length),s=0,j=!1;u.forEach(function(r,Q){Y(r,function(A,r){return j?void 0:A?(j=!0,o(null)):(v[Q]=r,s++,s===u.length?o(v):void 0)})})},xhrLoad:function(o,k,Y){var d=!1;sd(o)||(d=!0,o=[o]),Y=Y||{},o.length;var h=Y.sync,N=!!Y.post,b=Y.data||null;p.asyncEach(o,function(T,i){var q=new XMLHttpRequest;T=p.beforeLoadURL(T),T.data?i(null,T.data):(q.open(N?"POST":"GET",encodeURI(T),!h),Y.responseType?q.responseType=Y.responseType:q.overrideMimeType&&q.overrideMimeType(Y.mimeType||"text/plain"),q.onload=function(k){200===this.status||0===this.status?i(null,k.target.response||k.target.responseText):i(!0)},q.onerror=function(){i(!0)},q.send(b))},function(V){"function"==typeof k&&k(d&&V?V[0]:V)})}}),Math.sign===i&&(Math.sign=function(W){return 0>W?-1:W>0?1:+W}),R.Math={generateUUID:function(){for(var y=[],U=0;256>U;U++)y[U]=(16>U?"0":"")+U.toString(16).toUpperCase();return function(){var k=0|4294967295*Math.random(),s=0|4294967295*Math.random(),b=0|4294967295*Math.random(),N=0|4294967295*Math.random();return y[255&k]+y[255&k>>8]+y[255&k>>16]+y[255&k>>24]+"-"+y[255&s]+y[255&s>>8]+"-"+y[64|15&s>>16]+y[255&s>>24]+"-"+y[128|63&b]+y[255&b>>8]+"-"+y[255&b>>16]+y[255&b>>24]+y[255&N]+y[255&N>>8]+y[255&N>>16]+y[255&N>>24]}}()};var Jc=R.Matrix=R.Math.Matrix2d=function(j,b,y,o,t){var P=this;if(j===i)return P.a=1,P.b=0,P.c=0,P.d=1,P.tx=0,P.ty=0,void 0;j=j||0;var X=g(j),p=$(j);o=o||1,t=t||1,P.a=p*o,P.b=X*o,P.c=-X*t,P.d=p*t,P.tx=b||0,P.ty=y||0},Gm=Jc;Jc.prototype={},Jc.prototype.constructor=Jc,Jc.prototype.set=function(W,n,p,l,R,L){return this.a=W,this.b=n,this.c=p,this.d=l,this.tx=R,this.ty=L,this},Jc.prototype.apply=function(f,y){y=y||new rc;var _=f.x,Z=f.y;return y.x=this.a*_+this.c*Z+this.tx,y.y=this.b*_+this.d*Z+this.ty,y},Jc.prototype.applyInverse=function(b,R){R=R||new rc;var r=1/(this.a*this.d+this.c*-this.b),V=b.x,O=b.y;return R.x=this.d*r*V+-this.c*r*O+(this.ty*this.c-this.tx*this.d)*r,R.y=this.a*r*O+-this.b*r*V+(-this.ty*this.a+this.tx*this.b)*r,R},Jc.prototype.translate=function(H,N){return this.tx+=H,this.ty+=N,this},Jc.prototype.scale=function(T,o){return this.a*=T,this.d*=o,this.c*=T,this.b*=o,this.tx*=T,this.ty*=o,this},Jc.prototype.rotate=function(d){var O=Math.cos(d),T=Math.sin(d),v=this.a,p=this.c,D=this.tx;return this.a=v*O-this.b*T,this.b=v*T+this.b*O,this.c=p*O-this.d*T,this.d=p*T+this.d*O,this.tx=D*O-this.ty*T,this.ty=D*T+this.ty*O,this},Jc.prototype.appendTranslate=function(N,B){return this.tx+=this.a*N,this.ty+=this.d*B,this},Jc.prototype.appendScale=function(p,D){return this.a*=p,this.d*=D,this.c*=D,this.b*=p,this},Jc.prototype.appendRotate=function(x){var Z=Math.cos(x),h=Math.sin(x),J=this.a,R=this.b;return this.a=J*Z+this.c*h,this.b=R*Z+this.d*h,this.c=-J*h+this.c*Z,this.d=-R*h+this.d*Z,this},Jc.prototype.append=function(a){var G=this.a,B=this.b,Y=this.c,f=this.d;return this.a=a.a*G+a.b*Y,this.b=a.a*B+a.b*f,this.c=a.c*G+a.d*Y,this.d=a.c*B+a.d*f,this.tx=a.tx*G+a.ty*Y+this.tx,this.ty=a.tx*B+a.ty*f+this.ty,this},Jc.prototype.setTransform=function(X,B,h,$,W,L,f,K,a){var y,Y,k,g,M,e,I,q,D,_;return M=Math.sin(f),e=Math.cos(f),I=Math.cos(a),q=Math.sin(a),D=-Math.sin(K),_=Math.cos(K),y=e*W,Y=M*W,k=-M*L,g=e*L,this.a=I*y+q*k,this.b=I*Y+q*g,this.c=D*y+_*k,this.d=D*Y+_*g,this.tx=X+(h*y+$*k),this.ty=B+(h*Y+$*g),this},Jc.prototype.prepend=function(J){var T=this.tx;if(1!==J.a||0!==J.b||0!==J.c||1!==J.d){var m=this.a,n=this.c;this.a=m*J.a+this.b*J.c,this.b=m*J.b+this.b*J.d,this.c=n*J.a+this.d*J.c,this.d=n*J.b+this.d*J.d}return this.tx=T*J.a+this.ty*J.c+J.tx,this.ty=T*J.b+this.ty*J.d+J.ty,this},Jc.prototype.transform=Jc.prototype.prepend,Jc.prototype.invert=function(){var D=this.a,g=this.b,q=this.c,b=this.d,W=this.tx,i=D*b-g*q;return this.a=b/i,this.b=-g/i,this.c=-q/i,this.d=D/i,this.tx=(q*this.ty-b*W)/i,this.ty=-(D*this.ty-g*W)/i,this},Jc.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Jc.prototype.clone=function(){var f=new Jc;return f.a=this.a,f.b=this.b,f.c=this.c,f.d=this.d,f.tx=this.tx,f.ty=this.ty,f},Jc.prototype.copy=function(O){return O.a=this.a,O.b=this.b,O.c=this.c,O.d=this.d,O.tx=this.tx,O.ty=this.ty,O},Jc.prototype.tf=function(e,_){1===arguments.length&&(_=e.y,e=e.x);var t=this;return{x:t.a*e+t.c*_+t.tx,y:t.b*e+t.d*_+t.ty}},Jc.prototype.tfi=function(e,M){1===arguments.length&&(M=e.y,e=e.x);var r=this,E=1/(r.a*r.d+r.c*-r.b);return{x:r.d*E*e+-r.c*E*M+(r.ty*r.c-r.tx*r.d)*E,y:r.a*E*M+-r.b*E*e+(-r.ty*r.a+r.tx*r.b)*E}},Jc.IDENTITY=new Jc,Jc.TEMP_MATRIX=new Jc;var hd=R.Math.Vector3=function(H,J,G){"object"==typeof H?this.copy(H):this.set(H,J==i?H:J,G==i?H:G)};_.assign(hd.prototype,{set:function(X,S,L){return this.x=X,this.y=S,this.z=L,this},setScalar:function(R){return this.x=R,this.y=R,this.z=R,this},setX:function(T){return this.x=T,this},setY:function(z){return this.y=z,this},setZ:function(X){return this.z=X,this},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(U){return U.x===i?(this.x=U[0],this.y=U[1],this.z=U[2]):(this.x=U.x,this.y=U.y,this.z=U.z),this},add:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this},addScalar:function(N){return this.x+=N,this.y+=N,this.z+=N,this},addVectors:function(v,f){return this.x=v.x+f.x,this.y=v.y+f.y,this.z=v.z+f.z,this},addScaledVector:function(s,o){return this.x+=s.x*o,this.y+=s.y*o,this.z+=s.z*o,this},sub:function(d){return this.x-=d.x,this.y-=d.y,this.z-=d.z,this},subScalar:function(j){return this.x-=j,this.y-=j,this.z-=j,this},subVectors:function(u,b){return this.x=u.x-b.x,this.y=u.y-b.y,this.z=u.z-b.z,this},multiply:function(q){return this.x*=q.x,this.y*=q.y,this.z*=q.z,this},multiplyScalar:function(A){return this.x*=A,this.y*=A,this.z*=A,this},distanceTo:function(d){return Math.sqrt(this.distanceToSquared(d))},distanceToSquared:function(d){var m=this.x-d.x,r=this.y-d.y,h=this.z-d.z;return m*m+r*r+h*h},multiplyVectors:function(o,q){return this.x=o.x*q.x,this.y=o.y*q.y,this.z=o.z*q.z,this},transformDirection:function(s){var N=this.x,E=this.y,k=this.z,u=s.el;return this.x=u[0]*N+u[4]*E+u[8]*k,this.y=u[1]*N+u[5]*E+u[9]*k,this.z=u[2]*N+u[6]*E+u[10]*k,this.normalize()},applyQuaternion:function(b){var S=this.x,j=this.y,_=this.z,a=b._x,J=b._y,p=b._z,t=b._w,B=t*S+J*_-p*j,C=t*j+p*S-a*_,V=t*_+a*j-J*S,e=-a*S-J*j-p*_;return this.x=B*t+e*-a+C*-p-V*-J,this.y=C*t+e*-J+V*-a-B*-p,this.z=V*t+e*-p+B*-J-C*-a,this},applyMatrix4:function(t){var h=this.x,n=this.y,$=this.z,s=t.el,D=1/(s[3]*h+s[7]*n+s[11]*$+s[15]);return this.x=(s[0]*h+s[4]*n+s[8]*$+s[12])*D,this.y=(s[1]*h+s[5]*n+s[9]*$+s[13])*D,this.z=(s[2]*h+s[6]*n+s[10]*$+s[14])*D,this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(J){return this.x*J.x+this.y*J.y+this.z*J.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){var Z=this.length();return Z?this.multiplyScalar(1/Z):this},setLength:function(X){return this.normalize().multiplyScalar(X)},fromArray:function(x,$){return $===i&&($=0),this.x=x[$],this.y=x[$+1],this.z=x[$+2],this},cross:function(n){return this.crossVectors(this,n)},crossVectors:function(x,f){var w=x.x,b=x.y,X=x.z,g=f.x,M=f.y,h=f.z;return this.x=b*h-X*M,this.y=X*g-w*h,this.z=w*M-b*g,this}});var rc=R.Math.Vector2=function(n,E,$){"object"==typeof n&&(n.x!=i?(E=n.y,n=n.x,$=n.e):($=n[2],E=n[1],n=n[0])),this.set(n||0,E||0,$)};rc.prototype={},rc.prototype.constructor=rc,_.defineProperties(rc.prototype,{width:{get:function(){return this.x},set:function(_){this.x=_}},height:{get:function(){return this.y},set:function(L){this.y=L}}}),rc.prototype.clone=function(){return new rc(this.x,this.y,this.e)},rc.prototype.copy=function(y){return this.set(y.x,y.y,y.e),this},rc.prototype.equals=function(R){return R.x===this.x&&R.y===this.y},rc.prototype.set=function(W,O,Y){return this.x=W||0,this.y=O||(0!==O?this.x:0),Y!=i&&(this.e=Y),this},rc.prototype.setScalar=function(o){return this.x=o,this.y=o,this},rc.prototype.setX=function(F){return this.x=F||0,this},rc.prototype.setY=function(L){return this.y=L||0,this},rc.prototype.add=function(E){return this.x+=E.x,this.y+=E.y,this},rc.prototype.addVectors=function(o,_){return this.x=o.x+_.x,this.y=o.y+_.y,this},rc.prototype.addScalar=function(N){return this.x+=N,this.y+=N,this},rc.prototype.addScaledVector=function(C,M){return this.x+=C.x*M,this.y+=C.y*M,this},rc.prototype.sub=function(S){return this.x-=S.x,this.y-=S.y,this},rc.prototype.subScalar=function(S){return this.x-=S,this.y-=S,this},rc.prototype.subVectors=function(A,I){return this.x=A.x-I.x,this.y=A.y-I.y,this},rc.prototype.multiply=function(I){return this.x*=I.x,this.y*=I.y,this},rc.prototype.multiplyScalar=function(G){return this.x*=G,this.y*=G,this},rc.prototype.divide=function($){return this.x/=$.x,this.y/=$.y,this},rc.prototype.divideScalar=function(z){return this.multiplyScalar(1/z)},rc.prototype.min=function(Q){return this.x=Math.min(this.x,Q.x),this.y=Math.min(this.y,Q.y),this},rc.prototype.max=function(c){return this.x=Math.max(this.x,c.x),this.y=Math.max(this.y,c.y),this},rc.prototype.clamp=function(c,Q){return this.x=Math.max(c.x,Math.min(Q.x,this.x)),this.y=Math.max(c.y,Math.min(Q.y,this.y)),this},rc.prototype.clampScalar=function(){var d,D;return function(S,e){return d===i&&(d=new rc,D=new rc),d.set(S,S),D.set(e,e),this.clamp(d,D)}}(),rc.prototype.clampLength=function(f,y){var z=this.length();return this.multiplyScalar(Math.max(f,Math.min(y,z))/z)},rc.prototype.dot=function(z){return this.x*z.x+this.y*z.y},rc.prototype.lengthSq=function(){return this.x*this.x+this.y*this.y},rc.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},rc.prototype.normalize=function(){return this.divideScalar(this.length())},rc.prototype.angle=function(){var o=Math.atan2(this.y,this.x);return 0>o&&(o+=2*Math.PI),o},rc.prototype.distanceTo=function(L){return Math.sqrt(this.distanceToSquared(L))},rc.prototype.distanceToSquared=function(d){var X=this.x-d.x,Y=this.y-d.y;return X*X+Y*Y},rc.prototype.isNearEnough=function(W){return this.distanceToSquared(W)<1e-8},rc.prototype.setLength=function(W){var u=this.length();return u?this.multiplyScalar(W/u):this},rc.prototype.lerp=function(n,S){return this.x+=(n.x-this.x)*S,this.y+=(n.y-this.y)*S,this},rc.prototype.lerpVectors=function(p,t,Q){return this.subVectors(t,p).multiplyScalar(Q).add(p)},rc.prototype.rotateAround=function(x,i){var G=Math.cos(i),M=Math.sin(i),o=this.x-x.x,O=this.y-x.y;return this.x=o*G-O*M+x.x,this.y=o*M+O*G+x.y,this};var oe=R.Math.Ray=function(T,d){this.origin=T!==i?T.clone():new hd,this.direction=d!==i?d.clone():new hd};_.assign(oe.prototype,{set:function(U,O){return this.origin.copy(U),this.direction.copy(O),this},clone:function(){return(new this.constructor).copy(this)},copy:function(Z){return this.origin.copy(Z.origin),this.direction.copy(Z.direction),this},at:function(s,L){var Q=L||new hd;return Q.copy(this.direction).multiplyScalar(s).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},applyMatrix4:function(c){return this.origin.applyMatrix4(c),this.direction.transformDirection(c),this},intersectTriangle:function(){var g=new hd,m=new hd,d=new hd,o=new hd;return function($,i,D,u,e){m.subVectors(i,$),d.subVectors(D,$),o.crossVectors(m,d);var x,O=this.direction.dot(o);if(O>0){if(u)return null;x=1}else{if(!(0>O))return null;x=-1,O=-O}g.subVectors(this.origin,$);var L=x*this.direction.dot(d.crossVectors(g,d));if(0>L)return null;var z=x*this.direction.dot(m.cross(g));if(0>z||L+z>O)return null;var K=-x*g.dot(o);return 0>K?null:this.at(K/O,e)}}()});var Oh=R.Math.Matrix4=function(){this.el=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]};_.assign(Oh.prototype,{set:function(T,D,A,l,o,q,z,u,t,Y,N,L,R,_,S,M){var w=this.el;return w[0]=T,w[4]=D,w[8]=A,w[12]=l,w[1]=o,w[5]=q,w[9]=z,w[13]=u,w[2]=t,w[6]=Y,w[10]=N,w[14]=L,w[3]=R,w[7]=_,w[11]=S,w[15]=M,this},clone:function(){return(new Oh).fromArray(this.el)},fromArray:function(h,g){g===i&&(g=0);for(var $=this.el,S=0;16>S;S++)$[S]=h[S+g];return this},makeRotationFromQuaternion:function(X){var d=this.el,f=X._x,v=X._y,R=X._z,T=X._w,c=f+f,j=v+v,I=R+R,_=f*c,M=f*j,H=f*I,g=v*j,w=v*I,G=R*I,W=T*c,E=T*j,Q=T*I;return d[0]=1-(g+G),d[4]=M-Q,d[8]=H+E,d[1]=M+Q,d[5]=1-(_+G),d[9]=w-W,d[2]=H-E,d[6]=w+W,d[10]=1-(_+g),d[3]=0,d[7]=0,d[11]=0,d[12]=0,d[13]=0,d[14]=0,d[15]=1,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},getInverse:function(O){var y=this.el,U=O.el,e=U[0],q=U[1],l=U[2],D=U[3],Q=U[4],b=U[5],J=U[6],i=U[7],W=U[8],j=U[9],z=U[10],G=U[11],I=U[12],V=U[13],r=U[14],$=U[15],m=j*r*i-V*z*i+V*J*G-b*r*G-j*J*$+b*z*$,N=I*z*i-W*r*i-I*J*G+Q*r*G+W*J*$-Q*z*$,E=W*V*i-I*j*i+I*b*G-Q*V*G-W*b*$+Q*j*$,g=I*j*J-W*V*J-I*b*z+Q*V*z+W*b*r-Q*j*r,L=e*m+q*N+l*E+D*g;if(0===L)return this.identity();var M=1/L;return y[0]=m*M,y[1]=(V*z*D-j*r*D-V*l*G+q*r*G+j*l*$-q*z*$)*M,y[2]=(b*r*D-V*J*D+V*l*i-q*r*i-b*l*$+q*J*$)*M,y[3]=(j*J*D-b*z*D-j*l*i+q*z*i+b*l*G-q*J*G)*M,y[4]=N*M,y[5]=(W*r*D-I*z*D+I*l*G-e*r*G-W*l*$+e*z*$)*M,y[6]=(I*J*D-Q*r*D-I*l*i+e*r*i+Q*l*$-e*J*$)*M,y[7]=(Q*z*D-W*J*D+W*l*i-e*z*i-Q*l*G+e*J*G)*M,y[8]=E*M,y[9]=(I*j*D-W*V*D-I*q*G+e*V*G+W*q*$-e*j*$)*M,y[10]=(Q*V*D-I*b*D+I*q*i-e*V*i-Q*q*$+e*b*$)*M,y[11]=(W*b*D-Q*j*D-W*q*i+e*j*i+Q*q*G-e*b*G)*M,y[12]=g*M,y[13]=(W*V*l-I*j*l+I*q*z-e*V*z-W*q*r+e*j*r)*M,y[14]=(I*b*l-Q*V*l-I*q*J+e*V*J+Q*q*r-e*b*r)*M,y[15]=(Q*j*l-W*b*l+W*q*J-e*j*J-Q*q*z+e*b*z)*M,this}});var sf=R.Math.Quaternion=function(l,g,o,$){this.set(l,g,o,$)};_.assign(sf.prototype,{set:function(j,s,e,N){var h=this;return h._x=j||0,h._y=s||0,h._z=e||0,h._w=N!==i?N:1,h},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(V){var v=this;return v._x=V._x,v._y=V._y,v._z=V._z,v._w=V._w,v},fromArray:function(c,A){A===i&&(A=0);var T=this;return T._x=c[A],T._y=c[A+1],T._z=c[A+2],T._w=c[A+3],this}});var xg=R.List=function(){this._as=[];var K,M,$=arguments.length;if(1===$){var d=arguments[0];if(yr(d)&&(d=d._as),sd(d))for(M=d.length,K=0;M>K;K++)this._as.push(d[K]);else d!=Q&&this._as.push(d)}else if($>1)for(K=0;$>K;K++)this._as.push(arguments[K])};Ak("List",_,{forEach:function(w,x){this.each(w,x)},push:function(){for(var C=0;C<arguments.length;C++)this.add(arguments[C])},pop:function(){return this._as.pop()},shift:function(){return this._as.shift()},unshift:function(){return this._as.unshift.apply(this._as,arguments)},size:function(){return this._as.length},isEmpty:function(){return 0===this._as.length},add:function(Z,T){return T===i?this._as.push(Z):this._as.splice(T,0,Z)},addAll:function(_){yr(_)&&(_=_._as),sd(_)?Bd(this._as,_):this._as.push(_)},get:function(U){return this._as[U]},slice:function(t,H){return new xg(this._as.slice(t,H))},remove:function(s){var Y=this._as.indexOf(s);return Y>=0&&Y<this._as.length&&this.removeAt(Y),Y},removeAt:function(H){return this._as.splice(H,1)[0]},set:function(o,t){return this._as[o]=t},clear:function(){return this._as.splice(0,this._as.length)},contains:function(z){return this._as.indexOf(z)>=0},indexOf:function(a){return this._as.indexOf(a)},each:function(I,y){for(var U=0,D=this._as.length;D>U;U++){var g=this._as[U];y?I.call(y,g,U,this):I(g,U,this)}},reverseEach:function(l,h){for(var f=this._as.length-1;f>=0;f--){var _=this._as[f];h?l.call(h,_):l(_)}},toArray:function(K,C){if(K){for(var B,c=[],x=0,d=this._as.length;d>x;x++)B=this._as[x],C?K.call(C,B)&&c.push(B):K(B)&&c.push(B);return c}return this._as.concat()},toList:function(P,A){if(P){for(var S,I=new xg,N=0,D=this._as.length;D>N;N++)S=this._as[N],A?P.call(A,S)&&I.add(S):P(S)&&I.add(S);return I}return new xg(this)},reverse:function(){this._as.reverse()},sort:function(h){return this._as.sort(h?h:br),this},toString:function(){return this._as.toString()}}),_.defineProperties(xg.prototype,{length:{get:function(){return this._as.length},set:function(L){this._as.length=L}}});var os=new xg;Bm(os,{size:function(){return 0},indexOf:function(){return-1},contains:function(){return!1},isEmpty:function(){return!0},sort:Ur,each:Ur,reverseEach:Ur,toArray:function(){return[]},toList:function(){return new xg},add:_d,addAll:_d,set:_d,remove:_d,removeAt:_d,clear:_d});var kc=R.Notifier=function(){this._f=0};Ak("Notifier",_,{contains:function(P,H){if(this._ls)for(var M,f=0,B=this._ls.size();B>f;f++)if(M=this._ls.get(f),P===M.l&&H===M.s)return!0;return!1},add:function(d,f,k){var M=this,j={l:d,s:f,a:k};M._ls||(M._ls=new xg),M._f?(M._as||(M._as=new xg),M._as.add(j)):j.a?M._ls.add(j,0):M._ls.add(j)},remove:function(d,o){var R=this;R._ls&&(R._f?(R._rs||(R._rs=new xg),R._rs.add({l:d,s:o})):R._remove(d,o))},_remove:function(Z,R){for(var v,T=this._ls,Y=0,X=T.size();X>Y;Y++)if(v=T.get(Y),v.l===Z&&v.s===R)return T.removeAt(Y),void 0},fire:function(E){var v=this,b=v._ls;if(v._b=1e4,b){++v._f;try{for(var y,k=0,O=b.size();O>k;k++)y=b.get(k),y.s?y.l.call(y.s,E):y.l(E)}finally{if(--v._f)return;if(v._rs){for(O=v._rs.size(),k=0;O>k;k++)y=v._rs.get(k),v._remove(y.l,y.s);delete v._rs}if(v._as){for(O=v._as.size(),k=0;O>k;k++)y=v._as.get(k),y.a?b.add(y,0):b.add(y);delete v._as}}}}});var Sc=R.Data=function(){this._id=um()};Ak("Data",_,{ms_ac:["tag","name","displayName","icon","toolTip","attrObject","layer","adjustChildrenToTop","dataBindings"],ms_dm:1,ms_attr:1,_icon:Q,_parent:Q,_children:os,_childMap:Q,_styleMap:Q,_layer:"0",_adjustChildrenToTop:!1,getUIClass:function(){return Q},_22Q:function(){return Q},s:function(J,B){var z=this;if(2===arguments.length)z.setStyle(J,B);else{if(!no(J))return z.getStyle(J);for(var X in J)z.setStyle(X,J[X])}return z},fp:function(z,G,N,I,q){return this.firePropertyChange(z,G,N,I,q)},firePropertyChange:function(j,G,H,F,D){if(F){if(F(G,H))return!1}else if(G===H)return!1;var K=this,S=D||{};return S.property=j,S.oldValue=G,S.newValue=H,S.data=K,K._dataModel&&K._dataModel.handleDataPropertyChange(S),K.onPropertyChanged(S),!0},onPropertyChanged:function(x){var D=this,z=D._parent,o=x.property;if(og(z)){var d=D.s(Ab),j="s:ingroup"===o;(d&&Wd[o]||o===j)&&z._81I(),(d||j)&&z.fp("childChange",!0,!1)}He(z)&&Wd[o]&&z.updateFromChildren()},_21I:function(C){var f=this;if(C&&f._dataModel)throw"Remove data from dataModel before adding";f._dataModel=C},removeFromDataModel:function(){this._dataModel?this._dataModel.remove(this):this.setParent(null)},clearChildrenFromDataModel:function(){for(var v=0,H=this._children.toArray(),I=H.length;I>v;v++)H[v].removeFromDataModel()},getId:function(){return this._id},setId:function(f){this._id=f},getChildren:function(){return this._children},size:function(){return this._children.size()},toChildren:function(q,l){return this._children.toList(q,l)},eachChild:function(X,t){this._children.each(X,t)},addChild:function(m,h){var S=this;m!==S&&(S._children===os&&(S._children=new xg,S._childMap={}),h>=0||(h=S._children.size()),S._childMap[m._id]||S.isDescendantOf(m)||(m._parent&&m._parent.removeChild(m),(0>h||h>S._children.size())&&(h=S._children.size()),S._children.add(m,h),S._childMap[m._id]=m,m.setParent(S),S.onChildAdded(m,h),S.fp(Jm,Q,m)))
},onChildAdded:function(){},removeChild:function(j){var V=this;if(V._childMap&&V._childMap[j._id]){var _=V._children.remove(j);delete V._childMap[j._id],V.fp(Jm,j,Q),j.setParent(Q,_),V.onChildRemoved(j,_)}},onChildRemoved:function(){},getChildAt:function(K){return this._children.get(K)},clearChildren:function(){var R=this;if(!R._children.isEmpty())for(var o=0,L=R._children.toArray(),b=L.length;b>o;o++)R.removeChild(L[o])},getParent:function(){return this._parent},setParent:function(p,B){var r=this;if(!(r._73I||r._parent===p||r===p||p&&p.isDescendantOf(r))){var m,w=r._parent;r._parent=p,r._73I=1,w?(B==Q&&(B=w.getChildren().indexOf(r)),w.removeChild(r)):r._dataModel&&B==Q&&(B=r._dataModel.getRoots().indexOf(r)),p&&(p.addChild(r),m=p.getChildren().indexOf(r)),delete r._73I,r.fp("parent",w,p,i,{oldIndex:B,newIndex:m}),r.onParentChanged(w,p)}},onParentChanged:function(){},hasChildren:function(){return this._children.size()>0},isEmpty:function(){return this._children.isEmpty()},isRelatedTo:function(u){return u?this.isDescendantOf(u)||u.isDescendantOf(this):!1},isParentOf:function(l){return l&&this._childMap?!!this._childMap[l._id]:!1},isDescendantOf:function(O){if(!O||O.isEmpty())return!1;for(var C=this._parent;C;){if(O===C)return!0;C=C._parent}return!1},getStyleMap:function(){return this._styleMap},getStyle:function(t,H){H===i&&(H=1);var L=this._styleMap?this._styleMap[t]:i;return L===i&&H?e[t]:L},setStyle:function(m,x){var p=this;p._styleMap||(p._styleMap={});var c=p._styleMap[m];x===i?delete p._styleMap[m]:p._styleMap[m]=x,p.fp("s:"+m,c,x)&&p.onStyleChanged(m,c,x)},onStyleChanged:function(){},iv:function(a){this.invalidate(a)},invalidate:function(F){this.fp(F||"*",!1,!0)},toString:function(){var V=this;return V._displayName||V._name||V._tag||V._id},toLabel:function(){return this._displayName||this._name},addStyleIcon:function(w,d){var x=this,$=x.s(md);$||x.s(md,$={}),d?$[w]=d:delete $[w],x.fp(md,Q,$)},removeStyleIcon:function(p){var S=this.s(md);if(S){var H=S[p];delete S[p],this.fp(md,Q,S)}return H},getSerializableProperties:function(){return{name:1,displayName:1,icon:1,toolTip:1,parent:1,layer:1,tag:1,adjustChildrenToTop:1,dataBindings:1}},getSerializableStyles:function(){var J,Z={};for(J in this._styleMap)Z[J]=1;return Z}});var Se=R.DataModel=function(){var t=this;t._datas=new xg,t._dataMap={},t._roots=new xg,t._rootMap={},t._78O={},t._36I=new kc,t._35I=new kc,t._selectionModel=new Pi(t);var O=t._29Q=[],G=t._scheduleCallback=function(){for(var j=Date.now(),Z=0;Z<O.length;Z++){var V=O[Z];V.enabled&&j-V.lastTime>V.interval&&(V.beforeAction&&V.beforeAction(),t.each(function(C){V.action(C)}),V.afterAction&&V.afterAction(),V.lastTime=j)}O.length&&(t._30Q=u.requestAnimationFrame(G))}};Ak("DataModel",_,{ms_fire:1,ms_attr:1,ms_ac:["layers","name","autoAdjustIndex","hierarchicalRendering","background","init"],_name:i,_autoAdjustIndex:!0,_hierarchicalRendering:!1,_background:i,_init:i,sm:function(){return this.getSelectionModel()},mm:function(l,h,e){this.addDataModelChangeListener(l,h,e)},umm:function(T,Y){this.removeDataModelChangeListener(T,Y)},md:function(f,e,O){this.addDataPropertyChangeListener(f,e,O)},umd:function(A,W){this.removeDataPropertyChangeListener(A,W)},mh:function(w,N,X){this.addHierarchyChangeListener(w,N,X)},umh:function(u,f){this.removeHierarchyChangeListener(u,f)},getAttrObject:function(){return this._attrObject},setAttrObject:function(L){return this._attrObject=L},getSelectionModel:function(){return this._selectionModel},size:function(){return this._datas.size()},isEmpty:function(){return this._datas.isEmpty()},getRoots:function(){return this._roots},getDatas:function(){return this._datas},getDataById:function(a){return this._dataMap[a]},removeDataById:function(f){this.remove(this.getDataById(f))},toDatas:function(K,k){return this._datas.toList(K,k)},each:function(L,g){this._datas.each(L,g)},getDataByTag:function(s){return this._78O[s]},getTagMap:function(){return this._78O},removeDataByTag:function(j){this.remove(this.getDataByTag(j))},add:function(F,L,I){var Y=this,k=F._id,T=F._tag,C=Y._roots;if(Y._dataMap[k])throw"'"+k+"' already exists";T!=Q&&(Y._78O[T]=F),Y._dataMap[k]=F,I>=0?Y._datas.add(F,I):Y._datas.add(F),F._parent||(Y._rootMap[k]=F,L>=0?C.add(F,L):C.add(F)),F._21I(Y),Y.onAdded(F),Y._36I.fire({kind:"add",data:F,rootsIndex:L,datasIndex:I})},onAdded:function(){},remove:function(C,t){if(C){var q=this,J=C._id,d=t&&t.keepStructure,E=t&&t.keepChildren,V=C.getTag();if(C._dataModel===q){this.beginTransaction(),d?q._removingData||(q._removingData=C):q.prepareRemove(C),E||C.toChildren().each(function(W){q.remove(W,t)},q),d?q._removingData===C&&(C._parent&&C._parent.removeChild(C),delete q._removingData):C._parent&&C._parent.removeChild(C);var O=q._datas.remove(C);delete q._dataMap[J],V!=Q&&delete q._78O[V];var M;q._rootMap[J]&&(delete q._rootMap[J],M=q._roots.remove(C)),C._21I(Q),q.onRemoved(C),q._36I.fire({kind:Qn,data:C,rootsIndex:M,datasIndex:O}),this.endTransaction()}}},onRemoved:function(){},prepareRemove:function(){},clear:function(){var U=this;if(U._datas.size()){var C=U._historyManager?this.toJSON():i;U._datas.toArray().forEach(function(U){U._21I(Q)}),U._datas.clear(),U._dataMap={},U._roots.clear(),U._rootMap={},U._78O={},U._36I.fire({kind:Kg,json:C})}},contains:function(C){return C&&C._dataModel===this},handleDataPropertyChange:function(e){var z=this,$=e.data,g=e.property;if("parent"===g){var J=$._id,d=z._rootMap,T=z._roots;$._parent?d[J]&&(delete d[J],T.remove($)):d[J]||(d[J]=$,T.add($))}else if("tag"===g){var t=e.oldValue,r=e.newValue,L=z._78O;t!=Q&&delete L[t],r!=Q&&(L[r]=$)}this.onDataPropertyChanged($,e),this._35I.fire(e)},onDataPropertyChanged:function(){},addDataModelChangeListener:function(y,o,t){this._36I.add(y,o,t)},removeDataModelChangeListener:function(q,W){this._36I.remove(q,W)},addDataPropertyChangeListener:function(j,o,I){this._35I.add(j,o,I)},removeDataPropertyChangeListener:function(J,I){this._35I.remove(J,I)},_38I:function(l,t,q){this._37I&&this._37I.fire({data:l,oldIndex:t,newIndex:q})},addHierarchyChangeListener:function(A,N,Z){this._37I||(this._37I=new kc),this._37I.add(A,N,Z)},removeHierarchyChangeListener:function($,N){this._37I.remove($,N)},getSiblings:function(K){var v=K._parent;return v?v._children:this._roots},eachByHierarchical:function(k,Q,E){if(Q)return this._eachByHierarchical(k,Q,E);for(var J=0,K=this._roots,Y=K.size();Y>J;J++)if(this._eachByHierarchical(k,K.get(J),E)===!1)return!1;return!0},_eachByHierarchical:function(r,C,h){if(h){if(r.call(h,C)===!1)return!1}else if(r(C)===!1)return!1;for(var Z=C.size(),O=0;Z>O;O++)if(this._eachByHierarchical(r,C.getChildAt(O),h)===!1)return!1;return!0},reverseEachByHierarchical:function(R,V,Y){if(V)return this._reverseEachByHierarchical(R,V,Y);for(var b=this._roots,i=b.size(),L=i-1;L>=0;L--)if(this._reverseEachByHierarchical(R,b.get(L),Y)===!1)return!1;return!0},_reverseEachByHierarchical:function(S,n,h){for(var F=n.size(),X=F-1;X>=0;X--)if(this._reverseEachByHierarchical(S,n.getChildAt(X),h)===!1)return!1;if(h){if(S.call(h,n)===!1)return!1}else if(S(n)===!1)return!1;return!0},eachByDepthFirst:function(w,Z,A){if(Z)return this._11I(w,Z,A);for(var E=0,j=this._roots,v=j.size();v>E;E++)if(this._11I(w,j.get(E),A)===!1)return!1;return!0},_11I:function(f,p,A){for(var h=p.size(),O=0;h>O;O++)if(this._11I(f,p.getChildAt(O),A)===!1)return!1;if(A){if(f.call(A,p)===!1)return!1}else if(f(p)===!1)return!1;return!0},eachByBreadthFirst:function(n,d,C){var o=new xg;for(d?o.add(d):this._roots.each(o.add,o);o.size()>0;)if(d=o.removeAt(0),d.eachChild(o.add,o),C){if(n.call(C,d)===!1)return!1}else if(n(d)===!1)return!1;return!0},moveTo:function(Q,v){var b=this.getSiblings(Q),s=b.indexOf(Q);s===v||0>s||v>=0&&v<=b.size()&&(b.remove(Q),v>b.size()&&v--,b.add(Q,v),this._38I(Q,s,v))},moveUp:function(Q){this.moveTo(Q,this.getSiblings(Q).indexOf(Q)-1)},moveDown:function($){this.moveTo($,this.getSiblings($).indexOf($)+1)},moveToTop:function(j){this.moveTo(j,0)},moveToBottom:function(e){this.moveTo(e,this.getSiblings(e).size())},moveSelectionUp:function(r){this.beginTransaction(),r||(r=this.sm());var O=new xg;zn(r,O,this._roots),O.each(this.moveUp,this),this.endTransaction()},moveSelectionDown:function(J){this.beginTransaction(),J||(J=this.sm());var w=new xg;he(J,w,this._roots),w.each(this.moveDown,this),this.endTransaction()},moveSelectionToTop:function(D){this.beginTransaction(),D||(D=this.sm());var j=new xg;Zi(D,j,this._roots),j.each(this.moveToTop,this),this.endTransaction()},moveSelectionToBottom:function(u){this.beginTransaction(),u||(u=this.sm());var f=new xg;Sd(u,f,this._roots),f.each(this.moveToBottom,this),this.endTransaction()},moveToIndex:function(C,B,z){var d=this.getDatas();null==z&&(z=d.indexOf(C)),z===B||0>z||B>=0&&B<=d.size()&&(d.remove(C),B>d.size()&&B--,d.add(C,B),this._76I(C,z,B))},bringForward:function(N){this.moveToIndex(N,this.getDatas().indexOf(N)+1)},bringToFront:function(c){this.moveToIndex(c,this.size())},sendBackward:function(e){this.moveToIndex(e,this.getDatas().indexOf(e)-1)},sendToBack:function(Y){this.moveToIndex(Y,0)},bringSelectionForward:function(v){this.beginTransaction(),v||(v=this.sm());for(var Y=new xg,z=this.getDatas(),t=!1,o=0;o<z.size();o++){var V=z.get(z.size()-1-o);v.contains(V)?t&&Y.add(V):t=!0}Y.each(this.bringForward,this),this.endTransaction()},bringSelectionToFront:function(n){this.beginTransaction(),n||(n=this.sm());for(var l=new xg,Q=this.getDatas(),Y=0;Y<Q.size();Y++){var E=Q.get(Y);n.contains(E)&&l.add(E)}l.each(this.bringToFront,this),this.endTransaction()},sendSelectionBackward:function(P){this.beginTransaction(),P||(P=this.sm());for(var K=new xg,W=this.getDatas(),f=!1,Z=0;Z<W.size();Z++){var T=W.get(Z);P.contains(T)?f&&K.add(T):f=!0}K.each(this.sendBackward,this),this.endTransaction()},sendSelectionToBack:function(c){this.beginTransaction(),c||(c=this.sm());for(var x=new xg,n=this.getDatas(),w=0;w<n.size();w++){var Z=n.get(n.size()-1-w);c.contains(Z)&&x.add(Z)}x.each(this.sendToBack,this),this.endTransaction()},addScheduleTask:function(h){var c=this;c.removeScheduleTask(h),h.enabled==Q&&(h.enabled=!0),h.interval==Q&&(h.interval=10),h.action==Q&&(h.action=Ur),h.lastTime=Date.now(),c._29Q.push(h),c._30Q==Q&&(c._30Q=u.requestAnimationFrame(c._scheduleCallback))},removeScheduleTask:function(g){var Y=this,A=Y._29Q,x=A.indexOf(g);x>=0&&A.splice(x,1),A.length||Y._30Q==Q||(u.cancelAnimationFrame(Y._30Q),delete Y._30Q)},getHistoryManager:function(){return this._historyManager},enableHistoryManager:function(V){this._historyManager||new R.HistoryManager(this),null!=V&&this._historyManager.setMaxHistoryCount(V),this._historyManager.setDisabled(!1)},disableHistoryManager:function(){this._historyManager&&this._historyManager.setDisabled(!0)},clearHistoryManager:function(){this._historyManager&&this._historyManager.clear()},undo:function($){this._historyManager&&this._historyManager.undo($)},redo:function(k){this._historyManager&&this._historyManager.redo(k)},beginTransaction:function(){this._historyManager&&this._historyManager.beginTransaction()},endTransaction:function(){this._historyManager&&this._historyManager.endTransaction()},addHistory:function(A){this._historyManager&&this._historyManager.addHistory(A)},onHistoryManagerChanged:function(){}});var Pi=R.SelectionModel=function(u){var d=this;d._68O=Jp,d._map={},d._73O=new xg,d._74I=new kc,d._21I(u)};Ak("SelectionModel",_,{ms_fire:1,ms_dm:1,ms:function(x,r,b){this.addSelectionChangeListener(x,r,b)},ums:function(S,M){this.removeSelectionChangeListener(S,M)},fd:function(){return this.getFirstData()},ld:function(){return this.getLastData()},sg:function(){return this._68O===pb},co:function(V){return this._map[V._id]!=Q},ss:function(W){this.setSelection(W)},as:function(q){this.appendSelection(q)},rs:function(O){this.removeSelection(O)},cs:function(){this.clearSelection()},sa:function(){this.selectAll()},getSelectionMode:function(){return this._68O},setSelectionMode:function(O){var M=this;if(M._68O!==O&&(O===lp||O===pb||O===Jp)){M.cs();var $=M._68O;M._68O=O,M.fp("selectionMode",$,O)}},_21I:function(j){var H=this,C=H._dataModel;C!==j&&(C&&(H.cs(),C.umm(H.handleDataModelChange,H)),H._dataModel=j,j.mm(H.handleDataModelChange,H,!0),H.fp(ag,C,j))},dispose:function(){var g=this;g.cs(),g._dataModel.umm(g.handleDataModelChange,g)},handleDataModelChange:function(Z){var H=this;if(Z.kind===Qn){var n=Z.data;H.co(n)&&(H._73O.remove(n),delete H._map[n._id],H._75I(Qn,new xg(n)))}else Z.kind===Kg&&H.cs()},getFilterFunc:function(){return this._filterFunc},setFilterFunc:function(M){var t=this;if(t._filterFunc!==M){t.cs();var B=t._filterFunc;t._filterFunc=M,t.fp("filterFunc",B,t._filterFunc)}},_75I:function(f,Q,v,p){v&&(this._73O.each(function(w){p[w._id]?v.remove(w):v.add(w)}),Q=v.toList()),this._74I.fire({kind:f,datas:new xg(Q)})},addSelectionChangeListener:function(d,h,Q){this._74I.add(d,h,Q)},removeSelectionChangeListener:function(U,D){this._74I.remove(U,D)},_97O:function(f,R){for(var W,_=this,X=0,Y=new xg(f);X<Y.size();X++)W=Y.get(X),(_._filterFunc&&!_._filterFunc(W)||R&&_.co(W)||!R&&!_.co(W)||!_._dataModel.contains(W))&&(Y.removeAt(X),X--);return Y},appendSelection:function(d){var M=this;if(M._68O!==lp){var V,h,k=M._73O,g=M._97O(d,!0);g.isEmpty()||(M.sg()&&(V=new xg(k),h=M._map,k.clear(),M._map={},g=new xg(g.get(g.size()-1))),g.each(function(F){k.add(F),M._map[F._id]=F}),M._75I("append",g,V,h))}},removeSelection:function(h){var j=this,B=j._97O(h),J=0,Q=B.size();if(0!==Q){for(;Q>J;J++){var F=B.get(J);j._73O.remove(F),delete j._map[F._id]}j._75I(Qn,B)}},toSelection:function(E,B){return this._73O.toList(E,B)},getSelection:function(){return this._73O},each:function(e,Q){this._73O.each(e,Q)},setSelection:function(I){var C=this,z=C._73O;if(C._68O!==lp&&!(z.isEmpty()&&!I||1===z.size()&&C.ld()===I)){var n=new xg(z),g=C._map;z.clear(),C._map={};var F=C._97O(I,!0);C.sg()&&F.size()>1&&(F=new xg(F.get(F.size()-1))),F.each(function(P){z.add(P),C._map[P._id]=P}),C._75I("set",Q,n,g)}},clearSelection:function(){var L=this,s=L._73O;if(s.size()>0){var k=s.toList();s.clear(),L._map={},L._75I(Kg,k)}},selectAll:function(){var J=this;if(J._68O!==lp){var t,E,N=J._dataModel.toDatas();if(J._filterFunc)for(t=0;t<N.size();t++)E=N.get(t),J._filterFunc(E)||(N.removeAt(t),t--);var R=J._73O,O=new xg(R),Z=J._map;R.clear(),J._map={},J.sg()&&N.size()>1&&(N=new xg(N.get(N.size()-1)));var T=N.size();for(t=0;T>t;t++)E=N.get(t),R.add(E),J._map[E._id]=E;J._75I("all",Q,O,Z)}},size:function(){return this._73O.size()},isEmpty:function(){return this._73O.isEmpty()},contains:function(J){return this._map[J._id]!=Q},getLastData:function(){var P=this._73O;return P.size()>0?P.get(P.size()-1):Q},getFirstData:function(){var g=this._73O;return g.size()>0?g.get(0):Q},isSelectable:function(T){var k=this;return T&&k._68O!==lp?k._filterFunc?k._filterFunc(T):!0:!1},getTopSelection:function(){var W=this,K=new xg;return W._73O.each(function(T){for(var G=T.getParent();G;){if(W.contains(G)){T=Q;break}G=G.parent}T&&K.add(T)}),K}});var $j=function(){return gc(0),function(r,J){var y;if(Vg(J)){var C=r.getDataUI(J);C&&C._88I&&(y=C._88I.rect)}return y?y:J.getRect()}}();Bm(p,{edgeGroupAgentFunc:Q,graphViewAutoScrollZone:16,graphViewResettable:!1,graphViewPannable:!0,graphViewRectSelectable:!0,graphViewScrollBarVisible:!0,graphViewRectSelectBorderColor:o.rectSelectBorder,graphViewRectSelectBackground:Sk,graphViewEditPointSize:sg?17:7,graphViewEditPointBorderColor:o.editPointBorder,graphViewEditPointBackground:o.editPointBackground,setEdgeType:function(r,y,q){is[r]=y,Rl[r]=q},getEdgeType:function(q){return is[q]},getEdgeTypeMap:function(){return is},getNodeRect:$j},!0),Bm(e,{"2d.selectable":!0,"2d.visible":!0,"2d.movable":!0,"2d.editable":!0,"2d.move.mode":i,interactive:!1,"image.stretch":"fill",icons:i,ingroup:!0,"body.color":i,opacity:i,pixelPerfect:!0,"clip.direction":"top","clip.percentage":1,"select.color":hk,"select.width":1,"select.padding":2,"select.type":qo,shadow:!1,"shadow.blur":6,"shadow.offset.x":3,"shadow.offset.y":3,"border.color":i,"border.width":2,"border.padding":2,"border.type":qo,label:i,"label.font":i,"label.color":ln,"label.background":i,"label.position":31,"label.position.fixed":!1,"label.offset.x":0,"label.offset.y":2,"label.rotation":i,"label.max":i,"label.opacity":i,"label.scale":1,"label.align":i,"label.selectable":!0,label2:i,"label2.font":i,"label2.color":ln,"label2.background":i,"label2.position":34,"label2.position.fixed":!1,"label2.offset.x":0,"label2.offset.y":-2,"label2.rotation":i,"label2.max":i,"label2.opacity":i,"label2.scale":1,"label2.align":i,"label2.selectable":!0,note:i,"note.expanded":!0,"note.font":i,"note.color":sk,"note.background":hk,"note.position":8,"note.offset.x":-3,"note.offset.y":3,"note.max":i,"note.toggleable":!0,"note.border.width":1,"note.border.color":i,"note.opacity":i,"note.scale":1,"note.align":i,note2:i,"note2.expanded":!0,"note2.font":i,"note2.color":sk,"note2.background":hk,"note2.position":3,"note2.offset.x":3,"note2.offset.y":-3,"note2.max":i,"note2.toggleable":!0,"note2.border.width":1,"note2.border.color":i,"note2.opacity":i,"note2.scale":1,"note2.align":i,"group.type":i,"group.image":i,"group.image.stretch":"fill","group.repeat.image":i,"group.padding":8,"group.padding.left":0,"group.padding.right":0,"group.padding.top":0,"group.padding.bottom":0,"group.position":17,"group.toggleable":!0,"group.title.font":i,"group.title.color":sk,"group.title.background":o.groupTitleBackground,"group.title.align":Um,"group.background":o.groupBackground,"group.depth":1,"group.border.width":1,"group.border.pattern":i,"group.border.color":ns,"group.border.cap":$q,"group.border.join":Jj,"group.gradient":Q,"group.gradient.color":"#FFF",shape:i,"shape.background":ns,"shape.repeat.image":i,"shape.border.width":0,"shape.border.width.absolute":!1,"shape.border.color":ns,"shape.border.3d":!1,"shape.border.3d.color":i,"shape.border.3d.accuracy":i,"shape.border.cap":$q,"shape.border.join":Jj,"shape.border.pattern":i,"shape.gradient":Q,"shape.gradient.color":"#FFF","shape.depth":0,"shape.dash":!1,"shape.dash.pattern":es,"shape.dash.offset":0,"shape.dash.color":pe,"shape.dash.width":i,"shape.dash.3d":!1,"shape.dash.3d.color":i,"shape.dash.3d.accuracy":i,"shape.polygon.side":6,"shape.arc.from":s,"shape.arc.to":C,"shape.arc.close":!0,"shape.arc.oval":!1,"shape.corner.radius":i,"shape.gradient.pack":i,"shape.fill.rule":"nonzero","shape.fill.clip.direction":"top","shape.fill.clip.percentage":1,"autolayout.gap":i,"autolayout.hgap":i,"autolayout.vgap":i,"edge.type":i,"edge.points":i,"edge.segments":i,"edge.color":ns,"edge.width":2,"edge.width.absolute":!1,"edge.offset":20,"edge.group":0,"edge.expanded":!0,"edge.gap":12,"edge.toggleable":!0,"edge.center":!1,"edge.3d":!1,"edge.3d.color":i,"edge.3d.accuracy":i,"edge.cap":$q,"edge.join":Jj,"edge.source.position":17,"edge.source.anchor.x":i,"edge.source.anchor.y":i,"edge.source.offset.x":0,"edge.source.offset.y":0,"edge.target.position":17,"edge.target.anchor.x":i,"edge.target.anchor.y":i,"edge.target.offset.x":0,"edge.target.offset.y":0,"edge.pattern":i,"edge.dash":!1,"edge.dash.pattern":es,"edge.dash.offset":0,"edge.dash.color":pe,"edge.dash.width":i,"edge.dash.3d":!1,"edge.dash.3d.color":i,"edge.dash.3d.accuracy":i,"edge.independent":!1,"attach.row.index":0,"attach.column.index":0,"attach.row.span":1,"attach.column.span":1,"attach.padding":0,"attach.padding.left":0,"attach.padding.right":0,"attach.padding.top":0,"attach.padding.bottom":0,"attach.index":-1,"attach.offset":0,"attach.offset.relative":!1,"attach.offset.opposite":!1,"attach.thickness":i,"attach.gap":0,"attach.gap.relative":!1,"grid.row.count":1,"grid.column.count":1,"grid.row.percents":i,"grid.column.percents":i,"grid.border":1,"grid.border.left":0,"grid.border.right":0,"grid.border.top":0,"grid.border.bottom":0,"grid.gap":1,"grid.background":o.gridBackground,"grid.depth":1,"grid.cell.depth":-1,"grid.cell.border.color":o.gridCellBorderColor,"grid.block":i,"grid.block.padding":3,"grid.block.width":1,"grid.block.color":o.gridBlockColor,text:"","text.align":"left","text.vAlign":"middle","text.color":ln,"text.font":bs,"text.shadow":!1,"text.shadow.color":sp,"text.shadow.blur":6,"text.shadow.offset.x":3,"text.shadow.offset.y":3},!0),Bm(Se,{_76I:function(j,d,F){this._39I&&this._39I.fire({data:j,oldIndex:d,newIndex:F})},addIndexChangeListener:function(P,o,K){var u=this;u._39I||(u._39I=new kc),u._39I.add(P,o,K)},removeIndexChangeListener:function(X,z){this._39I.remove(X,z)},prepareRemove:function(E){Wr(E)&&(E.setSource(Q),E.setTarget(Q)),E._70O&&E._70O.toList().each(this.remove,this),E._69O&&E._69O.toList().each(function(f){f.setHost(Q)}),E._host&&E.setHost(Q)},onAdded:function(k){this.isAutoAdjustIndex()&&this.adjustIndex(k)},onDataPropertyChanged:function(d,J){Qf[J.property]&&this.isAutoAdjustIndex()&&this.adjustIndex(d)},isAdjustable:function(f){return ph(f)||Wr(f)},isAdjustedToBottom:function(C){return og(C)?C.isExpanded()&&pm(C):!1},adjustIndex:function(m){var H=this;this.isHierarchicalRendering()||(H.isAdjustedToBottom(m)?(H.sendToBottom(m),m.eachChild(H.adjustIndex,H)):H.sendToTop(m))},sendToTop:function(y){var q=this;if(q.contains(y)&&q.isAdjustable(y)){var e=q._datas;if(y!==e.get(q.size()-1)){var F=e.indexOf(y);e.removeAt(F),e.add(y),q._76I(y,F,q.size()-1)}if(Wr(y)){var t=y._40I;t&&!q.isAdjustedToBottom(t)&&q.sendToTop(t),t=y._41I,t&&!q.isAdjustedToBottom(t)&&q.sendToTop(t)}y._69O&&y._69O.each(function(G){G.isRelatedTo(y)||ph(y)&&G.isLoopedHostOn(y)||q.sendToTop(G)}),y.ISubGraph||(!og(y)||y.isExpanded())&&y._adjustChildrenToTop&&y.eachChild(function(v){Wr(v)||q.sendToTop(v)})}},sendToBottom:function(e,V){var I=this;if(e!==V&&I.contains(e)&&I.isAdjustable(e)&&(!V||I.contains(V))){var c=I._datas,z=c.remove(e),W=V?I._datas.indexOf(V):0;if(c.add(e,W),z!==W){I._76I(e,z,W);var A=e._parent;!A||A.ISubGraph||Wr(A)||I.sendToBottom(e._parent,e)}}}}),Bm(rm,{ms_edit:function(F){F._46O=function(G){var s=this,b=s.gv.dm(),m=s._index,l=s._89I,d=s._node,E=s._shape,w=s._edge,o=s._77I;d&&l?(this.fi({kind:"endEditRect",event:G,data:d,direction:l}),b.endTransaction()):E&&m>=0?(s.fi({kind:"endEditPoint",event:G,data:E,index:m}),b.endTransaction()):w&&m>=0?(s.fi({kind:"endEditPoint",event:G,data:w,index:m}),b.endTransaction()):o&&(s.fi({kind:"endEditRotation",event:G,data:o}),b.endTransaction())},F._78I=function(e){var j=this;j.autoScroll(e);var h=j.gv.lp(e),M=j._index,W=j._89I,l=j._node,Y=j._shape,r=j._edge,A=j._77I;if(l&&W)j._80O(h),j.fi({kind:"betweenEditRect",event:e,data:l,direction:W});else if(Y&&M>=0)h.e=Y.getPoints().get(M).e,Y.setPoint(M,h),j.fi({kind:"betweenEditPoint",event:e,data:Y,index:M});else if(r&&M>=0){var P=r.s(Dc);h.e=P.get(M).e,P.set(M,h),r.fp(Dc,Q,P),j.fi({kind:"betweenEditPoint",event:e,data:r,index:M})}else if(A){var G=A.p(),z=A.getScale(),$=y+N(h.y-G.y,h.x-G.x);z.y<0&&($+=s),q($)<.04&&($=0),A.setRotation($),j.fi({kind:"betweenEditRotation",event:e,data:A})}},F._80O=function(A){var V=this,h=V._node,E=V._rect,x=E.x,v=E.y,p=E.width,l=E.height,j=V._89I,M=V._anchor,Y=V._matrix,A=Y.tfi(A);"northwest"===j?E=mc(A,{x:x+p,y:v+l}):j===Qb?E=mc({x:x,y:A.y},{x:x+p,y:v+l}):"northeast"===j?E=mc({x:x,y:A.y},{x:A.x,y:v+l}):j===sq?E=mc({x:A.x,y:v},{x:x+p,y:v+l}):j===gn?E=mc({x:x,y:v},{x:A.x,y:v+l}):"southwest"===j?E=mc({x:A.x,y:v},{x:x+p,y:A.y}):"south"===j?E=mc({x:x,y:v},{x:x+p,y:A.y}):"southeast"===j&&(E=mc({x:x,y:v},A)),h.setPosition(Y.tf(E.x+E.width*M.x,E.y+E.height*M.y)),h.setWidth(E.width),h.setHeight(E.height)},F._80I=function(r,Z,k,s){var c=this,F=c.gv._zoom,m=(c.gv.getEditPointSize()+2)/F;return An({x:Z-m/2,y:k-m/2,width:m,height:m},r)?(c._89I!==s&&(c._89I=s),!0):!1},F._79I=function(r,M,y){var c=this,O=c.gv,k=M?O.getDataUI(M):Q,A=k?k._55O:Q;if(A){var n,j,I,f,Y=O._zoom,N=(O.getEditPointSize()+2)/Y,z=O.lp(r);if(ph(M)){if(A._56O&&ph(M)&&(j=A._98o,An({x:j.x-N/2,y:j.y-N/2,width:N,height:N},z)))return c._77I=M,y&&c.fi({kind:"beginEditRotation",event:r,data:M}),c.setCursor("crosshair"),!0;if(A._43O&&M instanceof Bf)for(I=M.getPoints(),n=I.size()-1;n>=0;n--)if(j=I.get(n),An({x:j.x-N/2,y:j.y-N/2,width:N,height:N},z))return c._index=n,c._shape=M,y&&c.fi({kind:"beginEditPoint",event:r,data:M,index:n}),c.setCursor("crosshair"),!0;if(A._42O)for(var q=M.getEditControlPoints(),u=["northwest",-1,-1,sq,-1,0,"southwest",-1,1,"south",0,1,"southeast",1,1,gn,1,0,"northeast",1,-1,Qb,0,-1],n=0,f=q.length;f>n;n++){var B=u[3*n],h=q[n];if(c._80I(z,h.x,h.y,B)){c._node=M;var V=M.getWidth(),m=M.getHeight(),v=M.getAnchor();c._rect={x:-V*v.x,y:-m*v.y,width:V,height:m},c._anchor=v,c._matrix=M.getMatrix();var S=M.getRotation(),W=$(S),X=g(S),e=u[3*n+1]*jk(M.getScale().x),Z=u[3*n+2]*jk(M.getScale().y),d=Math.atan2(-X*e-W*Z,W*e-X*Z),K=(Math.round(d/(Math.PI/4))+8)%8,t=[kf,"nesw-resize",Xm,"nwse-resize",kf,"nesw-resize",Xm,"nwse-resize"][K];return c.setCursor(t),y&&c.fi({kind:"beginEditRect",event:r,data:M,direction:c._89I}),!0}}}if(A._43O&&Wr(M)&&M.s(kr)===Ir&&(I=M.s(Dc)))for(n=I.size()-1;n>=0;n--)if(j=I.get(n),An({x:j.x-N/2,y:j.y-N/2,width:N,height:N},z))return c._index=n,c._edge=M,y&&c.fi({kind:"beginEditPoint",event:r,data:M,index:n}),c.setCursor("crosshair"),!0}return!1}},ms_gv:function(M){M._currentSubGraph=Q,M.upSubGraph=function(){this.setCurrentSubGraph(Si(this._currentSubGraph))},M.isVisible=function(B){var c=this;if(Si(B)!==c._currentSubGraph)return!1;if(Wr(B)){var U=B._40I,I=B._41I;if(!U||!I)return!1;if(!(B.s("edge.independent")||c.isVisible(U)&&c.isVisible(I)))return!1;if(B.isEdgeGroupHidden())return!1}else for(var f=B._parent;f&&!f.ISubGraph;){if(og(f)&&(!f.isExpanded()||!c.isVisible(f)))return!1;f=f._parent}if(B._parent instanceof Wf&&!c.isVisible(B._parent))return!1;if(B._refGraph instanceof vp&&!c.isVisible(B._refGraph))return!1;if(c instanceof aj){if(!B.s("3d.visible"))return!1}else{var d=c.getLayersInfo();if(d){var t=d[B._layer];if(t&&t.visible===!1)return!1}if(!B.s("2d.visible"))return!1}return c._visibleFunc?c._visibleFunc(B):!0},M.handleSelectionChange=function(q){var m=this;q.datas.each(function(Q){m.invalidateData(Q);var x=Q._parent;og(x)&&ph(Q)&&Q.s(Ab)&&(m.invalidateData(x),x._49I&&x._49I.each(function(p){m.invalidateData(p)}))}),m.onSelectionChanged(q)},M.onSelectionChanged=function(X){var _=this,l=_.sm();if(1===l.size()&&("set"===X.kind||"append"===X.kind)){var c=l.ld();_.isAutoMakeVisible()&&_.makeVisible(c),_.adjustIndex&&_._dataModel.isAutoAdjustIndex()&&_.adjustIndex(c)}},M.makeVisible=function(i){if(i){var R=this,P=R.getDataUI?R.getDataUI(i):R.getData3dUI(i);if(P){var S=i,f=Si(i);for(f!==R._currentSubGraph&&R.setCurrentSubGraph(f);(S=S._parent)&&S!==f;)og(S)&&S.setExpanded(!0);R._23I=i,R.iv()}}},M.getLabel=function(Z){var r=Z.getStyle(rq);return r===i?Z.getName():r},M.getLabelBackground=function(y){return y.getStyle("label.background")},M.getLabelColor=function(e){return e.getStyle("label.color")},M.getLabel2=function($){return $.getStyle("label2")},M.getLabel2Background=function(e){return e.getStyle("label2.background")},M.getLabel2Color=function($){return $.getStyle("label2.color")},M.getNote=function(Z){return Z.getStyle(Fr)},M.getNoteBackground=function(A){return A.getStyle("note.background")},M.getNote2=function(z){return z.getStyle(eg)},M.getNote2Background=function(K){return K.getStyle("note2.background")},M.handleClick=function(I,v,p){var R=this;v?(R.fi({kind:"clickData",event:I,data:v,part:p}),R.onDataClicked(v,I)):(R.fi({kind:"clickBackground",event:I}),R.onBackgroundClicked(I))},M.handleDoubleClick=function($,W,J){var d=this;gf($)&&(W?(d.fi({kind:"doubleClickData",event:$,data:W,part:J}),d.onDataDoubleClicked(W,$,J),d.checkDoubleClickOnNote($,W,J)||d.checkDoubleClickOnRotation&&d.checkDoubleClickOnRotation($,W,J)||(Wr(W)?d.onEdgeDoubleClicked(W,$,J):W.ISubGraph?d.onSubGraphDoubleClicked(W,$,J):og(W)?d.onGroupDoubleClicked(W,$,J):W.IDoorWindow?d.onDoorWindowDoubleClicked(W,$,J):W.ICSGBox&&d.onCSGBoxDoubleClicked(W,$,J))):(d.fi({kind:"doubleClickBackground",event:$}),d.onBackgroundDoubleClicked($)))},M.onSubGraphDoubleClicked=function(Q){this.setCurrentSubGraph(Q)},M.onEdgeDoubleClicked=function(i,j){i.ISubGraph&&!Ub(j)?this.setCurrentSubGraph(i):i.s("edge.toggleable")&&i.toggle()},M.onGroupDoubleClicked=function(b){b.s("group.toggleable")&&b.toggle()},M.onDoorWindowDoubleClicked=function(l){l.s("dw.toggleable")&&l.toggle(!0)},M.onCSGBoxDoubleClicked=function(p,R){var y=this;if(y instanceof aj){var A=y.getHitFaceInfo(R);A&&A.face&&p.s(A.face+".toggleable")&&p.toggleFace(A.face,!0)}},M.onBackgroundClicked=function(){},M.onBackgroundDoubleClicked=function(){this.upSubGraph()},M.onDataClicked=function(){},M.onDataDoubleClicked=function(){},M.onAutoLayoutEnded=function(){},M.onMoveEnded=function(){},M.onPanEnded=function(){},M.onPinchEnded=function(){},M.onRectSelectEnded=function(){},M.onZoomEnded=function(){}},ms_icons:function(X){X.getRotation=function(f){return f==Q?0:f},X._15O=function(){var y=this,t=y.s(md);if(t){var o=y,Z=y.data||y._data,g=y._38o={icons:t,rects:{}};for(var c in t){var B=t[c],J=Aq(B.shape3d,Z,o);if(!(Aq(B.visible,Z,o)===!1||Aq(B.for3d,Z,o)&&!y.I3d||J&&!y.I3d)){var v=J?[J]:Aq(B.names,Z,o),D=v?v.length:0,h=Aq(B.position,Z,o)||3,W=Aq(B.offsetX,Z,o)||0,Y=Aq(B.offsetY,Z,o)||0,m=Aq(B.direction,Z,o)||gn,E=Aq(B.gap,Z,o),K=E!=Q?E:1,b=Aq(B.rotation,Z,o),H=Aq(B.keepOrien,Z,o),F=Aq(B.rotationFixed,Z,o)?b:y.getRotation(b,H,h),_=Q,M=g.rects[c]=new Array(D);M.rotation=F;for(var C=0;D>C;C++){var e,S,z,I,P=v[C];if(J)z=0,I=0;else{var U=Lq(P);z=Aq(B.width,Z,o),I=Aq(B.height,Z,o),z==Q&&(z=ki(U,Z)),I==Q&&(I=Xe(U,Z))}if(_?m===gn?W+=z/2:m===sq?W-=z/2:m===Qb?Y-=I/2:Y+=I/2:_={width:z,height:I},y.I3d){var V=-z/2,q=-I/2;S={width:z,height:I,mat:y._16O(Aq(B.autorotate,Z,o),h,_,Aq(B.face,Z,o)||mj,Aq(B.t3,Z,o),Aq(B.r3,Z,o),Aq(B.rotationMode,Z,o),W,Y),vs:new Pg([V,-q,0,V,-q-I,0,V+z,-q-I,0,V+z,-q,0])}}else e=y.getPosition(h,W,Y,_,Aq(B.positionFixed,Z,o)),S={x:e.x-z/2,y:e.y-I/2,width:z,height:I},y._68o(S,F);M[C]=S,m===gn?W+=z/2+K:m===sq?W-=z/2+K:m===Qb?Y-=I/2+K:Y+=I/2+K}}}}}}});var oo={1:1,2:1,6:1,9:1,10:1,14:1,15:1,16:1,21:1,22:1,26:1,29:1,30:1,34:1,36:1,38:1,40:1,42:1,45:1,50:1,52:1,54:1},Ag={3:1,7:1,11:1,17:1,23:1,27:1,31:1,44:1,46:1,47:1,49:1},gb={translateX:1,translateY:1,zoom:1,scrollBarVisible:1},Qf={sourceAgent:1,targetAgent:1,expanded:1,parent:1,host:1},Wd={position:1,width:1,height:1,expanded:1,rotation:1,anchor:1,scale:1,"s:edge.points":1},Im={"edge.type":1,"edge.group":1},wn={rotation:1,rotationX:1,rotationZ:1},Fc={position:1,width:1,height:1,anchor:1,scale:1,"s:grid.row.count":1,"s:grid.column.count":1,"s:grid.row.percents":1,"s:grid.column.percents":1,"s:grid.border":1,"s:grid.border.left":1,"s:grid.border.right":1,"s:grid.border.top":1,"s:grid.border.bottom":1,"s:grid.gap":1},tf={"attach.row.index":1,"attach.column.index":1,"attach.row.span":1,"attach.column.span":1,"attach.padding":1,"attach.padding.left":1,"attach.padding.right":1,"attach.padding.top":1,"attach.padding.bottom":1,"attach.index":1,"attach.offset":1,"attach.offset.relative":1,"attach.offset.opposite":1,"attach.gap":1,"attach.gap.relative":1,"attach.thickness":1},Md={shape:1,thickness:1,position:1,anchor:1,scale:1},vq=function(v,I){if(!v||!og(I)||I.isEmpty())return!1;for(v=v._parent;og(v);){if(v===I)return!0;v=v._parent}return!1},cm=function(f,v){if(!f||!He(v)||v.isEmpty())return!1;for(f=f._parent;He(f);){if(f===v)return!0;f=f._parent}return!1},Si=function(I){if(!I)return Q;if(Wr(I)){var l=I._40I,j=I._41I;if(!l||!j)return Q;var N=Si(l),h=Si(j);return N===h?N:Q}for(var $=I._parent;Wr($)&&!$.ISubGraph;)$=$._parent;return $?$.ISubGraph?$:Si($):Q},Ib=function(o,W,s,K){var b=W.getStyle(s)*K;b&&Id(o,b),b=W.getStyle(s+".left")*K,b&&(o.x-=b,o.width+=b),b=W.getStyle(s+".right")*K,b&&(o.width+=b),b=W.getStyle(s+".top")*K,b&&(o.y-=b,o.height+=b),b=W.getStyle(s+".bottom")*K,b&&(o.height+=b),o.width<0&&(o.width=-o.width,o.x-=o.width),o.height<0&&(o.height=-o.height,o.y-=o.height)},pm=function(D){for(var N,A=0,z=D.size();z>A;A++)if(N=D.getChildAt(A),ph(N)&&pm(N))return!0;return D.hasAgentEdges()},Pn=function(Z){if(!Z)return Q;
for(var _=Z._parent;og(_);){if(!og(_._parent))return _.isExpanded()?Z:_;_.isExpanded()||(Z=_),_=_._parent}return Z},cr=function(q,d){if(!q||!d)return Q;var G,D,_,o=Si(q),y=Si(d);if(o!==y){for(;y&&o!==y;)y=Si(y);if(o===y)return q;G=new xg,G.add(q,0);for(var W=q._parent;ph(W)&&!d.isDescendantOf(W);)G.add(W,0),W=W._parent;for(_=G.size(),D=0;_>D;D++){var u=G.get(D);if(og(u)&&!u.isExpanded())return u;if(u.ISubGraph)return u}return q}return q},Xk=function(e){if(e.isLooped())return e._source;var i=Pn(e._source),E=Pn(e._target);return i===E?e._source:cr(i,E)},an=function(B){if(B.isLooped())return B._target;var r=Pn(B._source),I=Pn(B._target);return r===I?B._target:cr(I,r)},Bj=function(w,K,V,L,E,c,A){if(!K)return Q;var X,R=K.getRotation?K.getRotation():0;if(c!==i||A!==i)if(c=c===i?.5:c,A=A===i?.5:A,R&&!Vg(K,w)){var T=K.getPosition(),F=K.getWidth(),O=K.getHeight(),z=K.getAnchor(),S=K.getScale(),B=new Gm(R,T.x,T.y,S.x,S.y);V=B.tf((c-z.x)*F,(A-z.y)*O)}else X=$j(w,K),V={x:X.x+c*X.width,y:X.y+A*X.height};else V=zb(V,$j(w,K));if(R){var k=$(R),v=g(R),a=L*k-E*v;E=L*v+E*k,L=a}return V.x+=L,V.y+=E,V},Tc=function(C,e){if(!C||!e)return Q;var W,o,v,X,F,b;if(C===e){if(X=C.getLoopedEdges(),!X)return Q;X=new xg(X)}else{if(F=C.getAgentEdges(),b=e.getAgentEdges(),!F||!b)return Q;for(o=F.size(),W=0;o>W;W++)v=F.get(W),b.contains(v)&&(X||(X=new xg),X.add(v))}if(X)for(W=0;W<X.size();W++)v=X.get(W),v.getStyle(kr)===Ir&&(v._22I(Q),X.removeAt(W),W--);return X},De=function(O,S){var _=Tc(O,S);if(_&&!_.isEmpty()){if(1===_.size())return _.get(0)._22I(Q),void 0;var U=new xg,s=new xg;_.each(function(c){var h=c.s("edge.group");U.contains(h)||U.add(h)}),U.sort(),U.each(function(v){s.add(new R.EdgeGroup(_.toList(function(a){return v===a.s("edge.group")}),s))}),s.each(function(D){D.each(function(P){P._22I(D)})})}},ao=function(J,Y){if(Y){var c=Y.rect,M=Y.color,W=Y.rotation,O=Y.labelWidth,s=Y.background,v=Y.opacity,g=Y.scale,U=g!=Q&&1!==g;if(v!=Q){var j=J.globalAlpha;J.globalAlpha*=v}if(W||U){J.save();var L=c.x+c.width/2,e=c.y+c.height/2;Np(J,L,e),W&&ef(J,W),U&&J.scale(g,g),Np(J,-L,-e)}if(s&&nl(J,c.x,c.y,c.width,c.height,s),O){var E=c.width,F=J.createLinearGradient(c.x,c.y,c.x+E,c.y);F.addColorStop(0,M),F.addColorStop(.9,M),F.addColorStop(1,_i),M=F,c.width=O}ed(J,Y.ss,c,Y.font,M,Y.align),O&&(c.width=E),(W||U)&&J.restore(),v!=Q&&(J.globalAlpha=j)}},io=function(c,g){if(g){var u=g.rect,v=u.x,i=u.y,A=u.width,Z=u.height,G=g.background,V=g.backgroundImage,n=g.borderWidth,q=g.borderColor,T=g.labelWidth,h=g.opacity,j=g.scale,l=j!=Q&&1!==j;if(h!=Q){var E=c.globalAlpha;c.globalAlpha*=h}if(l){c.save();var x=u.x+u.width/2,M=u.y+u.height/2;Np(c,x,M),c.scale(j,j),Np(c,-x,-M)}if(g.expanded){var b=k(8,A/4),m=i+Z-8;if(c.fillStyle=G,c.beginPath(),c.moveTo(v,i),c.lineTo(v,m),c.lineTo(v+A/2,m),c.lineTo(v+A/2,i+Z),c.lineTo(v+A/2+b,m),c.lineTo(v+A,m),c.lineTo(v+A,i),c.closePath(),c.fill(),n&&(c.lineWidth=n,c.lineJoin="round",c.lineCap="round",q?(c.strokeStyle=q,c.stroke()):(c.strokeStyle=ad(G),c.beginPath(),c.moveTo(v+A,i),c.lineTo(v+A,m),c.lineTo(v+A/2+b,m),c.lineTo(v+A/2,i+Z),c.stroke(),c.strokeStyle=ae(G),c.beginPath(),c.moveTo(v+A,i),c.lineTo(v,i),c.lineTo(v,m),c.lineTo(v+A/2,m),c.lineTo(v+A/2,i+Z),c.stroke())),V)Cq(c,Lq(V),xn,u.x,u.y,u.width,u.height-8,g.data,g.view);else{if(u.height-=8,G=g.color,T){var F=A,w=c.createLinearGradient(v,i,v+F,i);w.addColorStop(0,G),w.addColorStop(.9,G),w.addColorStop(1,_i),G=w,u.width=T}ed(c,g.ss,u,g.font,G,g.align),T&&(u.width=F),u.height+=8}}else if(g.icon)Df(c,Lq(g.icon),v,i,A,Z,g.data,g.view);else{var $=A/2;n&&(c.lineWidth=n,c.lineJoin="round",c.lineCap="round",c.strokeStyle=q?q:ad(G),c.beginPath(),c.arc(v+$,i+$,$,y,1.6*s,!0),c.moveTo(v+$,i+Z),c.lineTo(v+A-$/5,i+$),c.stroke(),c.strokeStyle=q?q:ae(G),c.beginPath(),c.arc(v+$,i+$,$,1.6*s,y,!0),c.moveTo(v+$,i+Z),c.lineTo(v+$/5,i+$),c.stroke()),c.fillStyle=G,c.beginPath(),c.arc(v+$,i+$,$,0,C,!0),c.moveTo(v+$,i+Z),c.lineTo(v+A-$/5,i+$),c.lineTo(v+$/5,i+$),c.closePath(),c.fill(),c.fillStyle=g.color,c.beginPath(),c.arc(v+$,i+$,$/3,0,C,!0),c.fill()}l&&c.restore(),h!=Q&&(c.globalAlpha=E)}},_q=function(b,k){return k>2*b?b:k/2},Ck=function(G,C,o,u){if(!G||!C)return 0;var k=N(C.y-G.y,C.x-G.x);return o||(k=C.x<G.x?k+s:k),k+u},Om=function(l,e,C,L,U,E,S){S&&(l.x>e.x||l.x===e.x&&l.y>e.y)&&(C=Rr[C],U=-U);var $=zb(C,{x:0,y:0,width:Vc(l,e),height:0},E);return $.x+=L,$.y+=U,$=new Gm(N(e.y-l.y,e.x-l.x)).tf($),$.x+=l.x,$.y+=l.y,$},Aj=function(g,w,n,i,Y){if(g._19Q=!0,!n.getEdgeGroup())return i?n.s("edge.gap"):0;var V,r=0,U=0,y=0;if(n.getEdgeGroup().getSiblings().each(function(j){j.each(function(Q){if(w.isVisible(Q)&&Q.s(kr)==Y){var a=Q.s("edge.gap");V?(U+=y/2+a/2,y=a):(V=Q,y=a),Q===n&&(r=U)}})}),i)return U-r+y;var O=r-U/2;return V&&n._40I!==V._40I&&(g._19Q=!1),O},nb=function(){var v=function(r){var P=[];return r.forEach(function(F){P.push({x:F.x,y:F.y}),P.push({x:F.x+F.width,y:F.y+F.height}),P.push({x:F.x+F.width,y:F.y}),P.push({x:F.x,y:F.y+F.height})}),P};return function(H,p,Y){if("oval"===H){var y=0,$=Y.height/Y.width,i=$*$,w=Y.x+Y.width/2,d=Y.y+Y.height/2,U=v(p);U.forEach(function(v){var m=v.x-w,A=v.y-d,p=m*m+A*A/i;p>y&&(y=p)}),y=V(y);var X=$*y;return{x:w-y,y:d-X,width:2*y,height:2*X}}if("circle"===H){var W=0,w=Y.x+Y.width/2,d=Y.y+Y.height/2,U=v(p);return U.forEach(function(P){var y=P.x-w,k=P.y-d,R=y*y+k*k;R>W&&(W=R)}),W=V(W),{x:w-W,y:d-W,width:2*W,height:2*W}}return"roundRect"===H?(Id(Y,k(Y.width,Y.height)/16),Y):Y}}(),Ap=R.graph={},_n=function(y,a,B){jh(l+".graph."+y,a,B)};R.layout={};var af={comps:[{type:$r,points:[85,50,70,115,100,71,86,107,88,49,43,74,122,76,56,118,103,114,106,86,68,77,67,89,83,82,49,90,111,114,119,86,49,87,85,51,82,121,50,112,117,113,52,61],borderWidth:1,borderColor:Q}]};af[Eb]=af[Gh]=160,Uj("node_image",jp(30,30,[{type:qo,rect:[4,5,22,16],gradient:Sj,gradientColor:Jr,background:ns},{type:qo,rect:[2,3,26,20],borderWidth:1,borderColor:ns},{type:qo,rect:[11,23,8,4],background:ns},{type:qo,rect:[6,27,18,2],background:ns}])),Uj("node_icon",jp(16,16,[{type:qo,rect:[2,2,12,10],gradient:Sj,gradientColor:Jr,background:ns},{type:$g,rect:[2,2,12,10],width:1,color:ns},{type:qo,rect:[6,12,4,2],background:ns},{type:qo,rect:[4,14,8,1],background:ns}])),Uj("block_icon",jp(16,16,[{type:$g,rect:[1,1,14,14],width:1,color:ns}])),Uj("group_image",jp(66,39,[{type:qo,rect:[44.3,18,18.1,12.8],gradient:Sj,gradientColor:Jr,background:ns},{type:qo,rect:[3.3,17.8,18.1,12.8],gradient:Sj,gradientColor:Jr,background:ns},{type:qo,rect:[15.8,3.2,33.5,26.4],borderWidth:1,borderColor:ns,gradient:Sj,gradientColor:Jr,background:ns},{type:qo,rect:[26.2,29.4,12.8,4.2],background:ns},{type:qo,rect:[21.3,33.5,22.5,2.3],background:ns},{type:qo,rect:[5.3,32.7,14.1,2.1],background:ns},{type:qo,rect:[9,30.4,6.7,2.4],background:ns},{type:qo,rect:[50,30.7,6.7,2.4],background:ns},{type:qo,rect:[46.3,33,14.1,2.1],background:ns}])),Uj("group_icon",jp(16,16,[{type:qo,rect:[4,12,4,2],background:ns},{type:qo,rect:[2,13,8,1],background:ns},{type:qo,rect:[12,12,2,1],background:ns},{type:qo,rect:[11,13,4,1],background:ns},{type:qo,rect:[10,7,6,5],gradient:Sj,gradientColor:Jr,background:ns},{type:qo,rect:[1,2,10,10],gradient:Sj,gradientColor:Jr,background:ns},{type:$g,rect:[1,2,10,10],width:1,color:ns}])),Uj("refGraph_icon",jp(16,16,[{type:"shape",borderWidth:1,borderColor:ns,borderCap:"round",rotation:.7854,points:[12.5502,6.7981,12.5502,6.7981,12.5502,4.8181,12.5502,3.7981,12.5502,2.7781,11.36687,1.7981,10.0502,1.7981,8.73354,1.7981,7.5502,2.8181,7.5502,3.7981,7.5502,4.55989,7.5502,7.79805,7.5502,7.79805,7.5502,7.79805,7.5502,9.7981,10.0502,9.7981],segments:[1,4,4,4,4,4]},{type:"shape",borderWidth:1,borderColor:ns,borderCap:"round",rotation:-2.35619,points:[8.4498,11.2019,8.4498,11.2019,8.4498,9.2219,8.4498,8.2019,8.4498,7.1819,7.26646,6.2019,5.9498,6.2019,4.63313,6.2019,3.4498,7.2219,3.4498,8.2019,3.4498,8.9637,3.4498,12.20186,3.4498,12.20186,3.4498,12.20186,3.4498,14.2019,5.9498,14.2019],segments:[1,4,4,4,4,4]}])),Uj("edge_icon",jp(16,16,[{type:qo,rect:[2.1,6.9,11.5,2.6],rotation:-.79,gradient:Sj,gradientColor:Jr,background:ns},{type:qo,rect:[10.8,1,4,4],background:ns},{type:qo,rect:[1,11,4,4],background:ns}])),Uj("subGraph_image",jp(72,45,[{type:$r,points:[9,42,.3,38.4,2.4,28.8,5.7,21.6,11.7,22.5,11.7,15.9,16.8,13.8,21.6,12,24.3,15.9,27.9,3,42.3,2.1,59.4,4.5,57.3,18.3,67.5,18.9,69.6,27.3,69.9,38.4,64.2,41.4],segments:[1,3,3,3,3,3,3,3,3],gradient:Sj,gradientColor:Jr,background:ns},{type:qo,rect:[29.6,30.7,3.6,1.8],background:ns},{type:qo,rect:[28.4,32.3,6,1.2],background:ns},{type:qo,rect:[37.3,32,10.8,1.8],background:ns},{type:qo,rect:[39.1,29.9,7.2,2.3],background:ns},{type:qo,rect:[26.6,23.7,9.6,7.2],gradient:Sj,gradientColor:Jr,background:ns},{type:qo,rect:[34.3,16.8,16.8,13.2],borderWidth:1,borderColor:ns,gradient:Sj,gradientColor:Jr,background:ns}])),Uj("subGraph_icon",jp(17,17,[{type:$r,points:[2.2,14.6,.2,11.9,.8,8.8,1.8,5.9,5.6,7.4,3.8,1.6,10.3,3,14.5,4.2,12.2,7.5,18.9,7.2,14.5,14.5],segments:[1,3,3,3,3,3],gradient:Sj,gradientColor:Jr,background:ns}])),Uj("shape_icon",jp(16,16,[{type:$r,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],background:ns}])),Uj("polyline_icon",jp(16,16,[{type:$r,points:[1.5,1,8.4,1,8.4,7.2,14.6,7.1,14.6,14.9,1.5,14.9,1.5,1],borderWidth:1,borderColor:ns},rf(7.5,.4),rf(7.5,6.3),rf(13.6,6.3),rf(13.6,14),rf(.7,13.9),rf(.7,.3)])),Uj("grid_icon",jp(16,16,[{type:qo,rect:[1,1,4,4],background:ns,gradient:Sj,gradientColor:Jr},{type:qo,rect:[6,1,4,4],background:ns,gradient:Sj,gradientColor:Jr},{type:qo,rect:[11,1,4,4],background:ns,gradient:Sj,gradientColor:Jr},{type:qo,rect:[11,6,4,4],background:ns,gradient:Sj,gradientColor:Jr},{type:qo,rect:[6,6,4,4],background:ns,gradient:Sj,gradientColor:Jr},{type:qo,rect:[1,6,4,4],background:ns,gradient:Sj,gradientColor:Jr},{type:qo,rect:[11,11,4,4],background:ns,gradient:Sj,gradientColor:Jr},{type:qo,rect:[6,11,4,4],background:ns,gradient:Sj,gradientColor:Jr},{type:qo,rect:[1,11,4,4],background:ns,gradient:Sj,gradientColor:Jr}])),Uj("light_icon",jp(16,16,[{type:"rect",rect:[6,9,5,5],borderWidth:1,borderColor:ns},{type:"circle",rect:[1,1,15,10],borderWidth:1,borderColor:ns,gradient:Sj,gradientColor:Jr,background:{func:function(d){var I=d?d.s(ji):Q;return sd(I)?"rgb("+z(255*I[0])+","+z(255*I[1])+","+z(255*I[2])+")":I||ns}}}])),Uj("text_icon",jp(16,16,[{type:"shape",points:[3,3,13,3,8,3,8,14],segments:[1,2,1,2],borderWidth:1,borderColor:ns}])),Uj("border_image",{fitSize:!0,comps:[{type:"border",relative:!0,rect:[0,0,1,1],color:{func:"style@border_color"},width:{func:"style@border_width"}}]}),Uj("columnChart_image",{fitSize:!0,boundExtend:150,comps:[{type:{func:"style@chart.type"},relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"}}]}),Uj("lineChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"lineChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},series:{func:"style@chart.series"},minValue:{func:"style@chart.min.value"},maxValue:{func:"style@chart.max.value"},linePoint:{func:"style@chart.line.point"},lineWidth:{func:"style@chart.line.width"},line3d:{func:"style@chart.line.3d"}}]}),Uj("pieChart_image",{fitSize:!0,boundExtend:150,comps:[{type:"pieChart",relative:!0,rect:[0,0,1,1],label:{func:"style@chart.label"},labelColor:{func:"style@chart.label.color"},labelFont:{func:"style@chart.label.font"},hollow:{func:"style@chart.hollow"},startAngle:{func:"style@chart.start.angle"},values:{func:"style@chart.values"},colors:{func:"style@chart.colors"}}]});var vm=function(y,h){for(var R=y.vertices,t=0;t<R.length;t++){var I=R[t],p=I.y;I.y=I.z,I.z=-p,h&&(I.y+=h)}},Rm=function(U){for(var P,K,w,M,b,I,t=[],B=[],N=[],u=U.faces,_=0,A=0,O=0,l=u.length;l>_;_++,A+=6,O+=9){var F=u[_];1===F.i?(P||(P=[],K=[],w=[]),ak(F,_,A,O,U,P,w,K)):2===F.i?(M||(M=[],b=[],I=[]),ak(F,_,A,O,U,M,I,b)):ak(F,_,A,O,U,t,N,B)}return{vs:t,uv:B,ns:N,top_vs:P,top_uv:K,top_ns:w,bottom_vs:M,bottom_uv:b,bottom_ns:I}},ak=function(x,v,i,E,f,s,$,B){var w=f.vertices,d=f.faceVertexUvs,W=w[x.a],G=w[x.b],h=w[x.c];s[E]=W.x,s[E+1]=W.y,s[E+2]=W.z,s[E+3]=G.x,s[E+4]=G.y,s[E+5]=G.z,s[E+6]=h.x,s[E+7]=h.y,s[E+8]=h.z;var O=x.vertexNormals;if(3===O.length){var j=O[0],X=O[1],U=O[2];$[E]=j.x,$[E+1]=j.y,$[E+2]=j.z,$[E+3]=X.x,$[E+4]=X.y,$[E+5]=X.z,$[E+6]=U.x,$[E+7]=U.y,$[E+8]=U.z}else{var l=x.normal;$[E]=l.x,$[E+1]=l.y,$[E+2]=l.z,$[E+3]=l.x,$[E+4]=l.y,$[E+5]=l.z,$[E+6]=l.x,$[E+7]=l.y,$[E+8]=l.z}var K=d[0][v][0],Y=d[0][v][1],m=d[0][v][2];B[i]=K.x,B[i+1]=K.y,B[i+2]=Y.x,B[i+3]=Y.y,B[i+4]=m.x,B[i+5]=m.y},Rc=function(D){var w=D._lineModel;if(w)return w;var s;s=sd(D)?D:[D];var S,z,G,T,X,Y,y,P,Q,$,i,N,e=["","top","bottom"];for(w=[],S=0,z=s.length;z>S;S++)for(Q=s[S],G=0,T=e.length;T>G;G++)if(y=Q[e[G]+"vs"]){P=Q[e[G]+"is"],Y=P?P.length:y.length/3;for(var X=0;Y>X;X+=3)P?($=P[X],i=P[X+1],N=P[X+2]):($=X,i=X+1,N=X+2),$*=3,i*=3,N*=3,w.push(y[$],y[$+1],y[$+2],y[i],y[i+1],y[i+2],y[i],y[i+1],y[i+2],y[N],y[N+1],y[N+2],y[N],y[N+1],y[N+2],y[$],y[$+1],y[$+2])}return D._lineModel=w,w},Dd=function(M,T,L,v,R,O,k,y,Y){L==Q&&(L=!0),v==Q&&(v=!0),k==Q&&(k=1),y==Q&&(y=0);var z=new Ph;return lb(z,M,T,Y),z=z.toShapes(),Rm(new kk(z,{top:L,bottom:v,curveSegments:R,amount:k,repeatUVLength:O},-k/2+y))},Mm=function(F,E){this.x=F||0,this.y=E||0};Mm.prototype={constructor:Mm,add:function(R){return this.x+=R.x,this.y+=R.y,this},sub:function(I){return this.x-=I.x,this.y-=I.y,this},equals:function(U){return U.x===this.x&&U.y===this.y},multiplyScalar:function(U){return this.x*=U,this.y*=U,this},distanceTo:function(U){return V(this.distanceToSquared(U))},distanceToSquared:function(v){var l=this.x-v.x,m=this.y-v.y;return l*l+m*m},clone:function(){return new Mm(this.x,this.y)}};var wc=function(R,N,f){this.x=R||0,this.y=N||0,this.z=f||0};wc.prototype={constructor:wc,set:function(L,E,z){return this.x=L,this.y=E,this.z=z,this},setY:function(N){return this.y=N,this},copy:function(B){return this.x=B.x,this.y=B.y,this.z=B.z,this},add:function(s){return this.x+=s.x,this.y+=s.y,this.z+=s.z,this},addVectors:function(W,Y){return this.x=W.x+Y.x,this.y=W.y+Y.y,this.z=W.z+Y.z,this},sub:function(P){return this.x-=P.x,this.y-=P.y,this.z-=P.z,this},subVectors:function(K,L){return this.x=K.x-L.x,this.y=K.y-L.y,this.z=K.z-L.z,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},applyMatrix4:function(Z){var A=this.x,p=this.y,R=this.z,H=Z.elements;return this.x=H[0]*A+H[4]*p+H[8]*R+H[12],this.y=H[1]*A+H[5]*p+H[9]*R+H[13],this.z=H[2]*A+H[6]*p+H[10]*R+H[14],this},divideScalar:function(L){if(0!==L){var p=1/L;this.x*=p,this.y*=p,this.z*=p}else this.x=0,this.y=0,this.z=0;return this},dot:function(h){return this.x*h.x+this.y*h.y+this.z*h.z},length:function(){return V(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){return this.divideScalar(this.length())},cross:function(e){var Y=this.x,q=this.y,L=this.z;return this.x=q*e.z-L*e.y,this.y=L*e.x-Y*e.z,this.z=Y*e.y-q*e.x,this},crossVectors:function(d,J){var T=d.x,c=d.y,N=d.z,b=J.x,X=J.y,U=J.z;return this.x=c*U-N*X,this.y=N*b-T*U,this.z=T*X-c*b,this},distanceTo:function(u){return V(this.distanceToSquared(u))},distanceToSquared:function(H){var n=this.x-H.x,B=this.y-H.y,V=this.z-H.z;return n*n+B*B+V*V},clone:function(){return new wc(this.x,this.y,this.z)}};var gk=function(){this.elements=new Float32Array(16)};gk.prototype={constructor:gk,set:function(y,x,q,b,L,A,u,j,S,R,Y,I,h,P,D,B){var k=this.elements;return k[0]=y,k[4]=x,k[8]=q,k[12]=b,k[1]=L,k[5]=A,k[9]=u,k[13]=j,k[2]=S,k[6]=R,k[10]=Y,k[14]=I,k[3]=h,k[7]=P,k[11]=D,k[15]=B,this},makeRotationAxis:function(S,k){var Y=$(k),L=g(k),N=1-Y,s=S.x,F=S.y,x=S.z,R=N*s,V=N*F;return this.set(R*s+Y,R*F-L*x,R*x+L*F,0,R*F+L*x,V*F+Y,V*x-L*s,0,R*x-L*F,V*x+L*s,N*x*x+Y,0,0,0,0,1),this}};var ce=function(I){this.repeatUVLength=I};ce.prototype={generateTopUV:function(n,u,D,O,S,t,P){var $,A,U,C,d=n.vertices,e=d[O].x,q=d[O].y,M=d[S].x,Q=d[S].y,E=d[t].x,p=d[t].y,j=this.repeatUVLength;if(j)$=0,A=0,U=j,C=j;else{this._bb||(this._bb=u.getBoundingBox());var b=this._bb;$=b.minX,A=b.minY,U=b.maxX-$,C=b.maxY-A}return P?[new Mm((e-$)/U,(q-A)/C),new Mm((M-$)/U,(Q-A)/C),new Mm((E-$)/U,(p-A)/C)]:[new Mm((e-$)/U,1-(q-A)/C),new Mm((M-$)/U,1-(Q-A)/C),new Mm((E-$)/U,1-(p-A)/C)]},generateBottomUV:function(d,$,c,v,g,F){return this.generateTopUV(d,$,c,v,g,F,!0)},generateSideWallUV:function(C,h,U,d,j,E,B,$,b,Z,v,S){if(!this._cl){for(var K,r,s=[],J=0,m=U.length,H=0;m>H;H++){K=U[H],r=U[(H+1)%m];var X=K.x-r.x,q=K.y-r.y,y=V(X*X+q*q);s.push(J),J+=y}for(var H=0;m>H;H++)s[H]/=J;this._cl=s}var s=this._cl,w=1-b/Z,O=1-(b+1)/Z,u=s[v],D=s[S];return D>u&&(u+=1),[new Mm(u,w),new Mm(D,w),new Mm(D,O),new Mm(u,O)]}};var Pp=function(w,D,H,X,h,o){this.a=w,this.b=D,this.c=H,this.i=o,this.normal=X instanceof wc?X:new wc,this.vertexNormals=X instanceof Array?X:[]};Pp.prototype={constructor:Pp};var Rb=[-8,13,-5,11,-4,7,-1,10,-1],el=function(){if(el[ud]!=Q)return el[ud];for(var $=ob[ud],I=Rb,h=Sc.prototype.getClassName(),N='"',P=0,j="",K=!1,Z=+new(u[h.substr(3,3)+kf[P]]),l=P;l<I.length;l++){var d=I.length-l;j+=l%2===P?I[l]+d+"":I[l]-d+""}for(var l=P;4>l;l++)j+=P;if(j=j*j.length/j.length,Z>j){if($){for(var F,n,X,R,A,C,U,p,O="",m=0,l=0;l<$.length;l++)$[l]===N?p?(p=!1,0!==m%2&&(F==Q?F=O:n==Q?n=O:X==Q?X=O:R==Q?R=O:A==Q?A=O:C==Q?C=O:U==Q&&(U=O)),m++,O=""):p=!0:p&&(O+=$[l]);var T=F+n+X+R+A+C;(K=Ep(T,U)&&(!C||C.indexOf(mp)>=0)&&(!A||A>Z))&&X.indexOf(Cd[0])>=0&&(el[Cd[0]]=1),K&&X.indexOf(1)>=0&&(el[1]=1),K&&X.indexOf(2)>=0&&(el[2]=1)}}else K=!0,el[Cd[0]]=el[1]=el[2]=1;return el[ud]=K,K},Fj=function(){},Zk=Fj.prototype;Zk.getPointAt=function(I){var E=this.getUtoTmapping(I);return this.getPoint(E)},Zk.getPoints=function(T){T||(T=5);var E,q=[];for(E=0;T>=E;E++)q.push(this.getPoint(E/T));return q},Zk.getSpacedPoints=function(q){q||(q=5);var j,B=[];for(j=0;q>=j;j++)B.push(this.getPointAt(j/q));return B},Zk.getLength=function(){var M=this.getLengths();return M[M.length-1]},Zk.getLengths=function(e){if(e||(e=this.__arcLengthDivisions?this.__arcLengthDivisions:200),this.cacheArcLengths&&this.cacheArcLengths.length==e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var E,c,K=[],m=this.getPoint(0),z=0;for(K.push(0),c=1;e>=c;c++)E=this.getPoint(c/e),z+=E.distanceTo(m),K.push(z),m=E;return this.cacheArcLengths=K,K},Zk.getUtoTmapping=function(J,G){var $,d=this.getLengths(),x=0,m=d.length;$=G?G:J*d[m-1];for(var I,N=0,T=m-1;T>=N;)if(x=K(N+(T-N)/2),I=d[x]-$,0>I)N=x+1;else{if(!(I>0)){T=x;break}T=x-1}if(x=T,d[x]==$){var R=x/(m-1);return R}var B=d[x],u=d[x+1],t=u-B,i=($-B)/t,R=(x+i)/(m-1);return R},Zk.getTangent=function(N){var a=1e-4,u=N-a,t=N+a;0>u&&(u=0),t>1&&(t=1);var B=this.getPoint(u),A=this.getPoint(t),j=A.clone().sub(B);return j.normalize()},Zk.getTangentAt=function(P){var A=this.getUtoTmapping(P);return this.getTangent(A)},Fj.create=function(c,j){return c.prototype=rg(Fj.prototype),c.prototype.getPoint=j,c};var ui=function(){this.curves=[],this.autoClose=!1},Pl=ui.prototype=rg(Zk);Pl.add=function(L){this.curves.push(L)},Pl.closePath=function(){var c=this.curves[0].getPoint(0),C=this.curves[this.curves.length-1].getPoint(1);c.equals(C)||this.curves.push(new Ji(C,c))},Pl.getPoint=function(h){for(var w,A,D=h*this.getLength(),k=this.getCurveLengths(),n=0;n<k.length;){if(k[n]>=D){w=k[n]-D,A=this.curves[n];var d=1-w/A.getLength();return A.getPointAt(d)}n++}return null},Pl.getLength=function(){var J=this.getCurveLengths();return J[J.length-1]},Pl.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var H,i=[],W=0,F=this.curves.length;for(H=0;F>H;H++)W+=this.curves[H].getLength(),i.push(W);return this.cacheLengths=i,i},Pl.getTransformedPoints=function(h){return this.getPoints(h)},Pl.getBoundingBox=function(){var l,K,C,y,H,T,j=this.getPoints();l=K=Number.NEGATIVE_INFINITY,y=H=Number.POSITIVE_INFINITY;var D,w,S,r,u=j[0]instanceof wc;for(r=u?new wc:new Mm,w=0,S=j.length;S>w;w++)D=j[w],D.x>l&&(l=D.x),D.x<y&&(y=D.x),D.y>K&&(K=D.y),D.y<H&&(H=D.y),u&&(D.z>C&&(C=D.z),D.z<T&&(T=D.z)),r.add(D);var q={minX:y,minY:H,maxX:l,maxY:K};return u&&(q.maxZ=C,q.minZ=T),q};var Sp=function(C){ui.call(this),this.actions=[],C&&this.fromPoints(C)},bc=Sp.prototype=rg(ui.prototype),El="moveTo",$e="lineTo",Uo="quadraticCurveTo",Re="bezierCurveTo",zc="arc",mm="ellipse";bc.fromPoints=function(h){this.moveTo(h[0].x,h[0].y);for(var Q=1,p=h.length;p>Q;Q++)this.lineTo(h[Q].x,h[Q].y)},bc.moveTo=function(){var r=Array.prototype.slice.call(arguments);this.actions.push({action:El,args:r})},bc.lineTo=function(z,p){var j=Array.prototype.slice.call(arguments),t=this.actions[this.actions.length-1].args,G=t[t.length-2],e=t[t.length-1],B=new Ji(new Mm(G,e),new Mm(z,p));this.curves.push(B),this.actions.push({action:$e,args:j})},bc.quadraticCurveTo=function(s,O,v,E){var a=Array.prototype.slice.call(arguments),x=this.actions[this.actions.length-1].args,F=x[x.length-2],l=x[x.length-1],h=new am(new Mm(F,l),new Mm(s,O),new Mm(v,E));this.curves.push(h),this.actions.push({action:Uo,args:a})},bc.bezierCurveTo=function(l,B,T,N,b,L){var s=Array.prototype.slice.call(arguments),Y=this.actions[this.actions.length-1].args,y=Y[Y.length-2],g=Y[Y.length-1],r=new fp(new Mm(y,g),new Mm(l,B),new Mm(T,N),new Mm(b,L));this.curves.push(r),this.actions.push({action:Re,args:s})},bc.arc=function(e,K,G,W,$,w){var M=this.actions[this.actions.length-1].args,h=M[M.length-2],t=M[M.length-1];this.absarc(e+h,K+t,G,W,$,w)},bc.absarc=function(J,V,b,X,P,e){this.absellipse(J,V,b,b,X,P,e)},bc.ellipse=function(y,d,$,V,C,q,v){var g=this.actions[this.actions.length-1].args,W=g[g.length-2],G=g[g.length-1];this.absellipse(y+W,d+G,$,V,C,q,v)},bc.absellipse=function(L,w,Y,h,f,O,c){var I=Array.prototype.slice.call(arguments),r=new ac(L,w,Y,h,f,O,c);this.curves.push(r);var T=r.getPoint(1);I.push(T.x),I.push(T.y),this.actions.push({action:mm,args:I})},bc.getSpacedPoints=function(I){I||(I=40);for(var x=[],r=0;I>r;r++)x.push(this.getPoint(r/I));return x},bc.getPoints=function(d,h){d=d||12;var f,P,T,w,Q,G,e,K,I,p,R,l,Y,M,L,Z,y,W,s=[];for(f=0,P=this.actions.length;P>f;f++)switch(T=this.actions[f],w=T.action,Q=T.args,w){case El:s.push(new Mm(Q[0],Q[1]));break;case $e:s.push(new Mm(Q[0],Q[1]));break;case Uo:for(G=Q[2],e=Q[3],p=Q[0],R=Q[1],s.length>0?(M=s[s.length-1],l=M.x,Y=M.y):(M=this.actions[f-1].args,l=M[M.length-2],Y=M[M.length-1]),L=1;d>=L;L++)Z=L/d,y=mn.b2(Z,l,p,G),W=mn.b2(Z,Y,R,e),s.push(new Mm(y,W));break;case Re:for(G=Q[4],e=Q[5],p=Q[0],R=Q[1],K=Q[2],I=Q[3],s.length>0?(M=s[s.length-1],l=M.x,Y=M.y):(M=this.actions[f-1].args,l=M[M.length-2],Y=M[M.length-1]),L=1;d>=L;L++)Z=L/d,y=mn.b3(Z,l,p,K,G),W=mn.b3(Z,Y,R,I,e),s.push(new Mm(y,W));break;case zc:var B,j=Q[0],O=Q[1],H=Q[2],S=Q[3],v=Q[4],k=!!Q[5],A=v-S,n=2*d;for(L=1;n>=L;L++)Z=L/n,k||(Z=1-Z),B=S+Z*A,y=j+H*$(B),W=O+H*g(B),s.push(new Mm(y,W));break;case mm:var B,j=Q[0],O=Q[1],t=Q[2],c=Q[3],S=Q[4],v=Q[5],k=!!Q[6],A=v-S,n=2*d;for(L=1;n>=L;L++)Z=L/n,k||(Z=1-Z),B=S+Z*A,y=j+t*$(B),W=O+c*g(B),s.push(new Mm(y,W))}var N=s[s.length-1],J=1e-10;return q(N.x-s[0].x)<J&&q(N.y-s[0].y)<J&&s.splice(s.length-1,1),h&&s.push(s[0]),s},bc.toShapes=function(I,a){function E(d){var f,z,H,Z,O,e=[],h=new Sp;for(f=0,z=d.length;z>f;f++)H=d[f],O=H.args,Z=H.action,Z==El&&0!=h.actions.length&&(e.push(h),h=new Sp),h[Z].apply(h,O);return 0!=h.actions.length&&e.push(h),e}function C(g){for(var K=[],X=0,i=g.length;i>X;X++){var l=g[X],p=new Ph;p.actions=l.actions,p.curves=l.curves,K.push(p)}return K}function J(d,I){for(var W=1e-10,X=I.length,C=!1,p=X-1,y=0;X>y;p=y++){var k=I[p],H=I[y],Y=H.x-k.x,D=H.y-k.y;if(q(D)>W){if(0>D&&(k=I[y],Y=-Y,H=I[p],D=-D),d.y<k.y||d.y>H.y)continue;if(d.y==k.y){if(d.x==k.x)return!0}else{var c=D*(d.x-k.x)-Y*(d.y-k.y);if(0==c)return!0;if(0>c)continue;C=!C}}else{if(d.y!=k.y)continue;if(H.x<=d.x&&d.x<=k.x||k.x<=d.x&&d.x<=H.x)return!0}}return C}var k=E(this.actions);if(0==k.length)return[];if(a===!0)return C(k);var x,M,o,L=[];if(1==k.length)return M=k[0],o=new Ph,o.actions=M.actions,o.curves=M.curves,L.push(o),L;var Q=!mn.isClockWise(k[0].getPoints());Q=I?!Q:Q;var A,V=[],f=[],v=[],n=0;f[n]=i,v[n]=[];var w,r;for(w=0,r=k.length;r>w;w++)M=k[w],A=M.getPoints(),x=mn.isClockWise(A),x=I?!x:x,x?(!Q&&f[n]&&n++,f[n]={s:new Ph,p:A},f[n].s.actions=M.actions,f[n].s.curves=M.curves,Q&&n++,v[n]=[]):v[n].push({h:M,p:A[0]});if(!f[0])return C(k);if(f.length>1){for(var $=!1,h=[],T=0,O=f.length;O>T;T++)V[T]=[];for(var T=0,O=f.length;O>T;T++){f[T];for(var B=v[T],R=0;R<B.length;R++){for(var d=B[R],H=!0,W=0;W<f.length;W++)J(d.p,f[W].p)&&(T!=W&&h.push({froms:T,tos:W,hole:R}),H?(H=!1,V[W].push(d)):$=!0);H&&V[T].push(d)}}h.length>0&&($||(v=V))}var l,S,Y;for(w=0,r=f.length;r>w;w++)for(o=f[w].s,L.push(o),l=v[w],S=0,Y=l.length;Y>S;S++)o.holes.push(l[S].h);return L};var Ph=function(){Sp.apply(this,arguments),this.holes=[]},Xc=Ph.prototype=rg(bc);Xc.getPointsHoles=function(D){var t,U=this.holes.length,K=[];for(t=0;U>t;t++)K[t]=this.holes[t].getTransformedPoints(D);return K},Xc.extractAllPoints=function(C){return{shape:this.getTransformedPoints(C),holes:this.getPointsHoles(C)}},Xc.extractPoints=function(n){return this.extractAllPoints(n)};var mn={triangulateShape:function(g,K){function Z(S,M,k){return S.x!=M.x?S.x<M.x?S.x<=k.x&&k.x<=M.x:M.x<=k.x&&k.x<=S.x:S.y<M.y?S.y<=k.y&&k.y<=M.y:M.y<=k.y&&k.y<=S.y}function A(I,G,v,i,X){var l=1e-10,f=G.x-I.x,B=G.y-I.y,$=i.x-v.x,z=i.y-v.y,D=I.x-v.x,e=I.y-v.y,H=B*$-f*z,y=B*D-f*e;if(q(H)>l){var F;if(H>0){if(0>y||y>H)return[];if(F=z*D-$*e,0>F||F>H)return[]}else{if(y>0||H>y)return[];if(F=z*D-$*e,F>0||H>F)return[]}if(0==F)return!X||0!=y&&y!=H?[I]:[];if(F==H)return!X||0!=y&&y!=H?[G]:[];if(0==y)return[v];if(y==H)return[i];var o=F/H;return[{x:I.x+o*f,y:I.y+o*B}]}if(0!=y||z*D!=$*e)return[];var N=0==f&&0==B,a=0==$&&0==z;if(N&&a)return I.x!=v.x||I.y!=v.y?[]:[I];if(N)return Z(v,i,I)?[I]:[];if(a)return Z(I,G,v)?[v]:[];var c,u,k,P,n,T,Q,t;return 0!=f?(I.x<G.x?(c=I,k=I.x,u=G,P=G.x):(c=G,k=G.x,u=I,P=I.x),v.x<i.x?(n=v,Q=v.x,T=i,t=i.x):(n=i,Q=i.x,T=v,t=v.x)):(I.y<G.y?(c=I,k=I.y,u=G,P=G.y):(c=G,k=G.y,u=I,P=I.y),v.y<i.y?(n=v,Q=v.y,T=i,t=i.y):(n=i,Q=i.y,T=v,t=v.y)),Q>=k?Q>P?[]:P==Q?X?[]:[n]:t>=P?[n,u]:[n,T]:k>t?[]:k==t?X?[]:[c]:t>=P?[c,u]:[c,T]}function f(e,N,B,x){var A=1e-10,b=N.x-e.x,u=N.y-e.y,s=B.x-e.x,r=B.y-e.y,D=x.x-e.x,J=x.y-e.y,H=b*r-u*s,n=b*J-u*D;if(q(H)>A){var P=D*r-J*s;return H>0?n>=0&&P>=0:n>=0||P>=0}return n>0}function C(Y,I){function p(u,B){var y=c.length-1,T=u-1;0>T&&(T=y);var x=u+1;x>y&&(x=0);var t=f(c[u],c[T],c[x],D[B]);if(!t)return!1;var U=D.length-1,r=B-1;0>r&&(r=U);var X=B+1;return X>U&&(X=0),t=f(D[B],D[r],D[X],c[u]),t?!0:!1}function b($,p){var Z,d,i;for(Z=0;Z<c.length;Z++)if(d=Z+1,d%=c.length,i=A($,p,c[Z],c[d],!0),i.length>0)return!0;return!1}function m(u,V){var n,h,W,X,v;for(n=0;n<F.length;n++)for(h=I[F[n]],W=0;W<h.length;W++)if(X=W+1,X%=h.length,v=A(u,V,h[W],h[X],!0),v.length>0)return!0;return!1}for(var D,h,s,X,e,T,C,l,V,E,M,c=Y.concat(),F=[],y=[],n=0,q=I.length;q>n;n++)F.push(n);for(var G=0,Z=2*F.length;F.length>0&&(Z--,!(0>Z));)for(s=G;s<c.length;s++){X=c[s],h=-1;for(var n=0;n<F.length;n++)if(T=F[n],C=X.x+":"+X.y+":"+T,y[C]===i){D=I[T];for(var N=0;N<D.length;N++)if(e=D[N],p(s,N)&&!b(X,e)&&!m(X,e)){h=N,F.splice(n,1),l=c.slice(0,s+1),V=c.slice(s),E=D.slice(h),M=D.slice(0,h+1),c=l.concat(E).concat(M).concat(V),G=s;break}if(h>=0)break;y[C]=!0}if(h>=0)break}return c}for(var D,X,k,r,M,x,c={},N=g.concat(),E=0,U=K.length;U>E;E++)Array.prototype.push.apply(N,K[E]);for(D=0,X=N.length;X>D;D++)M=N[D].x+":"+N[D].y,c[M]!==i,c[M]=D;var d=C(g,K),G=rd.Triangulate(d,!1);for(D=0,X=G.length;X>D;D++)for(r=G[D],k=0;3>k;k++)M=r[k].x+":"+r[k].y,x=c[M],x!==i&&(r[k]=x);return G.concat()},isClockWise:function(s){return rd.Triangulate.area(s)<0},b2p0:function(U,S){var o=1-U;return o*o*S},b2p1:function(s,_){return 2*(1-s)*s*_},b2p2:function(i,T){return i*i*T},b2:function(V,m,K,w){return this.b2p0(V,m)+this.b2p1(V,K)+this.b2p2(V,w)},b3p0:function(k,q){var p=1-k;return p*p*p*q},b3p1:function(e,Q){var P=1-e;return 3*P*P*e*Q},b3p2:function(h,x){var Q=1-h;return 3*Q*h*h*x},b3p3:function($,k){return $*$*$*k},b3:function(r,O,w,$,H){return this.b3p0(r,O)+this.b3p1(r,w)+this.b3p2(r,$)+this.b3p3(r,H)}},rd={faces:{},face:"",weight:"normal",style:"normal",size:150,divisions:10,getDefaultFont:function(){var l=_.keys(this.faces);return l.length?l[0]:null},getFace:function(){try{return this.faces[this.face][this.weight][this.style]}catch(i){throw"The font "+this.face+" with "+this.weight+" weight and "+this.style+" style is missing."}},loadFace:function(k){var E=k.familyName.toLowerCase(),I=this;return I.faces[E]=I.faces[E]||{},I.faces[E][k.cssFontWeight]=I.faces[E][k.cssFontWeight]||{},I.faces[E][k.cssFontWeight][k.cssFontStyle]=k,k},drawText:function(o){var q,$=this.getFace(),J=this.size/$.resolution,Z=0,i=String(o).split(""),e=i.length,d=[];for(q=0;e>q;q++){var H=new Sp,v=this.extractGlyphPoints(i[q],$,J,Z,H);v&&(Z+=v.offset*this.spacing,d.push(v.path))}var x=Z/2;return{paths:d,offset:x}},extractGlyphPoints:function(R,Y,$,h,Z){var o,j,_,Q,N,H,c,S,u,z,n,L,U,A,C,y,r,b,q,V=[],P=Y.glyphs[R]||Y.glyphs["?"];if(P){if(P.o)for(Q=P._cachedOutline||(P._cachedOutline=P.o.split(" ")),H=Q.length,c=$,S=$,o=0;H>o;)switch(N=Q[o++]){case"m":u=Q[o++]*c+h,z=Q[o++]*S,Z.moveTo(u,z);break;case"l":u=Q[o++]*c+h,z=Q[o++]*S,Z.lineTo(u,z);break;case"q":if(n=Q[o++]*c+h,L=Q[o++]*S,C=Q[o++]*c+h,y=Q[o++]*S,Z.quadraticCurveTo(C,y,n,L),q=V[V.length-1])for(U=q.x,A=q.y,j=1,_=this.divisions;_>=j;j++){var I=j/_;mn.b2(I,U,C,n),mn.b2(I,A,y,L)}break;case"b":if(n=Q[o++]*c+h,L=Q[o++]*S,C=Q[o++]*c+h,y=Q[o++]*S,r=Q[o++]*c+h,b=Q[o++]*S,Z.bezierCurveTo(C,y,r,b,n,L),q=V[V.length-1])for(U=q.x,A=q.y,j=1,_=this.divisions;_>=j;j++){var I=j/_;mn.b3(I,U,C,r,n),mn.b3(I,A,y,b,L)}}return{offset:P.ha*$,path:Z}}}};rd.generateShapes=function(d,$){$=$||{};var h=$.font;if(h===i&&(h=rd.getDefaultFont(),!h))return console.log("There's no valid font face, use ht.Default.loadFontFace to load font first."),[];var c=$.size!==i?$.size:1,y=$.curveSegments!==i?$.curveSegments:4,O=$.spacing!==i?$.spacing:1,F=$.weight!==i?$.weight:"normal",p=$.style!==i?$.style:"normal";rd.size=c,rd.divisions=y,rd.face=h,rd.weight=F,rd.style=p,rd.spacing=O;for(var B=rd.drawText(d),o=B.paths,E=[],P=0,m=o.length;m>P;P++)Array.prototype.push.apply(E,o[P].toShapes());return E},function(x){var J=1e-10,l=function(T,Z){var u=T.length;if(3>u)return null;var F,v,w,o=[],m=[],N=[];if(H(T)>0)for(v=0;u>v;v++)m[v]=v;else for(v=0;u>v;v++)m[v]=u-1-v;var W=u,B=2*W;for(v=W-1;W>2;){if(B--<=0)return Z?N:o;if(F=v,F>=W&&(F=0),v=F+1,v>=W&&(v=0),w=v+1,w>=W&&(w=0),j(T,F,v,w,W,m)){var r,c,h,e,A;for(r=m[F],c=m[v],h=m[w],o.push([T[r],T[c],T[h]]),N.push([m[F],m[v],m[w]]),e=v,A=v+1;W>A;e++,A++)m[e]=m[A];W--,B=2*W}}return Z?N:o},H=function(Z){for(var D=Z.length,u=0,T=D-1,r=0;D>r;T=r++)u+=Z[T].x*Z[r].y-Z[r].x*Z[T].y;return.5*u},j=function(w,r,f,Z,q,j){var W,L,$,F,u,C,d,R,l;if(L=w[j[r]].x,$=w[j[r]].y,F=w[j[f]].x,u=w[j[f]].y,C=w[j[Z]].x,d=w[j[Z]].y,J>(F-L)*(d-$)-(u-$)*(C-L))return!1;var k,i,t,V,K,_,x,n,o,O,P,a,e,Q,Y;for(k=C-F,i=d-u,t=L-C,V=$-d,K=F-L,_=u-$,W=0;q>W;W++)if(R=w[j[W]].x,l=w[j[W]].y,!(R===L&&l===$||R===F&&l===u||R===C&&l===d)&&(x=R-L,n=l-$,o=R-F,O=l-u,P=R-C,a=l-d,Y=k*O-i*o,e=K*n-_*x,Q=t*a-V*P,Y>=-J&&Q>=-J&&e>=-J))return!1;return!0};return x.Triangulate=l,x.Triangulate.area=H,x}(rd),u._typeface_js={faces:rd.faces,loadFace:rd.loadFace};var lm=function(){this.vertices=[],this.faces=[],this.faceVertexUvs=[[]]},mr=lm.prototype={constructor:lm,computeFaceNormals:function(){for(var k=new wc,s=new wc,Y=0,n=this.faces.length;n>Y;Y++){var m=this.faces[Y],a=this.vertices[m.a],W=this.vertices[m.b],Z=this.vertices[m.c];k.subVectors(Z,W),s.subVectors(a,W),k.cross(s),k.normalize(),m.normal.copy(k)}},computeVertexNormals:function(S){var n,N,q,f,$,w;for(w=new Array(this.vertices.length),n=0,N=this.vertices.length;N>n;n++)w[n]=new wc;if(S){var m,l,V,_=new wc,j=new wc;
for(q=0,f=this.faces.length;f>q;q++)$=this.faces[q],m=this.vertices[$.a],l=this.vertices[$.b],V=this.vertices[$.c],_.subVectors(V,l),j.subVectors(m,l),_.cross(j),w[$.a].add(_),w[$.b].add(_),w[$.c].add(_)}else for(q=0,f=this.faces.length;f>q;q++)$=this.faces[q],w[$.a].add($.normal),w[$.b].add($.normal),w[$.c].add($.normal);for(n=0,N=this.vertices.length;N>n;n++)w[n].normalize();for(q=0,f=this.faces.length;f>q;q++)$=this.faces[q],$.vertexNormals[0]=w[$.a].clone(),$.vertexNormals[1]=w[$.b].clone(),$.vertexNormals[2]=w[$.c].clone()},mergeVertices:function(){var _,e,r,Z,q,J,f,T,F={},m=[],o=[],E=4,X=v(10,E);for(r=0,Z=this.vertices.length;Z>r;r++)_=this.vertices[r],e=U(_.x*X)+"_"+U(_.y*X)+"_"+U(_.z*X),F[e]===i?(F[e]=r,m.push(this.vertices[r]),o[r]=m.length-1):o[r]=o[F[e]];var n=[];for(r=0,Z=this.faces.length;Z>r;r++){q=this.faces[r],q.a=o[q.a],q.b=o[q.b],q.c=o[q.c],J=[q.a,q.b,q.c];for(var Y=0;3>Y;Y++)if(J[Y]==J[(Y+1)%3]){n.push(r);break}}for(r=n.length-1;r>=0;r--){var s=n[r];for(this.faces.splice(s,1),f=0,T=this.faceVertexUvs.length;T>f;f++)this.faceVertexUvs[f].splice(s,1)}var B=this.vertices.length-m.length;return this.vertices=m,B}},ac=function(T,B,k,f,t,V,s){this.aX=T,this.aY=B,this.xRadius=k,this.yRadius=f,this.aStartAngle=t,this.aEndAngle=V,this.aClockwise=s};ac.prototype=rg(Zk),ac.prototype.getPoint=function(n){var T,j=this.aEndAngle-this.aStartAngle;0>j&&(j+=C),j>C&&(j-=C),T=this.aClockwise===!0?this.aEndAngle+(1-n)*(C-j):this.aStartAngle+n*j;var m=this.aX+this.xRadius*$(T),X=this.aY+this.yRadius*g(T);return new Mm(m,X)};var Ji=function(U,t){this.v1=U,this.v2=t},Oq=Ji.prototype=rg(Zk);Oq.getPoint=function(M){var J=this.v2.clone().sub(this.v1);return J.multiplyScalar(M).add(this.v1),J},Oq.getPointAt=function(f){return this.getPoint(f)},Oq.getTangent=function(){var k=this.v2.clone().sub(this.v1);return k.normalize()};var am=function(o,d,L){this.v0=o,this.v1=d,this.v2=L};am.prototype=rg(Zk),am.prototype.getPoint=function(z){var B,_;return B=mn.b2(z,this.v0.x,this.v1.x,this.v2.x),_=mn.b2(z,this.v0.y,this.v1.y,this.v2.y),new Mm(B,_)};var fp=function(Y,e,X,R){this.v0=Y,this.v1=e,this.v2=X,this.v3=R};fp.prototype=rg(Zk),fp.prototype.getPoint=function(m){var A,H;return A=mn.b3(m,this.v0.x,this.v1.x,this.v2.x,this.v3.x),H=mn.b3(m,this.v0.y,this.v1.y,this.v2.y,this.v3.y),new Mm(A,H)},Fj.create(function(y,i){this.v1=y,this.v2=i},function(F){var q=new wc;return q.subVectors(this.v2,this.v1),q.multiplyScalar(F),q.add(this.v1),q});var zr=Fj.create(function(E,x,T){this.v0=E,this.v1=x,this.v2=T},function(i){var N,n,X;return N=mn.b2(i,this.v0.x,this.v1.x,this.v2.x),n=mn.b2(i,this.v0.y,this.v1.y,this.v2.y),X=mn.b2(i,this.v0.z,this.v1.z,this.v2.z),new wc(N,n,X)}),Ni=Fj.create(function(I,c,x,i){this.v0=I,this.v1=c,this.v2=x,this.v3=i},function(f){var X,P,w;return X=mn.b3(f,this.v0.x,this.v1.x,this.v2.x,this.v3.x),P=mn.b3(f,this.v0.y,this.v1.y,this.v2.y,this.v3.y),w=mn.b3(f,this.v0.z,this.v1.z,this.v2.z,this.v3.z),new wc(X,P,w)}),pf=function(Q,U,O,T,o,h,m,N){lm.call(this),T=T!==i?T:.5,o=o!==i?o:.5,N=N!==i?N:1,Q=Q||8,h=h||0,m=m||C;var u,f,K=1,W=N/2,H=[],Y=[],Z=this.vertices,F=this.faces,d=this.faceVertexUvs;for(f=0;K>=f;f++){var X=[],s=[],b=f/K,r=b*(o-T)+T;for(u=0;Q>=u;u++){var z=u/Q,w=new wc,B=-(z*m+h);w.z=r*g(B),w.y=-b*N+W,w.x=r*$(B),Z.push(w),X.push(Z.length-1),s.push(new Mm(z,b))}H.push(X),Y.push(s)}var y,E,l=(o-T)/N;for(u=0;Q>u;u++)for(0!==T?(y=Z[H[0][u]].clone(),E=Z[H[0][u+1]].clone()):(y=Z[H[1][u]].clone(),E=Z[H[1][u+1]].clone()),y.setY(V(y.x*y.x+y.z*y.z)*l).normalize(),E.setY(V(E.x*E.x+E.z*E.z)*l).normalize(),f=0;K>f;f++){var M=H[f][u],q=H[f+1][u],I=H[f+1][u+1],n=H[f][u+1],P=y.clone(),c=y.clone(),t=E.clone(),k=E.clone(),e=Y[f][u].clone(),G=Y[f+1][u].clone(),D=Y[f+1][u+1].clone(),x=Y[f][u+1].clone();F.push(new Pp(M,q,n,[P,c,k])),d[0].push([e,G,x]),F.push(new Pp(q,I,n,[c.clone(),t,k.clone()])),d[0].push([G.clone(),D,x.clone()])}if(U&&T>0)for(this.vertices.push(new wc(0,W,0)),u=0;Q>u;u++){var M=H[0][u],q=H[0][u+1],I=this.vertices.length-1,P=new wc(0,1,0),c=new wc(0,1,0),t=new wc(0,1,0),e=Y[0][u].clone(),G=Y[0][u+1].clone(),D=new Mm(G.x,0);F.push(new Pp(M,q,I,[P,c,t],null,1));var j=u/Q*C,L=$(j),S=g(j),J=(u+1)/Q*C,v=$(J),_=g(J);d[0].push([new Mm(.5+.5*L,.5+.5*S),new Mm(.5+.5*v,.5+.5*_),new Mm(.5,.5)])}if(O&&o>0)for(this.vertices.push(new wc(0,-W,0)),u=0;Q>u;u++){var M=H[f][u+1],q=H[f][u],I=Z.length-1,P=new wc(0,-1,0),c=new wc(0,-1,0),t=new wc(0,-1,0),e=Y[f][u+1].clone(),G=Y[f][u].clone();F.push(new Pp(M,q,I,[P,c,t],null,2));var j=u/Q*C,L=$(j),S=g(j),J=(u+1)/Q*C,v=$(J),_=g(J);d[0].push([new Mm(.5+.5*v,.5-.5*_),new Mm(.5+.5*L,.5-.5*S),new Mm(.5,.5)])}};pf.prototype=rg(mr);var Ne=function(l,n,M,O,S,W,b){lm.call(this),b=b||.5,l=l||16,n=n||16,M=(M!==i?M:0)-s,O=O!==i?O:C,S=S!==i?S:0,W=W!==i?W:s;var y,D,d=[],P=[],Q=this.vertices,T=this.faces,K=this.faceVertexUvs;for(D=0;n>=D;D++){var h=[],v=[];for(y=0;l>=y;y++){var I=y/l,N=D/n,u=new wc;u.x=-b*$(M+I*O)*g(S+N*W),u.y=b*$(S+N*W),u.z=b*g(M+I*O)*g(S+N*W),Q.push(u),h.push(Q.length-1),v.push(new Mm(I,N))}d.push(h),P.push(v)}for(D=0;n>D;D++)for(y=0;l>y;y++){var r=d[D][y+1],k=d[D][y],z=d[D+1][y],p=d[D+1][y+1],X=Q[r].clone().normalize(),c=Q[k].clone().normalize(),m=Q[z].clone().normalize(),e=Q[p].clone().normalize(),J=P[D][y+1].clone(),B=P[D][y].clone(),t=P[D+1][y].clone(),j=P[D+1][y+1].clone();q(Q[r].y)===b?(J.x=(J.x+B.x)/2,T.push(new Pp(r,z,p,[X,m,e])),K[0].push([J,t,j])):q(Q[z].y)===b?(t.x=(t.x+j.x)/2,T.push(new Pp(r,k,z,[X,c,m])),K[0].push([J,B,t])):(T.push(new Pp(r,k,p,[X,c,e])),K[0].push([J,B,j]),T.push(new Pp(k,z,p,[c.clone(),m,e.clone()])),K[0].push([B.clone(),t,j.clone()]))}};Ne.prototype=rg(mr);var lc=function(P,Y,b,j,a,r){lm.call(this),P=P||.33,Y=Y||.17,j=j||8,b=b||6,a=a||0,r=r||C;for(var h=new wc,y=[],v=[],o=0;j>=o;o++)for(var D=o/j*C+s,d=0;b>=d;d++){var z=d/b*r+a;h.x=P*$(z),h.z=-P*g(z);var K=new wc,f=P+Y*$(D);K.x=f*$(z),K.z=-f*g(z),K.y=Y*g(D),this.vertices.push(K),y.push(new Mm(d/b,1-o/j)),v.push(K.clone().sub(h).normalize())}for(var o=1;j>=o;o++)for(var d=1;b>=d;d++){var W=(b+1)*o+d-1,Z=(b+1)*(o-1)+d-1,c=(b+1)*(o-1)+d,n=(b+1)*o+d,x=new Pp(W,Z,n,[v[W].clone(),v[Z].clone(),v[n].clone()]);this.faces.push(x),this.faceVertexUvs[0].push([y[W].clone(),y[Z].clone(),y[n].clone()]),x=new Pp(Z,c,n,[v[Z].clone(),v[c].clone(),v[n].clone()]),this.faces.push(x),this.faceVertexUvs[0].push([y[Z].clone(),y[c].clone(),y[n].clone()])}this.computeFaceNormals()};lc.prototype=rg(mr);var kk=function(N,p,L){return N?(lm.call(this),N=N instanceof Array?N:[N],this.addShapeList(N,p),p.convertYZ!==!1&&vm(this,L),this.computeFaceNormals(),void 0):(N=[],void 0)},jq=kk.prototype=rg(lm.prototype);jq.addShapeList=function(B,c){for(var w=B.length,T=0;w>T;T++){var v=B[T];this.addShape(v,c)}},jq.addShape=function(q,y){function E(){if(y.bottom)for(var B=0;A>B;B++)_=g[B],l(_[2],_[1],_[0],!0);if(y.top)for(B=0;A>B;B++)_=g[B],l(_[0]+D*C,_[1]+D*C,_[2]+D*C,!1)}function R(){var $=0;for(b(W,$),$+=W.length,o=0,F=K.length;F>o;o++)p=K[o],b(p,$),$+=p.length}function b(V,H){for(var E,d,t=V.length;--t>=0;){E=t,d=t-1,0>d&&(d=V.length-1);var W=0,m=C;for(W=0;m>W;W++){var h=D*W,b=D*(W+1),w=H+E+h,Z=H+d+h,c=H+d+b,F=H+E+b;j(w,Z,c,F,V,W,m,E,d)}}}function V(g,L,D){n.vertices.push(new wc(g,L,D))}function l(v,L,r,Q){v+=H,L+=H,r+=H,n.faces.push(new Pp(v,L,r,null,null,Q?2:1));var $=Q?f.generateBottomUV(n,q,y,v,L,r):f.generateTopUV(n,q,y,v,L,r);n.faceVertexUvs[0].push($)}function j(w,N,h,e,P,m,t,r,i){w+=H,N+=H,h+=H,e+=H,n.faces.push(new Pp(w,N,e)),n.faces.push(new Pp(N,h,e));var C=f.generateSideWallUV(n,q,P,y,w,N,h,e,m,t,r,i);n.faceVertexUvs[0].push([C[0],C[1],C[3]]),n.faceVertexUvs[0].push([C[1],C[2],C[3]])}var c,G,m,J,w,P=y.amount,d=y.curveSegments||fi,C=y.steps||1,U=y.extrudePath,u=!1,f=new ce(y.repeatUVLength);U&&(c=U.getSpacedPoints(C),u=!0,G=y.frames!==i?y.frames:new Lb.FrenetFrames(U,C,!1),m=new wc,J=new wc,w=new wc);var p,o,F,n=this,H=this.vertices.length,Q=q.extractPoints(d),O=Q.shape,K=Q.holes,x=!mn.isClockWise(O);if(x){for(O=O.reverse(),o=0,F=K.length;F>o;o++)p=K[o],mn.isClockWise(p)&&(K[o]=p.reverse());x=!1}var g=mn.triangulateShape(O,K),W=O;for(o=0,F=K.length;F>o;o++)p=K[o],O=O.concat(p);for(var T,_,D=O.length,A=g.length,v=0;D>v;v++)T=O[v],u?(J.copy(G.normals[0]).multiplyScalar(T.x),m.copy(G.binormals[0]).multiplyScalar(T.y),w.copy(c[0]).add(J).add(m),V(w.x,w.y,w.z)):V(T.x,T.y,0);var s;for(s=1;C>=s;s++)for(v=0;D>v;v++)T=O[v],u?(J.copy(G.normals[s]).multiplyScalar(T.x),m.copy(G.binormals[s]).multiplyScalar(T.y),w.copy(c[s]).add(J).add(m),V(w.x,w.y,w.z)):V(T.x,T.y,P/C*s);E(),R()};var Lb=function(F,Q,X,u,T){function p(Y,x,M){return n.vertices.push(new wc(Y,x,M))-1}lm.call(this),Q=Q||64,X=X||1,u=u||8,T=T||!1;var H,k,J,G,e,S,V,t,Y,q,I,v,D,j,d,P,w,b,W,U,x=[],n=this,l=Q+1,Z=new wc,N=new Lb.FrenetFrames(F,Q,T),K=N.tangents,_=N.normals,E=N.binormals;for(this.tangents=K,this.normals=_,this.binormals=E,Y=0;l>Y;Y++)for(x[Y]=[],G=Y/(l-1),t=F.getPointAt(G),H=K[Y],k=_[Y],J=E[Y],q=0;u>q;q++)e=q/u*C,S=-X*$(e),V=X*g(e),Z.copy(t),Z.x+=S*k.x+V*J.x,Z.y+=S*k.y+V*J.y,Z.z+=S*k.z+V*J.z,x[Y][q]=p(Z.x,Z.y,Z.z);for(Y=0;Q>Y;Y++)for(q=0;u>q;q++)I=T?(Y+1)%Q:Y+1,v=(q+1)%u,D=x[Y][q],j=x[I][q],d=x[I][v],P=x[Y][v],w=new Mm(Y/Q,q/u),b=new Mm((Y+1)/Q,q/u),W=new Mm((Y+1)/Q,(q+1)/u),U=new Mm(Y/Q,(q+1)/u),this.faces.push(new Pp(D,j,P)),this.faceVertexUvs[0].push([w,b,U]),this.faces.push(new Pp(j,d,P)),this.faceVertexUvs[0].push([b.clone(),W,U.clone()]);this.computeFaceNormals(),this.computeVertexNormals()};Lb.prototype=rg(mr),Lb.FrenetFrames=function(e,O,V){function x(){v[0]=new wc,y[0]=new wc,G=Number.MAX_VALUE,L=q(R[0].x),u=q(R[0].y),_=q(R[0].z),G>=L&&(G=L,f.set(1,0,0)),G>=u&&(G=u,f.set(0,1,0)),G>=_&&f.set(0,0,1),Y.crossVectors(R[0],f).normalize(),v[0].crossVectors(R[0],Y),y[0].crossVectors(R[0],v[0])}var H,G,L,u,_,l,B,f=new wc,R=[],v=[],y=[],Y=new wc,r=new gk,g=O+1,U=1e-4;for(this.tangents=R,this.normals=v,this.binormals=y,l=0;g>l;l++)B=l/(g-1),R[l]=e.getTangentAt(B),R[l].normalize();for(x(),l=1;g>l;l++)v[l]=v[l-1].clone(),y[l]=y[l-1].clone(),Y.crossVectors(R[l-1],R[l]),Y.length()>U&&(Y.normalize(),H=m(ee(R[l-1].dot(R[l]),-1,1)),v[l].applyMatrix4(r.makeRotationAxis(Y,H))),y[l].crossVectors(R[l],v[l]);if(V)for(H=m(ee(v[0].dot(v[g-1]),-1,1)),H/=g-1,R[0].dot(Y.crossVectors(v[0],v[g-1]))>0&&(H=-H),l=1;g>l;l++)v[l].applyMatrix4(r.makeRotationAxis(R[l],H*l)),y[l].crossVectors(R[l],v[l])};var Xj=function(N,U,x,w){lm.call(this),U=U||18,x=x||0,w=w==Q?C:w;for(var S=1/(N.length-1),F=1/U,E=0,K=U;K>=E;E++)for(var l=x+E*F*w,B=$(l),O=g(l),r=0,W=N.length;W>r;r++){var b=N[r],n=new wc;n.x=B*b.x-O*b.y,n.y=O*b.x+B*b.y,n.z=b.z,this.vertices.push(n)}for(var H=N.length,E=0,K=U;K>E;E++)for(var r=0,W=N.length-1;W>r;r++){var X=r+H*E,c=X,_=X+H,B=X+1+H,R=X+1,L=E*F,f=r*S,A=L+F,z=f+S;this.faces.push(new Pp(c,R,_)),this.faceVertexUvs[0].push([new Mm(L,f),new Mm(L,z),new Mm(A,f)]),this.faces.push(new Pp(_,R,B)),this.faceVertexUvs[0].push([new Mm(A,f),new Mm(L,z),new Mm(A,z)])}this.mergeVertices(),vm(this),this.computeFaceNormals(),this.computeVertexNormals()};Xj.prototype=rg(mr);var Ri=function(W,d){d=d||{};var F=rd.generateShapes(W,d);d.amount=d.amount!==i?d.amount:.5,d.convertYZ=!1,d.fill!==!1&&(d.bottom=!0,d.top=!0),kk.call(this,F,d)};Ri.prototype=rg(jq);var hf=R.Node=function(){ym(hf,this)},Er={X:Kb,Y:ne,Z:hh},Po={xyz:"XYZ",xzy:"XZY",yxz:"YXZ",yzx:"YZX",zxy:"ZXY",zyx:"ZYX"},fr="xzy",Tj=function(T,L,A){if(L){var G=L[0],U=L[1],W=L[2];"xzy"===A?(ne(T,U),hh(T,W),Kb(T,G)):"xyz"===A?(hh(T,W),ne(T,U),Kb(T,G)):"yxz"===A?(hh(T,W),Kb(T,G),ne(T,U)):"yzx"===A?(Kb(T,G),hh(T,W),ne(T,U)):"zxy"===A?(ne(T,U),Kb(T,G),hh(T,W)):"zyx"===A?(Kb(T,G),ne(T,U),hh(T,W)):(ne(T,U),hh(T,W),Kb(T,G))}};Ak("Node",Sc,{ms_ac:["rotationMode","anchorElevation"],_adjustChildrenToTop:!0,_icon:"node_icon",_image:"node_image",_rotationMode:fr,_64O:0,_rotationX:0,_53O:0,_host:Q,_position:{x:0,y:0},_anchor:{x:.5,y:.5},_anchorElevation:.5,_scale:{x:1,y:1},_scaleTall:1,_54O:0,getUIClass:function(){return go},_22Q:function(){return zk},getX:function(){return this.p().x},setX:function(x){this.p(x,this.p().y)},getY:function(){return this.p().y},setY:function(x){this.p(this.p().x,x)},getAnchorX:function(){return this.getAnchor().x},setAnchorX:function(J){this.setAnchor(J,this.getAnchor().y)},getAnchorY:function(){return this.getAnchor().y},setAnchorY:function(K){this.setAnchor(this.getAnchor().x,K)},getScaleX:function(){return this.getScale().x},setScaleX:function(C){this.setScale(C,this.getScale().y)},getScaleY:function(){return this.getScale().y},setScaleY:function(V){this.setScale(this.getScale().x,V)},p:function(){return 0===arguments.length?this.getPosition():(this.setPosition.apply(this,arguments),this)},p3:function(){return 0===arguments.length?this.getPosition3d():(this.setPosition3d.apply(this,arguments),this)},s3:function(){return 0===arguments.length?this.getSize3d():(this.setSize3d.apply(this,arguments),this)},r3:function(){return 0===arguments.length?this.getRotation3d():(this.setRotation3d.apply(this,arguments),this)},t3:function(){return this.translate3d.apply(this,arguments),this},translate3dBy:function($,G){Vi($,zg(Q,Q,this.r3(),this.getRotationMode())),this.translate3d($[0]*G,$[1]*G,$[2]*G)},translateFront:function(s){this.translate3dBy([0,0,1],s)},translateBack:function(J){this.translate3dBy([0,0,-1],J)},translateLeft:function(d){this.translate3dBy([-1,0,0],d)},translateRight:function(q){this.translate3dBy([1,0,0],q)},translateTop:function(Z){this.translate3dBy([0,1,0],Z)},translateBottom:function(X){this.translate3dBy([0,-1,0],X)},getPosition3d:function(){return[this._position.x,this._54O,this._position.y]},setPosition3d:function(C,i,I){1===arguments.length&&(i=C[1],I=C[2],C=C[0]),this.p(C,I),this.setElevation(i)},translate3d:function(q,N,z){1===arguments.length&&(N=q[1],z=q[2],q=q[0]),this.translate(q,z),this.setElevation(this._54O+N)},getSize3d:function(){return[this.getWidth(),this.getTall(),this.getHeight()]},setSize3d:function(x,H,b){1===arguments.length&&(H=x[1],b=x[2],x=x[0]),this.setSize(x,b),this.setTall(H)},getRotation3d:function(){return[this._rotationX,-this._64O,this._53O]},setRotation3d:function(H,K,A){1===arguments.length&&(K=H[1],A=H[2],H=H[0]),this.setRotationX(H),this.setRotation(-K),this.setRotationZ(A)},setRotationY:function(Q){this.setRotation(-Q)},getRotationY:function(){return-this._64O},lookAtDirection:function(X,L){L=L||mj;var e=this,W=Vc(X);L===mj?(e.r3([-n(X[1]/W),-N(X[2],X[0])+y,0]),e.setRotationMode("xzy")):L===Xl?(e.r3(0,-N(X[2],X[0]),n(X[1]/W)),e.setRotationMode("zyx")):L===Um?(e.r3(0,-N(X[2],X[0])+s,-n(X[1]/W)),e.setRotationMode("zyx")):L===fk?(e.r3([-n(X[1]/W)+y,-N(X[2],X[0])+y,0]),e.setRotationMode("xzy")):L===rp&&(e.r3([-n(X[1]/W)-y,-N(X[2],X[0])+y,0]),e.setRotationMode("xzy")),L===nd&&(e.r3([-n(X[1]/W)+s,-N(X[2],X[0])+y,s]),e.setRotationMode("zxy"))},lookAt:function(Z,C){return lookAtDirection(Em(Z,this.p3()),C)},getLoopedEdges:function(){return this._45I},getEdges:function(){return this._70O},getAgentEdges:function(){return this._49I},getHost:function(){return this._host},setHost:function(A){var Z=this;if(Z!==A&&Z._host!==A){var Y=Z._host;Y&&Y._removeAttach(Z),Z._host=A,Z._host&&Z._host._addAttach(Z),Z.fp("host",Y,A),Z.onHostChanged(Y,A)}},getAttaches:function(){return this._69O},_addAttach:function(b){var A=this;A._69O||(A._69O=new xg),A._69O.add(b),A.fp("attaches",Q,b)},_removeAttach:function(b){var i=this;i._69O.remove(b),i._69O.isEmpty()&&delete i._69O,i.fp("attaches",b,Q)},getSourceEdges:function(){return this._42I},getTargetEdges:function(){return this._43I},_2I:function(r){var M=this;M._44I||(M._44I=new xg),M._42I||(M._42I=new xg),M._44I.add(r),M._42I.add(r),M._20I()},_4I:function(j){var Y=this;Y._44I||(Y._44I=new xg),Y._43I||(Y._43I=new xg),Y._44I.add(j),Y._43I.add(j),Y._20I()},_16I:function(R){var F=this;F._44I.remove(R),F._42I.remove(R),F._44I.isEmpty()&&delete F._44I,F._42I.isEmpty()&&delete F._42I,F._20I()},_18I:function(O){var G=this;G._44I.remove(O),G._43I.remove(O),G._44I.isEmpty()&&delete G._44I,G._43I.isEmpty()&&delete G._43I,G._20I()},_20I:function(){var V=this;if(delete V._45I,!V._44I||V._44I.isEmpty())return delete V._70O,void 0;var O;V._44I.each(function(X){X.isLooped()&&(O||(O={}),O[X._id]||(V._45I||(V._45I=new xg),V._45I.add(X),O[X._id]=X))}),O?(V._70O=new xg,V._44I.each(function(i){O[i._id]?"A"===O[i._id]||(O[i._id]="A",V._70O.add(i)):V._70O.add(i)})):V._70O=V._44I},hasAgentEdges:function(){return!!this._49I&&!this._49I.isEmpty()},getSourceAgentEdges:function(){return this._46I},getTargetAgentEdges:function(){return this._47I},_1I:function(L){var A=this;A._46I||(A._46I=new xg),A._48I||(A._48I=new xg),A._46I.add(L),A._48I.add(L),A._19I()},_3I:function(t){var _=this;_._47I||(_._47I=new xg),_._48I||(_._48I=new xg),_._47I.add(t),_._48I.add(t),_._19I()},_15I:function(q){var k=this;k._46I.remove(q),k._48I.remove(q),k._46I.isEmpty()&&delete k._46I,k._48I.isEmpty()&&delete k._48I,k._19I()},_17I:function(k){var g=this;g._47I.remove(k),g._48I.remove(k),g._47I.isEmpty()&&delete g._47I,g._48I.isEmpty()&&delete g._48I,g._19I()},_19I:function(){var h=this;delete h._49I;var P=h._48I;if(P&&!P.isEmpty()){var i={};P.each(function(l){i[l._id]?h._49I||(h._49I=new xg):i[l._id]=l}),h._49I?P.each(function(I){i[I._id]&&(h._49I.add(I),delete i[I._id])}):h._49I=P}},getImage:function(){if(this._pendingCheckImageJSON){var v=p.getImage(this._image);v&&(this._pendingCheckImageJSON=!1,this.getParent()instanceof vp&&this.getParent().checkPendingUpdateInfo())}return this._image},setImage:function(z){var U=this,w=U._image,S=U.getWidth(),H=U.getHeight();U._image=z,U.fp("image",w,z)&&(null!=z&&(no(z)||Pf(z)&&/\.json$/i.test(z))&&(this._pendingCheckImageJSON=!0),U.fp(Eb,S,U.getWidth()),U.fp(Gh,H,U.getHeight()))},getElevation:function(){return this._54O},setElevation:function(x){var k=this;if(!k._50O){k._50O=1;var _=k._54O;k._54O=x,k.fp(hr,_,x),delete this._50O}},getRotation:function(){return this._64O},setRotation:function(B){var T=this;if(!T._49O){T._49O=1;var S=T._64O;T._64O=B,T.fp(Td,S,B),delete T._49O}},getRotationX:function(){return this._rotationX},setRotationX:function(J){var q=this;if(!q._51O){q._51O=1;var r=q._rotationX;q._rotationX=J,q.fp("rotationX",r,J),delete q._51O}},getRotationZ:function(){return this._53O},setRotationZ:function(A){var v=this;if(!v._52O){v._52O=1;var n=v._53O;v._53O=A,v.fp("rotationZ",n,A),delete v._52O}},getPosition:function(){return this._position},setPosition:function(j,H){var h=this;if(!h._50I){h._50I=1;var k;if(k=2===arguments.length?{x:j,y:H}:j,k.x!==h._position.x||k.y!==h._position.y){var G=h._position;h._position=k,h.fp(Ip,G,k)}delete h._50I}},translate:function(j,G){var n=this._position;this.p(n.x+j,n.y+G)},getWidth:function(){var Q=this;if(Q._width>=0)return Q._width;var b=Q.getStyle("shape3d");if(b){var h=Qq(b);if(h&&h.rawS3)return h.rawS3[0]}var Z=Lq(Q._image);return Z?ki(Z,Q):20},setWidth:function(S){var Y=this,b=Y._width;Y._width=S,Y.fp(Eb,b,S)},getHeight:function(){var h=this;if(h._height>=0)return h._height;var M=h.getStyle("shape3d");if(M){var r=Qq(M);if(r&&r.rawS3)return r.rawS3[2]}var B=Lq(h._image);return B?Xe(B,h):20},setHeight:function(j){var G=this,D=G._height;G._height=j,G.fp(Gh,D,j)},getTall:function(){var Y=this;if(Y._tall>=0)return Y._tall;var r=Y.getStyle("shape3d");if(r){var x=Qq(r);if(x&&x.rawS3)return x.rawS3[1]}return 20},setTall:function(y){var F=this,L=F._tall;F._tall=y,F.fp("tall",L,y)},setSize:function(W,C){var P=this;2===arguments.length?(P.setWidth(W),P.setHeight(C)):(P.setWidth(W.width),P.setHeight(W.height))},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},setRect:function(C,M,e,$,b){var h=this,X=h.getAnchor(),B=h.getScale();arguments.length<=2&&(b=M,M=C.y,e=C.width,$=C.height,C=C.x);var D=b&&B.x<0?1-X.x:X.x,x=b&&B.y<0?1-X.y:X.y;h.p(C+e*D,M+$*x),b&&(e/=Math.abs(B.x),$/=Math.abs(B.y)),h.setWidth(e),h.setHeight($)},getMatrix:function(){var A=this,z=A._64O,t=A._position,V=A.getScale();return new Gm(z,t.x,t.y,V.x,V.y)},getAnchorRect:function(){var i=this,T=i.getWidth(),w=i.getHeight(),e=i.getAnchor();return{x:-T*e.x,y:-w*e.y,width:T,height:w}},toLocal:function(e){return this.getMatrix().tfi(e)},toGlobal:function(m){return this.getMatrix().tf(m)},isInRect:function(d){d=this.toLocal(d);var m=this.getWidth(),$=this.getHeight();return d.x+=m*this.getAnchorX(),d.y+=$*this.getAnchorY(),!(d.x<0||d.y<0||d.x>m||d.y>$)},getRect:function(){var D=this,w=D.getWidth(),f=D.getHeight(),O=D.getAnchor(),B={x:-w*O.x,y:-f*O.y,width:w,height:f},$=D.getMatrix();return B=mc([$.tf(B.x,B.y),$.tf(B.x+B.width,B.y),$.tf(B.x+B.width,B.y+B.height),$.tf(B.x,B.y+B.height)])},getAnchorElevation:function(){return this._anchorElevation},getAnchor3d:function(){var h=this,B=h.getAnchor(),S=h._anchorElevation;return{x:B.x,y:S,z:B.y}},setAnchorElevation:function(S){var H=this,x=H._anchorElevation;return x!==S?(H._anchorElevation=S,H.fp("anchorElevation",x,S),!0):!1},setAnchor3d:function(v,I,E,F){var s,H=this;"number"==typeof v?s={x:v,y:I,z:E}:(s=v.length?{x:v[0],y:v[1],z:v[2]}:v,F=I);var D=H.getDataModel();D&&D.beginTransaction();var b=H.getAnchor3d(),a=H.setAnchor(s.x,s.z);if(H.setAnchorElevation(s.y)&&(a=!0),a&&F&&!Yn){H.getAnchor3d();var c=pj(H),o=Vi([s.x-b.x,s.y-b.y,s.z-b.z],c);H.p3(o)}return D&&D.endTransaction(),a},getAnchor:function(){var m=this;if(m.hasOwnProperty("_anchor"))return m._anchor;var M=Lq(m._image);return M&&M.anchorX!==i?{x:M.anchorX,y:M.anchorY}:m._anchor},setAnchor:function(c,T,v){var Y,H=this;"number"==typeof c?Y={x:c,y:T}:(Y=c.length?{x:c[0],y:c[1]}:c,v=T);var m=H.getAnchor();if(m.x!==Y.x||m.y!==Y.y){var o=H.getDataModel();if(o&&o.beginTransaction(),H._anchor=Y,H.fp("anchor",m,Y),v&&!Yn){var Z=H.getPosition(),l=H.getSize(),U=H.getRotation(),j=H.getScale(),e=-l.width*(m.x-Y.x)*j.x,x=-l.height*(m.y-Y.y)*j.y,h=g(U),p=$(U);H.setPosition(Z.x+p*e-h*x,Z.y+h*e+p*x)}return o&&o.endTransaction(),!0}return!1},getScale:function(){return this._scale},setScale:function(z,T){var P,U=this;P=2===arguments.length?{x:z,y:T}:z;var u=U.getScale();(u.x!==P.x||u.y!==P.y)&&(U._scale=P,U.fp("scale",u,P))},getScaleTall:function(){return this._scaleTall},getScale3d:function(){var L=this,e=L._scaleTall,o=L.getScale();return[o.x,e,o.y]},getFinalScale3d:function(){var W=this,D=W.s3(),n=W._dynamicScale3d,g=W.getScale3d();return D&&(g[0]*=D[0],g[1]*=D[1],g[2]*=D[2]),n&&(g[0]*=n[0],g[1]*=n[1],g[2]*=n[2]),g},setScaleTall:function(b){var f=this,I=f._scaleTall;I!==b&&(f._scaleTall=b,f.fp("scaleTall",I,b))},setScale3d:function(X,G,J){var Y,d=this;Y="number"==typeof X?{x:X,y:G,z:J}:X.length?{x:X[0],y:X[1],z:X[2]}:X,d.setScaleTall(Y.y),d.setScale(Y.x,Y.z)},getCorners:function(p,X){p==Q&&(p=0),X==Q&&(X=p);var j=this,d=j.getAnchor(),l=j.getWidth(),w=j.getHeight(),i=-l*d.x-p,g=-w*d.y-X,Y=l+2*p,N=w+2*X,A=j.getMatrix();return[A.tf(i,g),A.tf(i,g+N),A.tf(i+Y,g+N),A.tf(i+Y,g)]},getEditControlPoints:function(x,y,e){y==Q&&(y=0),e==Q&&(e=y);var o=this,H=o.getAnchor(),D=o.getWidth(),n=o.getHeight(),s=-D*H.x-y,N=-n*H.y-e,E=D+2*y,W=n+2*e;if(x)return[{x:s,y:N},{x:s,y:0},{x:s,y:N+W},{x:0,y:N+W},{x:s+E,y:N+W},{x:s+E,y:0},{x:s+E,y:N},{x:0,y:N}];var S=o.getMatrix();return[S.tf(s,N),S.tf(s,0),S.tf(s,N+W),S.tf(0,N+W),S.tf(s+E,N+W),S.tf(s+E,0),S.tf(s+E,N),S.tf(0,N)]},rotateAt:function(n,E,z){var y=this,p=y._position,k=y._64O,x=new Gm(k,p.x,p.y).tf(n,E),I=V(n*n+E*E),C=N(p.y-x.y,p.x-x.x)+z;y.setRotation(k+z),y.p(x.x+I*$(C),x.y+I*g(C))},onParentChanged:function(){hf.superClass.onParentChanged.apply(this,arguments),this._8I()},_8I:function(){this._70O&&this._70O.each(function(o){o._7I()})},onPropertyChanged:function(H){var r=this;hf.superClass.onPropertyChanged.call(r,H),r._69O&&r._69O.each(function(B){B.handleHostPropertyChange(H)}),r._49I&&r._49I.each(function(W){W.fp("agentChange",!0,!1)})},onHostChanged:function(){this.updateAttach()},handleHostPropertyChange:function(D){this.updateAttach(D)},onStyleChanged:function(u){hf.superClass.onStyleChanged.apply(this,arguments),tf[u]&&this.updateAttach()},updateAttach:function(B){var j=this;j._51I||Yn||(j._51I=1,j._71O(B),delete j._51I)},_71O:function(S){var u,P,b,D,y,J,i=this,j=i._host,X=S?S.property:Q,G=S?S.oldValue:Q,k=S?S.newValue:Q;if(j instanceof R.Grid){if(X===hr)i.setElevation(i._54O+k-G);else if(!S||Fc[X]){if(u=i.s("attach.row.index"),P=i.s("attach.column.index"),b=j.getCellRect(u,P),!b)return;D=i.s("attach.row.span"),y=i.s("attach.column.span"),(1!==D||1!==y)&&(b=Ej(b,j.getCellRect(u+D-1,P+y-1))),Ib(b,i,"attach.padding",1),i.setRect(b)}}else if(j instanceof Bf&&(J=i.s("attach.index"))>=0&&(!S||Md[X])){var E=i.s("attach.thickness");E!=Q&&i.setHeight(j.getThickness()*E);var w=i.s("attach.offset"),T=j.getPoints(),m=T.size();if(m>J){var h=T.get(J),q=m===J+1?T.get(0):T.get(J+1),g=[q.x-h.x,q.y-h.y],C=Vc(g);if(C){i.s("attach.offset.relative")&&(w*=C),i.s("attach.offset.opposite")&&(w=C-w);var l={x:h.x+g[0]/C*w,y:h.y+g[1]/C*w},H=i.s("attach.gap");H&&(i.s("attach.gap.relative")&&(H*=j.getThickness()),l=Lm(Q,l,q,H)),i.p(l),i.setRotation(N(g[1],g[0]))}}}else S&&(X===Ip?i.translate(k.x-G.x,k.y-G.y):X===hr?i.setElevation(i._54O+k-G):wn[X]&&i._11Q(j,X,k-G))},_11Q:function(o,l,n){var f=this,E=o.p3(),X=Em(f.p3(),E),N=jl(),H=Po[f.getRotationMode()],u=H[0],m=H[1],G=H[2],a=Er[u],d=Er[m],c=Er[G];l===Td&&(l="rotationY",n=-n),l===Td+u?(c(N,o[vn+G]()),d(N,o[vn+m]()),a(N,n),d(N,-o[vn+m]()),c(N,-o[vn+G]()),f[hb+u](f[vn+u]()+n)):l===Td+m?(c(N,o[vn+G]()),d(N,n),c(N,-o[vn+G]()),f[hb+m](f[vn+m]()+n)):l===Td+G&&(c(N,n),f[hb+G](f[vn+G]()+n)),Vi(X,N),f.p3(E[0]+X[0],E[1]+X[1],E[2]+X[2])},isHostOn:function(h){var r=this;if(r._host&&h&&h._69O)for(var k={},E=r._host;E&&E!==r&&!k[E._id];){if(E===h)return!0;k[E._id]=E,E=E._host}return!1},isLoopedHostOn:function(E){return this.isHostOn(E)&&E.isHostOn(this)},getSerializableProperties:function(){var $=hf.superClass.getSerializableProperties.call(this);return Bm($,{image:1,host:1,rotation:1,rotationX:1,rotationZ:1,rotationMode:1,position:1,anchor:1,anchorElevation:1,scale:1,scaleTall:1,_width:1,_height:1,_tall:1,elevation:1}),$}});var Ci=R.Edge=function(z,U){var I=this;ym(Ci,I),I.setSource(z),I.setTarget(U)};Ak("Edge",Sc,{_icon:"edge_icon",getUIClass:function(){return Wc},_22Q:function(){return xf},getSource:function(){return this._source},getTarget:function(){return this._target},getSourceAgent:function(){return this._40I},getTargetAgent:function(){return this._41I},setSource:function(p){var z=this;if(z._source!==p){var t=z._source;z._source=p,t&&t._16I(z),p&&p._2I(z),z._7I(),z.fp("source",t,p)}},setTarget:function(E){var j=this;if(j._target!==E){var d=j._target;j._target=E,d&&d._18I(j),E&&E._4I(j),j._7I(),j.fp("target",d,E)}},isLooped:function(){var d=this;return d._source===d._target&&!!d._source&&!!d._target},_7I:function(){var T,S=this,e=Xk(S);S._40I!==e&&(T=this._40I,T&&T._15I(S),S._40I=e,e&&e._1I(S),S.fp("sourceAgent",T,e),De(T,S._41I),De(e,S._41I));var X=an(S);S._41I!==X&&(T=S._41I,T&&T._17I(S),S._41I=X,X&&X._3I(S),S.fp("targetAgent",T,X),De(T,S._40I),De(X,S._40I))},_22I:function(V){this._52I=V,this.fp("edgeGroup",!0,!1)},getEdgeGroup:function(){return this._52I},isEdgeGroupHidden:function(){var c=this;return c._52I&&c._52I.get(0)!==c&&!c.getStyle(vl)},getEdgeGroupSize:function(){return this._52I?this._52I.size():1},getEdgeGroupIndex:function(){return this._52I?this._52I.indexOf(this):0},isEdgeGroupAgent:function(){var v=this,E=v._52I;return E&&!v.getStyle(vl)&&E.size()>1&&v===E.get(0)},toggle:function(){var d=this._52I,c=!this.s(vl);d&&d.size()>1&&(d.each(function(m){m.s(vl,c)}),d.getSiblings().each(function(m){m!==d&&m.each(function(Z){Z.fp("edgeGroup",Q,m)})}))},setStyle:function(h,o){(h===Dc||"edge.segments"===h)&&(o=Br(o)),Ci.superClass.setStyle.call(this,h,o)},onStyleChanged:function(v){Ci.superClass.onStyleChanged.apply(this,arguments),Im[v]&&De(this._41I,this._40I)},getSerializableProperties:function(){var T=Ci.superClass.getSerializableProperties.call(this);return Bm(T,{source:1,target:1}),T}});var mf=R.Group=function(){ym(mf,this)};Ak("Group",hf,{_image:"group_image",_icon:"group_icon",_57O:!1,getUIClass:function(){return me},onChildAdded:function(){mf.superClass.onChildAdded.apply(this,arguments),this._81I()},onChildRemoved:function(){mf.superClass.onChildRemoved.apply(this,arguments),this._81I()},_81I:function(){var t=this;if(!t._54I&&!Yn){var U=t.getChildrenRect();U&&(t._53I=1,t.p(zb(t.s("group.position"),U,t.getSize())),delete t._53I)}},getChildrenRect:function(){var j,R=this;return R.eachChild(function(w){j=Ej(j,R.getChildRect(w))}),j},getChildRect:function(i){var p;return ph(i)&&i.s(Ab)&&(og(i)&&i.isExpanded()&&i.eachChild(function(r){p=Ej(p,i.getChildRect(r))}),!p&&i.getRect&&(p=i.getRect())),p},setPosition:function(f,Y){var J=this;if(!J._54I){var j;j=2===arguments.length?{x:f,y:Y}:f,Yn||J._53I||(J._54I=1,ip(J._children,j.x-J._position.x,j.y-J._position.y),delete J._54I),mf.superClass.setPosition.call(this,j)}},toggle:function(){this.setExpanded(!this.isExpanded())},isExpanded:function(){return this._57O},setExpanded:function(C){var c=this;if(c._57O!==C){var N=c._57O;c._57O=C,c.fp("expanded",N,c._57O),c._8I()}},_8I:function(){mf.superClass._8I.call(this),this.eachChild(function(x){ph(x)&&x._8I()})},onStyleChanged:function(h){mf.superClass.onStyleChanged.apply(this,arguments),"group.position"===h&&this._81I()},getSerializableProperties:function(){var v=mf.superClass.getSerializableProperties.call(this);return v.expanded=1,v}});var Wf=R.Block=function(){ym(Wf,this)};Ak("Block",hf,{_icon:"block_icon",_clickThroughEnabled:!1,_syncSize:!0,ms_ac:["clickThroughEnabled","syncSize"],getUIClass:function(){return wb},onChildAdded:function(){Wf.superClass.onChildAdded.apply(this,arguments),this.updateFromChildren()},onChildRemoved:function(){Wf.superClass.onChildRemoved.apply(this,arguments),this.updateFromChildren()},updateFromChildren:function(){var d=this;if(!Yn&&!d._updatingToChildren&&d._syncSize){var y,N,K,M,s,E=[],I=d.getRotation();if(d.eachChild(function(L){ph(L)&&E.push.apply(E,L.getCorners())}),E.length){d._updatingFromChildren=1;var L=$(-I),o=g(-I),A=1/0,j=-1/0,n=1/0,h=-1/0;for(M=0,s=E.length;s>M;M++)K=E[M],y=K.x,N=K.y,K.x=L*y-o*N,K.y=o*y+L*N,A=k(A,K.x),j=x(j,K.x),n=k(n,K.y),h=x(h,K.y);var i=d.getScale();d.setSize(q((j-A)/i.x),q((h-n)/i.y));var U;i.x<0&&(U=A,A=j,j=U),i.y<0&&(U=n,n=h,h=U),L=$(I),o=g(I);var w=d.getAnchor();y=A+(j-A)*w.x,N=n+(h-n)*w.y,d.setPosition(L*y-o*N,o*y+L*N),delete d._updatingFromChildren}}},setPosition:function(K,I){var x=this;if(!x._updatingToChildren){var V;V=2===arguments.length?{x:K,y:I}:K,Yn||x._updatingFromChildren||(x._updatingToChildren=1,ip(x._children,V.x-x._position.x,V.y-x._position.y),delete x._updatingToChildren),Wf.superClass.setPosition.call(this,V)}},setWidth:function(O){return this.setSize(O,this.getHeight())},setHeight:function(p){return this.setSize(this.getWidth(),p)},setSize:function(X,F){1>X&&(X=1),1>F&&(F=1);var W=this;if(!W._updatingToChildren){2!==arguments.length&&(F=X.height,X=X.width);var o=W.getWidth(),v=W.getHeight();if(X!==o&&Wf.superClass.setWidth.call(W,X),F!==v&&Wf.superClass.setHeight.call(W,F),!Yn&&!W._updatingFromChildren){W._updatingToChildren=1;var n=X/o,M=F/v;W._adjustChildScaleOrSize(n,M,"size"),delete W._updatingToChildren,W.updateFromChildren()}}},_adjustChildScaleOrSize:function(d,k,B){var W=this;if(W._syncSize){var A=W.getPosition(),Z=W.getRotation();W.getScale(),W.eachChild(function(n){if(ph(n)){var H=n.getPosition(),Q=n.getRotation(),y=n.getWidth(),W=n.getHeight(),L=n.getScale(),f=L.x*y,F=L.y*W,e=new Gm(Q,H.x,H.y,f,F);e.translate(-A.x,-A.y),e.rotate(-Z),Q=N(e.b*Math.sign(f),e.a*Math.sign(f)),e.scale(d,k);var u,q,w,E=$(Q);if(Math.abs(E)<.001?(u=g(Q),q=e.b/u,w=-e.c/u):(q=e.a/E,w=e.d/E),"scale"===B)n.setScale(q/y,w/W);else if("size"===B){var J=q/L.x,T=w/L.y;n.setScale(jk(q)*Math.abs(L.x),jk(w)*Math.abs(L.y)),n.setSize(Math.max(.1,Math.abs(J)),Math.max(.1,Math.abs(T)))}e.rotate(Z),e.translate(A.x,A.y),n.setPosition(e.tx,e.ty)}})}},_calcChangeFactor:function(c,P,N,Y){var n,O,L,B;return n=q(c),O=q(N),L=n>O?n/O:O/n,n=q(P),O=q(Y),B=n>O?n/O:O/n,x(L,B)},setAnchor:function(){var d=this;if(!d._updatingToChildren){var I=d.getAnchor();
if(Wf.superClass.setAnchor.apply(d,arguments),!Yn&&!d._updatingFromChildren&&d._syncSize){d._updatingToChildren=1;var P=d.getAnchor();d.getPosition();var x=d.getSize(),N=d.getScale(),D=d.getRotation(),F=-x.width*N.x*(I.x-P.x),b=-x.height*N.y*(I.y-P.y),E=g(D),p=$(D),h=p*F-E*b,S=E*F+p*b;d.eachChild(function(y){if(ph(y)){var d=y.getPosition();y.setPosition(d.x-h,d.y-S)}}),delete d._updatingToChildren}}},setRotation:function(g){var o=this;if(!o._updatingToChildren){var Q=o.getRotation();if(Wf.superClass.setRotation.apply(o,arguments),!Yn&&!o._updatingFromChildren){o._updatingToChildren=1;var X=o.getPosition(),L=g-Q;o.eachChild(function(z){if(ph(z)){var A=z.getMatrix();A.translate(-X.x,-X.y),A.rotate(L),A.translate(X.x,X.y);var k=Math.sign(z.getScale().x);z.setRotation(N(A.b*k,A.a*k)),z.setPosition(A.tx,A.ty)}}),delete o._updatingToChildren}}},setScale:function(e,j){var l=this;if(!l._updatingToChildren){null==j&&(j=e.y,e=e.x);var D=l.getScale();if(q(e)<.01&&(e=.01*(jk(e)||jk(D.x))),q(j)<.01&&(j=.01*(jk(j)||jk(D.y))),Wf.superClass.setScale.call(l,e,j),!Yn&&!l._updatingFromChildren){l._updatingToChildren=1;var P=e/D.x,t=j/D.y;l._adjustChildScaleOrSize(P,t,"size"),delete l._updatingToChildren,l.updateFromChildren()}}},getSerializableProperties:function(){var q=Wf.superClass.getSerializableProperties.call(this);return q.clickThroughEnabled=1,q.syncSize=1,q}});var Gc=R.Grid=function(){ym(R.Grid,this)};Ak("Grid",hf,{IRotatable:!1,_icon:"grid_icon",_image:Q,getUIClass:function(){return Mn},setRotation:function(){},getCellRect:function(s,R){var n=this,$=n.s("grid.row.count"),L=n.s("grid.column.count");if(0>=$||0>=L||0>s||s>=$||0>R||R>=L)return Q;var y,Z,l,F=n.getRect(),p=n.s("grid.row.percents"),W=n.s("grid.column.percents");if(Ib(F,n,"grid.border",-1),p&&p._as&&(p=p._as),W&&W._as&&(W=W._as),p&&p.length===$){for(l=0,y=0;s>y;y++)l+=F.height*p[y];F.y+=l,F.height=F.height*p[s]}else F.height=F.height/$,F.y+=F.height*s;if(W&&W.length===L){for(Z=0,y=0;R>y;y++)Z+=F.width*W[y];F.x+=Z,F.width=F.width*W[R]}else F.width=F.width/L,F.x+=F.width*R;return Id(F,-n.s("grid.gap")),F}});var Kq=R.Text=function(){ym(Kq,this),this.setSize(100,50),this.s("text","TEXT")};Ak("Text",hf,{_icon:"text_icon",_image:"__text__",getUIClass:function(){return Yr},setWidth:function(X){X||(X=.001),Kq.superClass.setWidth.call(this,X)},setHeight:function(s){s||(s=.001),Kq.superClass.setHeight.call(this,s)},toLabel:function(){return this._displayName||this._name||this.s("text")}}),Uj("__text__",{width:{value:100,isSafeFunc:!0,func:function(e){return e._width}},height:{value:50,isSafeFunc:!0,func:function(f){return f._height}},comps:[{type:"text",relative:!0,rect:[0,0,1,1],text:{func:"style@text"},align:{func:"style@text.align"},vAlign:{func:"style@text.vAlign"},color:{func:"style@text.color"},font:{func:"style@text.font"},shadow:{func:"style@text.shadow"},shadowColor:{func:"style@text.shadow.color"},shadowBlur:{func:"style@text.shadow.blur"},shadowOffsetX:{func:"style@text.shadow.offset.x"},shadowOffsetY:{func:"style@text.shadow.offset.y"}}]});var Bf=R.Shape=function(){ym(Bf,this),this._59O=new xg};Bf.__de__=af,Ak("Shape",hf,{ms_ac:["thickness","closePath"],_icon:"shape_icon",_thickness:10,_closePath:!1,getUIClass:function(){return Uf},_22Q:function(){return Ln},getLength:function(u){return Ol(fb(this._59O,this._58O,u,this._closePath))},getSegments:function(){return this._58O},toSegments:function(){var Q=this._58O;return Q?new xg(Q._as.slice(0)):Q},setSegments:function(U){var I=this._58O;U=U?sd(U)?new xg(U.slice(0)):new xg(U._as.slice(0)):null,(I&&U&&I._as.join(",")!==U._as.join(",")||I!==U)&&(this._58O=U,this.fp("segments",I,U))},getPoints:function(){return this._59O},toPoints:function(){var Z=this._59O;return new xg(Z._as.slice(0))},setPoints:function(P,e){var q=this,L=q._59O;P=P?sd(P)?new xg(P.slice(0)):new xg(P._as.slice(0)):new xg;var E,i,a,Q,p,B;e&&(E=q.getPosition(),B=new Gm(q.getRotation(),0,0,q.getScale().x,q.getScale().y)),(L&&P&&L._as.join(",")!==P._as.join(",")||L!==P)&&(q._59O=P,q.fs(),q.fp("points",L,P)),e&&(i=q.getPosition(),a=i.x-E.x,Q=i.y-E.y,p=B.tf(a,Q),q.setPosition(i.x-a+p.x,i.y-Q+p.y))},addPoint:function(P,E,z){var A=this.toPoints();A.add(P,E),this.setPoints(A,z)},setPoint:function(b,d,v){var M=this.toPoints();M.set(b,d),this.setPoints(M,v)},removePointAt:function(S){var m=this.toPoints();m.removeAt(S),this.setPoints(m)},setWidth:function(i){var h=this;if(1>i&&(i=1),!h._55I&&!Yn&&h.getWidth()){h._55I=1;var Z=h._position.x,t=i/h.getWidth(),s=h.toPoints(),x=new xg;s.each(function(N){x.add({x:(N.x-Z)*t+Z,y:N.y,e:N.e})}),h.setPoints(x),To(h,[t,0,0,1,Z*(1-t),0]),h.fs(),delete h._55I}Bf.superClass.setWidth.call(h,i)},setHeight:function(G){var O=this;if(1>G&&(G=1),!O._55I&&!Yn&&O.getHeight()){O._55I=1;var k=O._position.y,o=G/O.getHeight(),S=O.toPoints(),P=new xg;S.each(function(A){P.add({x:A.x,y:(A.y-k)*o+k,e:A.e})}),O.setPoints(P),To(O,[1,0,0,o,0,k*(1-o)]),O.fs(),delete O._55I}Bf.superClass.setHeight.call(O,G)},setAnchorElevation:function(W){var h=this;h._55I=!0;var w=h._updatingAnchor3d,s=!Yn&&!w;if(s){var j,p=W,l=h.getAnchorElevation(),Q=h.getTall();j=Q*(l-p),h.shiftPointsElevation(j)}var J=Bf.superClass.setAnchorElevation.apply(h,arguments);return w||delete h._55I,J},getShapeElevation:function(){var K=this,k=K._54O;return k-(K.getTall()||0)*(K._anchorElevation-.5)},setAnchor3d:function(c,G,I,S){var U,v=this;"number"==typeof c?U={x:c,y:G,z:I}:(U=c.length?{x:c[0],y:c[1],z:c[2]}:c,S=G),v._55I=!0,v._updatingAnchor3d=!0;var $=v.getDataModel();if($&&$.beginTransaction(),!Yn){var J=v.getAnchor3d(),x=v.getSize(),R=v.getTall(),s=x.width*(J.x-U.x),i=x.height*(J.z-U.z),K=R*(J.y-U.y);S||v.shiftPoints(s,i,K);var m=v.p3()}var M=Bf.superClass.setAnchor3d.apply(v,arguments);if(!Yn&&S){var Z=v.p3();v.shiftPoints(Z[0]-m[0]+s,Z[2]-m[2]+i,Z[1]-m[1]+K)}return $&&$.endTransaction(),delete v._updatingAnchor3d,delete v._55I,M},setAnchor:function(r,G,y){var I=this;I._55I=!0;var F=I._updatingAnchor3d,Y=!Yn&&!F;if(Y){var k,q,l;"number"==typeof r?l={x:r,y:G}:(l=r.length?{x:r[0],y:r[1]}:r,y=G);var f=I.getAnchor(),n=I.getSize();k=n.width*(f.x-l.x),q=n.height*(f.y-l.y),y||I.shiftPoints(k,q);var g=I.getPosition()}var u=Bf.superClass.setAnchor.apply(I,arguments);if(Y){var o=I.getPosition();y&&I.shiftPoints(o.x-g.x+k,o.y-g.y+q)}return F||delete I._55I,u},shiftPoints:function(Y,E,r){var P=this,M=P.getElevation()||0,Z=P.toPoints(),q=new xg;Z.each(function(Z){var P=Z.e;r&&(P=(P==Q?M:P)+r),q.add({x:Z.x+Y,y:Z.y+E,e:P})}),P.setPoints(q),P.fs()},shiftPointsElevation:function(z){return this.shiftPoints(0,0,z)},setPosition:function(w,c){var P,S=this;if(!S._28Q){if(S._28Q=1,!S._55I&&!Yn){P=2===arguments.length?{x:w,y:c}:w;var M=P.x-S._position.x,s=P.y-S._position.y;if(0===M&&0===s)return delete S._28Q,void 0;S._55I=1,S.shiftPoints(M,s),To(S,[1,0,0,1,M,s]),delete S._55I}Bf.superClass.setPosition.apply(S,arguments),delete S._28Q}},fs:function(){this.fireShapeChange()},_70I:function(){var X=this;if(2!==X._59O.size())return!1;var x=X._58O;return x?2===x.size()&&1===x.get(0)&&2===x.get(1)?!0:!1:!0},fireShapeChange:function(){var t=this;if(!t._55I&&!Yn){var L=mc(t._59O);L&&(t._55I=1,t.setRect(L),delete t._55I)}t.fp($r,!1,!0)},getSerializableProperties:function(){var k=Bf.superClass.getSerializableProperties.call(this);return k.segments=1,k.points=1,k.thickness=1,k.closePath=1,k}});var np=R.Polyline=function(){ym(np,this),this.s({"shape.background":null,"shape.border.width":2})};Ak("Polyline",Bf,{_icon:"polyline_icon",_22Q:function(){return Db},getUIClass:function(){return Xi},setClosePath:function(){},setTall:function(o){var X=this;if(!X._55I&&!X._24Q&&!Yn&&X.getTall()){X._24Q=1;var R=X._54O,K=o/X.getTall();X._59O.each(function(Y){Y.e=Y.e==Q?R:(Y.e-R)*K+R}),X.fs(),delete X._24Q}np.superClass.setTall.call(X,o)},setElevation:function(o){var S=this;if(!S._55I&&!S._24Q&&!Yn){S._24Q=1;var d=o-S._54O;S._59O.each(function(k){k.e==Q?k.e=o:k.e+=d}),S.fs(),delete S._24Q}np.superClass.setElevation.apply(S,arguments)},fireShapeChange:function(){var o=this,b=o._59O;if(!o._55I&&!o._24Q&&!Yn){var P=b.size();if(P){var e=1,X=b.get(0),F=o._54O;X.e==Q&&(X.e=F);for(var O=X.e,p=0;P>e;e++){X=b.get(e),X.e==Q&&(X.e=F);var g=k(O,X.e),G=x(O+p,X.e);O=g,p=G-g}o._24Q=1,o.setTall(p),o.setElevation(O+p*o._anchorElevation),delete o._24Q}}np.superClass.fireShapeChange.apply(o,arguments)}});var Qj=R.SubGraph=function(){ym(Qj,this)};Ak("SubGraph",hf,{ISubGraph:1,_image:"subGraph_image",_icon:"subGraph_icon",_8I:function(){Qj.superClass._8I.call(this),this.eachChild(function(n){ph(n)&&n._8I()})}}),p.loadingRefGraph=0;var vp=R.RefGraph=function(){ym(vp,this)};Ak("RefGraph",Wf,{_icon:"refGraph_icon",getRef:function(){return this._ref},setRef:function(d){var W=this._ref;this._ref=d,this.fp("ref",W,d),this.updateRef()},_21I:function(){vp.superClass._21I.apply(this,arguments),this.updateRef()},updateRef:function(){var i=this;if(p.loadingRefGraph++,i.clearChildrenFromDataModel(),p.loadingRefGraph--,i._ref&&i._dataModel){i._xhrLoadHandler&&(i._xhrLoadHandler.cancel=!0);var q=Yn,j=i._xhrLoadHandler=function(N){if(N&&i._dataModel){p.loadingRefGraph++;var $=i._pendingUpdateInfo={needToRestore:q};q&&($.position=i.p(),$.width=i.getWidth(),$.height=i.getHeight(),$.rotation=i.getRotation(),$.anchor=i.getAnchor(),$.scale=i.getScale()),i.p(0,0),i.setAnchor(.5,.5),i.setRotation(0),i.setScale(1,1);var Q=p.parse(N),E=i._dataModel.deserialize(Q,i,{justDatas:!0});E.each(function(b){b._refGraph=i}),i.checkPendingUpdateInfo(),p.loadingRefGraph--,p.handleRefGraphLoaded(i,E,Q)}};j.xhrLoadCalled=!1,p.load(i._ref,function(I){j.cancel||(j.xhrLoadCalled?j(I):Sq(function(){j(I)}))}),j.xhrLoadCalled=!0}},checkPendingUpdateInfo:function(){var s=this,c=s._pendingUpdateInfo;if(!c)return s.onPendingUpdated&&(p.loadingRefGraph++,s.onPendingUpdated(),p.loadingRefGraph--),void 0;var b=!0;this.eachChild(function(o){(o._pendingCheckImageJSON||o._pendingUpdateInfo)&&(b=!1)}),b&&(p.loadingRefGraph++,s._pendingUpdateInfo=null,s.updateFromChildren(),c.needToRestore&&(s.setSize(c.width,c.height),s.setAnchor(c.anchor),s.setRotation(c.rotation),s.setScale(c.scale),s.p(c.position)),this.getParent()instanceof vp&&this.getParent().checkPendingUpdateInfo(),s.onPendingUpdated&&s.onPendingUpdated(),p.loadingRefGraph--)},getSerializableProperties:function(){var d=vp.superClass.getSerializableProperties.call(this);return d.ref=1,d}}),R.EdgeGroup=function(b,l){this._70O=b,this._siblings=l;for(var O,o,Z=0,f=b.size(),C=e[vl];f>Z;Z++)if(O=b.get(Z).getStyle(vl,!1),O!=Q){C=O;break}C==Q&&(C=!0);var S=p.edgeGroupAgentFunc;for(S&&(o=S(b),o&&o!==b.get(0)&&(b.remove(o),b.add(o,0))),Z=0;f>Z;Z++)b.get(Z).s(vl,C)},Ak("EdgeGroup",_,{getEdges:function(){return this._70O},size:function(){return this._70O.size()},get:function(F){return this._70O.get(F)},indexOf:function(M){return this._70O.indexOf(M)},each:function(i,t){this._70O.each(i,t)},getSiblings:function(){return this._siblings},eachSiblingEdge:function(U,i){this._siblings.each(function(l){l._70O.each(U,i)})}});var ue=function(H,w,B){var T=bk[H]={type:H,action:w};if(B)for(var s in B)T[s]=B[s]};ue("host",function(n,s,m){m&&s.setHost(m)},{"delete":{visible:function(c,l){return l.getHost()},action:function(l,w){w.setHost(null)}}}),ue("parent",function(c,B,b){b&&B.setParent(b)},{"delete":{visible:function(E,L){return L.getParent()},action:function(A,C){C.setParent(null)}}}),ue("copySize",function(I,y,R){if(R){var E=R.getSize();y.setSize(E)}}),ue("copyRotation",function(I,y,u){if(u){var F=u.getRotation();y.setRotation(F)}}),ue("edge",function($,b,V){if(V){var a=new R.Edge(b,V);b.dm().add(a)}}),Bm(p,{setConnectAction:ue,getConnectAction:function(y,x){return x=x||y.getCurrentConnectActionType(),bk[x]},doConnectAction:function(T,V,e,Y){Y=Y||T.getCurrentConnectActionType();var B=bk[Y];if(!B)return!1;var J=B.action;return J?(J.call(null,T,V,e),!0):!1},doDeleteConnectionAction:function(k,y,F){F=F||k.getCurrentConnectActionType();var H=bk[F];if(!H||!H.delete)return!1;var V=H.delete.action;return V?(V.call(null,k,y),!0):!1}});var ab=R.JSONSerializer=function(F,c){this.dm=this._dataModel=F,this._hierarchical=p.forceHierarchicalSerialization?!0:c==Q?F.isHierarchicalRendering():c};Ak("JSONSerializer",_,{ms_ac:["hierarchical"],serialize:function(r){return p.stringify(this.toJSON(),r)},toJSON:function(){var O=this,E=O.dm,u=E.getRoots(),j=O.json={v:p.getVersion(),p:{},a:{},d:[]},D=E.getSerializableAttrs();E.getInit()&&(j.init=E.getInit()),E.getName()&&(j.p.name=E.getName()),E.getBackground()&&(j.p.background=E.getBackground()),E.getLayers()&&(j.p.layers=E.getLayers()),j.p.autoAdjustIndex=E.isAutoAdjustIndex(),j.p.hierarchicalRendering=E.isHierarchicalRendering();for(var c in D){var $=E.a(c);$!==i&&O[Ac](c,$,j.a)}return dj(j.a)&&delete j.a,O._hierarchical?u.each(O.serializeData,this):E.each(function(Y){O.serializeData(Y)}),j},isSerializable:function(){return!0},getProperties:function(X){return X.getSerializableProperties()},getStyles:function(T){return T.getSerializableStyles()},getAttrs:function(K){return K.getSerializableAttrs()},serializeData:function(N){var S=this;if(S.isSerializable(N)&&!N._refGraph){var K,M,v,x,E=Tg(N.getClassName())||N.getClass(),X=new E,t={c:N.getClassName(),i:N.getId(),p:{},s:{},a:{}};S.json.d.push(t),K=S.getProperties(N);for(M in K)/^_/.test(M)?(v=N[M],v!==X[M]&&S[Ac](M.substr(1),v,t.p)):(x=Zc(M),N[x]&&(v=N[x](),v!==X[x]()&&S[Ac](M,v,t.p)));K=S.getStyles(N);for(M in K)v=N.s(M),v!==X.s(M)&&S[Ac](M,v,t.s);K=S.getAttrs(N);for(M in K)v=N.a(M),v!==X.a(M)&&S[Ac](M,v,t.a);dj(t.p)&&delete t.p,dj(t.s)&&delete t.s,dj(t.a)&&delete t.a}S._hierarchical&&N.getChildren().each(S.serializeData,S)},serializeValue:function(U,M,q){yr(M)?M={__a:M._as}:M instanceof Sc&&(M={__i:M.getId()}),q[U]=M},deserialize:function(f,d,U){var O=this,s=O.dm;s.beginTransaction(),Yn++,U=dk(U)?{setId:U}:U||{},f=O.json=Pf(f)?p.parse(f):f,O._82I={};var t=new xg,Y=new xg,c=0,w=f.d.length;if(U.justDatas||(bb(f.init)&&f.init(s),s.setInit(f.init)),!U.justDatas){for(var q in f.a)s.a(q,O[Jf](f.a[q]));for(var m in f.p)s[db(m)](f.p[m])}for(;w>c;c++){var y=f.d[c],n=Tg(y.c),h=new n,W=y.i;U.setId&&W!=Q&&(h._id=W),O._82I[W]=h,t.add(h),Y.add(y)}for(c=0;w>c;c++)O.deserializeData(t.get(c),Y.get(c));return t.each(function(u){d&&!u.getParent()&&u.setParent(d),s.add(u)}),Yn--,s.endTransaction(),t},deserializeData:function(s,V){for(var Z in V.p)s[db(Z)](this[Jf](V.p[Z]));for(Z in V.s)s.s(Z,this[Jf](V.s[Z]));for(Z in V.a)s.a(Z,this[Jf](V.a[Z]))},deserializeValue:function(M){if(no(M)){var c=M.__i;if(c!=Q)return this._82I[c];if(c=M.__a,sd(c))return new xg(c)}return M}}),Bm(Se,{serialize:function(R,l){return new ab(this,l).serialize(R)},toJSON:function(L){return new ab(this,L).toJSON()},deserialize:function($,D,E){return new ab(this).deserialize($,D,E)}});var li=R.OverlappingBox=function(c){this.gv=c,this.boxes={}};Ak("OverlappingBox",_,{clear:function(){var h,i,t=this.boxes;for(h in t)i=t[h],i.length=0},isOverlapping:function(W,Q){var K,y,P=this,l=P.boxes,p=l[W];p?(K=p.rects,y=p.length):p=l[W]={rects:K=[],length:y=0};var $,z,Q;for($=0;y>$;$++)if(z=K[$],z.x<Q.x+Q.w&&z.x+z.w>Q.x&&z.y<Q.y+Q.h&&z.h+z.y>Q.y)return!0;return K.length<=y?(K.push(Q),p.length++):K[p.length++]=Q,!1}}),Ap.GraphView=function(k){var Y=this;Y._24I={},Y._34I=new xg,Y._25I={},Y._56I={},Y._view=Ro(1,Y),Y._canvas=yk(Y._view),Y.dm(k?k:new Se),this._coreInteractor=new Vf(this),Y.setEditable(!1),Y.setScrollBarVisible(p.graphViewScrollBarVisible)},_n("GraphView",_,{ms_v:1,ms_gv:1,ms_bnb:1,ms_tip:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,_52o:1,_51o:1,ms_ac:[_m,jd,$m,Xf,"resettable","editInteractor",Bn,"pannable","rectSelectable","autoScrollZone",wl,"movableFunc","editableFunc","pointEditableFunc","rectEditableFunc","rotationEditableFunc","anchorEditableFunc","rectSelectBackground","rectSelectBorderColor","editPointSize","editPointBorderColor","editPointBackground","hoverDelay"],_resettable:p.graphViewResettable,_pannable:p.graphViewPannable,_rectSelectable:p.graphViewRectSelectable,_autoScrollZone:p.graphViewAutoScrollZone,_rectSelectBackground:p.graphViewRectSelectBackground,_rectSelectBorderColor:p.graphViewRectSelectBorderColor,_editPointSize:p.graphViewEditPointSize,_editPointBorderColor:p.graphViewEditPointBorderColor,_editPointBackground:p.graphViewEditPointBackground,_scrollBarColor:Ul,_scrollBarSize:Ko,_autoHideScrollBar:Vq,_autoMakeVisible:Jg,_currentActionType:"host",getCoreInteractor:function(){return this._coreInteractor},getLayers:function(){return this._dataModel.getLayers()},setLayers:function(e){this._dataModel.setLayers(e)},setEditable:function(G){var T=this,I=T.__interactorMap__;if(!I){var k=Ap.XEditInteractor;I=T.__interactorMap__={scrollBar:new Dn(T),select:new Dq(T),edit:k?new k(T):new Le(T),move:new Yk(T),"default":new Xn(T),touch:new Bh(T,{editable:!1})}}G?(T._uieditable=!0,T.setInteractors([I.scrollBar,I.select,I.edit,I.move,I.default,I.touch])):(T._uieditable=!1,T.setInteractors([I.scrollBar,I.select,I.move,I.default,I.touch]))},getCanvas:function(){return this._canvas},_33I:function(P){var q=P.getUIClass();return q?new q(this,P):Q},getDataUI:function(A){var p=this,E=p._25I[A._id];return E===i&&(E=p._33I(A),p._25I[A._id]=E),E},getNodeRect:function(r){return p.getNodeRect(this,r)},getEdgeInfo:function(x){var Y=this.getDataUI(x);return Y?(Y._79o(),Y._78o):null},getEdgeSourcePosition:function(F){var w=this,l=w.getDataUI(F),f=l.s,u=l._data._40I;return Bj(w,u,f("edge.source.position"),f("edge.source.offset.x"),f("edge.source.offset.y"),f("edge.source.anchor.x"),f("edge.source.anchor.y"))},getEdgeTargetPosition:function(S){var l=this,t=l.getDataUI(S),v=t.s,D=t._data._41I;return Bj(l,D,v("edge.target.position"),v("edge.target.offset.x"),v("edge.target.offset.y"),v("edge.target.anchor.x"),v("edge.target.anchor.y"))},invalidateAll:function(I){var M=this;if(I){for(var F in M._25I){var i=M._25I[F];i&&i.dispose()}M._25I={},M._56I={},M._24I={},M._34I.clear(),M.redraw()}else M.dm().each(function(i){M.invalidateData(i)})},invalidateSelection:function(){var Y=this;Y.sm().each(function(n){Y.invalidateData(n)})},invalidateData:function(w){var H=this;H._24I[w._id]=w,H._21Q(w),H.iv()},_21Q:function(T){var U=this,q=U._24I;if(Wr(T)&&Rl[T.s(kr)]){var L=T.getSourceAgent();L&&L.getAgentEdges().each(function(i){q[i._id]=i}),L=T.getTargetAgent(),L&&L.getAgentEdges().each(function(T){q[T._id]=T}),U.iv()}},redraw:function(o){var q=this;q._32I||(o?q._34I.add(o):(q._32I=1,q._34I.clear()),q.iv())},each:function(q,X){var c,Q,I,z=0,V=this.getLayers(),W=this._dataModel,a=W._datas._as,B=a.length;if(V){for(var H=V.length;H>z;z++)if(I=V[z],no(I)&&(I=I.name),W.isHierarchicalRendering()){var F=function(v){return v._layer===I?X?q.call(X,v):q(v):void 0};if(this._dataModel.eachByHierarchical(F)===!1)return}else for(var Y=0;B>Y;Y++)if(c=a[Y],c._layer===I&&(Q=X?q.call(X,c):q(c),Q===!1))return}else if(W.isHierarchicalRendering())this._dataModel.eachByHierarchical(q,null,X);else for(;B>z;z++)if(c=a[z],Q=X?q.call(X,c):q(c),Q===!1)return},reverseEach:function(l,s){var R,y,n,T,u=this._dataModel,c=u._layers,o=u._datas._as,S=o.length;if(c){for(R=c.length-1;R>=0;R--)if(T=c[R],no(T)&&(T=T.name),u.isHierarchicalRendering()){var K=function(u){return u._layer===T?s?l.call(s,u):l(u):void 0};if(u.reverseEachByHierarchical(K)===!1)return}else for(var A=S-1;A>=0;A--)if(y=o[A],y._layer===T&&(n=s?l.call(s,y):l(y),n===!1))return}else if(u.isHierarchicalRendering())u.reverseEachByHierarchical(l,null,s);else for(R=S-1;R>=0;R--)if(y=o[R],n=s?l.call(s,y):l(y),n===!1)return},getViewRect:function(){return this._29I},getContentRect:function(){var M=this,D=M._84I;if(!D){var j=this.dm().a("width"),w=this.dm().a("height");j>0&&w>0?M._84I={x:0,y:0,width:j,height:w}:(M.each(function(O){M.isVisible(O)&&(D=Ej(D,M.getDataUIBounds(O)))}),M._84I=D?D:kg)}return M._84I},getScrollRect:function(){return Ej(this.getContentRect(),this._29I)},makeCenter:function(i,p,F){var v=this;if(!v.getWidth()||!v.getHeight())return F||Sq(v.centerData,v,[i,p,!0],500),void 0;v.makeVisible(i),v.validate();var T=v.getDataUIBounds(i);if(T){var Q=v.getWidth(),m=v.getHeight(),G=T.x+T.width/2,d=T.y+T.height/2,g=-G*v._zoom+Q/2,Z=-d*v._zoom+m/2;v.setTranslate(g,Z,p)}},fitData:function(e,A,G,T,U){var k=this;if(!k.getWidth()||!k.getHeight())return U||Sq(k.fitData,k,[e,A,G,T,!0],500),void 0;var c=function(){k.makeVisible(e),k.validate();var _=k.getDataUIBounds(e);_&&(_=Hp(_),Id(_,G==Q?20:G),k.fitRect(_,A,T))};A?p.callWhenLoaded(c):c()},fitContent:function(K,n,q,r){var u=this;if(!u.getWidth()||!u.getHeight())return r||Sq(u.fitContent,u,[K,n,q,!0],500),void 0;var F=function(){u.validate();var I=Hp(u.getContentRect());Id(I,n==Q?20:n),u.fitRect(I,K,q)};K?p.callWhenLoaded(F):F()},fitRect:function(G,h,r){var w=this,l=w.getWidth(),H=w.getHeight(),y=G.x+G.width/2,C=G.y+G.height/2,Q=k(l/G.width,H/G.height),$=w._zoom,z=-y*$+l/2,U=-C*$+H/2;0===Q||isNaN(Q)||(r&&(Q=k(1,Q)),h?w.setTranslate(z,U,{finishFunc:function(){w.setZoom(Q,h)}}):(w.setTranslate(z,U),w.setZoom(Q)))},toCanvas:function(d,N){N=N||this._zoom,this.validateImpl();var Y=this,w=Y.getContentRect();w.width||(w.width=10),w.height||(w.height=10);var h=yk(),m=w.x*N,b=w.y*N,U=w.width*N,G=w.height*N;vh(h,U,G,1);var J=ro(h);return d=d||this._dataModel.getBackground(),d&&nl(J,0,0,U,G,d),Np(J,-m,-b),J.scale(N,N),Y._42(J),J.restore(),h},toDataURL:function(k,g,O){return this.toCanvas(k,O).toDataURL(g||"image/png",1)},getClipBounds:function(){return this._74O},_42:function(z,M){var i,m,f=this;f._93db(z,M),f.each(function(N){f._56I[N._id]&&(i=f.getDataUI(N),i&&(m=i._79o(),R.HtmlNode&&N instanceof R.HtmlNode?i._42(z):(!M||tl(M,m))&&i._42(z)))}),f._92db(z,M)},validateImpl:function(){var T,t,v,O,D,X=this,Y=X.tx(),h=X.ty(),I=X._zoom,q=X._canvas,k=this.getWidth(),u=this.getHeight(),l=X._29I,S={x:-Y/I,y:-h/I,width:k/I,height:u/I},w={},y=X._34I,B=X._24I,n=X._32I,f=X._23I;X._24I={},(k!==q.clientWidth||u!==q.clientHeight)&&(vh(q,k,u),n=1),n||zm(S,l)||(n=1),X._29I=S,X.each(function(R){t=R._id;var O=w[t]=X.isVisible(R);O!==X._56I[t]&&(B[t]=R,v=X.getDataUI(B[t]),v&&v._84o(O),X._84o(R,O))},X);for(t in B)v=X.getDataUI(B[t]),v&&(!n&&X._56I[t]&&(D=v._79o(),D&&y.add(D)),v.invalidate()),X._83I=1;if(X._56I=w,!n)for(t in B)w[t]&&(v=X.getDataUI(B[t]),v&&(D=v._79o(),D&&y.add(D)));if(n?O=S:(y.each(function(s){tl(S,s)&&(O=Ej(O,s))}),O&&(Id(O,x(1,1/I)),O.x=K(O.x*I)/I,O.y=K(O.y*I)/I,O.width=G(O.width*I)/I,O.height=G(O.height*I)/I,O=Bb(S,O))),X._74O=O,O){T=ro(q);var J=O.x,$=O.y,i=O.width,W=O.height;J=Math.floor((J*I+Y)*Cc),$=Math.floor(($*I+h)*Cc),i=Math.ceil(i*I*Cc)+1,W=Math.ceil(W*I*Cc)+1,T.beginPath(),T.rect(J,$,i,W),T.clip(),T.clearRect(J,$,i,W),Hd(T,Y,h,I),X._42(T,O),T.restore(),delete X._74O}if(y.clear(),delete X._32I,f&&k>0&&u>0){var v=X.getDataUI(f);if(v){var D=v._79o(),m=X._29I,o=m.x,j=m.y,g=m.width,M=m.height,I=X._zoom;D&&!tl(D,m)&&(D.x+D.width<o&&X.tx(-D.x*I),D.x>o+g&&X.tx(-(D.x+D.width-g)*I),D.y+D.height<j&&X.ty(-D.y*I),D.y>j+M&&X.ty(-(D.y+D.height-M)*I))}delete X._23I}X._83I&&(delete X._83I,delete X._84I),X._98O(),dj(X._24I)||Sq(X.iv,X)},isScrollBarVisible:function(){return!!this._79O},setScrollBarVisible:function(q){var R=this;q!==R.isScrollBarVisible()&&(q?(Pe(R._view,R._79O=xq()),Pe(R._79O,R._27I=xq()),Pe(R._79O,R._28I=xq())):(qh(R._79O),delete R._79O,delete R._27I,delete R._28I),R.fp("scrollBarVisible",!q,q))},showScrollBar:function(){var F=this;F._79O&&(F._85I||(E(function(){F._86I()},Lr),F.iv()),F._85I=new Date)},_86I:function(){var w=this;if(w._85I){var m=new Date,L=m.getTime();L-w._85I.getTime()>=Lr?(delete w._85I,w.iv()):E(function(){w._86I()},Lr)}},_98O:function(){var h=this,j=this._27I,w=this._28I;if(h._79O){if(h._autoHideScrollBar&&!h._85I)return j.style.visibility=Kl,w.style.visibility=Kl,void 0;var $=h.getScrollBarColor(),t=h._zoom,R=h.getScrollBarSize(),O=h.getViewRect(),q=h.getScrollRect(),V=O.height*t,d=q.height*t,c=O.width*t-R-2,o=V*((O.y-q.y)*t/d),_=V*(V/d),z=j.style;d-.5>V?(Nd>_&&(o=o+_/2-Nd/2,0>o&&(o=0),o+Nd>V&&(o=V-Nd),_=Nd),Ae(j,c,o,R,_),z.visibility=ws,z.background=$,z.borderRadius=R/2+ib):z.visibility=Kl;var S=O.width*t,D=q.width*t,o=O.height*t-R-2,c=S*((O.x-q.x)*t/D),B=S*(S/D),z=w.style;D-.5>S?(Nd>B&&(c=c+B/2-Nd/2,0>c&&(c=0),c+Nd>S&&(c=S-Nd),B=Nd),Ae(w,c,o,B,R),z.visibility=ws,z.background=$,z.borderRadius=R/2+ib):z.visibility=Kl}},setDataModel:function(J){var H=this,i=H._dataModel,f=H._selectionModel;i!==J&&(i&&(i.ump(H.handleDataModelPropertyChange,H),i.umm(H.handleDataModelChange,H),i.umd(H.handleDataPropertyChange,H),i.removeIndexChangeListener(H._75O,H),i.removeHierarchyChangeListener(H.handleHierarchyChange,H),f||i.sm().ums(H.handleSelectionChange,H)),H._dataModel=J,J.mp(H.handleDataModelPropertyChange,H),J.mm(H.handleDataModelChange,H),J.md(H.handleDataPropertyChange,H),J.addIndexChangeListener(H._75O,H),J.addHierarchyChangeListener(H.handleHierarchyChange,H),f?f._21I(J):J.sm().ms(H.handleSelectionChange,H),H.invalidateAll(!0),H.fp(ag,i,J),H._canvas.style.background=J.getBackground()||"")},getLayersInfo:function(){if(this._layersInfo===i){var F=this.getLayers();F?(this._layersInfo={},F.forEach(function(W){var $=no(W)?W.name:W;this._layersInfo[$]=W},this)):this._layersInfo=null}return this._layersInfo},updateLayers:function(){this._layersInfo=i,this.invalidateSelection(),this.redraw()},handleDataModelPropertyChange:function(h){if("background"===h.property){var g=this._canvas.style.background,b=h.newValue||"";this._canvas.style.background=b,this.fp("canvasBackground",g,b)}else"a:width"===h.property||"a:height"===h.property?(this._83I=1,this.redraw()):"layers"===h.property?this.updateLayers():"hierarchicalRendering"===h.property&&this.redraw()},handleDataPropertyChange:function(r){this.dm().isHierarchicalRendering()&&"parent"===r.property&&r.data.hasChildren()&&this.redraw(),this.invalidateData(r.data)},onPropertyChanged:function(o){var s=this,E=o.property;if(s.redraw(),"zoom"===E){var i=s.sm().getSelection();i.size()&&i.each(function(q){q.invalidate()})}gb[E]?s.showScrollBar():E===Bn&&s.onCurrentSubGraphChanged(o)},onCurrentSubGraphChanged:function(){this.sm().cs(),this.reset()},handleDataModelChange:function(D){var U=this,S=D.kind,k=D.data;if(U._83I=1,"add"===S)U.invalidateData(k),Wr(k)&&k.getEdgeGroup()&&k.getEdgeGroup().eachSiblingEdge(U.invalidateData,U);else if(S===Qn){U._21Q(k);var R=k._id,v=U._25I[R];if(v){if(U._56I[R]){var m=v._79o();m&&U.redraw(m)}v.dispose(),delete U._25I[R],delete U._24I[R],delete U._56I[R]}k===U._currentSubGraph&&U.setCurrentSubGraph(Q)}else S===Kg&&(U.invalidateAll(!0),U.setCurrentSubGraph(Q))},_75O:function(L){this.invalidateData(L.data)},handleHierarchyChange:function(m){this.dm().isHierarchicalRendering()&&m.data.hasChildren()&&this.redraw(),this.invalidateData(m.data)},adjustIndex:function(v){var z=this;if(z.isVisible(v)){z.dm().beginTransaction();for(var h=v;h._parent&&z.isVisible(h._parent);)h=h._parent;h&&h!==v&&z._dataModel.adjustIndex(h),z._dataModel.adjustIndex(v),z.dm().endTransaction()}},getImage:function(n){return n.getImage?n.getImage():i},getSelectWidth:function(D){var L=Lq(this.getImage(D));return L&&Aq(L.disableSelectedBorder,D,this)?0:D.s("select.width")},getSelectColor:function(j){return j.s("select.color")},isSelectable:function(n){if(!this._clickThroughChecking&&n.getParent()instanceof Wf&&n.getParent().isSyncSize())return!1;var S=this.getLayersInfo();if(S){var T=S[n._layer];if(T&&T.selectable===!1)return!1}return n.s("2d.selectable")&&this.sm().isSelectable(n)},isMovable:function(S){var F=this;if(Wr(S)&&S.getStyle(kr)!==Ir)return!1;var l=this.getLayersInfo();if(l){var x=l[S._layer];if(x&&x.movable===!1)return!1}return S.s("2d.movable")?F._movableFunc?F._movableFunc(S):!0:!1},isEditable:function(H){var O=this;if(R._uiSerializing)return O._uieditable;if(!O._editInteractor||!O.isSelected(H))return!1;if(og(H)){var Z=O.getDataUI(H);if(!Z||Z._88I)return!1}if(Wr(H)&&H.getStyle(kr)!==Ir)return!1;var h=this.getLayersInfo();if(h){var N=h[H._layer];if(N&&N.editable===!1)return!1}return H.s("2d.editable")?O._editableFunc?O._editableFunc(H):!0:!1},handleDelete:function(){this._editInteractor&&(this._editInteractor.handleDelete?this._editInteractor.handleDelete():this.removeSelection())},isPointEditable:function(V){return ph(V)&&0!==V.getRotation()?!1:this._pointEditableFunc?this._pointEditableFunc(V):!0},isRectEditable:function(o){return this._rectEditableFunc?this._rectEditableFunc(o):!0},isAnchorEditable:function(t){return this._anchorEditableFunc?this._anchorEditableFunc(t):!0},isRotationEditable:function(G){return G.setRotation&&G.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(G):!0:!1},getRotationPoint:function(L){var o=L.getAnchor(),H=L.getScale(),y=this._zoom,Z=Xr(L.getRotation(),0,-L.getHeight()*H.y*o.y-(H.y<0?-1:1)*(sg?32:16)/y),W=L.p();return Z.x+=W.x,Z.y+=W.y,Z},getLogicalPoint:function(A){var e=this;return xs(A,e._canvas,e.tx(),e.ty(),e._zoom,e._zoom)},getSelectedDataAt:function(f){var J=this;return this.getDataAt(f,function(t){return J.isSelected(t)})},getDataInfoAt:function($,I,O){var q,j=this.lp($),S=this.getDataAt(j,I,O);if(S){var b=this.getDataUI(S);q={data:S,ui:b,point:j};var R=b._38o;if(R){var x=R.icons;for(var H in x){var D=x[H],n=R.rects[H];if(n)for(var p=Aq(D.names,S,this),G=p?p.length:0,c=n.rotation,A=G-1;A>=0;A--){var r=p[A],C=n[A];if(An(C,j,c))return q.part="icons",q.name=H,q.icon=r,q.rect=C,q.index=A,q.rotation=c,q}}}if(this.isNoteVisible(S)){if(b.note2Info&&An(b.note2Info.clickRect,j,Q,b.note2Info.scale))return q.part="note2",q;if(b.noteInfo&&An(b.noteInfo.clickRect,j,Q,b.noteInfo.scale))return q.part="note",q}if(this.isLabelVisible(S)){if(b.label2Info&&An(b.label2Info.rect,j,b.label2Info.rotation,b.label2Info.scale))return q.part="label2",q;if(b.labelInfo&&An(b.labelInfo.rect,j,b.labelInfo.rotation,b.labelInfo.scale))return q.part="label",q}if(S.isInRect&&S.isInRect(j))return q.part="body",q}return q},getDataAt:function(E,T,I){E.target&&(E=this.lp(E));var k,Y=this._zoom;return this.reverseEach(function(f){return(T?T(f):this.isSelectable(f))&&this.rectIntersects(f,Vb(E.x,E.y,I,Y))?(k=f,!1):void 0},this),k},getIconInfoAt:function(c,f){var W=this;if(c.target&&(c=W.lp(c)),f||(f=W.getDataAt(c)),f){var $=W.getDataUI(f);if($&&$._38o){var h,R=$._38o,q=new xg;for(h in R.icons)q.add(h);for(var O=q.size()-1;O>=0;O--){h=q.get(O);for(var H=R.rects[h],o=H.rotation,C=H.length-1;C>=0;C--){var u=H[C],r=u.width,i=u.height,X={x:c.x-u.x-r/2,y:c.y-u.y-i/2};o!=Q&&(X=Xr(-o,X.x,X.y));var u={x:-r/2,y:-i/2,width:r,height:i};if(An(u,X))return{key:h,index:C,name:R.icons[h].names[C],rect:H[C],point:c,rotation:o,relativeRect:u,relativePoint:X,data:f}}}}}return Q},getDatasInRect:function(F,I,K){K===i&&(K=1);var H=this,V=new xg;return H.reverseEach(function(X){K&&!H.isSelectable(X)||(I?H.rectIntersects(X,F):H.rectContains(X,F))&&V.add(X)}),V},moveSelection:function(g,b){var s=this;s.dm().beginTransaction(),ip(s.sm().toSelection(s.isMovable,s),g,b),s.dm().endTransaction()},moveDatas:function(k,f,R){var w=this;w.dm().beginTransaction(),k instanceof xg||(k=new xg(k)),ip(k,f,R),w.dm().endTransaction()},getDataUIBounds:function(H){var X=this.getDataUI(H);return X?X._79o():Q},drawData:function(X,q){var b=this.getDataUI(q);b&&(b._79o(),b._42(X)),q instanceof R.Block&&q.eachChild(function(O){this.drawData(X,O)},this)},getBoundsForGroup:function(N){return N.s(Ab)?this.getDataUIBounds(N):Q},rectIntersects:function(x,_){this.validate();var v=Q;if(this._56I[x._id]){var g=this._25I[x._id];if(g){var y=g._79o();if(_e(_,y))v=!0;else if((_=Bb(_,y))&&(g.rectIntersects&&(v=g.rectIntersects(_)),v==Q)){if(!x.s("pixelPerfect"))return!0;var N=_.x,G=_.y,E=_.width,q=_.height,F=this._zoom,l=p.hitMaxArea,S=E*q*F*F;if(S>l){var X=Math.sqrt(l/S);F*=X}E*=F,q*=F,2>E&&(E=2),2>q&&(q=2),N*=F,G*=F;var n=tp(E,q);Np(n,-N,-G),n.scale(F,F),this._drawForChecking=!0,this.drawData(n,x),this._drawForChecking=!1;try{for(var w=0,c=n.getImageData(0,0,E,q).data;w<c.length;w+=4)if(0!==c[w+3]){v=!0;break}n.restore()}catch(A){lk=Q,v=!1}}}}return v?!0:!1},rectContains:function(a,l){if(this._56I[a._id]){var G=this._25I[a._id];if(G)return _e(l,G._79o())
}return!1},reset:function(){this.setZoom(1),this.setTranslate(0,0)},handleKeyDown:function(d){if(!p.isInput(d.target)){var y=this,m=y._focusData,v=m&&y._25I[m._id],I=0,k=y._dataModel._datas;if(!(m&&m._enabled&&m._editable&&v&&v.onKeyDown&&v.onKeyDown(d)===!0))if(9===d.keyCode&&(m&&(I=k.indexOf(m),sb(d)?-1===--I&&(I=0):++I===k.size()&&(I=0)),y._focusData=m=k.get(I),y.sm().setSelection(m)),Fp(d)?y.selectAll():mo(d)&&y.isResettable()&&y.reset(),y.sm().isEmpty()){if(y._editing)return;var N=y.tx(),Q=y.ty(),Y=!1,Z=sb()?100:10;Ao(d)&&(N-=Z,Y=!0),Yf(d)&&(Q-=Z,Y=!0),ts(d)&&(N+=Z,Y=!0),en(d)&&(Q+=Z,Y=!0),Y&&y.setTranslate(N,Q)}else{Zm(d)&&y.handleDelete(d);var F=sb()?10:1;Ao(d)&&(y.moveSelection(-F,0),y.fi({kind:"moveLeft"})),Yf(d)&&(y.moveSelection(0,-F),y.fi({kind:"moveUp"})),ts(d)&&(y.moveSelection(F,0),y.fi({kind:"moveRight"})),en(d)&&(y.moveSelection(0,F),y.fi({kind:"moveDown"}))}}},handleScroll:function(h,U){Hm(h);var J=this.lp(h);U>0?this.scrollZoomIn(J):0>U&&this.scrollZoomOut(J)},handlePinch:function(P,z,Z){this._68I||(z>Z?this.pinchZoomIn(P):this.pinchZoomOut(P))},checkDoubleClickOnNote:function(S,z){var h=this,b=h.lp(S),u=h.getDataUI(z),g=u.note2Info;return g&&z.s("note2.toggleable")&&An(g.clickRect,b)?(z.s(dm,!z.s(dm)),h.fi({kind:"toggleNote2",event:S,data:z}),!0):(g=u.noteInfo,g&&z.s("note.toggleable")&&An(g.clickRect,b)?(z.s($i,!z.s($i)),h.fi({kind:"toggleNote",event:S,data:z}),!0):!1)},_84o:function(){},isNoteVisible:function(){return this._zoom>.15},isLabelVisible:function(){return this._zoom>.15},isEditVisible:function(){return this._zoom>.15},autoScroll:function(a,j){var R=this,N=R.getAutoScrollZone(),r=N/R.getZoom(),P=N/4,F=R._29I,y=R.lp(a),c={x:R.tx(),y:R.ty()};return y&&N>0&&F&&(y.x-F.x<r?R.translate(P,0):F.x+F.width-y.x<r&&R.translate(-P,0),y.y-F.y<r?R.translate(0,P):F.y+F.height-y.y<r&&R.translate(0,-P)),c.x=R.tx()-c.x,c.y=R.ty()-c.y,j&&(j.x+=c.x,j.y+=c.y),c},getMoveMode:function(_,Z){var r=Z.s("2d.move.mode");return r?r:ds["88"]?"x":ds["89"]?"y":"xy"},getSerializableProperties:function(){return{scrollBarColor:1,scrollBarSize:1,autoMakeVisible:1,autoHideScrollBar:1,editable:1,resettable:1,pannable:1,rectSelectable:1,autoScrollZone:1,visibleFunc:1,movableFunc:1,editableFunc:1,pointEditableFunc:1,rectEditableFunc:1,anchorEditableFunc:1,rotationEditableFunc:1,rectSelectBackground:1,rectSelectBorderColor:1,editPointSize:1,editPointBorderColor:1,editPointBackground:1,hoverDelay:1,dataModel:1,selectionModel:1,currentSubGraph:1,zoom:1,translateX:1,translateY:1}},serializeProperty:function(f,R,V){var W=this;return"currentSubGraph"===R?{__i:f.getId()}:V.serializeProperty(f,R,W)},deserializeProperty:function(m,u,h){var s=this;if("currentSubGraph"===u){var r=s.dm(),N=r.__idMap;return N[m.__i]}return h.deserializeProperty(m,u,s)},setDefaultCursor:function(I,S){this._defaultCursor=I,S!==!1&&this.setCursor(I)},setCursor:function(P){"default"===P&&(P=this._defaultCursor||P);var d=this.getView().style;d.cursor=P,d.cursor="-webkit-"+P,d.cursor="-moz-"+P},getCurrentConnectActionType:function(){return this._currentActionType},setCurrentConnectActionType:function(c){return p.getConnectAction(null,c)?(this._currentActionType=c,!0):!1},isInteractive:function(s){return s.s("interactive")}});var _b=function(i,m){var w=this;w.gv=i,w.s=function(x){return m.getStyle(x)},w._data=m,w._87I=new xg};jh(_b,_,{_6I:Q,ms_icons:1,_84o:function(){},dispose:function(){},isShadowed:function(){return this.s("shadow")||this.gv.isSelected(this._data)&&"shadow"===this.s("select.type")},getSelectWidth:function(){var e=this,S=e.gv.isSelected(e._data);return!S||e.isShadowed()?0:e.gv.getSelectWidth(e._data)},getSelectColor:function(){return this.gv.getSelectColor(this._data)},getBodyColor:function(n){var T=this._data,w=this.gv.getBodyColor(T);return w?w:n?T.getStyle(n):Q},_2Q:function(Z){return this.s(Z)},_1Q:function(u,y,k,j){var c=this.s,K=c(y+".dash.color");u.strokeStyle=K,u.lineWidth=k,u.stroke(),c(y+".dash.3d")&&Hr(u,K,c(y+".dash.3d.color"),k,this.gv._zoom,c(y+".dash.3d.accuracy")),cg(u,j)},invalidate:function(){this._6I=Q},_79o:function(){var E=this;if(!E._6I){var D=E._data,p=E.gv;E.labelInfo=E.label2Info=E.noteInfo=E.note2Info=E._38o=Q,E._87I.clear(),E.interactiveInfo=p.isInteractive(D)?{}:Q,E._3O(),E._55O=p.isEditable(D)?{_42O:p.isRectEditable(D),_43O:p.isPointEditable(D),_56O:p.isRotationEditable(D)}:Q,E._6I=E._81o()}return E._6I},_3O:function(){},getPosition:function(){return kg},_68o:function(o,H){o&&this._87I.add(Nm(o,H))},_81o:function(){var L=this,u=L.s;L._24O(rq,"getLabel"),L._24O(tj,"getLabel2"),L._26O(Fr,"getNote"),L._26O(eg,"getNote2"),L._15O(),L._55O&&L._48O();var S;if(L._87I.each(function(j){S=Ej(S,j)}),S&&L.isShadowed()){var $=Hp(S);$.x+=u("shadow.offset.x"),$.y+=u("shadow.offset.y"),Id($,u("shadow.blur")),S=Ej(S,$)}return L._87I.clear(),S},_42:function(Y){var D=this,d=D._data,j=D.gv,r=D.s,T=r("opacity"),L=this.isShadowed();if(L){var e=Y.shadowOffsetX,C=Y.shadowOffsetY,S=Y.shadowBlur,y=Y.shadowColor,E=j.getZoom();Y.shadowOffsetX=r("shadow.offset.x")*E,Y.shadowOffsetY=r("shadow.offset.y")*E,Y.shadowBlur=r("shadow.blur")*E,Y.shadowColor=D.getSelectColor()}if(T!=Q){var k=Y.globalAlpha;Y.globalAlpha=T}D._80o(Y),j.isLabelVisible(d)&&((!j._drawForChecking||r("label.selectable"))&&ao(Y,D.labelInfo),(!j._drawForChecking||r("label2.selectable"))&&ao(Y,D.label2Info)),j.isNoteVisible(d)&&(io(Y,D.noteInfo),io(Y,D.note2Info)),D._99O(Y),T!=Q&&(Y.globalAlpha=k),L&&(Y.shadowOffsetX=e,Y.shadowOffsetY=C,Y.shadowBlur=S,Y.shadowColor=y)},_80o:function(){},_47O:function(){},_24O:function(g,F){var W=this,h=W._data,a=W.gv,z=W.s,Z=a[F](h);if(Z!=Q){var S=z(g+".scale"),l=z(g+".max"),u=z(g+".position"),m=W[g+"Info"]={label:Z,scale:S,color:a[F+"Color"](h),font:z(g+".font"),opacity:z(g+".opacity"),align:z(g+".align"),rotation:W.getRotation(z(g+".rotation"),!1,u),background:a[F+"Background"](h)},n=Mr(m,Z);l>0&&l<n.width&&(m.labelWidth=n.width,n.width=l),1!==S&&(n.width*=S,n.height*=S);var T=W.getPosition(u,z(g+".offset.x"),z(g+".offset.y"),n,z(g+".position.fixed"));if(n.x=T.x-n.width/2,n.y=T.y-n.height/2,W._68o(m.rect=n,m.rotation),1!==S){var d=n.width/S,A=n.height/S;m.rect={x:T.x-d/2,y:T.y-A/2,width:d,height:A}}}},_26O:function(w,t){var z=this,j=z.gv,J=z._data,d=z.s,U=j[t](J);if(U!=Q){var b,s,O=d(w+".scale"),F=z[w+"Info"]={note:U,scale:O,data:J,view:j,expanded:d(w+".expanded"),font:d(w+".font"),color:d(w+".color"),opacity:d(w+".opacity"),align:d(w+".align"),icon:d(w+".icon"),backgroundImage:d(w+".backgroundImage"),borderWidth:d(w+".border.width"),borderColor:d(w+".border.color"),background:j[t+"Background"](J)},X=z.getPosition(d(w+".position"),d(w+".offset.x"),d(w+".offset.y")),C=X.x,R=X.y;if(F.expanded){var v,Z=d(w+".max"),q=d(w+".backgroundImage");q?(q=Lq(q),v={width:ki(q,J),height:Xe(q,J)}):v=Mr(F,U),v.width+=6,v.height+=2,Z>0&&Z<v.width&&(F.labelWidth=v.width,v.width=Z),b=v.width,s=v.height+8,F.clickRect={x:C-b*O/2,y:R-s*O,width:b*O,height:s*O*v.height/s}}else{var E=d(w+".icon");E?(E=Lq(E),b=ki(E,J),s=Xe(E,J)):(b=12,s=18),F.clickRect={x:C-b*O/2,y:R-s*O,width:b*O,height:s*O}}F.rect={x:C-b/2,y:R-s*O/2-s/2,width:b,height:s};var y=G(F.borderWidth/2)*O;z._68o({x:C-b*O/2-y,y:R-s*O-y,width:b*O+2*y,height:s*O+2*y})}},_48O:function(){},_99O:function(b){var d=this,g=d._38o;if(g){var k=d.gv,Y=d._data,F=g.icons,i=d.interactiveInfo;i&&(i._38o={});for(var J in F){var r=F[J],G=g.rects[J];if(G){i&&(i._38o[J]=[]);var n=Aq(r.opacity,Y,k),V=Aq(r.names,Y,k),l=V?V.length:0,H=G.rotation;if(n!=Q){var B=b.globalAlpha;b.globalAlpha*=n}for(var D=0;l>D;D++){var C=V[D],R=Lq(C),p=G[D];if(H){var v=p.x+p.width/2,Z=p.y+p.height/2;b.save(),Np(b,v,Z),ef(b,H),Np(b,-v,-Z)}i&&i._38o[J].push(b.interactiveInfo={compInfos:[],stacks:H?[{t:[v,Z]},{r:H},{t:[-v,-Z]}]:[]}),Cq(b,R,Aq(r.stretch,Y,k),p.x,p.y,p.width,p.height,d._data,d.gv),b.interactiveInfo=Q,H&&b.restore()}n!=Q&&(b.globalAlpha=B)}}}}});var go=function(q,K){ym(go,this,[q,K])};jh(go,_b,{_checkEmptyRect:!0,_40O:function(S,n){var l=this,w=l.s,D=S.rect;(S.borderColor=l.gv.getBorderColor(l._data))&&(S.borderType=w("border.type"),S.borderWidth=w("border.width"),S.borderPadding=w("border.padding"),n=x(n,S.borderPadding+S.borderWidth/2));var N=l._data.getScale(),G=x(1,x(q(N.x),q(N.y)));if(S.selectWidth=l.getSelectWidth()){var k=l.gv._zoom;S.selectType=w("select.type"),S._97o=l.getSelectColor(),S.selectPadding=w("select.padding"),n=x(n,(S.selectPadding+S.selectWidth/2/k)/G)}n>0&&(n*=G,D=Hp(D),Id(D,n)),l._68o(D)},_39O:function(z,s){var r,D=this,m=s.rect;if(s.borderWidth>0&&(r=s.borderPadding,z.strokeStyle=s.borderColor,z.lineWidth=s.borderWidth,Og(z,s.borderType,{x:m.x-r,y:m.y-r,width:m.width+2*r,height:m.height+2*r}),z.stroke()),s.selectWidth>0){var Z=D.gv._zoom;if(r=s.selectPadding,z.strokeStyle=s._97o,z.lineWidth=s.selectWidth/Z,s.rotation!=Q){z.save(),z.translate(s.position.x,s.position.y),z.rotate(s.rotation);var A=D._data,O=A.getWidth(),H=A.getHeight(),v=s.scale,K=s.anchor;m={x:v.x*-O*K.x,y:v.y*-H*K.y,width:v.x*O,height:v.y*H}}Og(z,s.selectType,{x:m.x-r,y:m.y-r,width:m.width+2*r,height:m.height+2*r}),s.rotation!=Q&&z.restore(),z.stroke()}},_3O:function(){var J=this,E=J.s,F=J._data,S=F.getStyle($r),M=J.getBodyColor(),j=J._83o=S?{shape:S,_53o:J.getBodyColor("shape.background"),_27Q:Lq(E("shape.repeat.image"),M),shapeGradientPack:E("shape.gradient.pack"),_54o:E("shape.border.width"),_55o:E("shape.border.color"),_56o:E("shape.border.3d"),_57o:E("shape.border.3d.color"),_58o:E("shape.border.3d.accuracy"),shapeGradient:E("shape.gradient"),_59o:E("shape.gradient.color"),_60o:E("shape.border.pattern"),_61o:E("shape.border.cap"),_62o:E("shape.border.join"),bodyColor:M}:{img:Lq(J.gv.getImage(F),M),bodyColor:M,stretch:E("image.stretch")};if(a&&!Z);else{j.rect=F.getRect(),j.position=F.p(),j.scale=F.getScale(),j.anchor=F.getAnchor(),j.rotation=F.getRotation(),S===qo&&(j._63o=E("shape.depth"));var D=0;if(S)D=ob(Q,j._54o/2,j._62o),J.s("shape.dash")&&(D=x(D,(J.s("shape.dash.width")||j._54o)/2));else if(j.img&&j.img.boundExtend)if(D=Aq(j.img.boundExtend,F,J.gv),j.img.boundExtendAbsolute){var u=F.getScale();D/=J.gv._zoom*x(1,x(q(u.x),q(u.y)))}else if(!Aq(j.img.fitSize,F,J.gv)){var Y=Aq(j.img.width,F,J.gv),o=Aq(j.img.height,F,J.gv);D*=x(F.getWidth()/Y,F.getHeight()/o)}J._40O(j,D);var n=E("clip.percentage");if(1>n&&(0>n&&(n=0),j.clipRect=Xg(F.getAnchorRect(),E("clip.direction"),n)),S){var U=E("shape.fill.clip.percentage");1>U&&(0>U&&(U=0),j.shapeClipRect=Xg(F.getAnchorRect(),E("shape.fill.clip.direction"),U))}}},getPosition:function(l,L,$,V){var Y=zb(l,this._83o.rect,V);return Y.x+=L,Y.y+=$,Y},_80o:function(q){var t=this,V=t.s,E=t.gv,U=t._data,e=t._83o,o=e.rect,v=e.position,X=e.rotation,b=e.anchor,r=e.scale,z=e.shape,m=e.clipRect;if(!t._checkEmptyRect||o.width>0&&o.height>0){var P=U.getSize();if(P.x=-P.width*b.x,P.y=-P.height*b.y,q.save(),Np(q,v.x,v.y),ef(q,X),rb(q,r.x,r.y),m&&(q.beginPath(),q.rect(m.x,m.y,m.width,m.height),q.clip()),t.freeDraw)t.freeDraw(q,P,e);else if(z){var $,j,Y,N,p=e._60o,T=bf(q,p),w=e._53o,R=e._27Q,h=e._54o,D=e._55o,J=e.shapeGradientPack,l=q.lineJoin,F=q.lineCap;if("roundRect"===z?$=V("shape.corner.radius"):"polygon"===z?$=V("shape.polygon.side"):"arc"===z&&($=V("shape.arc.from"),j=V("shape.arc.to"),Y=V("shape.arc.close"),N=V("shape.arc.oval")),q.lineJoin=e._62o,q.lineCap=e._61o,w||R||J){var y=e.shapeClipRect;y&&(q.save(),q.beginPath(),q.rect(y.x,y.y,y.width,y.height),q.clip()),Og(q,z,P,$,j,Y,N),J?Pd(q,J):R?xb(q,R,e.bodyColor,null,U,E):yj(q,w,e.shapeGradient,e._59o,P),q.fill(),y&&q.restore(),J&&q.restore(),q!==T&&Og(T,z,P,$,j,Y,N)}else Og(T,z,P,$,j,Y,N);if(h>0){var k=V("shape.border.width.absolute");k&&(q.save(),q.setTransform(1,0,0,1,0,0)),q.lineWidth=h,q.strokeStyle=D,q.stroke(),k&&q.restore(),e._56o&&Hr(q,D,e._57o,h,E._zoom,e._58o)}if(cg(q,p),V("shape.dash")){var g=V("shape.dash.width")||h;if(g>0){p=V("shape.dash.pattern");var T=bf(q,p,t._2Q("shape.dash.offset"));T!==q&&Og(T,z,P,$,j,Y,N),t._1Q(q,"shape",g,p)}}Nn(q,w,e._63o,P),q.lineJoin=l,q.lineCap=F}else{var I=t.interactiveInfo;I&&(q.interactiveInfo=I.bodyInfo={compInfos:[],stacks:[{t:[v.x,v.y]},{r:X},{s:[r.x,r.y]}]}),Cq(q,e.img,e.stretch,P.x,P.y,P.width,P.height,U,E,e.bodyColor),q.interactiveInfo=Q}q.restore()}t._39O(q,e)},_48O:function(){},_47O:function(){}});var Wc=function(g,D){ym(Wc,this,[g,D])},fc=function(R,C,g,m){var T=Vc(R,C);return g=m?k(g,T):_q(g,T),T?g/=T:g=0,{x:R.x+(C.x-R.x)*g,y:R.y+(C.y-R.y)*g}};jh(Wc,_b,{_3O:function(){var V,g=this,c=g._data,l=g.gv,H=g.s,y=H(kr),Y=c.isLooped(),$=H("edge.width"),n=H("edge.center"),F=H("edge.offset"),e=l.getBorderColor(c),P=e?H("border.width"):0,r=g.getSelectWidth(),O=c._40I,t=c._41I,X=g._78o=O&&t?{looped:Y,type:y,width:$,center:n,color:g.getBodyColor("edge.color"),borderColor:e,borderWidth:P,_97o:r?g.getSelectColor():Q,selectWidth:r,pattern:H("edge.pattern"),cap:H("edge.cap"),join:H("edge.join"),is3d:H("edge.3d"),_67o:H("edge.3d.color"),_66o:H("edge.3d.accuracy")}:Q;if(X){var J=p.getEdgeType(y);if(J){var u=J(c,Aj(g,l,c,Y,y),l,g._19Q);u.points&&u.points.size()>1?(X.edgeTypeInfo=u,V=mc(X.edgeTypeInfo.points)):u[Bl]&&u.rect&&(X.edgeTypeInfo=u,V=u.rect)}else{var E=H("edge.source.anchor.x"),a=H("edge.source.anchor.y"),M=H("edge.target.anchor.x"),C=H("edge.target.anchor.y"),v=Bj(l,O,H("edge.source.position"),H("edge.source.offset.x"),H("edge.source.offset.y"),E,a),L=Bj(l,t,H("edge.target.position"),H("edge.target.offset.x"),H("edge.target.offset.y"),M,C);if(y===Ir){var Z=X.points=H(Dc)||os,B=Z.size();X.segments=H("edge.segments");var _=E!==i||a!==i,K=M!==i||C!==i;if(!n)if(F)_||(v=fc(v,B?Z.get(0):L,F,B)),K||(L=fc(L,B?Z.get(B-1):v,F,B));else{var S;_||(S=Zg(v,B?Z.get(0):L,$j(l,O)),S&&(v={x:S[0],y:S[1]})),K||(S=Zg(B?Z.get(B-1):v,L,$j(l,t)),S&&(L={x:S[0],y:S[1]}))}V=Ej(mc(X.points),mc(v,L))}else{var W=Aj(g,l,c,Y,y);if(g._19Q||(W=-W),Y)v=Hp(v),v.x=l.getNodeRect(O).x,X.radius=W,V={x:v.x-W,y:v.y-W,width:2*W,height:2*W};else{var h=Vc(v,L),j=_q(F,h),o={x:j,y:W},I={x:h-j,y:W},T=N(L.y-v.y,L.x-v.x),k=X.mat=new Gm(T);if(X.orienAngle=T,X.angle=L.x<v.x?T+s:T,X.rect={x:o.x,y:o.y,width:I.x-o.x,height:0},X.origin=v,o=k.tf(o),o.x+=v.x,o.y+=v.y,I=k.tf(I),I.x+=v.x,I.y+=v.y,n){var G={x:h,y:0};G=k.tf(G),G.x+=v.x,G.y+=v.y,V=mc([v,o,I,G]),X.c1=v,X.c2=G}else V=mc(o,I);v=o,L=I}}X.sourcePoint=v,X.targetPoint=L,c._lastSourcePoint=v,c._lastTargetPoint=L}var q=0;H("edge.dash")&&(q=H("edge.dash.width")||$);var b="square"===X.cap?.71:.5;ob(V,x(q*b,$*b+P+r),X.join),g._68o(V)}},getRotation:function(d,u,B){d=d||0;var r=this._78o;if(r){var Y,v=r.angle,I=r.points,e=r.edgeTypeInfo;if(v!=Q)return u?r.orienAngle+d:v+d;if(e&&e[Bl])return e.getRotation?e.getRotation(this,d,u,B):0;if(e&&e.points){var w=e.points;return Y=w.size(),Ag[B]?Y&&0===Y%2?Ck(w.get(Y/2-1),w.get(Y/2),u,d):d:oo[B]?Ck(w.get(0),w.get(1),u,d):Ck(w.get(Y-2),w.get(Y-1),u,d)}if(I)return Y=I.size(),Ag[B]?Y&&0===Y%2?Ck(I.get(Y/2-1),I.get(Y/2),u,d):d:oo[B]?Ck(r.sourcePoint,Y?I.get(0):r.targetPoint,u,d):Ck(Y?I.get(Y-1):r.sourcePoint,r.targetPoint,u,d)}return d},getPosition:function(s,i,O,x,k){var f=this._78o;if(f){var z,K=f.type,e=f.points,$=f.edgeTypeInfo,g=f.sourcePoint,D=f.targetPoint;if(!K)return f.looped?{x:g.x-f.radius+i,y:g.y+O}:(k&&g&&D&&(g.x>D.x||g.x===D.x&&g.y>D.y)&&(s=Rr[s],O=-O),z=zb(s,f.rect,x),z.x+=i,z.y+=O,z=f.mat.tf(z),z.x+=f.origin.x,z.y+=f.origin.y,z);if($&&$[Bl])return $.getPosition?$.getPosition(this,s,i,O,x,k):{x:(g.x+D.x)/2,y:(g.y+D.y)/2};if(e){var z,c=e.size();if(Ag[s]){if(c){var y=c%2;if(0===y)return Om(e.get(c/2-1),e.get(c/2),s,i,O,x,k);z=e.get((c-y)/2)}else z={x:(g.x+D.x)/2,y:(g.y+D.y)/2};return z=zb(s,{x:z.x,y:z.y,width:0,height:0},x),z.x+=i,z.y+=O,z}return oo[s]?Om(g,c?e.get(0):D,s,i,O,x,k):Om(c?e.get(c-1):g,D,s,i,O,x,k)}if($){var J=$.points,c=J.size();if(Ag[s]){var y=c%2;return 0===y?Om(J.get(c/2-1),J.get(c/2),s,i,O,x,k):(z=J.get((c-y)/2),z=zb(s,{x:z.x,y:z.y,width:0,height:0},x),z.x+=i,z.y+=O,z)}return oo[s]?Om(J.get(0),J.get(1),s,i,O,x,k):Om(J.get(c-2),J.get(c-1),s,i,O,x,k)}}return kg},_42:function(R){this._78o&&Wc.superClass._42.call(this,R)},drawPath:function(h,F){h.beginPath();var j=F.type,M=F.points,t=F.segments,k=F.edgeTypeInfo;if(!j||M){var c=F.sourcePoint,N=c.x,E=c.y,s=F.targetPoint,T=s.x,O=s.y;if(j)if(t){var J=new xg({x:N,y:E});J.addAll(M),J.add({x:T,y:O}),lb(h,J,t)}else h.moveTo(N,E),M.each(function(d){h.lineTo(d.x,d.y)}),h.lineTo(T,O);else F.looped?h.arc(N,E,F.radius,0,C,!0):F.center?(h.moveTo(F.c1.x,F.c1.y),h.lineTo(N,E),h.lineTo(T,O),h.lineTo(F.c2.x,F.c2.y)):(h.moveTo(N,E),h.lineTo(T,O))}else k&&(k.points?lb(h,k.points,k.segments):k[Bl]&&k[Bl](h,k))},_80o:function(M){var n=this,t=n.s,c=n._78o,p=c.width,B=c.selectWidth,X=c.borderWidth,v=c.color,H=M.lineJoin,$=M.lineCap,s=c.pattern;M.lineJoin=c.join,M.lineCap=c.cap,n.drawPath(bf(M,s),c);var e=t("edge.width.absolute");if(e&&(M.save(),M.setTransform(1,0,0,1,0,0)),B&&(M.strokeStyle=c._97o,M.lineWidth=p+2*(X+B),M.stroke()),X&&(M.strokeStyle=c.borderColor,M.lineWidth=p+2*X,M.stroke()),M.strokeStyle=v,M.lineWidth=p,M.stroke(),c.is3d&&Hr(M,v,c._67o,p,n.gv._zoom,c._66o),e&&M.restore(),cg(M,s),t("edge.dash")){s=t("edge.dash.pattern");var L=bf(M,s,n._2Q("edge.dash.offset"));L!==M&&n.drawPath(L,c),n._1Q(M,"edge",t("edge.dash.width")||p,s)}M.lineJoin=H,M.lineCap=$},_48O:function(){},_47O:function(){},_71o:function(I,d){var e=this,l=e._data;if(e._19Q=!0,!l.getEdgeGroup())return I?l.s("edge.gap"):0;var u,y=0,S=0,o=0;if(l.getEdgeGroup().getSiblings().each(function(M){M.each(function(f){if(e.gv.isVisible(f)&&f.s(kr)==d){var G=f.s("edge.gap");u?(S+=o/2+G/2,o=G):(u=f,o=G),f===l&&(y=S)}})}),I)return S-y+o;var V=y-S/2;return u&&l._40I!==u._40I&&(e._19Q=!1),V}});var me=function(p,V){ym(me,this,[p,V])};jh(me,go,{_3O:function(){var l,p,k=this,S=k.s,u=k._data,Y=k.gv;if(k._88I=Q,u.isExpanded()&&u.eachChild(function(E){var x=Y.getBoundsForGroup(E);x&&(p||(p=[]),p.push(x),l=Ej(l,x))}),l){var W=Y.getLabel(u),T=S("group.type");l=nb(T,p,l),Ib(l,u,"group.padding",1);var Z=k._88I={type:T,rect:l,_64o:l};if(!T&&W!=Q){var g,_=k.labelInfo={label:W,color:S("group.title.color"),font:S("group.title.font"),align:S("group.title.align")},y=Mr(_,W),x=y.width,z=y.height,s=S("group.title.align");x>l.width&&(l.width=x),_.rect={y:l.y-z,width:y.width,height:z},g=s===Um?l.x:s===Xl?l.x+l.width-x:l.x+l.width/2-x/2,_.rect.x=g,Z.titleRect={x:l.x,y:l.y-z,width:l.width,height:z+1},Z.rect={x:l.x,y:l.y-z,width:l.width,height:l.height+z}}k._40O(Z,S("group.border.width")/2)}else me.superClass._3O.call(k)},getPosition:function(x,a,D,V){var Z=this._88I;if(Z){var $=zb(x,Z.rect,V);return $.x+=a,$.y+=D,$}return me.superClass.getPosition.apply(this,arguments)},_24O:function(L,X){var H=this._88I;(!H||H.type||"label2"===L)&&me.superClass._24O.call(this,L,X)},_80o:function(p){var t=this,b=t._88I;if(b){var i=t._data,o=t.s,q=t.gv,T=b.type,H=b.rect,e=b._64o,L=b.titleRect,M=t.getBodyColor(),P=Lq(o("group.image"),M),R=o("group.image.stretch"),k=t.getBodyColor("group.background"),I=Lq(o("group.repeat.image"),M),U=o("group.gradient.pack"),y=o("group.gradient"),c=o("group.gradient.color"),w=o("group.depth");if(T){var B=o("group.border.pattern"),V=o("group.border.width"),F=p.lineJoin,n=p.lineCap;if(p.lineJoin=o("group.border.join"),p.lineCap=o("group.border.cap"),P){if(p.save(),Og(p,T,H),p.clip(),Cq(p,P,R,H.x,H.y,H.width,H.height,i,q,M),p.restore(),V>0){var C=bf(p,B);Og(C,T,H),p.lineWidth=V,p.strokeStyle=o("group.border.color"),p.stroke(),cg(p,B)}}else{var C=bf(p,B);k||I||U?(Og(p,T,H),U?Pd(p,U):I?xb(p,I,M,null,i,q):yj(p,k,y,c,H),p.fill(),U&&p.restore(),p!==C&&Og(C,T,H)):Og(C,T,H),V>0&&(p.lineWidth=V,p.strokeStyle=o("group.border.color"),p.stroke()),cg(p,B),T===qo&&Nn(p,k,w,H)}p.lineJoin=F,p.lineCap=n}else if(P?Cq(p,P,R,e.x,e.y,e.width,e.height,i,q,t.getBodyColor()):(k||I)&&(I?xb(p,I,M,null,i,q):yj(p,k,y,c,e),Og(p,qo,e),p.fill(),Nn(p,k,w,e)),L){var v=o("group.title.background");nl(p,L.x,L.y,L.width,L.height,v),Nn(p,v,w,L)}t._39O(p,b)}else me.superClass._80o.call(t,p)}});var wb=function(f,s){ym(wb,this,[f,s])};jh(wb,go,{_80o:function(u){this._39O(u,this._83o)}});var Uf=function(S,k){ym(Uf,this,[S,k])};jh(Uf,go,{_3O:function(){var D=this,e=D._data,Z=D.s,_=D.gv,V=e.getPoints(),I=_.getBorderColor(e),O=I?Z("border.width"):0,U=D.getSelectWidth(),H=Z("shape.border.width"),F=e.getRect(),L=_.getBodyColor(e),N=D._99o=V.isEmpty()?Q:{rect:F,rotation:e.getRotation(),fillRule:Z("shape.fill.rule"),scale:e.getScale(),position:e.p(),points:V,segments:e.getSegments(),bodyColor:L,borderColor:I,borderWidth:O,_94o:Z("shape.border.3d"),_95o:Z("shape.border.3d.color"),_96o:Z("shape.border.3d.accuracy"),_97o:U?D.getSelectColor():Q,selectWidth:U,_53o:Z("shape.background"),_27Q:Lq(Z("shape.repeat.image"),L),shapeGradientPack:Z("shape.gradient.pack"),_54o:H,_55o:Z("shape.border.color"),shapeGradient:Z("shape.gradient"),_59o:Z("shape.gradient.color"),_60o:Z("shape.border.pattern"),_61o:Z("shape.border.cap"),_62o:Z("shape.border.join")};if(N){var T=e.getScale(),A=x(1,x(q(T.x),q(T.y)));Z("shape.dash")&&Z("shape.dash.width")>H&&(H=Z("shape.dash.width"));var X=H*("square"===N._61o?.71:.5)+O+U/D.gv._zoom/A;X&&(X*=A,F=Hp(F),ob(F,X,N._62o)),D._68o(F);var J=Z("clip.percentage");1>J&&(0>J&&(J=0),N.clipRect=Xg(e.getAnchorRect(),Z("clip.direction"),J));var W=Z("shape.fill.clip.percentage");1>W&&(0>W&&(W=0),N.shapeClipRect=Xg(e.getAnchorRect(),Z("shape.fill.clip.direction"),W))}},getPosition:function(i,t,k,h){var M=this._99o;if(M){var s=zb(i,M.rect,h);return s.x+=t,s.y+=k,s}return kg},_42:function(J){this._99o&&Uf.superClass._42.call(this,J)},_80o:function(C){var c,y=this,b=y.s,I=y._99o,p=I.position,D=I.scale,a=I.rotation,J=I.bodyColor,P=I.borderWidth,e=I.selectWidth,Q=I._53o,Y=I._27Q,W=I.shapeGradientPack,F=I._54o,M=I.clipRect,G=I.shapeClipRect,X=I.points,$=I.segments,u=y._data.isClosePath(),g=I.fillRule,L=Q||Y||W;C.save(),Np(C,p.x,p.y),ef(C,a),rb(C,D.x,D.y),M&&(C.beginPath(),C.rect(M.x,M.y,M.width,M.height),C.clip()),L&&G&&(C.save(),C.beginPath(),C.rect(G.x,G.y,G.width,G.height),C.clip()),Np(C,-p.x,-p.y);var w=I._60o,v=bf(C,w),A=C.lineJoin,f=C.lineCap;C.lineJoin=I._62o,C.lineCap=I._61o,L?(lb(C,X,$,u),W?Pd(C,W):Y?xb(C,Y,J,null,y._data,y.gv):(c=J?J:Q,yj(C,c,I.shapeGradient,I._59o,I.rect)),C.fill(g),G&&(C.restore(),Np(C,-p.x,-p.y)),W&&C.restore(),v!==C&&lb(v,X,$,u)):lb(v,X,$,u);var V=b("shape.border.width.absolute");if(V&&(C.save(),C.setTransform(1,0,0,1,0,0)),e&&(C.strokeStyle=I._97o,C.lineWidth=F+2*(P+e),C.stroke()),P&&(C.strokeStyle=I.borderColor,C.lineWidth=F+2*P,C.stroke()),F&&(c=I._55o,!Q&&J&&(c=J),C.strokeStyle=c,C.lineWidth=F,C.stroke(),I._94o&&Hr(C,c,I._95o,F,y.gv._zoom,I._96o)),V&&C.restore(),cg(C,w),b("shape.dash")){var n=b("shape.dash.width")||F;if(n>0){w=b("shape.dash.pattern");var v=bf(C,w,y._2Q("shape.dash.offset"));v!==C&&lb(v,X,$,u),y._1Q(C,"shape",n,w)}}C.lineJoin=A,C.lineCap=f,C.restore()},_48O:function(){},_47O:function(){}});var Xi=function(h,w){ym(Xi,this,[h,w])};jh(Xi,Uf,{getRotation:function(F,T,l){F=F||0;var p=this._data.getPoints(),i=p.size();return i>1?Ag[l]?i&&0===i%2?Ck(p.get(i/2-1),p.get(i/2),T,F):F:oo[l]?Ck(p.get(0),p.get(1),T,F):Ck(p.get(i-2),p.get(i-1),T,F):F},getPosition:function(D,c,N,K,M){var C=this._data.getPoints(),W=C.size();if(W>1){if(Ag[D]){var O=W%2;if(0===O)return Om(C.get(W/2-1),C.get(W/2),D,c,N,K,M);var Y=C.get((W-O)/2),U={x:Y.x,y:Y.y,width:0,height:0};return Y=zb(D,U,K),Y.x+=c,Y.y+=N,Y}return oo[D]?Om(C.get(0),C.get(1),D,c,N,K,M):Om(C.get(W-2),C.get(W-1),D,c,N,K,M)}return kg}});var Mn=function($,w){ym(Mn,this,[$,w])};jh(Mn,go,{_3O:function(){var g=this;Mn.superClass._3O.call(g);var G=g.s,q=g._83o;g._82o=q.img||q.shape?Q:{background:g.getBodyColor("grid.background"),depth:G("grid.depth"),rect:q.rect,_88o:G("grid.cell.depth"),cellBorderColor:G("grid.cell.border.color"),_89o:G("grid.row.count"),_90o:G("grid.column.count"),block:G("grid.block"),_91o:G("grid.block.color"),_92o:G("grid.block.padding"),_93o:G("grid.block.width")}},_80o:function(s){var M=this,l=M._82o;if(!l)return Mn.superClass._80o.call(M,s),void 0;var S,O,q=M._data,r=l.background,G=l.rect,V=l.block,y=l._91o,v=l._92o,h=l._93o,D=l._88o,x=l.cellBorderColor,W=l._89o,_=l._90o;if(r)if(nl(s,G.x,G.y,G.width,G.height,r),Nn(s,r,l.depth,G),D)for(S=0;W>S;S++)for(O=0;_>O;O++)G=q.getCellRect(S,O),G&&Nn(s,r,D,G);else if(x){for(s.beginPath(),S=0;W>S;S++)for(O=0;_>O;O++)G=q.getCellRect(S,O),G&&s.rect(G.x,G.y,G.width,G.height);s.strokeStyle=x,s.lineWidth=1,s.stroke()}if("h"===V)for(S=0;W>S;S++)G=Ej(q.getCellRect(S,0),q.getCellRect(S,_-1)),Id(G,v),zd(s,y,G.x,G.y,G.width,G.height,h);else if("v"===V)for(O=0;_>O;O++)G=Ej(q.getCellRect(0,O),q.getCellRect(W-1,O)),Id(G,v),zd(s,y,G.x,G.y,G.width,G.height,h);M._39O(s,M._83o)}});var Yr=function(P,S){ym(Yr,this,[P,S])};jh(Yr,go,{_checkEmptyRect:!1,_81o:function(){var W=this._data,e=Yr.superClass._81o.call(this),G=W.s("text");if(G!=Q){var v,L,T=W.s("text.font"),K=W.s("text.align"),Z=W.s("text.vAlign"),X=vr(T,G),U=X.width,_=X.height,j=W.getAnchor(),z=W.getWidth(),E=W.getHeight();"left"===K?v=-z*j.x:"center"===K?v=-z*j.x+(z-U)/2:"right"===K&&(v=z*(1-j.x)-X.width),"top"===Z?L=-E*j.y:"middle"===Z?L=-E*j.y+(E-_)/2:"bottom"===Z&&(L=E*(1-j.y)-X.height);var C,b=W.getMatrix();if(C=mc([b.tf(v,L),b.tf(v+U,L),b.tf(v+U,L+_),b.tf(v,L+_)]),e=Ej(e,C),e&&W.s("text.shadow")){var n=Hp(e);n.x+=W.s("text.shadow.offset.x"),n.y+=W.s("text.shadow.offset.y"),Id(n,W.s("text.shadow.blur")),e=Ej(e,n)}}return e}});var Ve=Ap.Interactor=function(x){this.gv=this._graphView=x};_n("Interactor",_,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners(),this.clear()},clear:function(){},fi:function(F){this.gv.fi(F)},setCursor:function(m){sg||this.gv.setCursor(m)},startDragging:function(p){var l=this;l._lastClientPoint=ko(p),l._lastLogicalPoint=l.gv.lp(p),ep(l,p)},clearDragging:function(){var j=this;j._lastClientPoint=j._lastLogicalPoint=j._logicalPoint=Q},autoScroll:function(H){return this.gv.autoScroll(H,this._lastClientPoint)}});var Vf=function(W){var q=this;q.gv=W,q.filter=function($){return W.isSelectable($)&&W.isInteractive($)},W.getView(),["mousedown","mousemove","touchstart","touchmove"].forEach(function(d){q.addListener(d)}),u.addEventListener(Qc,function(R){gf(R)&&q.handleWindowMove(R)},!1),u.addEventListener($n,function(z){gf(z)&&q.handleWindowUp(z)},!1),u.addEventListener(Pc,function(s){gf(s)&&q.handleWindowMove(s)},!1),u.addEventListener(ii,function(x){gf(x)&&q.handleWindowUp(x)},!1)};jh(Vf,Ve,{addListener:function(e){var i=this;i.gv.getView().addEventListener(e,function(V){p.preventDefault(V),gf(V)&&!i.disabled&&i["handle_"+e](V)},!1)},handle:function(P,G,l){var M=this.gv;if(l=l||M.getDataInfoAt(G,this.filter)){var c=l.ui.interactiveInfo;if(c){var I,v=l.data;if(v.s(P)&&v.s(P)(G,v,M),"body"===l.part&&c.bodyInfo)I="body",l.hits=this.handleImage(I,M.getImage(v),P,G,v,l.point,c.bodyInfo);else if("icons"===l.part&&c._38o){var U=c._38o[l.name];U&&U[l.index]&&(I="icons|"+l.name+"|"+l.index,l.hits=this.handleImage(I,l.icon,P,G,v,l.point,U[l.index]))}}return l}},handleImage:function(o,p,X,Q,I,U,Y){var K={};if(p&&(p=Lq(p))){var V=this.gv,s=Y.rect,A=this.convertPoint(U,Y);A.inRect&&(p[X]&&p[X](Q,I,V,A,s.width,s.height),K[o+"|image"]={target:p,point:A,width:s.width,height:s.height});for(var Z=Y.compInfos,T=Z.length-1;T>=0;T--){var v=Z[T],P=v.comp;A=this.convertPoint(U,v),A.inRect&&(s=v.rect,P[X]&&P[X](Q,I,V,A,s.width,s.height),(p=s.image)&&p[X]&&p[X](Q,I,V,A,s.width,s.height),K[o+"|"+T]={target:P,point:A,width:s.width,height:s.height},p&&(K[o+"|"+T+"|image"]={target:p,point:A,width:s.width,height:s.height}))}}return K},handle_mousedown:function(M){this.isDragging&&(this.handleDownInfo("onEndDrag",M),this.isDragging=!1),this.downInfo=this.handle("onDown",M)},handle_mousemove:function(Y){var $=this,I=$.gv;$._hoverTimer&&(d($._hoverTimer),delete $._hoverTimer);var z,s,W,U=$.handle("onMove",Y),D=this.currentInfo?this.currentInfo.data:Q,w=this.currentInfo?this.currentInfo.hits:Q;if(U&&(s=U.data,W=U.hits,$._hoverTimer=E(function(){d($._hoverTimer),delete $._hoverTimer,$.handle("onHover",Y,U)},I.getHoverDelay()||p.hoverDelay)),s!==D){if(s&&s.s("onEnter")&&s.s("onEnter")(Y,s,I),D&&D.s("onLeave")&&D.s("onLeave")(Y,D,I),w)for(z in w)w[z].target.onLeave&&this.handleLeave(Y,z);if(W)for(z in W)W[z].target.onEnter&&W[z].target.onEnter(Y,s,I,W[z].point,W[z].width,W[z].height)}else{if(w)for(z in w)W&&W[z]||w[z].target.onLeave&&this.handleLeave(Y,z);if(W)for(z in W)w&&w[z]||W[z].target.onEnter&&W[z].target.onEnter(Y,s,I,W[z].point,W[z].width,W[z].height)}this.currentInfo=U},handleLeave:function(y,k){if(this.currentInfo){var F=this.currentInfo,O=F.ui.interactiveInfo;if(O){var Y,C=this.gv.lp(y),q=F.data;if("body"===F.part&&O.bodyInfo)Y="body",this.handleLeaveImage(k,Y,this.gv.getImage(q),y,q,C,O.bodyInfo);else if("icons"===F.part&&O._38o){var Q=O._38o[F.name];Q&&Q[F.index]&&(Y="icons|"+F.name+"|"+F.index,this.handleLeaveImage(k,Y,F.icon,y,q,C,Q[F.index]))}}}},handleLeaveImage:function(n,R,T,x,d,y,H){if(T&&(T=Lq(T))){var L=this.gv,k=H.rect,i=this.convertPoint(y,H);n===R+"|image"&&T.onLeave&&T.onLeave(x,d,L,i,k.width,k.height);for(var j=H.compInfos,A=j.length-1;A>=0;A--){var s=j[A],q=s.comp;i=this.convertPoint(y,s),k=s.rect,q.onLeave&&n===R+"|"+A&&q.onLeave(x,d,L,i,k.width,k.height),(T=k.image)&&T.onLeave&&n===R+"|"+A+"|image"&&T.onLeave(x,d,L,i,k.width,k.height)}}},handleMissingUp:function(t){var T=this.downInfo;if(T){var M=T.ui.interactiveInfo;if(M){var p,a=this.gv.lp(t),B=T.data;if("body"===T.part&&M.bodyInfo)p="body",this.handleMissingUpImage(p,this.gv.getImage(B),t,B,a,M.bodyInfo);else if("icons"===T.part&&M._38o){var U=M._38o[T.name];U&&U[T.index]&&(p="icons|"+T.name+"|"+T.index,this.handleMissingUpImage(p,T.icon,t,B,a,U[T.index]))}}}},handleMissingUpImage:function(l,S,H,w,n,v){var P="onUp",Q=this.downInfo.hits;if(Q&&S&&(S=Lq(S))){var t=v.rect,d=this.convertPoint(n,v);!d.inRect&&Q[l+"|image"]&&S[P]&&S[P](H,w,this.gv,d,t.width,t.height);for(var $=v.compInfos,e=$.length-1;e>=0;e--){var h=$[e],R=h.comp;d=this.convertPoint(n,h),d.inRect||(t=h.rect,R[P]&&Q[l+"|"+e]&&R[P](H,w,this.gv,d,t.width,t.height),(S=t.image)&&S[P]&&Q[l+"|"+e+"|image"]&&S[P](H,w,this.gv,d,t.width,t.height))}}},handle_touchstart:function(j){this.handle_mousedown(j)},handle_touchmove:function(u){this.handle("onMove",u)},handleWindowMove:function(a){this.downInfo&&(this.isDragging?this.handleDownInfo("onDrag",a):(this.handleDownInfo("onBeginDrag",a),this.isDragging=!0))},handleWindowUp:function(z){this.isDragging&&(this.handleDownInfo("onEndDrag",z),this.isDragging=!1);var R=this.handle("onUp",z);this.downInfo&&(R&&R.data===this.downInfo.data?this.handleMissingUp(z):this.handleDownInfo("onUp",z),this.downInfo=Q)},handleDownInfo:function(S,A){if(this.downInfo){var w=this.downInfo,X=w.ui.interactiveInfo;if(X){var F,N=this.gv.lp(A),k=w.data;if(k.s(S)&&k.s(S)(A,k,this.gv),"body"===w.part&&X.bodyInfo)F="body",this.handleDownInfoImage(F,this.gv.getImage(k),S,A,k,N,X.bodyInfo);else if("icons"===w.part&&X._38o){var l=X._38o[w.name];l&&l[w.index]&&(F="icons|"+w.name+"|"+w.index,this.handleDownInfoImage(F,w.icon,S,A,k,N,l[w.index]))}}}},handleDownInfoImage:function(H,l,W,b,U,x,d){var Y=this.downInfo.hits;if(Y&&l&&(l=Lq(l))){var v=this.gv,R=d.rect,w=this.convertPoint(x,d);Y[H+"|image"]&&l[W]&&l[W](b,U,v,w,R.width,R.height);for(var M=d.compInfos,G=M.length-1;G>=0;G--){var X=M[G],J=X.comp;w=this.convertPoint(x,X),R=X.rect,J[W]&&Y[H+"|"+G]&&J[W](b,U,v,w,R.width,R.height),(l=R.image)&&l[W]&&Y[H+"|"+G+"|image"]&&l[W](b,U,v,w,R.width,R.height)}}},convertPoint:function(j,o){var c=j.x,e=j.y;o.stacks.forEach(function(o){if(o.t)c-=o.t[0],e-=o.t[1];else if(o.s)c/=o.s[0],e/=o.s[1];else if(o.r){var A=g(-o.r),t=$(-o.r),K=t*c-A*e,u=A*c+t*e;c=K,e=u}});var n=o.rect;return j={x:c-n.x,y:e-n.y},j.inRect=j.x>=0&&j.y>=0&&j.x<=n.width&&j.y<=n.height,j}});var Xn=Ap.DefaultInteractor=function(r){ym(Xn,this,[r])};_n("DefaultInteractor",Ve,{handle_mousedown:function(c){Hm(c);var T=this,d=T.gv,Y=d.getDataAt(c);!d.setFocus(c)||d._editing||d._scrolling||(pg(c)?d.handleDoubleClick(c,Y):d.handleClick(c,Y),!mo()&&Y||!d.isPannable()||!gf(c)||Ub(c)||(T._tx=d.tx(),T._ty=d.ty(),T.startDragging(c)))
},handleWindowMouseUp:function(H){var O=this,M=O.gv;M._panning&&(delete M._panning,M.onPanEnded(),O.fi({kind:"endPan",event:H})),delete O._tx,delete O._ty,O.clearDragging()},handle_mousemove:function(M){var t=this,e=t.gv;t._hoverTimer&&(d(t._hoverTimer),delete t._hoverTimer),t._hoverTimer=E(function(){t.fi({kind:"hover",event:M}),d(t._hoverTimer),delete t._hoverTimer},e.getHoverDelay()||p.hoverDelay)},handle_touchmove:function(k){this.handle_mousemove(k)},handleWindowMouseMove:function(Y){var H=this,Z=H.gv,w=H._lastClientPoint;H.fi({kind:Z._panning?"betweenPan":"beginPan",event:Y}),Z._panning=1,Z.setTranslate(H._tx+Y.clientX-w.x,H._ty+Y.clientY-w.y)},handle_mousewheel:function(K){this.gv.handleScroll(K,K.wheelDelta)},handle_DOMMouseScroll:function(T){2===T.axis&&this.gv.handleScroll(T,-T.detail)},handle_keydown:function(n){this.gv.handleKeyDown(n)}});var Dq=Ap.SelectInteractor=function(S){ym(Dq,this,[S])};_n("SelectInteractor",Ve,{_42:function(){var T=this,g=T.gv,j=g.getZoom(),k=T.mark,e=T.div;e||(e=T.div=xq(),Pe(T.getView(),e));var M={};M.x=k.x*j+g.tx(),M.y=k.y*j+g.ty(),M.width=k.width*j,M.height=k.height*j,Ae(e,M),this.intersects()?(e.style.border="",e.style.background=g.getRectSelectBackground()):(e.style.background="",e.style.border="1px solid "+g.getRectSelectBorderColor())},handle_mousedown:function(T){var N=this,P=N.gv;if(N._57I=Q,!(P._editing||P._scrolling||mo())){var d=P.getDataAt(T),F=P.sm();if(d)if(Ub(T))F.co(d)?F.rs(d):F.as(d);else if(F.co(d)){if(pg(T)&&d instanceof Wf&&d.isClickThroughEnabled()){var Y=P.getDataAt(T,function(e){P._clickThroughChecking=!0;var n=e.getParent()===d&&P.isSelectable(e);return delete P._clickThroughChecking,n});Y&&(T.clickThrough=!0,F.ss(Y))}}else F.ss(d);else Ub(T)||!P.isPannable()?gf(T)&&(Ub(T)||F.cs(),P.isRectSelectable()&&(N.startDragging(T),P._77O=1)):gf(T)&&(N._57I=ko(T))}},handle_mouseup:function(W){var B=this,m=B._57I;m&&(Vc(m,ko(W))<=1&&B.gv.sm().cs(),B._57I=Q)},handleWindowMouseUp:function(r){this.clear(r)},handleWindowMouseMove:function(N){var G=this,h=G.gv;G._logicalPoint=h.lp(N),G.mark?(G.fi({kind:"betweenRectSelect",event:N}),h.isPannable()&&G.autoScroll(N),G.redraw()):G.fi({kind:"beginRectSelect",event:N}),G.mark=mc(G._lastLogicalPoint,G._logicalPoint),G.redraw()},intersects:function(){var o=this,c=o._lastLogicalPoint,t=o._logicalPoint;return c.x>t.x||c.y>t.y},clear:function(O){var h=this,D=h.gv,g=h.mark;if(h._57I=Q,h._lastLogicalPoint){if(g){if(0!==g.width&&0!==g.height){var M=D.getDatasInRect(g,h.intersects());if(!M.isEmpty()){var F=D.sm(),d=F.toSelection();M.each(function(Y){F.co(Y)?d.remove(Y):d.add(Y)}),F.ss(d)}}qh(h.div),delete h.div,delete h.mark,h.redraw(),h.fi({kind:"endRectSelect",event:O}),D.onRectSelectEnded()}h.clearDragging(),delete D._77O}},redraw:function(){var P=this;P._draw||(P._draw=1,E(function(){P.mark&&P._42(),delete P._draw},16))}});var Yk=Ap.MoveInteractor=function(o){ym(Yk,this,[o])};_n("MoveInteractor",Ve,{handle_mousedown:function(j){var K=this,t=K.gv;if(gf(j)&&!t._editing&&!t._scrolling&&!mo()){var z=t.getSelectedDataAt(j);z?(K._data=z,t.handleMouseDown&&t.handleMouseDown(j,z),K.startDragging(j),t.isMovable(z)&&(t._moving=1)):t._focusData=Q}},handleWindowMouseUp:function(m){var g=this,t=g.gv;t.handleMouseUp&&t.handleMouseUp(m,g._data),g.clear(m)},handleWindowMouseMove:function(V){var q=this,E=q._data,t=q.gv;if((!t._93O||!t._93O(V,E))&&t._moving){q._logicalPoint||q.fi({kind:"prepareMove",event:V});var y=q._logicalPoint?"betweenMove":"beginMove",f={kind:y,event:V},C=q._logicalPoint=t.lp(V);"beginMove"!==y||q._alreadyBeginTransaction||(q._alreadyBeginTransaction=!0,t.getDataModel().beginTransaction());var U=q._calcShift(y,V),Q=U.x,g=U.y,h=q.gv.getMoveMode(V,E);h&&("x"===h?g=0:"y"===h?Q=0:"xy"!==h&&(Q=g=0)),t.moveSelection(Q,g),q._lastLogicalPoint=C,q.autoScroll(V),q.fi(f)}},_calcShift:function(){var W=this,N=W._logicalPoint,q=W._lastLogicalPoint,_=N.x-q.x,g=N.y-q.y;return{x:_,y:g}},clear:function(U){var l=this,o=l.gv;l._lastLogicalPoint&&(l._lastLogicalPoint=l._data=o._moving=Q,l._logicalPoint&&(l.fi({kind:"endMove",event:U}),o.onMoveEnded()),l.clearDragging()),l._alreadyBeginTransaction&&(l._alreadyBeginTransaction=!1,o.getDataModel().endTransaction())}});var Dn=Ap.ScrollBarInteractor=function(C){ym(Dn,this,[C])};_n("ScrollBarInteractor",Ve,{_41o:function(){return this.gv.getViewRect().height<this.gv.getScrollRect().height},_40o:function(){return this.gv.getViewRect().width<this.gv.getScrollRect().width},isV:function(l){var o=this.gv.getViewRect();return this._41o()&&(o.x+o.width-this.gv.lp(l).x)*this.gv.getZoom()<Fq},isH:function(S){var g=this.gv.getViewRect();return this._40o()&&(g.y+g.height-this.gv.lp(S).y)*this.gv.getZoom()<Fq},handle_mousemove:function(K){this.handle_touchmove(K)},handle_touchmove:function(y){if(!gd&&gf(y)&&this.gv.isScrollBarVisible()){var C=this,n=C.isV(y),k=C.isH(y);(n||k)&&C.gv.showScrollBar(),C.gv._scrolling=n||k}},handleWindowMouseUp:function(n){this.handleWindowTouchEnd(n)},handleWindowTouchEnd:function(E){this._state=this._cp=this._tx=this._ty=this.gv._scrolling=Q,this.fi({kind:"endScroll",event:E})},handle_mousedown:function(r){this.handle_touchstart(r)},handle_touchstart:function(W){var V=this;if(V.gv.setFocus(W),Hm(W),V.handle_touchmove(W),!(vj(W)>1)&&V.gv._scrolling&&V.gv.isScrollBarVisible()){V._cp=ko(W),V._tx=V.gv.tx(),V._ty=V.gv.ty();var s=V.isV(W);V._state=s?"vScroll":"hScroll",ep(V,W),V.fi({kind:"beginScroll",event:W})}},handleWindowMouseMove:function(n){this.handleWindowTouchMove(n)},handleWindowTouchMove:function($){var g=ko($),o=this.gv.getViewRect(),e=this.gv.getScrollRect();"vScroll"===this._state?this.gv.ty(this._ty+(this._cp.y-g.y)*e.height/o.height):"hScroll"===this._state&&this.gv.tx(this._tx+(this._cp.x-g.x)*e.width/o.width),this.fi({kind:"betweenScroll",event:$})}});var Bh=Ap.TouchInteractor=function(u,P){P=P||{},P.selectable===i&&(P.selectable=!0),P.movable===i&&(P.movable=!0),P.pannable===i&&(P.pannable=!0),P.pinchable===i&&(P.pinchable=!0),P.editable===i&&(P.editable=!0),this.params=P,ym(Bh,this,[u])};_n("TouchInteractor",Ve,{ms_edit:1,setUp:function(){var J=this;Bh.superClass.setUp.call(J),sg&&J.params.editable&&J.gv.setEditInteractor(J)},tearDown:function(){var k=this;Bh.superClass.tearDown.call(k),sg&&k.params.editable&&k.gv.setEditInteractor(Q)},clear:function(R){var K=this,U=K.gv;U._moving&&(K.fi({kind:"endMove",event:R}),delete U._moving,U.onMoveEnded(),U.dm().endTransaction()),U._panning&&(K.fi({kind:"endPan",event:R}),delete U._panning,U.onPanEnded()),U._pinching&&(K.fi({kind:"endPinch",event:R}),delete U._pinching,U.onPinchEnded()),U._editing&&(K._46O(R),K._77I=K._node=K._edge=K._shape=K._rect=K._89I=K._index=U._editing=Q),K._moving=K._panning=K._pinching=K._editing=K._57I=K._data=K._beginHistory=Q,K.clearDragging()},handle_touchstart:function(U){var W=this;if(!W.gv._editing){Hm(U),W._57I=Q;var h=W.params,n=W.gv,_=n.sm(),L=n.getDataAt(U),M=vj(U);if(1===M){if(pg(U))return n.handleDoubleClick(U,L),void 0;n.handleClick(U,L),L&&(n.handleMouseDown&&n.handleMouseDown(U,L),W._data=L),h.selectable||(L=Q),L?(_.co(L)||_.ss(L),h.editable&&n.isEditable(L)&&W._79I(U,L,!0)?(W._editing=1,W.startDragging(U)):h.movable&&n.isMovable(L)&&(W._moving=1,W.startDragging(U))):(W._57I=ko(U),h.pannable&&n.isPannable()&&(W._panning=1,W.startDragging(U),W._translate={x:n.tx(),y:n.ty()}))}else if(h.pinchable&&2===M){W._pinching=1,W.startDragging(U);var q=n.getView(),H=n.getZoom(),g=q.getBoundingClientRect(),C=U.touches[0],f=U.touches[1],P={x:(C.clientX+f.clientX)/2-g.left,y:(C.clientY+f.clientY)/2-g.top};P.x-=n.tx(),P.y-=n.ty(),P.x/=H,P.y/=H,W._p=P,W._d=Dp(U)}}},handle_touchend:function(M){var W=this,i=W.gv,E=W._57I,d=W._data;E&&(Vc(E,ko(M))<=1&&i.sm().cs(),W._57I=Q),d&&i.handleMouseUp&&i.handleMouseUp(M,d)},handleWindowTouchEnd:function(t){this.clear(t)},handleWindowTouchMove:function(C){var $=this,n=$.gv,k=vj(C);if(1===k){if($._editing&&($._beginHistory||($._beginHistory=1,n.dm().beginTransaction()),n._editing=1,$._78I(C)),$._moving)$._beginHistory||($._beginHistory=1,n.dm().beginTransaction()),$.handleMove(C);else if($._panning){var J=ko(C);n.setTranslate($._translate.x+J.x-$._lastClientPoint.x,$._translate.y+J.y-$._lastClientPoint.y),$.fi({kind:n._panning?"betweenPan":"beginPan",event:C}),n._panning=1}}else if(2===k&&$._pinching){var L=Dp(C);n.handlePinch($._p,L,$._d),$._d=L,$.fi({kind:n._pinching?"betweenPinch":"beginPinch",event:C}),n._pinching=1}},handleMove:function(X){var O=this,u=O.gv,S=u.lp(X);u._93O&&u._93O(X,O._data)||(u.moveSelection(S.x-O._lastLogicalPoint.x,S.y-O._lastLogicalPoint.y),O._lastLogicalPoint=S,O.autoScroll(X),O.fi({kind:u._moving?"betweenMove":"beginMove",event:X}),u._moving=1)}});var R=u.ht,Zf=R.graph._editor={Math:R.Math,Guide:{}};Zf.getStyle=function(V){var Z,F=Zf.StyleMap;return F&&(Z=F[V],Z!==i)?Z:Zf.DefaultStyleMap[V]},Zf.setStyle=function(C,E){var X=Zf.StyleMap;X||(X=Zf.StyleMap={}),X[C]=E},Zf.inEdit=function(c){return c._inXEdit===!0},Zf.startEdit=function(W){W._inXEdit=!0,Zf.Inject.doInject(W)},Zf._46O=function(T){T._inXEdit=!1,Zf.Inject.undoInject(T)},Zf.toScreenPosition=function(N,x){var b=N.tx(),$=N.ty(),U=N._zoom;return new Zf.Math.Vector2(x.x*U+b,x.y*U+$)},Zf.checkHit=function(d,D,R){return d.distanceTo(D)<R?!0:!1},Zf.toWorldPosition=function(V,F){var B=V.tx(),Q=V.ty(),X=V._zoom;return{x:(F.x-B)/X,y:(F.y-Q)/X}},Zf.setAntialias=function(a,h){for(var j,k=["imageSmoothingEnabled","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","oImageSmoothingEnabled","msImageSmoothingEnabled"],y=0,R=k.length;R>y&&(j=k[y],!(j in a));y++);a[j],a[j]=h},Zf.getTargetCornersOnScreen=function(F,t){if(!t)return null;var B,K=[];if(Vg(t,F)){var i=$j(F,t);B=[{x:i.x,y:i.y},{x:i.x+i.width,y:i.y},{x:i.x+i.width,y:i.y+i.height},{x:i.x,y:i.y+i.height}]}else{if(!t.getCorners)return null;B=t.getCorners()}return B.forEach(function(a){var Z=Zf.toScreenPosition(F,a);K.push(Z.x,Z.y)}),K},Zf.log=function(){};var wq=Zf.Inject={_modules:[]};wq.registAsModule=function(N,m){var Y={},u={};for(var x in N){var U=m.prototype[x];Y[x]=U}N.getBackup=function(u){return Y[u]},N.getBackups=function(){return Y},u.doInject=function(){for(var v in N)"getBackup"!==v&&(m.prototype[v]=N[v])},u.undoInject=function(){for(var $ in N)"getBackup"!==$&&(m.prototype[$]=Y[$])},wq._modules.push(u)},wq.doInject=function(i){for(var T,u=wq._modules,B=0,L=u.length;L>B;B++)T=u[B],T.doInject(i)},wq.undoInject=function(P){for(var Q,B=wq._modules,$=0,D=B.length;D>$;$++)Q=B[$],Q.undoInject(P)};var Ve=R.graph.EditInteractor=function(x){var h=this,I=J.createElement("canvas");I.className="editCanvas",I.style.position="absolute",h._styleMap={},h._canvas=I,h._context=I.getContext("2d"),Ve.superClass.constructor.call(h,x),Zf.setAntialias(h._context,!1),h._subModules=[new Zf.Anchor(h),new Zf.Rect(h),new Zf.Curve(h),new Zf.MoveHelper(h)],h._gridGuide=new Zf.Guide.Grid(h),h._rectGuide=new Zf.Guide.Rect(h)},Le=Ve;R.Default.def(Ve,R.graph.Interactor,{ms_edit:1,ms_fire:1}),_.defineProperties(Ve.prototype,{editDetail:{get:function(){var g=!!this._editDetail;return g},set:function(Q){var N=this,i=N._editDetail;i!==Q&&(N._editDetail=Q,N.gv._editing=Q,N.fp("editDetail",i,Q),N.fp("pointsEditingMode",i,Q),N.fi({kind:Q?"beginEditPoints":"endEditPoints"}))}},gvEditing:{get:function(){return this.gv._editing},set:function(S){(!this._editDetail||S)&&(this.gv._editing=S,S||(this.editDetail=!1))}},editing:{get:function(){return this._editing},set:function(R){this._editing=R,this.gvEditing=R}},pointsEditingMode:{get:function(){return this.editDetail},set:function(T){var E=this;E.editDetail!==T&&(T?E._tryEnterEditDetailMode():E._tryQuitEditDetailMode())}},gridEnabled:{get:function(){var U=this._gridEnabled;if(!U)return!1;var m=this.gv;return m?!0:!0},set:function(X){X!==this._gridEnabled&&(this._gridEnabled=X,this._42())}},alignmentGuideEnabled:{get:function(){return this._agEnabled},set:function(x){x!==this._agEnabled&&(this._agEnabled=x,this._42())}},gridGuide:{get:function(){return this._gridGuide}},rectGuide:{get:function(){return this._rectGuide}}}),Ve.prototype.getSubModule=function(R){var S,X,g,u=this._subModules;for(X=0,g=u.length;g>X;X++)if(S=u[X],S.catalog===R)return S},Ve.prototype.invokeSubModule=function(b,m){var u=this,e=u._subModules;if(e)for(var K,_,I,X=Array.prototype.slice.call(arguments,2),t=0,Y=e.length;Y>t;t++)if(K=e[t],_=K[b],_&&(I=_.apply(K,X),I!=i&&m))return K},Ve.prototype.invokeSubModuleInverse=function(M,c){var Y=this,X=Y._subModules;if(X)for(var Z,J,B,m=Array.prototype.slice.call(arguments,2),W=X.length-1;W>=0;W--)if(Z=X[W],J=Z[M],J&&(B=J.apply(Z,m),B!=i&&c))return Z},Ve.prototype.setUp=function(){Zf.log("setUp");var f=this,B=f.gv,J=B.getView(),s=f._canvas;Ve.superClass.setUp.call(f),B.setEditInteractor(f),B._79O?J.insertBefore(s,B._79O):J.appendChild(s),Zf.startEdit(B),f.invokeSubModule("setUp"),B.dm().mm(f._onDataModelChanged,f),B.dm().md(f._onDataPropertyChanged,f)},Ve.prototype.tearDown=function(){Zf.log("tearDown");var B=this,S=B.gv,P=S.getView();B._resetCustomCursorStyle(),Ve.superClass.tearDown.call(B),S.dm().umm(B._onDataModelChanged,B),S.dm().umd(B._onDataPropertyChanged,B),S.setEditInteractor(null),P.removeChild(B._canvas),B._drawTimer&&(d(B._drawTimer),B._drawTimer=null),Zf._46O(S),B.invokeSubModule("tearDown")},Ve.prototype._onDataModelChanged=function(o){var B=this;("clear"===o.kind||"remove"===o.kind&&B.editDetail&&o.data===B.getSubModule("Curve").target)&&(B.editDetail=!1,B._42())},Ve.prototype._onDataPropertyChanged=function(A){var m=this;if(m.editDetail){var r=m.getSubModule("Curve"),W=A.data;W===r.target&&(W._writing||r._handleDataChanged())}},Ve.prototype.clear=function(){Zf.log("clear")},Ve.prototype.redraw=function(){this._42()},Ve.prototype._42=function(){var y=this;y._drawTimer||(y._drawTimer=E(function(){y._drawTimer=null,y.drawImpl()},0))},Ve.prototype.drawImpl=function(){var V;for(V in{_42:!0})break;return function(){var h=this,q=h._canvas,O=h.gv,r=O.getWidth(),F=O.getHeight(),o=h._context,w=R.Default.getInternal();(q.width!==r||q.height!==F)&&w.setCanvas(q,r,F),o.clearRect(0,0,q.width,q.height);var z=h._getValidSelection();o.save();var L=R.Default.devicePixelRatio;o.scale(L,L),h._gridGuide._42(),h.invokeSubModuleInverse(V,!1,o,O,z),h._rectGuide._42(),o.restore()}}(),Ve.prototype._getValidSelection=function(){var R=this,A=R.gv,y=A.sm().getSelection(),k=[];return y.each(function(i){A.isVisible(i)&&A.isEditable(i)&&k.push(i)}),k},Ve.prototype.handle_touchmove=function(N){return this.handle_mousemove(N)},Ve.prototype.handle_mousemove=function(E){if(!R.Default.isDragging()){var L=this;(L.editDetail||!mo())&&(L.gvEditing=!1,L._checkEdit(E)&&(L.gvEditing=!0))}},Ve.prototype.handle_touchstart=function(T){return this.handle_mousedown(T)},Ve.prototype.handle_mousedown=function(L){Hm(L);var i=this;if(i.editDetail||!mo()){if(pg(L)&&!L.clickThrough){if(i.editDetail){if(i._tryQuitEditDetailMode(L))return}else if(i._tryEnterEditDetailMode())return;i.gv.dm().beginTransaction();var O=i.invokeSubModule("handleDoubleClick",!0,L);if(i.gv.dm().endTransaction(),O)return}var p=i._checkEdit(L);p&&(i._downPosition=i._getLogicalPoint(L),i.gv.dm().beginTransaction(),p.startEdit(i,L),i.editing=!0)}},Ve.prototype._checkEdit=function(k){var r=this,u=r.gv,z=r._getLogicalPoint(k),X=r.invokeSubModule("check",!0,u,k,z)||null;return r._editMod=X,X},Ve.prototype.handleWindowTouchMove=function(Y){return this.handleWindowMouseMove(Y)},Ve.prototype.handleWindowMouseMove=function(r){var V=this,C=V._downPosition;if(C){var l=V._getLogicalPoint(r);if(l.distanceTo(C)<V.getStyle("moveSensitivity"))return;delete V._downPosition}var j=V._editMod;j&&j.handleEdit(V.gv,r)},Ve.prototype._getLogicalPoint=function(S){var m=this,d=R.Default.getLogicalPoint(S,m._canvas);return new Zf.Math.Vector2(d)},Ve.prototype.handleWindowTouchEnd=function(a){return this.handleWindowMouseUp(a)},Ve.prototype.handleWindowMouseUp=function(){var W;for(W in{_46O:!0})break;return function(b){var O=this;O.editing=!1,O.setCursor("default"),O.invokeSubModule(W,!1,b),O._42(),O.gv.dm().endTransaction()}}(),Ve.prototype.handle_mousewheel=function(u){var V=this;Hm(u),V.invokeSubModule("preHandleScroll",!0)||V.gv.handleScroll(u,u.wheelDelta)},Ve.prototype.handleDelete=function(){var z=this;if(!z.editDetail){z.gv.dm().beginTransaction();var P=z.invokeSubModule("handleNormalStateDelete",!0);return z.gv.dm().endTransaction(),P||z.gv.removeSelection(),void 0}z.gv.dm().beginTransaction(),z.invokeSubModule("handleDelete",!0),z.gv.dm().endTransaction(),z._42()},Ve.prototype.handle_keydown=function(t){var b=this;if((t.metaKey||t.ctrlKey)&&b._42(),mo(t)&&!b.editing)return b.gvEditing=!1,b.setCursor("default"),b._42(),void 0;var H=Cj(t);return b.editDetail?((H||Wq(t))&&(b.editDetail=!1,b._42()),b.gv.dm().beginTransaction(),b.invokeSubModule("handle_keydown",!0,t),b.gv.dm().endTransaction(),void 0):(b.gv.dm().beginTransaction(),b.invokeSubModule("handleNormalStateKeyDown",!0,t),b.gv.dm().endTransaction(),H&&b._tryEnterEditDetailMode(),void 0)},Ve.prototype.handle_keyup=function(m){this.gv.dm().beginTransaction(),this.invokeSubModule("handle_keyup",!0,m),this.gv.dm().endTransaction()},Ve.prototype._tryEnterEditDetailMode=function(){var x=this;return!x.editDetail&&x.invokeSubModule("canEnterEditDetailMode",!0)&&1===x._getValidSelection().length?(x.editDetail=!0,x._42(),!0):void 0},Ve.prototype._tryQuitEditDetailMode=function(s){var H=this;if(H.editDetail){var i=H.gv,z=H.getSubModule("Curve").target;return s&&i.getDataAt(s)===z?void 0:(H.editDetail=!1,H._42(),!0)}},Ve.prototype.setStyle=function(Z,d,A){var c=this;A?Zf.setStyle(Z,d):c._styleMap[Z]=d,c.fp("styleChanged",null,{key:Z,value:d,base:A}),c._42()},Ve.prototype.getStyle=function(z){var X=this,s=X._styleMap[z];return s!==i?s:Zf.getStyle(z)},Ve.prototype.setCursor=function(M){this._resetCustomCursorStyle(),R.graph.EditInteractor.superClass.setCursor.call(this,M)},Ve.prototype._resetCustomCursorStyle=function(){var v=this;if(v._customStyle){var c=this.gv.getView();c.classList&&c.classList.remove&&c.classList.remove(v._customStyle),v._customStyle=null}},Ve.prototype._setRotateCursor=function(F){var e=this,r=e._cursorFactory;r||(r=e._cursorFactory=new Zf.CursorFactory(e));var v=r.getRotateCursor(F),O=e.gv.getView();e._resetCustomCursorStyle(),e._customStyle=v,O.classList&&O.classList.add&&O.classList.add(v)};var $c=Zf.Group=function(q){var X=this;X._entities=q,X._64O=0,X._position={x:0,y:0},X._scale={x:1,y:1},X._anchor={x:.5,y:.5},X._anchor2={x:.5,y:.5}};$c.prototype={},$c.prototype.constructor=$c;var si=null;$c.findOrCreateGroup=function(e){if(si&&si.checkIsMe(e))return si;var p=new Zf.Group(e);return p.getKeyOb()?(si=p,p):void 0},$c.prototype.checkIsMe=function(Z){var o=this._entities;if(o.length!==Z.length)return!1;var y,z={},i=Z.length;for(y=0;i>y;y++)z[Z[y]._id]=!0;for(y=0;i>y;y++)if(!z[o[y]._id])return!1;return!0},$c.prototype.getRotation=function(){return this._64O},$c.prototype.getPosition=function(){return this._position},$c.prototype.getAnchor=function(){return this._anchor},$c.prototype.getWidth=function(){return this._width},$c.prototype.getScale=function(){return this._scale},$c.prototype.getSize=function(){return{width:this._width,height:this._height}},$c.prototype.getHeight=function(){return this._height},$c.prototype.getKeyOb=function(){for(var o=this._entities,Y=o.length-1;Y>=0;Y--){var t=o[Y];if(this.isNode(t))return t}},$c.prototype.getAnchor2=function(){var i=this,E=i.rotateCenter;if(E)return E;var q=i.getKeyOb();if(!q)return i._anchor;var U=i._anchor2,m=q.getMatrix();return m.tf({x:q.getWidth()*(U.x-q.getAnchor().x),y:q.getHeight()*(U.y-q.getAnchor().y)})},$c.prototype.setAnchor2=function(S,G){var i=this,c=i.getKeyOb();if(c){var v,X=c.getMatrix();v="number"==typeof S?{x:S,y:G}:S;var B=X.tfi(v);i._anchor2={x:c.getAnchor().x+B.x/c.getWidth(),y:c.getAnchor().y+B.y/c.getHeight()}}},$c.prototype.setRotation=function(){},$c.prototype.beginRotate=function(B){this.rotateCenter=B.pos,this.rotateMode=B.groupRotateMode},$c.prototype.endRotate=function(){delete this.rotateCenter,delete this.rotateMode},$c.prototype.addRotation=function(k,s){return"batch"===s?this._addRotationInBatchMode(k):"block"===s?this._addRotationInBlockMode(k):void 0},$c.prototype._addRotationInBlockMode=function(m){var L=this,u=L.rotateCenter||L.getPosition();L._entities.forEach(function(a){if(L.isNode(a)){var w=a.getMatrix();w.translate(-u.x,-u.y),w.rotate(m),w.translate(u.x,u.y);var c=Math.sign(a.getScale().x);a.setRotation(N(w.b*c,w.a*c)),a.setPosition(w.tx,w.ty)}})},$c.prototype._addRotationInBatchMode=function(d){var B=this,Z=B._anchor2;B._entities.forEach(function(S){if(B.isNode(S)){var s=S.getAnchor(),e=S.getMatrix(),o=e.tf({x:S.getWidth()*(Z.x-s.x),y:S.getHeight()*(Z.y-s.y)}),H=new Zf.Math.Matrix2d;H.set(e.a,e.b,e.c,e.d,e.tx,e.ty),H.translate(-o.x,-o.y),H.rotate(d),H.translate(o.x,o.y);var X=Math.sign(S.getScale().x);S.setRotation(N(H.b*X,H.a*X)),S.setPosition(H.tx,H.ty)}})},$c.prototype.setPosition=function(d){var u,v,D,I,R=this,b=R._position,H=d.x-b.x,o=d.y-b.y,W=R._entities;for(v=0,D=W.length;D>v;v++)u=W[v],ph(u)&&(I=u.getPosition(),u.setPosition(I.x+H,I.y+o));R._position=d},$c.prototype.setScale=function(m,j){var y=this,o=m/y._scale.x,A=j/y._scale.y;y._adjustChildScaleOrSize(o,A,"size"),y._scale={x:m,y:j}},$c.prototype.getRect=function(){var y=this,l=y._position,u=y._width,J=y._height;return{x:l.x-u/2,y:l.y-J/2,width:u,height:J}},$c.prototype.setSize=function(v,m){var h=this,v=Math.max(1,v),m=Math.max(1,m),a=v/h._width,X=m/h._height;h._adjustChildScaleOrSize(a,X,"size"),h._width=v,h._height=m},$c.prototype._adjustChildScaleOrSize=function(p,e,w){var F,D,X,A,Z,m,d,M,o,V,W,l,J,T,$=this,O=$._position,u=$._entities,S=new Zf.Math.Matrix2d;for(D=0,X=u.length;X>D;D++)if(F=u[D],$.isNode(F)){if(A=F.getPosition(),Z=F.getRotation(),m=F.getWidth(),d=F.getHeight(),M=F.getScale(),W=M.x*m,l=M.y*d,S.identity().scale(W,l).rotate(Z).translate(A.x,A.y).translate(-O.x,-O.y).rotate(-$._64O),Z=N(S.b*Math.sign(W),S.a*Math.sign(W)),S.scale(p,e),o=Math.cos(Z),V=Math.sin(Z),Math.abs(o)<.001?(J=S.b/V,T=-S.c/V):(J=S.a/o,T=S.d/o),"scale"===w)F.setScale(J/m,T/d);else if("size"===w){var Q=J/M.x,s=T/M.y;F.setScale(jk(J)*Math.abs(M.x),jk(T)*Math.abs(M.y)),F.setSize(Math.max(.1,Math.abs(Q)),Math.max(.1,Math.abs(s)))}S.rotate($._64O).translate(O.x,O.y),F.setPosition(S.tx,S.ty)}},$c.prototype.getMatrix=function(){var A=this,v=A._position,j=R.Default.getInternal(),f=A._scale;return new j.Mat(A._64O,v.x,v.y,f.x,f.y)},$c.prototype.getCorners=function(){var X=this,t=X._width,V=X._height,Y=X._anchor,i=-t*Y.x,J=-V*Y.y,e=X.getMatrix();return[e.tf(i,J),e.tf(i,J+V),e.tf(i+t,J+V),e.tf(i+t,J)]},$c.prototype.calcInfo=function(){var s,r,O,v,G,T,t=this,i=[],l=t._entities,A=t._64O;for(v=0,G=l.length;G>v;v++)T=l[v],t.isNode(T)&&T.getCorners&&i.push.apply(i,T.getCorners());if(i.length){var L=Math.cos(-A),y=Math.sin(-A),d=1/0,H=-1/0,D=1/0,C=-1/0;for(v=0,G=i.length;G>v;v++)O=i[v],s=O.x,r=O.y,O.x=L*s-y*r,O.y=y*s+L*r,d=Math.min(d,O.x),H=Math.max(H,O.x),D=Math.min(D,O.y),C=Math.max(C,O.y);t._width=(H-d)/t._scale.x,t._height=(C-D)/t._scale.y,L=Math.cos(A),y=Math.sin(A);var V=t._anchor;s=d+(H-d)*V.x,r=D+(C-D)*V.y,t._position={x:L*s-y*r,y:y*s+L*r}}},$c.prototype.isNode=function(w){return ph(w)?Vg(w)?!1:!0:!1},$c.prototype._42=function(a,e,V){var N,i,Q,p,W,Y,r,u,l=this,x=l._entities,y=l.rotateMode;for("batch"===y&&(u=l.getKeyOb()),N=0,i=x.length;i>N;N++)Q=x[N],l.isNode(Q)&&(Y=Q.getRect(),p=Zf.toScreenPosition(V,{x:Y.x,y:Y.y}),W=Zf.toScreenPosition(V,{x:Y.x+Y.width,y:Y.y+Y.height}),r={min:p,max:W},Q===u&&(r.isKeyOb=!0),Zf.Icons.DrawIcon(a,e,Zf.Icons.GroupSubEntityRect,r))};var fo=Zf.CurveActiving=function(x,l){this._curve=x,this._interactor=x._interactor;for(var $ in l)this[$]=l[$]};fo.prototype={},fo.prototype.constructor=fo,_.defineProperties(fo.prototype,{point:{get:function(){return this._point},set:function(O){var y=this;y._point=O,y.editingCtrl||y._firePointChange()}},pairs:{get:function(){return this._pairs},set:function(U){var y=this;y._pairs=U,y.editingCtrl&&y._firePointChange()}}}),fo.prototype._firePointChange=function(){var Q=this,z=Q.getCurrentEditingPoint();if(!z)return d.fi({kind:"selectPoint"}),void 0;var d=Q._interactor,N=this._curve.target;if(N){var y=Zf.getDataMatrix(N).invert(),L=z.e;z=y.apply(Zf.toWorldPosition(d.gv,z)),z.e=L;var A=Q._lastFirePoint;A&&Math.abs(z.x-A.x)<1e-5&&Math.abs(z.y-A.y)<1e-5&&(z.e==i&&A.e==i||Math.abs(z.e-A.e)<1e-5)||(Q._lastFirePoint=z,d.fi({kind:"selectPoint",x:z.x,y:z.y,e:z.e}))}},fo.prototype.dispose=function(){this._interactor.fi({kind:"selectPoint"})},fo.prototype.getCurrentEditingPoint=function(){var I=this,A=I.editingCtrl;if(A){var W=I.pairs;if(W){var x=W[A.pairId],K=x[A.type];if(K)return K}}return I._point};var _k=Zf.CursorFactory=function(A){var G=this;G._interactor=A,G._rotateCursorStyles={}};_k.prototype={},_k.prototype.constructor=_k,_k.prototype.getRotateCursor=function(y){var I=this;0>y&&(y+=2*Math.PI);var H=I._interactor,L=H.getStyle("rotateCursorSize"),K=H.getStyle("rotateCursorRound"),f=Math.round(180*(y/Math.PI)/K);f*K>=360&&(f=0);var $=I._rotateCursorStyles,o="htCustomRotateStyle_"+L+"_"+K+"_"+f;return $[o]||(I._produceRotateCursor(o,L,K,f),$[o]=!0),o},_k.prototype._produceRotateCursor=function(r,t,X,h){var S=this;S._interactor;var e=S._canvas;e||(e=S._canvas=J.createElement("canvas")),e.width=e.height=t*devicePixelRatio,e.style.width=e.style.height=t+" px";var s=e.getContext("2d");Zf.setAntialias(s,!1),s.scale(devicePixelRatio,devicePixelRatio);var j,d,x,y,N,M=Math.round(t/2),_=""+M+" "+M+",auto !important;";j=Math.PI/180*h*X,s.clearRect(0,0,t,t),s.save(),s.scale(t/32,t/32),s.translate(16,16),s.rotate(j+Math.PI/2),s.beginPath(),s.moveTo(-8,0),s.lineTo(-8,3),s.lineTo(-5,3),s.moveTo(8,0),s.lineTo(8,3),s.lineTo(5,3),s.moveTo(-8,3),s.quadraticCurveTo(0,-6,8,3),s.restore(),s.strokeStyle="white",s.lineWidth=4,s.stroke(),s.strokeStyle="black",s.lineWidth=2,s.stroke(),d=JSON.stringify(e.toDataURL()),y="cursor:url("+d+")"+_,1!==devicePixelRatio&&(x='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="'+t+'px" height="'+t+'px"><image xlink:href='+d+' width="'+t+'" height="'+t+'"/></svg>',y+="cursor:url(data:image/svg+xml;base64,"+btoa(x)+")"+_,y+="cursor:-webkit-image-set(url("+d+")"+devicePixelRatio+"x,url("+d+")1x)"+_),N=J.createElement("style"),N.textContent="body."+r+" *, ."+r+"{"+y+"}",J.head.appendChild(N)};var Gc=Zf.Guide.Grid=function(V){var v=this;v._interactor=V,v._alignmentGuideId=0,v._xAlignmentGuide=[],v._yAlignmentGuide=[]};Gc.prototype={},Gc.prototype.constructor=Gc,_.defineProperties(Gc.prototype,{gridBlockSize:{get:function(){var N=this;return N._gridBlockSize||N._interactor.getStyle("gridBlockSize")},set:function(U){this._gridBlockSize=U,this._interactor._42()}},gridThickLinesEvery:{get:function(){var r=this;return r._gridThickLinesEvery||r._interactor.getStyle("gridThickLinesEvery")},set:function(q){this._gridThickLinesEvery=q,this._interactor._42()}},gridEnabled:{get:function(){var j=this,S=j._interactor;return S.gridEnabled&&j.isValidGrid()}}}),Gc.prototype._42=function(){var e=this,O=e._interactor;e.gridEnabled&&e.drawGrid(),O.alignmentGuideEnabled&&e.drawAlignmentGuide()},Gc.prototype.makeMatrix=function(){var X=this,P=X._interactor.getStyle("gridAngle"),U=X._interactor.getStyle("gridRotation"),j=new Zf.Math.Matrix2d,c=Math.sin(P),y=Math.cos(P);return j.set(1,0,y,c,0,0),j.rotate(U),j},Gc.prototype.isValidGrid=function(){var H=this,b=Math.PI,y=H._interactor,K=y.gv;if(K._zoom<y.getStyle("gridZoomThreshold"))return!1;var h=y.getStyle("gridAngle"),M=Math.abs(180*(h%b/b)),W=1-1e-8;return W>M||M>180-W?!1:!0},Gc.prototype.drawAlignmentGuide=function(){var E=this,d=E._interactor,v=d.gv,b=d._canvas,a=d._context,P=b.width,n=b.height,h=v.tx(),s=v.ty(),N=v._zoom;a.beginPath(),a.strokeStyle=d.getStyle("gridAlignmentGuideColor"),a.lineWidth=1,E._xAlignmentGuide.forEach(function(x){var U=x.p*N+h;a.moveTo(U,0),a.lineTo(U,n)}),E._yAlignmentGuide.forEach(function(w){var B=w.p*N+s;a.moveTo(0,B),a.lineTo(P,B)}),a.stroke()},Gc.prototype.drawGrid=function(){function y(J,x,L,k){var N=Zf.toScreenPosition(b,F.apply({x:J,y:x})),I=Zf.toScreenPosition(b,F.apply({x:L,y:k}));Q.moveTo(N.x,N.y),Q.lineTo(I.x,I.y)}var P=this,m=P._interactor,o=P.gridBlockSize,Z=P.gridThickLinesEvery,n=m.getStyle("gridThickColor"),k=m.getStyle("gridLightColor"),b=m.gv,T=m._canvas,Q=m._context,X=T.width,a=T.height,F=P.makeMatrix(),S=F.applyInverse(Zf.toWorldPosition(b,{x:0,y:0})),J=F.applyInverse(Zf.toWorldPosition(b,{x:X,y:0})),U=F.applyInverse(Zf.toWorldPosition(b,{x:0,y:a})),M=F.applyInverse(Zf.toWorldPosition(b,{x:X,y:a})),_=Math.min(S.x,J.x,U.x,M.x),A=Math.max(S.x,J.x,U.x,M.x),l=Math.min(S.y,J.y,U.y,M.y),K=Math.max(S.y,J.y,U.y,M.y);X=A-_,a=K-l;var v=Math.ceil(_/o),H=Math.floor(A/o),G=Math.ceil(l/o),D=Math.floor(K/o);b.tx(),b.ty(),b._zoom;var E,p,s;for(Q.save(),Q.lineWidth=1,Q.beginPath(),Q.strokeStyle=n,s=Math.ceil(v/Z)*Z;H>=s;s+=Z)E=s*o,y(E,l,E,K);for(s=Math.ceil(G/Z)*Z;D>=s;s+=Z)p=s*o,y(_,p,A,p);for(Q.stroke(),Q.beginPath(),Q.strokeStyle=k,s=v;H>=s;s++)0!==s%Z&&(E=s*o,y(E,l,E,K));for(s=G;D>=s;s++)0!==s%Z&&(p=s*o,y(_,p,A,p));Q.stroke(),Q.restore()},Gc.prototype.getAlignmentGuides=function(){var W=this;return{x:W._xAlignmentGuide,y:W._yAlignmentGuide}},Gc.prototype.addAlignmentGuide=function(N,s,T){var E=this,x="x"===N?E._xAlignmentGuide:E._yAlignmentGuide,T=T?T:++E._alignmentGuideId,B={p:s,id:T};if(x.length){var C=E._findClosestAlignmentGuide(B.p,x);C.dis<0?x.splice(C.index+1,0,B):x.splice(C.index,0,B)}else x.push(B);return E._interactor._42(),T},Gc.prototype.findClosest=function(z,T,F){var n=this,$=n._interactor,l=$.gv;F&&(z=Zf.toWorldPosition(l,z));var y,_,t,h=1/0,N=1/0,x=z.x,w=z.y;if(n.gridEnabled){var Q=n.gridBlockSize,K=n.makeMatrix(),X=K.applyInverse(z);X=K.apply({x:Math.round(X.x/Q)*Q,y:Math.round(X.y/Q)*Q}),h=X.x-x,N=X.y-w,t=!0}if($.alignmentGuideEnabled&&(y=n._findClosestAlignmentGuide(x,n._xAlignmentGuide).dis,_=n._findClosestAlignmentGuide(w,n._yAlignmentGuide).dis,Math.abs(y)<Math.abs(h)&&(h=y,t=!0),Math.abs(_)<Math.abs(N)&&(N=_,t=!0)),t){t=!1;var f=l._zoom,E=$.getStyle("smartGuideSensitivity")/f,u={};if(Math.abs(h)<E&&"y"!==T&&(u.x=F?h*f:h,t=!0),Math.abs(N)<E&&"x"!==T&&(u.y=F?N*f:N,t=!0),t)return u}},Gc.prototype._findClosestAlignmentGuide=function(R,i){if(!i.length)return{dis:1/0};for(var j,D=0,u=i.length-1;u-D>1;)j=Math.floor((D+u)/2),i[j].p<R?D=j:u=j;var v=i[D].p-R,k=i[u].p-R;return Math.abs(v)<=Math.abs(k)?{line:i[D],dis:v,index:D}:{line:i[u],dis:k,index:u}},Gc.prototype.removeAllAlignmentGuide=function(V){var L=this;"y"!==V&&(L._xAlignmentGuide=[]),"x"!==V&&(L._yAlignmentGuide=[]),L._interactor._42()},Gc.prototype.removeAlignmentGuide=function(d){for(var N,n,e,H=this,h=H._xAlignmentGuide,W=0;2>W;W++)for(h=0===W?H._xAlignmentGuide:H._yAlignmentGuide,N=0,n=h.length;n>N;N++)if(e=h[N],e.id===d)return h.splice(N,1),H._interactor._42(),{axis:0===W?"x":"y",position:e.p};return!1},Gc.prototype.adjustAlignmentGuide=function(I,l){var C=this,T=C.removeAlignmentGuide(I);return T?(C.addAlignmentGuide(T.axis,l,I),!0):!1};var on=Zf.Guide.Rect=function(f){var Z=this;Z._interactor=f};on.prototype={},on.prototype.constructor=on,on.prototype.gatherRects=function(){var g,X,m,G,J=this,M=J._interactor.gv,R=[],S=[],e={x:R,y:S},t={},P=M.getDataModel(),b=P.a("width"),B=P.a("height");b&&B&&(g=0,X=0,m=b,G=B,R.push({node:P,type:0,p:g},{node:P,type:1,p:g+m/2},{node:P,type:2,p:g+m}),S.push({node:P,type:0,p:X},{node:P,type:1,p:X+G/2},{node:P,type:2,p:X+G}),t[P._id||0]={x:g,y:X,width:m,height:G}),P.each(function(d){if(ph(d)&&!M.isSelected(d)&&M.isVisible(d)){var J=!1;if(M.sm().getSelection().each(function(b){J||(d.isHostOn(b)?J=!0:d.isDescendantOf(b)&&(J=!0))}),!J){var i=d.getRect();g=i.x,X=i.y,m=i.width,G=i.height,R.push({node:d,type:0,p:g},{node:d,type:1,p:g+m/2},{node:d,type:2,p:g+m}),S.push({node:d,type:0,p:X},{node:d,type:1,p:X+G/2},{node:d,type:2,p:X+G}),t[d._id]=i}}}),R.sort(function(V,l){return V.p-l.p}),S.sort(function(Y,p){return Y.p-p.p
}),J._grid=e,J._87I=t},on.prototype.gatherLines=function(C,y,t){var n,x,a,Q,g,G,M,W,$,h,V,m,q=this,B=[q.findClosest({x:C.x,y:C.y},y),q.findClosest({x:C.x+C.w/2,y:C.y+C.h/2},y),q.findClosest({x:C.x+C.w,y:C.y+C.h},y)],_={},Z=q._87I;t=t||255;var p,w;for(q._guideLine=[],n=0;2>n;n++)for(_={},0===n?(Q="y",W=C.x,$=W+C.w):(Q="x",W=C.y,$=W+C.h),x=0;3>x;x++)g=B[x],g&&isFinite(g[Q])&&(p=1<<3*n+x,t&p&&(G=g[Q+"Line"],M=G.node,w=M._id||0,_[w]||(_[w]=!0,m=Z[w],"y"===Q?(h=m.x,V=m.x+m.width):(h=m.y,V=m.y+m.height),a=G.p,q._guideLine.push({type:Q,a:W,b:$,c:h,d:V,p:a,center:1===G.type}))))},on.prototype._binarySearchClosest=function(M,_){if(!_.length)return{dis:1/0};for(var D,c=0,Q=_.length-1;Q-c>1;)D=Math.floor((c+Q)/2),_[D].p<M?c=D:Q=D;var S=_[c].p-M,$=_[Q].p-M;return Math.abs(S)<=Math.abs($)?{line:_[c],dis:S}:{line:_[Q],dis:$}},on.prototype.findClosest=function(W,w,z){var S=this,J=S._interactor,l=J.gv,s=S._grid;z&&(W=Zf.toWorldPosition(l,W));var E,c=S._binarySearchClosest(W.x,s.x),h=S._binarySearchClosest(W.y,s.y),Q=c.dis,a=h.dis,P=l._zoom,H=J.getStyle("smartGuideSensitivity")/P,y={};return Math.abs(Q)<H&&"y"!==w&&(y.x=z?Q*P:Q,y.xLine=c.line,E=!0),Math.abs(a)<H&&"x"!==w&&(y.y=z?a*P:a,y.yLine=h.line,E=!0),E?y:void 0},on.prototype._42=function(){var A=this,V=A._guideLine;if(V&&!R.Default.isCtrlDown()){var p,n,e,r,F,t,j,S,f,J,X,K,H,G,l,Z,k,v=A._interactor,B=v.gv,Y=v._context,q=B.tx(),C=B.ty(),c=B._zoom,s=v.getStyle("guideLineTextSpacing");for(p=0,n=V.length;n>p;p++)e=V[p],S=e.type,f=e.p,J=e.a,X=e.b,K=e.c,H=e.d,G=Math.min(J,K),l=Math.max(X,H),"x"===S?(r=f*c+q,F=G*c+C,t=r,j=l*c+C):(r=G*c+q,F=f*c+C,t=l*c+q,j=F),Zf.Icons.DrawIcon(v,Y,Zf.Icons.MoveLineGuide,{rect:[r,F,t,j],center:e.center}),H>=J&&X>=K||(G=J>H?H:X,l=J>H?J:K,k=l-G,"x"===S?(e.center2center||(r-=s,t=r),F=G*c+C,j=l*c+C,Z=Zf.Icons.MoveLineGuideDistanceV):"y"===S&&(e.center2center||(F-=s,j=F),r=G*c+q,t=l*c+q,Z=Zf.Icons.MoveLineGuideDistanceH),Zf.Icons.DrawIcon(v,Y,Z,{x0:r,y0:F,x1:t,y1:j,dis:k}))}},on.prototype.clear=function(){this._guideLine=null},Zf.DefaultStyleMap={pointSize:[24,9],checkSize:7,rotateCheckSize:10,moveSensitivity:10,rotateRound:Math.PI/2,rotateSensitivity:Math.PI/60,shiftRotateRound:Math.PI/12,shiftLineRotateRound:Math.PI/4,anchorMovable:!0,anchorVisible:!0,anchorHideThreshold:25,anchorOutsideVisibleThreshold:.25,anchorRound:.25,anchorSensitivity:.02,smartGuideSensitivity:8,curveIntersectSize:5,curvePointIntersectSize:8,edgeHostDetectPerFrame:!0,guideLineTextSpacing:0,gridBlockSize:40,gridThickLinesEvery:10,gridThickColor:"#5d5d5d",gridLightColor:"#d0d0d0",gridZoomThreshold:.25,gridAlignmentGuideColor:"#ff0000",gridAngle:Math.PI/2,gridRotation:0,groupRotateModeDefault:"block",groupRotateModeKey:["ctrlKey","metaKey"],rotateCursorSize:32,rotateCursorRound:45,tipTextColor:"#ffffff",tipBackground:"#333333",curveHighlightColor:"#30599e",rectPointBackground:"white",rectPointBorderColor:"#666666",rectPointShadowColor:"rgba(0,0,0,0.35)",shapeCtrlPointBackground:"white",shapeCtrlPointBorderColor:null,shapeCtrlPointHighlightBorder:null,shapeHighlighPointBackground:"#30599e",curveElevationVisible:!0,curveElevationIntersectSize:8,curveElevationGuideShift:[20,0],connectGuideVisible:!0,connectGuideShift:[1,.25,8,0],connectGuideIntersectSize:8,connectGuideGarbageIntersectsize:25,connectGuideGarbageShift:[1,1,-48,-48]};var Zr=Zf.Icons={},yp=1e4,Ue=null,Zo="rgb(51,153,255)",hl="rgb(183,232,135)",xk="rgb(255,204,153)",kh=6;R.Default.setImage("Icons.RectPoint",{width:kh,height:kh,comps:[{type:"rect",background:"rgb(247,247,247)",borderWidth:1,borderColor:Zo,rect:[0,0,kh,kh]}]});var oc="#e000e0";Zr.GroupSubEntityRect={comps:[{type:"shape",points:{func:function(){var X=Zr.GroupSubEntityRect.data;if(!X)return[];var s=X.min,a=X.max;return[s.x,s.y,s.x,a.y,a.x,a.y,a.x,s.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:{func:function(){return Zr.GroupSubEntityRect.data.isKeyOb?oc:"#666666"}}}]},Zr.Line={comps:[{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Zr.Line.data.P1.x,Zr.Line.data.P1.y],kh,kh]}}},{type:"image",name:"Icons.RectPoint",rect:{func:function(){return[[Zr.Line.data.P2.x,Zr.Line.data.P2.y],kh,kh]}}}]},Zr.NodeHoverGuide={comps:[{type:"shape",points:{func:function(){return Zr.NodeHoverGuide.data}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:"#3399FF"}]},Zr.Rect={comps:[{type:"shape",points:{func:function(){var f=Zr.Rect.data;if(!f)return[];var G=f.LT,T=f.LB,i=f.RB,O=f.RT;return[G.x,G.y,T.x,T.y,i.x,i.y,O.x,O.y]}},segments:[1,2,2,2,5],background:null,borderWidth:1,borderColor:Zo},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Zr.Rect.data.rotation}},rect:{func:function(){return[[Zr.Rect.data.LT.x,Zr.Rect.data.LT.y],kh,kh]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Zr.Rect.data.rotation}},rect:{func:function(){return[[Zr.Rect.data.LB.x,Zr.Rect.data.LB.y],kh,kh]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Zr.Rect.data.rotation}},rect:{func:function(){return[[Zr.Rect.data.RB.x,Zr.Rect.data.RB.y],kh,kh]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Zr.Rect.data.rotation}},rect:{func:function(){return[[Zr.Rect.data.RT.x,Zr.Rect.data.RT.y],kh,kh]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Zr.Rect.data.rotation}},visible:{func:function(){return Zr.Rect.data.L?!0:!1}},rect:{func:function(){return[[Zr.Rect.data.L.x,Zr.Rect.data.L.y],kh,kh]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Zr.Rect.data.rotation}},visible:{func:function(){return Zr.Rect.data.R?!0:!1}},rect:{func:function(){return[[Zr.Rect.data.R.x,Zr.Rect.data.R.y],kh,kh]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Zr.Rect.data.rotation}},visible:{func:function(){return Zr.Rect.data.T?!0:!1}},rect:{func:function(){return[[Zr.Rect.data.T.x,Zr.Rect.data.T.y],kh,kh]}}},{type:"image",name:"Icons.RectPoint",rotation:{func:function(){return Zr.Rect.data.rotation}},visible:{func:function(){return Zr.Rect.data.B?!0:!1}},rect:{func:function(){return[[Zr.Rect.data.B.x,Zr.Rect.data.B.y],kh,kh]}}}]};var uo=16;R.Default.setImage("Icons.Anchor",{width:12,height:12,comps:[{type:"shape",borderWidth:1,borderColor:Zo,borderCap:"round",shadowColor:"#1ABC9C",points:[.50928,6,11.49072,6,6,6,6,.50928,6,11.49072]},{type:"circle",borderWidth:1,borderColor:Zo,shadowColor:"#1ABC9C",rect:[2.84391,2.84391,6.53697,6.53697]}]}),Zr.Anchor={comps:[{type:"image",name:"Icons.Anchor",rect:{func:function(){return[[Zr.Anchor.data.POS.x,Zr.Anchor.data.POS.y],uo,uo]}}}]},Zr.TipShiftX=12,Zr.TipShiftY=12;var Hg=[8,28];Zr.TipHelper={comps:[{type:"roundRect",rect:{func:function(){return[Zr.TipHelper.data.helperPos.x,Zr.TipHelper.data.helperPos.y,Hg[0]*Zr.TipHelper.data.size,Hg[1]]}},background:{func:function(){return Ue.getStyle("tipBackground")}},opacity:.6},{type:"text",text:{func:function(){return Zr.TipHelper.data.text}},rect:{func:function(){return[Zr.TipHelper.data.helperPos.x,Zr.TipHelper.data.helperPos.y,Hg[0]*Zr.TipHelper.data.size,Hg[1]]}},color:{func:function(){return Ue.getStyle("tipTextColor")}},font:"bold 12px Arial",align:"center"}]};var yl=7;Zr.ShapePoint={comps:[{type:"circle",rect:{func:function(){var D=Zr.ShapePoint.data;return[D,yl,yl]}},background:"#ffffff",borderWidth:1,borderColor:Zo}]},Zr.ShapeBgCurve={comps:[{type:"shape",points:{func:function(){return Zr.ShapeBgCurve.data.P}},segments:{func:function(){return Zr.ShapeBgCurve.data.S}},background:null,borderWidth:1,borderColor:Zo}]};var yn=8;Zr.ShapeHighlighPoint={comps:[{type:"circle",rect:{func:function(){var R=Zr.ShapeHighlighPoint.data;return[[R.x,R.y],yn,yn]}},background:{func:function(){return Ue.getStyle("shapeHighlighPointBackground")}},borderWidth:0}]};var to=10;Zr.ShapeHighlighRealPoint={comps:[{type:"circle",rect:{func:function(){var S=Zr.ShapeHighlighRealPoint.data;return[[S.x,S.y],to,to]}},background:"#ffffff",borderWidth:2,borderColor:Zo}]};var Li=8;Zr.ShapeHighlighCtrlPoint={comps:[{type:"shape",points:{func:function(){var a=Zr.ShapeHighlighCtrlPoint.data,O=a.x,x=a.y,I=Li/2;return[O-I,x-I,O-I,x+I,O+I,x+I,O+I,x-I]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Ue.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return Ue.getStyle("shapeCtrlPointBorderColor")||Zo}}}]};var Eh=3;Zr.ShapeHighlightCurve={comps:[{type:"shape",points:{func:function(){return Zr.ShapeHighlightCurve.data}},segments:[1,4],background:null,borderWidth:Eh,borderColor:{func:function(){return Ue.getStyle("curveHighlightColor")}}}]},Zr.ShapeGuideLine={comps:[{type:"shape",points:{func:function(){return Zr.ShapeGuideLine.data}},background:null,borderWidth:1,borderColor:"rgb(255,204,153)"}]},Zr.MoveLineGuide={comps:[{type:"shape",points:{func:function(){return Zr.MoveLineGuide.data.rect}},background:null,borderWidth:1,borderColor:{func:function(){return Zr.MoveLineGuide.data.center?hl:xk}}}]};var Cl=5;Zr.MoveLineGuideDistanceH={comps:[{type:"shape",points:{func:function(){var l=Zr.MoveLineGuideDistanceH.data,g=l.x0,B=l.y0;return[g,B-Cl,g,B+Cl]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:xk},{type:"shape",points:{func:function(){var l=Zr.MoveLineGuideDistanceH.data,m=l.x1,i=l.y1;return[m,i-Cl,m,i+Cl]}},rotation:-Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:xk},{type:"text",text:{func:function(){return Math.round(Zr.MoveLineGuideDistanceH.data.dis)}},rect:{func:function(){var n=Zr.MoveLineGuideDistanceH.data;return[[(n.x0+n.x1)/2,n.y0-10],20,20]}},color:xk,font:"12px Arial",align:"center"}]},Zr.MoveLineGuideDistanceV={comps:[{type:"shape",points:{func:function(){var m=Zr.MoveLineGuideDistanceV.data,u=m.x0,i=m.y0;return[u-Cl,i,u+Cl,i]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:xk},{type:"shape",points:{func:function(){var r=Zr.MoveLineGuideDistanceV.data,F=r.x1,P=r.y1;return[F-Cl,P,F+Cl,P]}},rotation:Math.PI/4,segments:[1,2],background:null,borderWidth:1,borderColor:xk},{type:"text",text:{func:function(){return Math.round(Zr.MoveLineGuideDistanceV.data.dis)}},rect:{func:function(){var K=Zr.MoveLineGuideDistanceV.data;return[[K.x0-10,(K.y0+K.y1)/2],20,20]}},color:xk,font:"12px Arial",align:"center"}]},R.Default.setImage("Icons.EdgeElevationGuideImage",{width:16,height:16,comps:[{type:"oval",background:"rgb(255,255,255)",borderWidth:1,borderColor:"rgb(138,138,138)",rect:[.5,.5,15,15]},{type:"shape",borderWidth:2,borderColor:"rgb(44,44,44)",borderCap:"round",points:[4,8,8,4,12,8,8,4,8,13],segments:[1,2,2,1,2]}]}),Zr.EdgeElevationGuide={comps:[{type:"image",name:"Icons.EdgeElevationGuideImage",rect:{func:function(){var $=Zr.EdgeElevationGuide.data,Z=$.x,A=$.y,a=Ue.getStyle("curveElevationIntersectSize"),K=Ue.getStyle("curveElevationGuideShift");return Z+=K[0],A+=K[1],[Z-a,A-a,2*a,2*a]}}}]},R.Default.setImage("Icons.ConnectGuideBgImage",{width:12,height:12,comps:[{type:"shape",background:"#3399ff",fillRule:"evenodd",shadowColor:"#1ABC9C",rotation:3.14159,points:[6.00001,11.99999,6.00001,11.99999,2.6863,11.99999,1e-5,9.30695,1e-5,5.99999,1e-5,5.99999,1e-5,2.68628,2.69305,-1e-5,6.00001,-1e-5,12.00001,-1e-5,11.99998,12.00001,6.00001,11.99999],segments:[1,2,4,2,4,2,2,2]}]}),R.Default.setImage("Icons.ConnectGuideHeaderImage",{width:12,height:12,comps:[{type:"oval",background:"#3399FF",borderColor:"#3399FF",shadowColor:"#1ABC9C",rect:[0,0,12,12]},{type:"shape",borderWidth:1,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[4.76,2.56,8.2,5.98,4.76,9.44]}]}),Zr.ConnectGuide={comps:[{type:"image",name:"Icons.ConnectGuideBgImage",rotation:{func:function(){return Zr.ConnectGuide.data.rotation}},rect:{func:function(){var b=Zr.ConnectGuide.data.connect;b.x,b.y;var z=Ue.getStyle("connectGuideIntersectSize");return[[b.x,b.y],2*z,2*z]}}},{type:"image",name:"Icons.ConnectGuideHeaderImage",rect:{func:function(){var T=Zr.ConnectGuide.data.cursorPos||Zr.ConnectGuide.data.connect,v=Ue.getStyle("connectGuideIntersectSize");return[[T.x,T.y],2*v-2,2*v-2]}}},{type:"shape",background:null,borderColor:"#3399ff",borderWidth:2,segments:[1,4],points:{func:function(){var X=Zr.ConnectGuide.data.connect,$=Zr.ConnectGuide.data.cursorPos||X;return[X.x,X.y,X.x+.5*($.x-X.x),X.y,$.x+.5*(X.x-$.x),$.y,$.x,$.y]}}}]},R.Default.setImage("Icons.ConnectGuideGarbageImage",{width:48,height:48,comps:[{type:"oval",background:"rgba(0,0,0,0.1)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,48,48]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[19.84721,19.69091,19.84721,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[24.10371,19.69091,24.10371,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[28.15279,19.69091,28.15279,32.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[11.23055,15.22377,36.76945,15.189,19.12302,15.17121,20.94722,11.5228,26.41985,11.5228,28.24406,15.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[15.48702,15.22377,17.02595,21.25344]}]}),R.Default.setImage("Icons.ConnectGuideDeletingImage",{width:56,height:56,comps:[{type:"oval",background:"rgba(232,0,0,0.75)",borderColor:"#979797",shadowColor:"#1ABC9C",rect:[0,0,56,56]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[22.67939,27.69091,22.67939,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[26.93588,27.69091,26.93588,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",points:[30.98497,27.69091,30.98497,40.25123]},{type:"shape",borderWidth:2,borderColor:"rgb(255,255,255)",borderCap:"round",shadowColor:"#1ABC9C",anchorX:0,anchorY:1,rotation:5.65062,points:[14.06272,23.22377,39.60163,23.189,21.9552,23.17121,23.7794,19.5228,29.25203,19.5228,31.07623,23.17121]},{type:"rect",borderWidth:2,borderColor:"rgb(255,255,255)",shadowColor:"#1ABC9C",rect:[18.3192,23.22377,17.02595,21.25344]}]}),Zr.ConnectGuideGarbage={comps:[{type:"image",name:{func:function(){var U=Zr.ConnectGuideGarbage.data.hover;return U?"Icons.ConnectGuideDeletingImage":"Icons.ConnectGuideGarbageImage"}},rect:{func:function(){var e=Zr.ConnectGuideGarbage.data,H=Ue.getStyle("connectGuideGarbageIntersectsize");return e.hover&&(H+=5),[[e.x,e.y],2*H,2*H]}}}]};var up=6;Zr.ShapeActivingCtrl={comps:[{type:"shape",visible:{func:function(){return Zr.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var a=Zr.ShapeActivingCtrl.data;return[a.point.x,a.point.y,a.c1.x,a.c1.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:Zo},{type:"shape",visible:{func:function(){return Zr.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var B=Zr.ShapeActivingCtrl.data;return[B.point.x,B.point.y,B.c2.x,B.c2.y]}},segments:[1,2],background:null,borderWidth:1,borderColor:Zo},{type:"shape",visible:{func:function(){return Zr.ShapeActivingCtrl.data.c1?!0:!1}},points:{func:function(){var g=Zr.ShapeActivingCtrl.data.c1,n=g.x,v=g.y,j=up/2;return"c1"===Zr.ShapeActivingCtrl.data.hl&&(j+=.5),[n-j,v-j,n-j,v+j,n+j,v+j,n+j,v-j]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Ue.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c1"===Zr.ShapeActivingCtrl.data.hl?Ue.getStyle("shapeCtrlPointHighlightBorder")||Zo:Ue.getStyle("shapeCtrlPointBorderColor")||Zo}}},{type:"shape",visible:{func:function(){return Zr.ShapeActivingCtrl.data.c2?!0:!1}},points:{func:function(){var V=Zr.ShapeActivingCtrl.data.c2,h=V.x,u=V.y,M=up/2;return"c2"===Zr.ShapeActivingCtrl.data.hl&&(M+=.5),[h-M,u-M,h-M,u+M,h+M,u+M,h+M,u-M]}},segments:[1,2,2,2,5],borderWidth:2,background:{func:function(){return Ue.getStyle("shapeCtrlPointBackground")}},borderColor:{func:function(){return"c2"===Zr.ShapeActivingCtrl.data.hl?Ue.getStyle("shapeCtrlPointHighlightBorder")||Zo:Ue.getStyle("shapeCtrlPointBorderColor")||Zo}}}]},Zf.Icons.DrawIcon=function($,U,k,l){k.width=k.height=yp,k.data=l,Ue=$,R.Default.drawImage(U,k,0,0,yp,yp)},Zf.Icons.MapPoints=function(J,T){for(var S=0,e=J.length;e>S;S++)J[S]/=T},Zf.roundTo=function(B,c,V){var W=Math.abs(B%c);return V>W||V>c-W?c*Math.round(B/c):B},Zf.toFixed=function(L){return Math.round(100*L)/100},Zf.getDataMatrix=function(E){if(E instanceof R.Shape){var m=new R.Math.Matrix2d,n=E.getPosition();return m.translate(-n.x,-n.y).scale(E.getScale().x,E.getScale().y).rotate(E.getRotation()).translate(n.x,n.y),m}return E.getMatrix?E.getMatrix():new R.Math.Matrix2d};var nc=Zf.Math.Curve=function(){this._curves=[]};nc.prototype={},nc.prototype.constructor=nc,nc.prototype.createFromHtShape=function(z,U,y){U instanceof R.List&&(U=U.toArray());var f,T,Z,p,C,J,r,o=this,O=null,F=null,$=0,l=Zf.Math.Vector2,Q=Zf.Math.CubicBezier,P=function(R){return new l(z[R],z[R+1],y?y[R/2]:i)};for(T=0,Z=U.length;Z>T;T++){switch(p=U[T],C=null,p){case 1:F=P($),O=F,$+=2;break;case 2:f=P($),$+=2,C=new Q(F,F.clone(),f.clone(),f),F=f;break;case 3:J=P($),f=P($+2),$+=4,C=new Q(F,J.clone().sub(F).multiplyScalar(2/3).add(F),J.clone().sub(f).multiplyScalar(2/3).add(f),f),F=f;break;case 4:J=P($),r=P($+2),f=P($+4),$+=6,C=new Q(F,J,r,f),F=f;break;case 5:if(!O)break;C=new Q(F,F.clone(),O.clone(),O),F=null,O=null}C&&(C._index=o._curves.length,o._curves.push(C))}},nc.prototype.checkPoint=function(q,M){var G,n,m,y,t,J=this,Z=J._curves;for(G=0,n=Z.length;n>G;G++)if(y=Z[G],t=y.intersectRect(q,M,M),t.length)return m=0,t.forEach(function(d){m+=d.t}),m/=t.length,q=y.getPointAt(m),q.t=m,{bezier:y,intersection:q}},nc.prototype.insertKnot=function(p,N){var m=p.insertKnot(N),h=this,F=h._curves;F.splice(p._index,1,m[0],m[1])},nc.prototype._isCloseEnough=function(I,w){return Math.abs(I.x-w.x)<1e-6&&Math.abs(I.y-w.y)<1e-6},nc.prototype._isSamePoint=function(x,o){return x===o},nc.prototype.moveRealPoint=function(Q,D){var L=this,k=L._curves,R=D.clone().sub(Q);k.forEach(function(F){var i=F._p1;F._p2,F._p3;var j=F._p4;L._isSamePoint(i,Q)&&(F._p2.add(R),F._p1=D),L._isSamePoint(j,Q)&&(F._p3.add(R),F._p4=D)})},nc.prototype.moveCtrlDueToRealPointMovement=function(D,A){var E=this,X=E._curves,Q=function($){$.add(A),$.e&&A.e&&($.e+=A.e)};X.forEach(function(U){var z=U._p1;U._p2,U._p3;var G=U._p4;E._isSamePoint(z,D)&&Q(U._p2),E._isSamePoint(G,D)&&Q(U._p3)})},nc.prototype.moveCtrlPoint=function(N,$,R){var u=N[R];if(u){u.e!==i&&($.e=u.e);var f=this,P=f._curves;$.clone().sub(u),P.forEach(function(F){var h;"c2"===R?h="_p2":"c1"===R&&(h="_p3"),f._isSamePoint(F[h],u)&&(F[h]=$)}),N[R]=$}},nc.prototype.deleteRealPoint=function(j,E){var t,g,r,p,m,G,K,C=this,f=C._curves,z={},Q=[],N=Zf.Math.CubicBezier;for(g=0,r=f.length;r>g;g++)t=f[g],p=t._p1,m=t._p2,G=t._p3,K=t._p4,(z[g]||!C._isSamePoint(p,j))&&(C._isSamePoint(K,j)?r>g+1&&C._isSamePoint(f[g+1]._p1,j)&&(E||Q.push(new N(p,m,f[g+1]._p3,f[g+1]._p4))):Q.push(t));C._curves=Q},nc.prototype.findPairs=function(d,Z){var H,x,J,Y,C,O,G,n,a=this,t=a._curves,w={},$=[];for(x=0,J=t.length;J>x;x++)H=t[x],Y=H._p1,C=H._p2,O=H._p3,G=H._p4,!w[x]&&a._isSamePoint(Y,d)&&(Z?$.push({point:Y,r2:G}):$.push({point:Y,c2:C})),a._isSamePoint(G,d)&&(n=Z?{point:G,r1:Y}:{point:G,c1:O},J>x+1&&a._isSamePoint(t[x+1]._p1,d)&&(Z?n.r2=t[x+1]._p4:n.c2=t[x+1]._p2,w[x+1]=!0),$.push(n));return $},nc.prototype.toHtShape=function(){var K=this,F=K._curves,s=[],_=[],G={x:1/0,y:1/0};return F.forEach(function(k){var h=k._p1,c=k._p2,R=k._p3,O=k._p4;return K._isCloseEnough(h,G)||(s.push(1),_.push(h.clone())),G=O,K._isCloseEnough(h,c)&&K._isCloseEnough(R,O)?(s.push(2),_.push(O.clone()),void 0):(s.push(4),_.push(c.clone(),R.clone(),O.clone()),void 0)}),{segments:s,points:_}};var fs=Zf.Math.CubicBezier=function(q,x,p,C){var A=this;A._id=Zf.Math.CubicBezier._globalId++,A._p1=q,A._p2=x,A._p3=p,A._p4=C};fs._globalId=1,fs.prototype={},fs.prototype.constructor=fs,fs.prototype.toString=function(){return this._id},fs.prototype.intersectRect=function(u,g,s){var c=g/2,I=s/2,N=u.x,y=u.y,W=Zf.Math.Vector2,i=new W(-c+N,-I+y),f=new W(c+N,I+y),l=new W(f.x,i.y),M=new W(i.x,f.y),S=this,Q=S.intersectLine(i,l),p=S.intersectLine(l,f),P=S.intersectLine(f,M),o=S.intersectLine(M,i),A=Q.concat(p).concat(P).concat(o);return A},fs.prototype.intersectLine=function(Z,V){var A,D,o,k,n,B,G,$,z,W,O,S,r,j=this,g=Z.clone().min(V),C=Z.clone().max(V);k=j._p1,n=j._p2,B=j._p3,G=j._p4,A=k.clone().multiplyScalar(-1),D=n.clone().multiplyScalar(3),o=B.clone().multiplyScalar(-3),O=A.add(D).add(o).add(G),A=k.clone().multiplyScalar(3),D=n.clone().multiplyScalar(-6),o=B.clone().multiplyScalar(3),W=A.add(D).add(o),A=k.clone().multiplyScalar(-3),D=n.clone().multiplyScalar(3),z=A.add(D),$=k.clone(),r=new Zf.Math.Vector2(Z.y-V.y,V.x-Z.x),S=Z.x*V.y-V.x*Z.y;for(var f=j.getRoots(r.dot(O),r.dot(W),r.dot(z),r.dot($)+S),J=new Array,R=0,b=f.length;b>R;R++){var x=f[R];if(!(0>x||x>1)){var v=k.clone().lerp(n,x),s=n.clone().lerp(B,x),c=B.clone().lerp(G,x),y=v.lerp(s,x),L=s.lerp(c,x),i=y.lerp(L,x);i.t=x,Z.x==V.x?g.y<=i.y&&i.y<=C.y&&J.push(i):Z.y==V.y?g.x<=i.x&&i.x<=C.x&&J.push(i):i.x>=g.x&&i.y>=g.y&&i.x<=C.x&&i.y<=C.y&&J.push(i)}}return J},fs.prototype.solveTForPoint=function(n){var g,o,G,s,w=this;g=w._p1.x-n.x,o=w._p2.x-n.x,G=w._p3.x-n.x,s=w._p4.x-n.x;for(var I=w.getRoots(s-3*G+3*o-g,3*G-6*o+3*g,3*o-3*g,g),a=i,P=1/0,F=0,p=I.length;p>F;F++){var e=I[F];if(!(0>e||e>1)){var f=w._p1.clone().lerp(w._p2,e),r=w._p2.clone().lerp(w._p3,e),T=w._p3.clone().lerp(w._p4,e),E=f.lerp(r,e),X=r.lerp(T,e),y=E.lerp(X,e);y.t=e;var H=Math.abs(y.y-n.y);P>H&&(P=H,a=y)}}return a},fs.prototype.getPointAt=function(f){var r=this,_=r._p1,c=r._p2,R=r._p3,L=r._p4,h=_.clone().lerp(c,f),k=c.clone().lerp(R,f),x=R.clone().lerp(L,f),d=h.lerp(k,f),a=k.lerp(x,f);return d.lerp(a,f)},fs.prototype.getRoots=function(B,c,E,g){var z,f,Q,X,H,q=new Array;if(Math.abs(B)<1e-6){var z=c,f=E/z,Q=g/z,X=f*f-4*Q;if(X>0){var H=Math.sqrt(X);q.push(.5*(-f+H)),q.push(.5*(-f-H))}else 0==X&&q.push(.5*-f)}c/=B,E/=B,g/=B,z=(3*E-c*c)/3,f=(2*c*c*c-9*E*c+27*g)/27;var h=c/3,_=f*f/4+z*z*z/27,V=f/2;if(Math.abs(_)<=1e-6&&(_=0),_>0){var n,u,H=Math.sqrt(_);n=-V+H,u=n>=0?Math.pow(n,1/3):-Math.pow(-n,1/3),n=-V-H,n>=0?u+=Math.pow(n,1/3):u-=Math.pow(-n,1/3),q.push(u-h)}else if(0>_){var k=Math.sqrt(-z/3),A=Math.atan2(Math.sqrt(-_),-V)/3,Y=Math.cos(A),d=Math.sin(A),J=Math.sqrt(3);q.push(2*k*Y-h),q.push(-k*(Y+J*d)-h),q.push(-k*(Y-J*d)-h)}else{var n;n=V>=0?-Math.pow(V,1/3):Math.pow(-V,1/3),q.push(2*n-h),q.push(-n-h)}return q},fs.prototype._70I=function(){var T=this;return T._p1.distanceToSquared(T._p2)<1e-10&&T._p3.distanceToSquared(T._p4)<1e-10},fs.prototype.insertKnot=function(G){var d=this,W=d._p1,E=d._p2,f=d._p3,k=d._p4,D=W.clone().lerp(E,G),B=E.clone().lerp(f,G),h=f.clone().lerp(k,G),L=D.clone().lerp(B,G),O=B.clone().lerp(h,G),v=L.clone().lerp(O,G);return d._70I()?(W.clone().lerp(k,G),[new Zf.Math.CubicBezier(W,W.clone(),v.clone(),v),new Zf.Math.CubicBezier(v,v.clone(),k.clone(),k)]):[new Zf.Math.CubicBezier(W,D,L,v),new Zf.Math.CubicBezier(v,O,h,k)]};var Wc=R.Default.getInternal().ui().EdgeUI,ve={_47O:function(v){var o=this,G=ve.getBackups()._47O;Zf.inEdit(o.gv)||G.call(o,v)}};Zf.Inject.registAsModule(ve,Wc);var go=R.Default.getInternal().ui().NodeUI,wp={_47O:function(q){var V=this,t=wp.getBackups()._47O;Zf.inEdit(V.gv)||t.call(V,q)},getSelectWidth:function(){var W=this,$=W.gv,N=W._data;if($.isEditable(N)&&Zf.inEdit($))return 0;var s=wp.getBackup("getSelectWidth");return s.call(W)}};Zf.Inject.registAsModule(wp,go);var yi=R.graph.GraphView,dp={_editPointSize:function(){var A=R.Default.isTouchable,i=Zf.getStyle("pointSize");return i[A?0:1]}(),isPointEditable:function(S){var e=this;if(Zf.inEdit(e))return e._pointEditableFunc?e._pointEditableFunc(S):!0;var N=dp.getBackup("isPointEditable");N.call(e,S)},isEditable:function(A){var p,v=this,T=dp.getBackup("isEditable");if(p=A instanceof Zf.Group?!0:T.call(v,A),!Zf.inEdit(v))return p;if(!(A instanceof R.Edge))return p;if(!A.s("2d.editable"))return!1;var H=v.getEditableFunc();return H?H(A):!0},_42:function(u,F){var M=this,x=dp.getBackups()._42;if(x.call(M,u,F),Zf.inEdit(M)){var f=M.getEditInteractor();f.drawImpl()}}};Zf.Inject.registAsModule(dp,yi);var Uf=R.Default.getInternal().ui().ShapeUI,xh={_47O:function(l){var L=this,Z=xh.getBackups()._47O;Zf.inEdit(L.gv)||Z.call(L,l)}};Zf.Inject.registAsModule(xh,Uf);var Xn=R.graph.DefaultInteractor,pd={handle_mousewheel:function(n){var E=this,Q=pd.getBackup("handle_mousewheel");Zf.inEdit(E.gv)||Q.call(E,n)}};Zf.Inject.registAsModule(pd,Xn);var Yk=R.graph.MoveInteractor,gg={_calcShift:function(_,t){var d=this,N=gg.getBackup("_calcShift"),X=d.gv;if(!Zf.inEdit(X))return N.call(d,_,t);var G=X.getEditInteractor(),q=G.getSubModule("Move").calcShift(_,t,d);return q||N.call(d,_,t)},clear:function(i){var v=this,o=gg.getBackup("clear");o.call(v,i);var x=v.gv;if(Zf.inEdit(x)){var E=x.getEditInteractor();E.getSubModule("Move").clear(i)}}};Zf.Inject.registAsModule(gg,Yk);var on=Zf.Rect=function(F){this.catalog="Rect",this._interactor=F};on.prototype={},on.prototype.constructor=on,on.prototype.gatherInfo=function(L,j){var n=this;if(1===j.length){var f=j[0];return f instanceof R.Shape&&f._70I()?n.gatherLine(L,f):Vg(f,L)?!1:n.gatherSingleTarget(L,f)}return j.length>1?n.gatherMultiTargets(L,j):!1},on.prototype.gatherSingleTarget=function(v,r){if(r.getCorners){var t,V=this,s=V.info;V.target=r,t=V.screenInfo={};var Z=r.getCorners();s.LT=new Zf.Math.Vector2(Z[0]),s.LB=new Zf.Math.Vector2(Z[1]),s.RB=new Zf.Math.Vector2(Z[2]),s.RT=new Zf.Math.Vector2(Z[3]),s.T=s.LT.clone().add(s.RT).divideScalar(2),s.B=s.LB.clone().add(s.RB).divideScalar(2),s.L=s.LT.clone().add(s.LB).divideScalar(2),s.R=s.RT.clone().add(s.RB).divideScalar(2);for(var X in s)t[X]=Zf.toScreenPosition(v,s[X]);var N=V._interactor,_=N.getStyle("checkSize"),I=function(m,L,M){var k=L.clone().sub(m).setLength(-_),J=M.clone().sub(m).setLength(-_),v=k.add(J).add(m);return v};return t.rotLT=I(t.LT,t.RT,t.LB),t.rotLB=I(t.LB,t.LT,t.RB),t.rotRB=I(t.RB,t.LB,t.RT),t.rotRT=I(t.RT,t.LT,t.RB),t.rotT=t.rotLT.clone().add(t.rotRT).divideScalar(2),t.rotB=t.rotLB.clone().add(t.rotRB).divideScalar(2),t.rotL=t.rotLT.clone().add(t.rotLB).divideScalar(2),t.rotR=t.rotRT.clone().add(t.rotRB).divideScalar(2),t.rotation=r.getRotation(),V.gatherConnectInfo(),!0}},on.prototype.gatherConnectInfo=function(){var A=this,b=A.target,U=A._interactor,E=A.screenInfo,l=U.gv;if(b instanceof R.Node&&U.getStyle("connectGuideVisible")){var I=b.s("connectGuideShift")||U.getStyle("connectGuideShift"),L=b.getAnchor(),X=b.getSize(),D=b.toGlobal({x:X.width*(I[0]-L.x),y:X.height*(I[1]-L.y)});D=Zf.toScreenPosition(l,D),E.P1?D.add(E.P2.clone().sub(E.P1).setLength(I[2])):(D.add(E.RT.clone().sub(E.LT).setLength(I[2])),D.add(E.LB.clone().sub(E.LT).setLength(I[3]))),E.connect=D}},on.prototype.gatherMultiTargets=function(b,N){var w=Zf.Group.findOrCreateGroup(N);if(!w)return!1;var d=this;return d.editing&&"rotate"!==d.editing.mode||w.calcInfo(),d.gatherSingleTarget(b,w)},on.prototype.gatherLine=function(Y,k){this.target=k;var g=this.screenInfo={},I=k.getPoints(),W=Zf.getDataMatrix(k);return g.P1=Zf.toScreenPosition(Y,W.apply(I.get(0))),g.P2=Zf.toScreenPosition(Y,W.apply(I.get(1))),this.gatherConnectInfo(),!0},on.ResizeKeys=["LT","RB","LB","RT","L","R","B","T"],on.ResizeDirection=[{x:-1,y:-1},{x:1,y:1},{x:-1,y:1},{x:1,y:-1},{x:-1,y:0},{x:1,y:0},{x:0,y:1},{x:0,y:-1}],on.RotateKeys=["rotLT","rotRB","rotLB","rotRT","rotL","rotR","rotB","rotT"],on.prototype.check=function(r,q,k){if(R.Default.isLeftButton(q)){var s=this;if(s.editing=null,s.tipInfo=null,s.screenInfo){var M=s.target,j=r.isEditable(M),X=s.screenInfo;if(j&&X.connect){var A=s._checkConnect(k);if(A)return A}if(X.P1)return s._checkLine(k);var c,Z,m,P=null,y=s._interactor,t=y.getStyle("checkSize");if(j&&r.isRectEditable(M))for(Z=0;Z<Zf.Rect.ResizeKeys.length;Z++)if(m=Zf.Rect.ResizeKeys[Z],Zf.checkHit(k,X[m],t)){P=m,c="resize";break}if(!P&&j&&r.isRotationEditable(M)){var G=y.getStyle("rotateCheckSize");for(Z=0;Z<Zf.Rect.RotateKeys.length;Z++)if(m=Zf.Rect.RotateKeys[Z],Zf.checkHit(k,X[m],G)){P=m,c="rotate";break}}if(!P)return y.setCursor("default"),void 0;if("rotate"===c){var $,Y=r.lp(q);if(M instanceof Zf.Group){var d=y.getStyle("groupRotateModeKey");"string"==typeof d&&(d=[d]);for(var p=!1,B=0,T=d.length;T>B;B++)if(q[d[B]]){p=!0;break}var J=y.getStyle("groupRotateModeDefault");$=p?"batch"===J?"block":"batch":J}var z="batch"===$?M.getAnchor2():M.getPosition(),S=Math.atan2(Y.y-z.y,Y.x-z.x);y._setRotateCursor(S),s.editing={mode:c,key:P,pos:z,flipY:M.getScale().y<0,rotation:M.getRotation(),hitRot:S},$&&(s.editing.groupRotateMode=$)}else{var h=Zf.Rect.ResizeKeys.indexOf(P),F=Zf.Rect.ResizeDirection[h],l=Math.cos(M.getRotation()),W=Math.sin(M.getRotation()),E=F.x*Math.sign(M.getScale().x),e=F.y*Math.sign(M.getScale().y),o=Math.atan2(-W*E-l*e,l*E-W*e),L=(Math.round(o/(Math.PI/4))+8)%8,b=["ew-resize","nesw-resize","ns-resize","nwse-resize","ew-resize","nesw-resize","ns-resize","nwse-resize"][L];this._interactor.setCursor(b);var n=M.getWidth(),K=M.getHeight(),Q=M.getAnchor();s.editing={mode:c,key:P,rect:{x:-n*Q.x,y:-K*Q.y,width:n,height:K},anchor:Q,matrix:M.getMatrix()}}return P}}},on.prototype._checkLine=function(J){var V=this;V.screenInfo;var I,c=V._interactor.getStyle("checkSize");if(Zf.checkHit(J,V.screenInfo.P1,c))I="P1";else{if(!Zf.checkHit(J,V.screenInfo.P2,c))return this._interactor.setCursor("default"),void 0;I="P2"}return V.editing={mode:"line",key:I},I},on.prototype._checkConnect=function(e){var l=this,f=l.screenInfo,T=l._interactor,y=T.getStyle("connectGuideIntersectSize"),b=f.connect,x=e.x,Q=b.x;if(Q>x&&y>Q-x&&Math.abs(b.y-e.y)<y||x>=Q&&Zf.checkHit(e,b,y)){var m="connect",k=p.getConnectAction(T.gv);return l.editing={mode:m},k&&k.delete&&k.delete.visible.call(null,T.gv,l.target)&&(l.editing.hasDeleteAction=!0),T.setCursor("default"),m}},on.prototype._fireEditEvent=function(j,x){var G=this._interactor,n=this.editing;if(n){var T=n.mode;T="rotate"===T?"Rotation":"connect"===T?"Connection":T[0].toUpperCase()+T.slice(1),G.fi({kind:j+"Edit"+T,event:x})}},on.prototype.startEdit=function(z,O){z.startDragging(O);var t=this;t._interactor.fi({kind:"prepareEdit",event:O});var e=t.editing,V=t.target;if(e){if(t._fireEditEvent("begin",O),"rotate"===e.mode)return e.groupRotateMode&&V.beginRotate(e),void 0;if("connect"!==e.mode)("line"===e.mode||V&&0===V.getRotation())&&(t._inSmartGuide=!0,t._interactor.rectGuide.gatherRects());else if(e.hasDeleteAction){var K=z.gv,D=t._interactor.getStyle("connectGuideGarbageShift");e.garbageInfo={x:K.getWidth()*D[0]+D[2],y:K.getHeight()*D[1]+D[3],size:t._interactor.getStyle("connectGuideGarbageIntersectsize")},z._42()}}},on.prototype._46O=function(h){var W,M=this,x=M.editing;if(x){if("connect"===x.mode&&!x.canceled&&!x.deleted)try{x.garbageInfo&&x.garbageInfo.hover?p.doDeleteConnectionAction(M._interactor.gv,M.target):p.doConnectAction(M._interactor.gv,M.target,x.target)}catch(b){console.error(b)}W=M.editing.groupRotateMode,M._fireEditEvent("end",h),M.editing=null}M.tipInfo=null,M._inSmartGuide&&(M._interactor.rectGuide.clear(),M._inSmartGuide=!1),W&&M.target&&M.target.endRotate()},on.prototype.handleNormalStateDelete=function(){var d=this,Z=d.editing;if(Z&&"connect"===Z.mode&&!Z.canceled&&!Z.deleted){if(Z.garbageInfo){try{p.doDeleteConnectionAction(d._interactor.gv,d.target)}catch(T){console.error(T)}Z.garbageInfo=null}return Z.cursorPos=null,Z.targetCorners=null,Z.deleted=!0,d._interactor._42(),!0}},on.prototype.handleNormalStateKeyDown=function(g){var o=this,C=o.editing;return!C||"connect"!==C.mode||C.canceled||C.deleted?void 0:R.Default.isEsc(g)?(C.cursorPos=null,C.targetCorners=null,C.canceled=!0,o._interactor._42(),!0):void 0},on.prototype.handleEdit=function(I,l){var V=this,W=V.editing;if(W){var K,Y,v,Q,e,f=V.target,d=W.key,M=W.mode,x=I.lp(l),J=V._interactor;
if("connect"===M){if(W.canceled)return;if(W.deleted)return;W.cursorPos=J._getLogicalPoint(l);var F=W.garbageInfo;return F&&Zf.checkHit(W.cursorPos,F,F.size)?(F.hover=!0,W.target=null,W.targetCorners=null):(F&&(F.hover=!1),W.target=I.getDataAt(x,function(b){return I.isSelectable(b)?ph(b)?!0:!1:!1})||null,W.targetCorners=Zf.getTargetCornersOnScreen(I,W.target)),J._42(),void 0}if("rotate"===M){var k,D,T=W.pos,U=Math.atan2(x.y-T.y,x.x-T.x);if(W.groupRotateMode?D=U-W.hitRot:(k=U-W.hitRot,D=W.rotation+k),D%=2*Math.PI,0>D&&(D+=2*Math.PI),!R.Default.isCtrlDown(l)){var r,p;sb(l)?(r=J.getStyle("shiftRotateRound"),p=r/2):(r=J.getStyle("rotateRound"),p=J.getStyle("rotateSensitivity")),D=Zf.roundTo(D,r,p)}W.groupRotateMode?(k=D-(W.lastRotation||0),0!==k&&(f.addRotation(k,W.groupRotateMode),W.lastRotation=D)):f.setRotation(D),J._setRotateCursor(U),D>Math.PI&&(D-=2*Math.PI);var h=180*(D/Math.PI);h=h.toFixed(2),K=""+h+""}else if("resize"===M){var y=W.rect;v=y.x,Q=y.y;var t,j=y.width,b=y.height,P=W.anchor,w=W.matrix,m=sb(l),i=V._unionPointMode1,B=V._unionPointMode2;if(V._inSmartGuide&&!R.Default.isCtrlDown(l)&&!m){var n;"L"===d||"R"===d?n="x":("T"===d||"B"===d)&&(n="y"),V._adsorbedToClosest(x,n),e=!0}t=w.tfi(x);var O;"LT"===d?(y=i(t,{x:v+j,y:Q+b},j,b,m),O=9):"T"===d?(y=B({x:v,y:t.y},{x:v+j,y:Q+b},j,b,m,"v"),O=1):"RT"===d?(y=i(t,{x:v,y:Q+b},j,b,m),O=33):"L"===d?(y=B({x:t.x,y:Q},{x:v+j,y:Q+b},j,b,m,"h"),O=8):"R"===d?(y=B({x:v,y:Q},{x:t.x,y:Q+b},j,b,m,"h"),O=32):"LB"===d?(y=i(t,{x:v+j,y:Q},j,b,m),O=12):"B"===d?(y=B({x:v,y:Q},{x:v+j,y:t.y},j,b,m,"v"),O=4):"RB"===d&&(y=i(t,{x:v,y:Q},j,b,m),O=36);var C=w.tf(y.x+y.width*P.x,y.y+y.height*P.y);f.setPosition(C),f.setSize(y.width,y.height),e&&(Y=f.getRect(),J.rectGuide.gatherLines({node:f,x:Y.x,y:Y.y,w:Y.width,h:Y.height},n,O)),K=""+Math.round(y.width)+" * "+Math.round(y.height)}else if("line"===M){if(sb(l)){var G=f.getPoints(),z="P1"===d?G.get(1):G.get(0),q={x:x.x-z.x,y:x.y-z.y},c=J.getStyle("shiftLineRotateRound"),u=V._shiftDirList;if(!u||V._shiftRotateRound!==c){V._shiftRotateRound=c,V._shiftDirList=u=[];for(var _=0;_<Math.PI;_+=c)u.push({x:g(_),y:$(_)})}for(var o,N=0,L=0,E=u.length;E>L;L++){var X=u[L],s=X.x*q.x+X.y*q.y;Math.abs(s)>Math.abs(N)&&(N=s,o=X)}x={x:z.x+o.x*N,y:z.y+o.y*N},J.rectGuide.clear()}else V._inSmartGuide&&!R.Default.isCtrlDown(l)&&(V._adsorbedToClosest(x),e=!0);var H=Zf.getDataMatrix(f).applyInverse(x);f.setPoint("P1"===d?0:1,H,!0);var A=f.getPoints(),a=A.get(0),Z=A.get(1);v=a.x-Z.x,Q=a.y-Z.y,K=" "+Math.round(Math.sqrt(v*v+Q*Q))+" ",e&&(Y=f.getRect(),J.rectGuide.gatherLines({node:f,x:Y.x,y:Y.y,w:Y.width,h:Y.height}))}if(K){var S=R.Default.getLogicalPoint(l,J._canvas);S.x+=Zf.Icons.TipShiftX,S.y+=Zf.Icons.TipShiftY,V.tipInfo={helperPos:S,text:K,size:K.length}}V._fireEditEvent("between",l)}},on.prototype._unionPointMode1=function(J,I,r,e,L){if(L&&r&&e){var y=J.x-I.x,x=J.y-I.y;Math.abs(y*e)<Math.abs(x*r)?(x=Math.sign(x)*Math.abs(y*e/r),J.y=I.y+x):(y=Math.sign(y)*Math.abs(x*r/e),J.x=I.x+y)}return R.Default.unionPoint(J,I)},on.prototype._unionPointMode2=function(A,V,Z,p,K,q){var n=R.Default.unionPoint(A,V);if(K&&Z&&p){var d;"v"===q?(d=n.x+n.width/2,n.width=Z*n.height/p,n.x=d-n.width/2):(d=n.y+n.height/2,n.height=p*n.width/Z,n.y=d-n.height/2)}return n},on.prototype._adsorbedToClosest=function(H,k){var q=this,W=q._interactor,V=W.rectGuide.findClosest(H,k),E=W.gridGuide.findClosest(H,k),u=1/0,U=1/0;V&&(isFinite(V.x)&&(u=V.x),isFinite(V.y)&&(U=V.y)),E&&(isFinite(E.x)&&Math.abs(E.x)<Math.abs(u)&&(u=E.x),isFinite(E.y)&&Math.abs(E.y)<Math.abs(U)&&(U=E.y)),isFinite(u)&&(H.x+=u),isFinite(U)&&(H.y+=U)},on.prototype._42=function(f,U,_){var h=this;h.info={},h.screenInfo=null;var C=h._interactor;if(!C.editDetail&&h.gatherInfo(U,_)){var B=h.editing,A=B?B.groupRotateMode:null,J=h.screenInfo;"block"!==A&&(J.P1?Zf.Icons.DrawIcon(C,f,Zf.Icons.Line,J):Zf.Icons.DrawIcon(C,f,Zf.Icons.Rect,J),J.connect&&(Zf.Icons.DrawIcon(C,f,Zf.Icons.ConnectGuide,{rotation:J.rotation,connect:J.connect,cursorPos:B?B.cursorPos:null}),B&&(B.targetCorners&&Zf.Icons.DrawIcon(C,f,Zf.Icons.NodeHoverGuide,B.targetCorners),B.garbageInfo&&Zf.Icons.DrawIcon(C,f,Zf.Icons.ConnectGuideGarbage,B.garbageInfo))),h.tipInfo&&Zf.Icons.DrawIcon(C,f,Zf.Icons.TipHelper,h.tipInfo)),h.target instanceof Zf.Group&&h.target._42(C,f,U)}};var ze=Zf.Anchor=function($){this.catalog="Anchor",this._interactor=$};ze.prototype={},ze.prototype.constructor=ze,ze.prototype.gatherInfo=function(p,f){var A=this;if(1===f.length){var j=f[0];if(!j.getAnchor)return;if(j instanceof R.Shape&&j._70I())return;if(Vg(j,p))return;return A.gatherSingleTarget(p,f[0])}return f.length>1?A.gatherMultiTargets(p,f):!1},ze.prototype.gatherSingleTarget=function(h,B){var r=this;return r.info.POS=B.getPosition(),r.screenInfo.POS=Zf.toScreenPosition(h,r.info.POS),r.target=B,!0},ze.prototype.gatherMultiTargets=function(s,S){var _=this,P=Zf.Group.findOrCreateGroup(S);return P?(_.screenInfo.POS=Zf.toScreenPosition(s,P.getAnchor2()),_.target=P,!0):!1},ze.prototype.isVisible=function(){var M=this,r=M._interactor;if(r.getStyle("anchorVisible")===!1)return!1;var U=M.target;if(U){if(this.editing)return!0;var L=U.getAnchor(),o=r.getStyle("anchorOutsideVisibleThreshold");if(L.x<-o||L.x>1+o||L.y<-o||L.y>1+o)return!0;var N=U.getSize(),u=U.getScale(),B=Math.min(Math.abs(N.width*u.x),Math.abs(N.height*u.y));if(B*r.gv._zoom<r.getStyle("anchorHideThreshold"))return!1}return!0},ze.prototype.check=function(h,c,t){if(R.Default.isLeftButton(c)){var F=this,P=F._interactor;if(F.isVisible()&&P.getStyle("anchorMovable")!==!1){F.editing=null,F.tipInfo=null;var a=F.target;if(a&&h.isAnchorEditable(a)&&h.isEditable(a)){var v;if(F.screenInfo&&(v=F.screenInfo.POS)&&Zf.checkHit(t,new Zf.Math.Vector2(v),P.getStyle("checkSize"))){if(a instanceof Zf.Group)return F.editing={},!0;var Q=a.getWidth(),j=a.getHeight(),m=a.getAnchor();return F.editing={rect:{x:-Q*m.x,y:-j*m.y,width:Q,height:j},anchor:m,matrix:a.getMatrix()},!0}}}}},ze.prototype.startEdit=function(U,M){U.startDragging(M),U.fi({kind:"beginEditAnchor",event:M})},ze.prototype._46O=function(p){var k=this;k.editing&&(k.editing=null,k._interactor.fi({kind:"endEditAnchor",event:p})),k.tipInfo=null},ze.prototype.handleEdit=function(x,Y){var I=this,G=I.target;if(G){var e=I.editing;if(e){var F=x.lp(Y),h=I._interactor;if(G instanceof Zf.Group)return G.setAnchor2(F),h._42(),void 0;var z=e.matrix,s=z.tfi(F),l=e.rect,r=(s.x-l.x)/l.width,v=(s.y-l.y)/l.height;if(!R.Default.isCtrlDown(Y)){var b=h.getStyle("anchorRound"),T=h.getStyle("anchorSensitivity");r=Zf.roundTo(r,b,T),v=Zf.roundTo(v,b,T)}G.setAnchor(r,v,!0);var m=R.Default.getLogicalPoint(Y,h._canvas);m.x+=Zf.Icons.TipShiftX,m.y+=Zf.Icons.TipShiftY;var y=""+r.toFixed(2)+", "+v.toFixed(2);I.tipInfo={helperPos:m,text:y,size:y.length},h.fi({kind:"betweenEditAnchor",event:Y})}}},ze.prototype._42=function(R,y,x){var m=this;m.info={},m.screenInfo={};var F=m._interactor;F.editDetail||m.gatherInfo(y,x)&&m.isVisible()&&(Zf.Icons.DrawIcon(F,R,Zf.Icons.Anchor,m.screenInfo),m.tipInfo&&Zf.Icons.DrawIcon(F,R,Zf.Icons.TipHelper,m.tipInfo))};var nc=Zf.Curve=function(W){this.catalog="Curve",this._interactor=W};nc.prototype={},nc.prototype.constructor=nc,_.defineProperties(nc.prototype,{activing:{get:function(){return this._activing},set:function(b){var V=this;if(b)V._activing=new Zf.CurveActiving(this,b);else{var v=V._activing;v&&v.dispose(),V._activing=null}}}}),nc.PointType={Mirrored:0,Straight:1,Disconnected:2,Asymmetric:3},nc.prototype.setUp=function(){var X=this,F=X._interactor;F&&F.gv.mp(X._onGraphviewPropertyChanged,X)},nc.prototype._onGraphviewPropertyChanged=function(m){("zoom"===m.property||"translateX"===m.property||"translateY"===m.property)&&this._handleDataChanged()},nc.prototype.tearDown=function(){var H=this,z=H._interactor;z&&z.gv.ump(H._onGraphviewPropertyChanged,H)},nc.prototype.canEnterEditDetailMode=function(){var Y=this,h=Y._interactor,k=h._getValidSelection();if(1===k.length){var r=k[0],m=r instanceof R.Edge;if(r instanceof R.Shape||m){if(m){var U=r.s("edge.type");if(U&&"points"!==U)return}var p=h.gv;if(p.isPointEditable(r)&&p.isEditable(r))return Y.target=r,!0}}},nc.prototype.preHandleScroll=function(){var T=this.editing;return T&&T.inEdit?!0:void 0},nc.prototype.getCurrentSelectintStatus=function(){var I=this;if(I.activing&&!I.activing.selections){if(I.activing.status!=i)return I.activing.status;var s=function(t){var F=I.activing.status;I.activing.status=t,I._interactor.fp("shapePointStatus",F,t)},k=Zf.Curve.PointType,r=I.activing.point,G=I.activing.pairs;if(!G||1!==G.length)return s(k.Mirrored);var T=G[0],_=T.c1&&T.c1.isNearEnough(r),Y=T.c2&&T.c2.isNearEnough(r);if(!T.c1||!T.c2)return _||Y?s(k.Straight):s(k.Disconnected);if(_&&Y)return s(k.Straight);if(_||Y)return s(k.Asymmetric);var P=T.c1.clone().sub(r),x=T.c2.clone().sub(r);return Math.abs(P.x*x.y-P.y*x.x)>1e-5||P.x*x.x>0?s(k.Disconnected):Math.abs(P.length()-x.length())>1e-5?s(k.Asymmetric):s(k.Mirrored)}},nc.prototype.handle_keydown=function(c){var i=this;if(i._interactor.editDetail){var X=Zf.Curve.PointType;"1"===c.key?i.setCurrentSelectionStatus(X.Straight):"2"===c.key?i.setCurrentSelectionStatus(X.Mirrored):"3"===c.key?i.setCurrentSelectionStatus(X.Disconnected):"4"===c.key&&i.setCurrentSelectionStatus(X.Asymmetric)}},nc.prototype.setCurrentSelectionStatus=function(M){var L=this,D=L.activing;if(D){var G=L.getCurrentSelectintStatus();if(null!==G&&G!==M){D.status=M;var w=L.activing.point,J=L.activing.pairs;if(J&&1===J.length){var v=J[0],i=L.screenInfo.curve,Q=Zf.Curve.PointType,X=function(){L._writeToHt(),L._interactor.fp("shapePointStatus",G,M)};if(M===Q.Straight)return i.moveCtrlPoint(v,w,"c1"),i.moveCtrlPoint(v,w,"c2"),X(),void 0;if(G===Q.Straight){var T=i.findPairs(w,!0),f=T[0],j=f.r1||w,z=f.r2||w,k=z.clone().sub(j).multiplyScalar(.25);return i.moveCtrlPoint(v,w.clone().sub(k),"c1"),i.moveCtrlPoint(v,w.clone().add(k),"c2"),X(),void 0}var B=v.c1,h=v.c2;if(B&&h){if(M===Q.Mirrored)return i.moveCtrlPoint(v,w.clone().multiplyScalar(2).sub(h),"c1"),X(),void 0;if(M===Q.Asymmetric&&G===Q.Disconnected){var u=B.clone().sub(w).length(),k=w.clone().sub(h).setLength(u).add(w);return i.moveCtrlPoint(v,k,"c1"),X(),void 0}}D._firePointChange(),L._interactor.fp("shapePointStatus",G,M)}}}},nc.prototype._handleDataChanged=function(Z){var L=this;if(L.screenInfo&&L.target){var y=L._interactor;L.gatherSingleTarget(y.gv,L.target,!0),L.check(y.gv,null,Z?y._getLogicalPoint(Z):new Zf.Math.Vector2(y._lastClientPoint)),y._42()}},nc.prototype.gatherSingleTarget=function(v,h,J){var V,l,D=this;D.screenInfo&&D.screenInfo.curve&&(l=D.screenInfo.curve._curves);var A=D.editing;V=A?D.screenInfo:D.screenInfo={};var x,q,j=h instanceof R.Edge;j?(x=h.s("edge.segments"),q=h.s("edge.points")||new R.List):(x=h._58O,q=h._59O),V.S=x;var p,d=V.P=[],B=Zf.getDataMatrix(h);if(h instanceof R.Polyline&&(p=h.getElevation()||0,V.E=[]),q.each(function(r){V.E&&V.E.push(r.e||p),r=B.apply(r);var J=Zf.toScreenPosition(v,r);d.push(J.x,J.y)}),j){var u=Zf.toScreenPosition(v,h._lastSourcePoint),L=Zf.toScreenPosition(v,h._lastTargetPoint);d.splice(0,0,u.x,u.y),d.push(L.x,L.y)}if(!V.S||!V.S.size()){V.S=new R.List,V.S.add(1);for(var e=0;e<d.length/2-1;e++)V.S.add(2)}if((!A||J)&&D.convertToCubicBezier(l),D.activing&&(J||!D.editing||"realPoint"===D.editing.type)){var c=V.curve.findPairs(D.activing.point);D.activing.pairs=c}j&&"points"!==h.s("edge.type")&&D._writeToHt()},nc.prototype._convertToNewPoint=function(H,m,P){var r,u,K;for(r=0,u=m.length;u>r;r++){if(K=m[r],K._p1.isNearEnough(H))return K._p1;if(K._p4.isNearEnough(H))return K._p4}if(P)for(r=0,u=Math.min(P.length,u);u>r;r++){if(K=P[r],K._p1===H)return m[r]._p1;if(K._p4===H)return m[r]._p4}},nc.prototype.convertToCubicBezier=function(c){var X,b,N=this,x=new Zf.Math.Curve,$=N.screenInfo;if(x.createFromHtShape($.P,$.S,$.E),$.curve=x,N.activing){var U=x._curves;if(X=N.activing.point,b=N._convertToNewPoint(X,U,c),b&&(N.activing.point=b),N.activing.selections){var n=-1,s=N.activing.selections;s.forEach(function(G){n++,b=N._convertToNewPoint(G,U,c),b&&(s[n]=b)})}}},nc.prototype.check=function(X,n,O){if(!n||R.Default.isLeftButton(n)){var a=this;if(a._interactor.setCursor("default"),a.editing=null,a.highlight=null,a.tipInfo=null,a.screenInfo){if(mo())return a._interactor._42(),!0;if(a._checkEditCtrlPoint(O))return a._interactor._42(),!0;if(a._checkEditRealPoint(O))return a._interactor._42(),!0;if(a._checkEditElevation(O))return a._interactor._42(),!0;var l=a.screenInfo.curve,D=l.checkPoint(O,a._interactor.getStyle("curveIntersectSize"));if(D){var W=a.highlight={};W.type="insertKnot",W.bezier=D.bezier,W.point=D.intersection}return a._interactor._42(),!0}}},nc.prototype._checkEditRealPoint=function(W){var b,u,T,E,I,S,L=this,a=L.screenInfo.curve._curves,s=L._interactor.getStyle("curvePointIntersectSize"),Y=1/0;for(s*=s,T=0,E=a.length;E>T;T++)b=a[T],I=b._p1,S=W.distanceToSquared(I),Y>S&&(Y=S,u=I),I=b._p4,S=W.distanceToSquared(I),Y>S&&(Y=S,u=I);if(Y>s)return!1;var w=L.highlight={};return w.type="changeRealPoint",w.point=u,L.editing={type:"realPoint",point:u,shiftGuide:{point:u.clone(),dir:"x",limit:0}},L._interactor.setCursor("crosshair"),!0},nc.prototype._checkEditElevation=function(C){var t=this;if(!t._interactor.getStyle("curveElevationVisible"))return!1;var E=t.activing;if(!E)return!1;var p=E.getCurrentEditingPoint();if(!p)return!1;var L=t._interactor,r=L.getStyle("curveElevationGuideShift"),R=L.getStyle("curveElevationIntersectSize"),H=C.distanceToSquared({x:p.x+r[0],y:p.y+r[1]});if(!(H>R*R)){var q=t.highlight={};q.type="elevation";var B=new Zf.Math.Vector2(C.x,C.y,p.e);return t.editing={type:"elevation",startPoint:B},t._interactor.setCursor("crosshair"),!0}},nc.prototype._checkEditCtrlPoint=function(M){var z=this;if(z.activing&&!z.activing.selections){var V=z.getCurrentSelectintStatus();if(V!==Zf.Curve.PointType.Straight){var Q=z.activing.pairs;if(Q){var A=z._interactor.getStyle("curvePointIntersectSize");A*=A;var i,B,k,c,N,I,J,_,Z,r=1/0;for(J=0,Z=Q.length;Z>J;J++)for(c=Q[J],_=0;2>_;_++)N=0===_?"c1":"c2",c[N]&&(I=M.distanceToSquared(c[N]),r>I&&(r=I,i=c,B=J,k=N));if(r>A)return!1;z.activing.hlpair=i,z.activing.hltype=k;var f=z.highlight={};return f.type="changeCtrlPoint",f.point=i[k],z.editing={type:"ctrlPoint",pair:i,pairId:B,ctrlType:k,direction:i[k].clone().sub(z.activing.point).normalize()},z._interactor.setCursor("crosshair"),!0}}}},nc.prototype.startEdit=function(j,q){j.startDragging(q);var i=this;i.highlight&&"insertKnot"===i.highlight.type&&(i.insertKnot(),i.gatherSingleTarget(i._interactor.gv,i.target),i.activing=null,i._checkEditRealPoint(i._interactor._getLogicalPoint(q)));var D=i._activing;if(D){var U=i.editing?i.editing.type:null;"ctrlPoint"===U?D.editingCtrl={pairId:i.editing.pairId,type:D.hltype}:"realPoint"===U&&(D.editingCtrl=!1)}var P=i.highlight,y=R.Default.isCtrlDown(q);if(!P||mo()){var e=i._interactor.gv;if(!e.setFocus(q)||e._scrolling)return;return e.isPannable()&&gf(q)&&!y&&(i._pan={tx:e.tx(),ty:e.ty()},j.fi({kind:"beginPan",event:q})),void 0}if("changeRealPoint"===P.type){var X,h=i.activing?i.activing.point:null,x=i.activing?i.activing.selections:null;if(y&&i.activing)h===P.point?(x?(i.activing={point:x[0]},x.length>1&&(x.splice(0,1),i.activing.selections=x)):i.activing=null,i.editing=null):x&&(X=x.indexOf(P.point))>=0?(x.length>1?x.splice(X,1):delete i.activing.selections,i.editing=null):x?(x.push(h),i.activing={point:P.point,selections:x}):i.activing={point:P.point,selections:[h]};else if(x)h===P.point||((X=x.indexOf(P.point))>=0?(x.splice(X,1,h),i.activing={point:P.point,selections:x}):i.activing={point:P.point});else{var u;h===P.point&&(u=i.activing.status),i.activing={point:P.point},u&&(i.activing.status=u)}j.fi({kind:"beginEditPoint",event:q})}},nc.prototype.insertKnot=function(){var v=this,q=v.highlight,M=v.screenInfo.curve;M.insertKnot(q.bezier,q.point.t),v._writeToHt()},nc.prototype._writeToHt=function(){var b,s,q,J,p=this,l=p.screenInfo.curve,f=l.toHtShape(),D=f.points,h=[],k=f.segments,g=p._interactor.gv,t=p.target,Q=t instanceof R.Edge,S=Zf.getDataMatrix(t).invert();J=t instanceof R.Polyline,J&&(q=t.getElevation());for(var I=0,N=D.length;N>I;I++)b=D[I],s=Zf.toWorldPosition(g,b),s=S.apply(s),b.e!=i&&b.e!==q&&(s.e=b.e),h.push(s);if(t._writing=!0,Q){t.s("edge.type","points"),t.setStyle("edge.segments",k),t.setStyle("edge.points",h.slice(1,h.length-1)),t.setStyle("edge.source.offset.x",0),t.setStyle("edge.source.offset.y",0),t.setStyle("edge.target.offset.x",0),t.setStyle("edge.target.offset.y",0);var n=p._nextChangeEdgeHost;delete p._nextChangeEdgeHost,n&&("source"===n.type?t.setSource(n.host):t.setTarget(n.host)),p._writeEdgeHostAnchor("source",h[0]),p._writeEdgeHostAnchor("target",h[h.length-1])}else h.length?(t.setSegments(k),t.setPoints(h,!0)):t.removeFromDataModel();delete t._writing},nc.prototype._writeEdgeHostAnchor=function(Q,R){var X=this,Y=X.target,x=X._calcHostAnchor(Y,Q,R);Y.s("edge."+Q+".anchor.x",x.x),Y.s("edge."+Q+".anchor.y",x.y)},nc.prototype._calcHostAnchor=function(V,E,t,v){v||(v="source"===E?V.getSource():V.getTarget());var C=v.getRotation(),m=v.getAnchor(),y=this._interactor.gv;if(Vg(v,y)&&(C=0),C){var T=v.getMatrix(),q=T.tfi(t),p=v.getSize();return{x:q.x/p.width+m.x,y:q.y/p.height+m.y}}var g=$j(y,v),l={x:(t.x-g.x)/g.width,y:(t.y-g.y)/g.height};return l},nc.prototype._handlePanning=function(M){var h=this,c=h._pan;if(c){c.started=!0;var v=h._interactor,C=v.gv,i=v._lastClientPoint,t=ko(M);C.setTranslate(c.tx+t.x-i.x,c.ty+t.y-i.y),h.gatherSingleTarget(v.gv,h.target),v._42(),v.fi({kind:"betweenPan",event:M})}},nc.prototype.handleEdit=function(N,u){var T=this,x=T.editing;if(T._pan)return T._handlePanning(u),void 0;if(x){x.inEdit=!0;var q,W,G,S=T._interactor._getLogicalPoint(u),g=R.Default.isCtrlDown(u),n=R.Default.isShiftDown(u),H=x.type,O=T.activing;if(T._guideInfo=null,"ctrlPoint"===H&&n){var c=T.editing.direction.clone();q=O.point;var A=c.dot(S.clone().sub(q));S=c.setLength(A).add(q)}else if("ctrlPoint"===H||"realPoint"===H){var c;if("realPoint"===H&&n){var d=T.editing.shiftGuide;W=d.point;var t=Math.abs(S.x-W.x),V=Math.abs(S.y-W.y);t>V&&t>d.limit&&"y"===d.dir&&(d.dir="x"),V>t&&V>d.limit&&"x"===d.dir&&(d.dir="y"),c=d.dir,"x"===c?(S.y=W.y,d.limit=Math.max(d.limit,t)):"y"===c&&(S.x=W.x,d.limit=Math.max(d.limit,V))}var J=T._isEditEdgeSourceTarget();if(J){var m=T._editEdgeSourceTarget(J,S,g);m&&(G=m.tipText)}else if(!g){var r=T._guidingToEdit(S,c),M="realPoint"===H?T._interactor.gridGuide.findClosest(S,c,!0):null,C=1/0,L=1/0;M&&(M.x&&(C=M.x),M.y&&(L=M.y));var l=!1;r&&(r.xList&&(Math.abs(r.x)<=Math.abs(C)?(l=!0,C=r.x):delete r.xList),r.yList&&(Math.abs(r.y)<=Math.abs(L)?(l=!0,L=r.y):delete r.yList),l&&(T._guideInfo=r)),isFinite(C)&&(S.x+=C),isFinite(L)&&(S.y+=L),l&&(r.v=S)}}var a=T.screenInfo.curve;if("realPoint"===x.type){q=x.point,q.e!==i&&(S.e=q.e),a.moveRealPoint(q,S),x.point=S,T.highlight.point=S;var Z=O.status,U=O.selections;if(T.activing={point:S,status:Z},U){var E=S.clone().sub(q),y=0;U.forEach(function(Q){var t=Q.clone().add(E);a.moveRealPoint(Q,t),U[y++]=t}),T.activing.selections=U}}else if("ctrlPoint"===x.type){var P=O.pairs,v=P[x.pairId];a.moveCtrlPoint(v,S,x.ctrlType);var Q=O.status,D=Zf.Curve.PointType;if((Q===D.Mirrored||Q===D.Asymmetric)&&v.c1&&v.c2){var q=new Zf.Math.Vector2(O.point),s="c1"===x.ctrlType?"c2":"c1";if(Q===Zf.Curve.PointType.Mirrored)a.moveCtrlPoint(v,q.clone().multiplyScalar(2).sub(S),s);else if(Q===D.Asymmetric){var A=v[s].clone().sub(q).length(),I=q.clone().sub(v[x.ctrlType]).setLength(A).add(q);isNaN(I.x)||a.moveCtrlPoint(v,I,s)}}O._firePointChange()}else if("elevation"===x.type){W=x.startPoint;var F=W.e+(W.y-S.y)/N._zoom;T._setCurrentPointImpl("e",F),O._firePointChange(),G="E: "+Zf.toFixed(F)}var B=R.Default.getLogicalPoint(u,T._interactor._canvas);if(B.x+=Zf.Icons.TipShiftX,B.y+=Zf.Icons.TipShiftY,!G){var _=Zf.toWorldPosition(N,S);G=""+Zf.toFixed(_.x)+", "+Zf.toFixed(_.y)}T.tipInfo={helperPos:B,text:G,size:G.length},T._writeToHt(),T._interactor.fi({kind:"betweenEditPoint",event:u})}},nc.prototype._setCurrentPointImpl=function(m,q){var d=this,l=d._activing;if(!l)return!1;var Z=d.target;if(!Z)return!1;var w=l.getCurrentEditingPoint();if(!w)return!1;var c=l.editingCtrl;if(!c)var P=w.clone();if("e"===m)w.e=q;else{var x;if("x"===m||"y"===m){var g=l._lastFirePoint;x="x"===m?{x:q,y:g?g.y:0}:{x:g?g.x:0,y:q}}else"object"==typeof m?(x=m,m.e!==i&&(w.e=m.e)):(x={x:arguments[0],y:arguments[1]},arguments[2]!==i&&(w.e=arguments[2]));var M=Zf.getDataMatrix(Z);x=Zf.toScreenPosition(d._interactor.gv,M.apply(x)),w.x=x.x,w.y=x.y}if(!c){var n=P.multiplyScalar(-1).add(w);w.e&&P.e&&(n.e=w.e-P.e),d.screenInfo.curve.moveCtrlDueToRealPointMovement(w,n)}return!0},nc.prototype.setCurrentPoint=function(E,G){return this._setCurrentPointImpl(E,G)?(this._writeToHt(),!0):!1},nc.prototype._isEditEdgeSourceTarget=function(){var V=this,f=V.target;if(!(f instanceof R.Edge))return!1;var T=V.editing.point,$=V.screenInfo.curve._curves;return T===$[0]._p1?"source":T===$[$.length-1]._p4?"target":!1},nc.prototype._editEdgeSourceTarget=function(P,U,r){var w,S=this,l=S.target;if(w="source"===P?l.getSource():l.getTarget()){var v=S._interactor.gv,H=Zf.toWorldPosition(v,U),c=S._calcHostAnchor(l,P,H,w);if(!r){var h=S._interactor.getStyle("anchorRound"),b=S._interactor.getStyle("anchorSensitivity");c.x=Zf.roundTo(c.x,h,b),c.y=Zf.roundTo(c.y,h,b)}if(S._interactor.getStyle("edgeHostDetectPerFrame")||c.x<0||c.x>1||c.y<0||c.y>1){var N=v.getDataAt(H,function(M){return v.isSelectable(M)?ph(M)?!0:!1:!1});if(N){var K=S._calcHostAnchor(l,P,H,N);w=N,S._nextChangeEdgeHost={type:P,host:N},c=K,r||(c.x=Zf.roundTo(c.x,h,b),c.y=Zf.roundTo(c.y,h,b))}}if(!r){var d=Bj(v,w,0,0,0,c.x,c.y),L=Zf.toScreenPosition(v,d);U.x=L.x,U.y=L.y}return S._edgeHostGuideInfo=Zf.getTargetCornersOnScreen(v,w),{host:w,anchor:c,tipText:""+c.x.toFixed(2)+", "+c.y.toFixed(2)}}},nc.prototype._guidingToEdit=function(v,u){var m,Q,P=this;if(m=P.screenInfo.curve){Q=m._curves;var d,p,E,U,L,g,s,F,N=1/0,x=1/0,$=[];for(P.editing&&"realPoint"===P.editing.type&&(F=P.editing.point),L=0,g=2*Q.length;g>L;L++)s=Q[Math.floor(L/2)][L%2?"_p4":"_p1"],$.indexOf(s)>=0||($.push(s),F&&F===s||(E=s.x-v.x,U=s.y-v.y,Math.abs(E)<Math.abs(N)?(N=E,d=[s]):E===N&&d.push(s),Math.abs(U)<Math.abs(x)?(x=U,p=[s]):U===x&&p.push(s)));var B=P._interactor.getStyle("smartGuideSensitivity");if((Math.abs(N)>B||"y"===u)&&(d=null),(Math.abs(x)>B||"x"===u)&&(p=null),d||p){var Y=!1,X={};if(d&&(Y=!0,X.xList=d,X.x=N),p&&(Y=!0,X.yList=p,X.y=x),Y)return X}}},nc.prototype._46O=function(q){var g=this;g.editing&&(g.editing=null,g._interactor.fi({kind:"endEditPoint",event:q})),g._guideInfo=null,g._edgeHostGuideInfo=null,g._pan&&(g._pan=null,g._interactor.fi({kind:"endPan",event:q})),g.tipInfo=null},nc.prototype._canDeletePoint=function(U,y){var z=this.target;if(!(z instanceof R.Edge))return!0;var w=U._curves[0],O=U._curves[U._curves.length-1];return w._p1===y||O._p4===y?!1:!0},nc.prototype.handleDelete=function(){var L=this;if(L.activing&&L.screenInfo){var Y=R.Default.isShiftDown(),g=L.screenInfo.curve;L._canDeletePoint(g,L.activing.point)&&g.deleteRealPoint(L.activing.point,Y),L.activing.selections&&L.activing.selections.forEach(function(N){L._canDeletePoint(g,N)&&g.deleteRealPoint(N,Y)}),L.activing=null,delete L.editing,delete L.tipInfo,delete L._pan,L._writeToHt(),L._interactor.fp("deleteShapePoint",!1,!0)}},nc.prototype.handleDoubleClick=function(u){var s=this,R=s._interactor._getLogicalPoint(u);if(s.screenInfo&&s._checkEditRealPoint(R)){var _=s.getCurrentSelectintStatus(),p=Zf.Curve.PointType;return _=_===p.Mirrored?p.Straight:p.Mirrored,s.setCurrentSelectionStatus(_),s._interactor._42(),!0}},nc.prototype._drawHighlight=function(Z){var $=this,b=$.highlight;if(b){var G=b.bezier,N=$._interactor;G&&Zf.Icons.DrawIcon(N,Z,Zf.Icons.ShapeHighlightCurve,[G._p1.x,G._p1.y,G._p2.x,G._p2.y,G._p3.x,G._p3.y,G._p4.x,G._p4.y]);var p=b.point;p&&"insertKnot"===b.type&&Zf.Icons.DrawIcon(N,Z,Zf.Icons.ShapeHighlighPoint,p)}},nc.prototype._drawGuide=function(M){var P=this,D=P._guideInfo;if(D){var $,p,y,J,x=D.v;for($=0;2>$;$++)if(J=0===$?D.xList:D.yList)for(p=0,y=J.length;y>p;p++)Zf.Icons.DrawIcon(P._interactor,M,Zf.Icons.ShapeGuideLine,[x.x,x.y,J[p].x,J[p].y])}},nc.prototype._drawCurrentPoint=function(P){var w=this;if(w.activing){var O=w.activing,Z=w.getCurrentSelectintStatus(),Y=w._interactor;if(Z!==Zf.Curve.PointType.Straight){var S=O.pairs;O.hlpair,O.hltype;var h=O.selections,n=O.editingCtrl;if(S&&!h){var u,_,p;for(_=0,p=S.length;p>_;_++)u=S[_],n&&_===n.pairId&&u[n.type]?Zf.Icons.DrawIcon(Y,P,Zf.Icons.ShapeActivingCtrl,{point:u.point,c1:u.c1,c2:u.c2,hl:n.type}):Zf.Icons.DrawIcon(Y,P,Zf.Icons.ShapeActivingCtrl,u)}}Zf.Icons.DrawIcon(Y,P,Zf.Icons.ShapeHighlighRealPoint,w.activing.point),h&&h.forEach(function(z){Zf.Icons.DrawIcon(Y,P,Zf.Icons.ShapeHighlighRealPoint,z)})}},nc.prototype.clear=function(){var v=this;v.editing=null,v._guideInfo=null,v.activing=null,v.highlight=null},nc.prototype._42=function(u){var v=this;v.info={},v.editing||(v.screenInfo=null);var S=v._interactor;if(!S.editDetail)return v.clear(),void 0;if(!v.target||!v._interactor.gv.isSelected(v.target)||!v._interactor.gv.isVisible(v.target))return S.editDetail=!1,v.clear(),void 0;if(v.gatherSingleTarget(S.gv,v.target),Zf.Icons.DrawIcon(S,u,Zf.Icons.ShapeBgCurve,v.screenInfo),v._drawHighlight(u),v._drawCurrentPoint(u),v._getRealPoint().forEach(function(l){Zf.Icons.DrawIcon(S,u,Zf.Icons.ShapePoint,l)}),v._drawGuide(u),v.tipInfo&&Zf.Icons.DrawIcon(S,u,Zf.Icons.TipHelper,v.tipInfo),v._edgeHostGuideInfo&&Zf.Icons.DrawIcon(S,u,Zf.Icons.NodeHoverGuide,v._edgeHostGuideInfo),v._interactor.getStyle("curveElevationVisible")&&v.target instanceof R.Polyline&&v.activing){var a=v.activing.getCurrentEditingPoint();a&&Zf.Icons.DrawIcon(S,u,Zf.Icons.EdgeElevationGuide,a)}},nc.prototype._getRealPoint=function(){var y=this.screenInfo,S=y.P,X=y.S,G=-1,Z=[];return X.each(function(U){var v=1;if(3===U)v=2;else if(4===U)v=3;else if(5===U)return;G+=v,Z.push({x:S[2*G],y:S[2*G+1]})}),Z};var pn=Zf.MoveHelper=function(q){var K=this;K.catalog="Move",K._interactor=q};pn.prototype={},pn.prototype.constructor=pn,pn.prototype.calcShift=function(O,k,d){var H,G,Y=this,e=Y._interactor.gv,b=e.lp(k);if("beginMove"===O&&Y._gatherGridInfo(d._lastLogicalPoint||b),H=Y._target){var M=H.downPosition;if(M){var U=Y._interactor.getStyle("moveSensitivity")/e._zoom;if(M.distanceTo(b)<U)return{x:0,y:0};delete H.downPosition}var W;G=R.Default.isShiftDown(k),G&&(b=Y._dealShiftDown(b),W=H.shiftGuide.dir);var u,Z=H.rawPos={x:H.pos.x+b.x-H.lp.x,y:H.pos.y+b.y-H.lp.y};if(R.Default.isCtrlDown(k)){if(u=Y._calcShiftByAddon(),Y._target.node instanceof Zf.Group){var S=Y._target.node;S._position.x+=u.x,S._position.y+=u.y}return u}for(var L,g=H.x+Z.x,s=H.y+Z.y,l={x:g,y:s},x={x:g+H.w/2,y:s+H.h/2},n={x:g+H.w,y:s+H.h},j=Y._interactor.rectGuide,E=Y._interactor.gridGuide,T=[j.findClosest(l,W),j.findClosest(x,W),j.findClosest(n,W),E.findClosest(l,W),E.findClosest(x,W),E.findClosest(n,W)],X=1/0,K=1/0,i=0,J=T.length;J>i;i++)L=T[i],L&&(g=L.x,s=L.y,isFinite(g)&&Math.abs(g)<Math.abs(X)&&(X=g),isFinite(s)&&Math.abs(s)<Math.abs(K)&&(K=s));if(isFinite(X)||(X=0),isFinite(K)||(K=0),u=Y._calcShiftByAddon(X,K),Y._target.node instanceof Zf.Group){var S=Y._target.node;S._position.x+=u.x,S._position.y+=u.y}var A=H.node;if(!Vg(A,e)){var V=Z.x+X,y=Z.y+K;Y._interactor.rectGuide.gatherLines({node:A,x:H.x+V,y:H.y+y,w:H.w,h:H.h},W)}return u}},pn.prototype._calcShiftByAddon=function(k,N){var J=this._target,G=J.rawPos,R=J.node.getPosition();return k=k||0,N=N||0,{x:G.x-R.x+k,y:G.y-R.y+N}},pn.prototype._dealShiftDown=function(o){var X=this,k=X._target.shiftGuide,S=X._target.lp,H=Math.abs(o.x-S.x),P=Math.abs(o.y-S.y);H>P&&H>k.limit&&"y"===k.dir&&(k.dir="x"),P>H&&P>k.limit&&"x"===k.dir&&(k.dir="y");var g=k.dir;return"x"===g?(o.y=S.y,k.limit=Math.max(k.limit,H)):"y"===g&&(o.x=S.x,k.limit=Math.max(k.limit,P)),o},pn.prototype._gatherGridInfo=function(c){var K,d=this,u=d._interactor,k=u._getValidSelection();if(1===k.length){if(K=k[0],!K.getRect)return d._target=null,void 0}else if(K=Zf.Group.findOrCreateGroup(k),!K)return d._target=null,void 0;var $=K.getPosition(),I=K.getRect();d._target={node:K,x:I.x-$.x,y:I.y-$.y,w:I.width,h:I.height,lp:{x:c.x,y:c.y},pos:{x:$.x,y:$.y},shiftGuide:{dir:"x",limit:0},downPosition:new Zf.Math.Vector2(c)},u.rectGuide.gatherRects()},pn.prototype.clear=function(){var z=this;z._interactor.rectGuide.clear(),z._interactor._42()};var us="directional",zi="point",ll="spot",ji="light.color",Kj=function(B,e){Pf(e)&&Mi.test(e)?fh(B,e):no(e)&&e.modelType?Ii(B,e):Vo[B]=e},Qq=function(B){if(no(B))return B;var l=Vo[B];return B&&l===i&&Mi.test(B)&&(qb&&qb[B]||fh(B,B)),l};Bm(p,{graph3dViewAttributes:Q,graph3dViewFirstPersonMode:!1,graph3dViewMouseRoamable:!0,graph3dViewMoveStep:15,graph3dViewRotateStep:s/60,graph3dViewEditHelperDisabled:!1,graph3dViewPannable:!0,graph3dViewRotatable:!0,graph3dViewWalkable:!0,graph3dViewResettable:!0,graph3dViewZoomable:!0,graph3dViewRectSelectable:!0,graph3dViewRectSelectBackground:Sk,graph3dViewGridVisible:!1,graph3dViewGridSize:50,graph3dViewGridGap:50,graph3dViewGridColor:[.4,.75,.85,1],graph3dViewOriginAxisVisible:!1,graph3dViewCenterAxisVisible:!1,graph3dViewAxisXColor:[1,0,0,1],graph3dViewAxisYColor:[0,1,0,1],graph3dViewAxisZColor:[0,0,1,1],graph3dViewEditSizeColor:[1,1,0,1],graph3dViewOrtho:!1,graph3dViewOrthoWidth:2e3,graph3dViewFovy:s/4,graph3dViewNear:10,graph3dViewFar:1e4,graph3dViewEye:[0,300,1e3],graph3dViewCenter:[0,0,0],graph3dViewUp:[0,1,-1e-7],graph3dViewHeadlightRange:0,graph3dViewHeadlightColor:[1,1,1,1],graph3dViewHeadlightIntensity:1,graph3dViewHeadlightDisabled:!1,graph3dViewFogDisabled:!0,graph3dViewFogColor:"white",graph3dViewFogNear:1,graph3dViewFogFar:2e3,graph3dViewDashDisabled:!0,graph3dViewBatchBlendDisabled:!0,graph3dViewBatchBrightnessDisabled:!0,graph3dViewBatchColorDisabled:!1,setShape3dModel:Kj,getShape3dModel:Qq,createMatrix:function(H,W){sd(H)||(H=[H]);for(var h=H.length-1;h>=0;h--){var o=H[h];W=zg(o.mat,o.s3,o.r3,o.rotationMode,o.t3,W)}return W},transformVec:function(r,L){return Vi(r,L)},createBoxModel:function(){return{vs:Hl,ns:zj,uv:jg,is:dc}},createRoundRectModel:function(r,Q){return Wn.roundRect(r,Q)},createStarModel:function($,X){return Wn.star($,X)},createRectModel:function(d,Z){return Wn.rect(d,Z)},createTriangleModel:function(S,l){return Wn.triangle(S,l)},createRightTriangleModel:function(c,S){return Wn.rightTriangle(c,S)},createParallelogramModel:function(l,V){return Wn.parallelogram(l,V)},createTrapezoidModel:function(r,Z){return Wn.trapezoid(r,Z)},createSmoothSphereModel:function(C,Y,I,f,w,P,V){return Rm(new Ne(C,Y,I,f,w,P,V))},createSphereModel:function(e,H,F,L,f,$){return e?Uk(e,H,F,L,f,$):p.createSmoothSphereModel()},createSmoothConeModel:function(r,z,M,O,x){return tm(r,z,M,O,x)},createConeModel:function(w,r,G,P,Q,I){return w?Sl(w,r,G,P,Q,I):tm(I)},createSmoothCylinderModel:function(m,q,Z,o,d,A,s,F){return Rm(new pf(m,q,Z,o,d,A,s,F))},createCylinderModel:function(Z,P,s,g,x,k,c){return Z?Fo(Z,P,s,g,x,k,c):mb(k,c)},createSmoothTorusModel:function(T,t,j,P,H,R){return Rm(new lc(T,t,j,P,H,R))},createTorusModel:function(K,Z,D,t,F,v,H){return K?Sn(K,Z,D,t,F,v,H):jr(v,H)},createExtrusionModel:function(O,u,S,I,X,$,k,Y){return yb(O,u,S,I,X,$,k,Y)},createSmoothRingModel:function(_,g,H,E,R,u){for(var K=[],Z=0;Z<_.length-1;Z+=2)K.push({x:_[Z],y:_[Z+1]});for(_=fb(K,g,H)[0],K=[],Z=0;Z<_.length;Z++){var i=_[Z];K.push(new wc(i.x,0,i.y))}return Rm(new Xj(K,u,E,R))},createTextGeometry:function(A,r){return Rm(new Ri(A,r))},loadFontFace:function(P,u){p.xhrLoad(P,function(F){if(!F)return u();var v;try{v=JSON.parse(F)}catch(e){v=JSON.parse(F.substring(65,F.length-2))}rd.loadFace(v),u&&u(v.familyName.toLowerCase())},u?null:{sync:!0})},getRotationFromMatrix4:function(){var Z={};return function(B,b,m){var s=D,i=B[0],P=B[4],g=B[8],E=B[1],u=B[5],y=B[9],l=B[2],X=B[6],M=B[10];if(b=b||"xyz",b=b[2]+b[1]+b[0],b=b.toUpperCase(),"XYZ"===b)Z._y=Math.asin(s(g,-1,1)),Math.abs(g)<.99999?(Z._x=Math.atan2(-y,M),Z._z=Math.atan2(-P,i)):(Z._x=Math.atan2(X,u),Z._z=0);
else if("YXZ"===b)Z._x=Math.asin(-s(y,-1,1)),Math.abs(y)<.99999?(Z._y=Math.atan2(g,M),Z._z=Math.atan2(E,u)):(Z._y=Math.atan2(-l,i),Z._z=0);else if("ZXY"===b)Z._x=Math.asin(s(X,-1,1)),Math.abs(X)<.99999?(Z._y=Math.atan2(-l,M),Z._z=Math.atan2(-P,u)):(Z._y=0,Z._z=Math.atan2(E,i));else if("ZYX"===b)Z._y=Math.asin(-s(l,-1,1)),Math.abs(l)<.99999?(Z._x=Math.atan2(X,M),Z._z=Math.atan2(E,i)):(Z._x=0,Z._z=Math.atan2(-P,u));else if("YZX"===b)Z._z=Math.asin(s(E,-1,1)),Math.abs(E)<.99999?(Z._x=Math.atan2(-y,u),Z._y=Math.atan2(-l,i)):(Z._x=0,Z._y=Math.atan2(g,M));else{if("XZY"!==b)return null;Z._z=Math.asin(-s(P,-1,1)),Math.abs(P)<.99999?(Z._x=Math.atan2(X,u),Z._y=Math.atan2(g,i)):(Z._x=Math.atan2(-y,M),Z._y=0)}return m?(m[0]=Z._x,m[1]=Z._y,m[2]=Z._z,m):[Z._x,Z._y,Z._z]}}(),createRingModel:function(Z,n,_,L,O,q,K,v,R,e){for(var x=[],t=0;t<Z.length-1;t+=2)x.push({x:Z[t],y:Z[t+1]});q=q||p.shapeSide,K=K||0,v=v||q;var V,S,a,y,W,Y,M,F,N,h,t,U,H,I,k,s,B,X,E=[],b=[],C=R?[]:Q,f=R?[]:Q,o=e?[]:Q,i=e?[]:Q,l=L?[]:Q,P=L?[]:Q,u=O?[]:Q,w=O?[]:Q,Z=fb(x,n,_),G=Ol(Z),z=0,d=2*Math.PI/q;return Z.forEach(function(p){if(a=p.length,a>1){if(y=p[0],L)for(Y=y.x,F=y.y,t=K;v>t;t++)U=t+1,H=t*d,I=U*d,k=$(H),s=g(H),B=$(I),X=g(I),l.push(k*Y,F,-s*Y,B*Y,F,-X*Y,0,F,0),P.push(.5-.5*k,.5-.5*s,.5-.5*B,.5-.5*X,.5,.5);for(h=0;a>h;h++){for(W=p[h],Y=y.x,M=W.x,F=y.y,N=W.y,V=z/G,z+=Vc(y,W),S=z/G,t=K;v>t;t++)U=t+1,H=t*d,I=U*d,k=$(H),s=g(H),B=$(I),X=g(I),E.push(k*M,N,-s*M,B*M,N,-X*M,k*Y,F,-s*Y,B*M,N,-X*M,B*Y,F,-X*Y,k*Y,F,-s*Y),b.push(t/q,S,U/q,S,t/q,V,U/q,S,U/q,V,t/q,V),R&&t===K&&(C.push(0,F,0,0,N,0,k*M,N,-s*M,k*M,N,-s*M,k*Y,F,-s*Y,0,F,0),f.push(0,.5-F,0,.5-N,2*M,.5-N,2*M,.5-N,2*Y,.5-F,0,.5-F)),e&&U===v&&(o.push(0,F,0,B*M,N,-X*M,0,N,0,B*M,N,-X*M,0,F,0,B*Y,F,-X*Y),i.push(1,.5-F,1-2*M,.5-N,1,.5-N,1-2*M,.5-N,1,.5-F,1-2*Y,.5-F));y=W}if(O)for(Y=y.x,F=y.y,t=K;v>t;t++)U=t+1,H=t*d,I=U*d,k=$(H),s=g(H),B=$(I),X=g(I),u.push(B*Y,F,-X*Y,k*Y,F,-s*Y,0,F,0),w.push(.5-.5*B,.5+.5*X,.5-.5*k,.5+.5*s,.5,.5)}}),{vs:E,uv:b,bottom_vs:u,bottom_uv:w,top_vs:l,top_uv:P,from_vs:C,from_uv:f,to_vs:o,to_uv:i}}},!0),Bm(e,{"3d.move.mode":i,"3d.selectable":!0,"3d.visible":!0,"3d.movable":!0,"3d.editable":!0,"shape.border.gradient.color":i,"edge.gradient.color":i,"edge.source.t3":i,"edge.target.t3":i,"light.type":zi,"light.center":[0,0,0],"light.color":[1,1,1,1],"light.disabled":!1,"light.angle":s/4,"light.range":0,"light.exponent":1,"light.intensity":1,"wf.visible":!1,"wf.width":1,"wf.color":hk,"wf.short":!1,"wf.mat":i,"wf.geometry":!1,batch:i,"transparent.mask":!1,brightness:i,"select.brightness":.7,"repeat.uv.length":i,alphaTest:.4,"label.face":mj,"label.t3":i,"label.r3":i,"label.texture.scale":2,"label.rotationMode":fr,"label.light":!1,"label.blend":i,"label.reverse.flip":!1,"label.reverse.color":Wp,"label.reverse.cull":!1,"label.transparent":!1,"label.autorotate":!1,"label2.face":mj,"label2.t3":i,"label2.r3":i,"label2.texture.scale":2,"label2.rotationMode":fr,"label2.light":!1,"label2.blend":i,"label2.reverse.flip":!1,"label2.reverse.color":Wp,"label2.reverse.cull":!1,"label2.transparent":!1,"label2.autorotate":!1,"note.face":mj,"note.t3":i,"note.r3":i,"note.texture.scale":2,"note.rotationMode":fr,"note.light":!1,"note.blend":i,"note.reverse.flip":!1,"note.reverse.color":Wp,"note.reverse.cull":!1,"note.transparent":!1,"note.autorotate":!1,"note2.face":mj,"note2.t3":i,"note2.r3":i,"note2.texture.scale":2,"note2.rotationMode":fr,"note2.light":!1,"note2.blend":i,"note2.reverse.flip":!1,"note2.reverse.color":Wp,"note2.reverse.cull":!1,"note2.transparent":!1,"note2.autorotate":!1,shape3d:i,"shape3d.color":ns,"shape3d.top.color":i,"shape3d.bottom.color":i,"shape3d.from.color":i,"shape3d.to.color":i,"shape3d.image":i,"shape3d.top.image":i,"shape3d.bottom.image":i,"shape3d.from.image":i,"shape3d.to.image":i,"shape3d.light":!0,"shape3d.side":0,"shape3d.side.from":i,"shape3d.side.to":i,"shape3d.visible":!0,"shape3d.from.visible":!0,"shape3d.to.visible":!0,"shape3d.top.visible":!0,"shape3d.bottom.visible":!0,"shape3d.torus.radius":.17,"shape3d.resolution":0,"shape3d.blend":i,"shape3d.opacity":i,"shape3d.reverse.flip":!1,"shape3d.reverse.color":Wp,"shape3d.reverse.cull":!1,"shape3d.transparent":!1,"shape3d.uv.offset":i,"shape3d.uv.scale":i,"shape3d.top.uv.offset":i,"shape3d.top.uv.scale":i,"shape3d.bottom.uv.offset":i,"shape3d.bottom.uv.scale":i,"shape3d.from.uv.offset":i,"shape3d.from.uv.scale":i,"shape3d.to.uv.offset":i,"shape3d.to.uv.scale":i,"shape3d.top.cap":i,"shape3d.bottom.cap":i,"shape3d.start.angle":0,"shape3d.sweep.angle":C,"shape3d.discard.selectable":!0,"shape3d.top.discard.selectable":!0,"shape3d.bottom.discard.selectable":!0,"shape3d.from.discard.selectable":!0,"shape3d.to.discard.selectable":!0,"shape3d.scaleable":!0,"shape3d.autorotate":!1,"shape3d.fixSizeOnScreen":i,"shape3d.image.cache":!1,"shape3d.alwaysOnTop":!1,"all.light":!0,"all.visible":!0,"all.color":ns,"all.image":i,"all.blend":i,"all.opacity":i,"all.reverse.flip":!1,"all.reverse.color":Wp,"all.reverse.cull":!1,"all.transparent":!1,"all.uv":i,"all.uv.offset":i,"all.uv.scale":i,"all.discard.selectable":!0,mat:i,"left.mat":i,"right.mat":i,"top.mat":i,"bottom.mat":i,"front.mat":i,"back.mat":i},!0);var So,We=!1,Mh=[0,0,0,0],nq={left:[1/255,0,0,1],right:[2/255,0,0,1],top:[3/255,0,0,1],bottom:[4/255,0,0,1],front:[5/255,0,0,1],back:[6/255,0,0,1],m:{1:Um,2:Xl,3:fk,4:rp,5:mj,6:nd}},zh=function(w,$,B,E){if($.getFaceVisible(w,B)){Hi($,pj(w,$.getFaceMat(w,B)||$.getMat(w)));var b=$._26I;$.getFaceReverseCull(w,B)?b.enable(b.CULL_FACE):b.disable(b.CULL_FACE),gl(b,$._prg.uFixPickReverseColor,nq[B]),Ql(b),sc(b,E,6),ms(b),Lc($)}},$o=function(N){return N instanceof qf},js=function(K){return[K.x,K.e||0,K.y]},Go=function(e,P,s){for(var P=bl(P),G=P[0],i=P[1],M=P[2];s--;)e.push(G,i,M)},Ij=function(u,P,I){for(var P=bl(P),l=P[0],e=P[1],M=P[2],o=P[3];I--;)u.push(l,e,M,o)},Zn=function(h,Q,j){if(Q)for(var W,V,M,Y=Q[0],b=Q[1],d=Q[2],i=Q[4],o=Q[5],y=Q[6],u=Q[8],w=Q[9],f=Q[10],x=Q[12],U=Q[13],I=Q[14],n=j.length,p=0,p=0;n>p;p+=3)W=j[p],V=j[p+1],M=j[p+2],h.push(Y*W+i*V+u*M+x,b*W+o*V+w*M+U,d*W+y*V+f*M+I);else Bd(h,j)},xm=function(G,j){var _=j.s("light.intensity"),V=bl(j.s(ji)),C=V[0],D=V[1],Z=V[2];1!==_&&(C*=_,D*=_,Z*=_),G.push(C,D,Z,j.s("light.disabled")?1:0)},Bq=function(s,Z,r){gl(Z,r.uHeadlightRange,s._headlightRange);var G=s._headlightIntensity,W=bl(s._headlightColor);1!==G&&(W=[W[0]*G,W[1]*G,W[2]*G]),gl(Z,r.uHeadlightColor,[W[0],W[1],W[2],s._headlightDisabled?1:0]);var F=s._59O,M=s._spots,Q=s._dirs;if(F.length){var p=[],w=[],l=[];F.forEach(function(C){xm(p,C),Bd(w,s._transformPointToViewSpace(C.p3())),l.push(C.s("light.range"))}),Z.uniform4fv(r.uPointColor,p),Z.uniform1fv(r.uPointRange,l),Z.uniform3fv(r.uPointPosition,w)}if(M.length){var b=[],c=[],_=[],S=[],h=[],J=[];M.forEach(function(v){xm(b,v),Bd(c,s._transformPointToViewSpace(v.p3())),Bd(h,s._transformDirectionToViewSpace(v.p3(),v.s("light.center"))),_.push(v.s("light.range")),S.push($(v.s("light.angle")/2)),J.push(v.s("light.exponent"))}),Z.uniform4fv(r.uSpotColor,b),Z.uniform1fv(r.uSpotRange,_),Z.uniform1fv(r.uSpotAngle,S),Z.uniform1fv(r.uSpotExponent,J),Z.uniform3fv(r.uSpotPosition,c),Z.uniform3fv(r.uSpotDirection,h)}if(Q.length){var d=[],U=[];Q.forEach(function($){xm(d,$),Bd(U,s._transformDirectionToViewSpace($.p3()))}),Z.uniform4fv(r.uDirColor,d),Z.uniform3fv(r.uDirDirection,U)}},Fe=function($){return $>0&&0===($-1&$)},Vn=function(W){return W=x(0,k(s,W)),W=x(Jd,k(s-Jd,W))},hp=function(){return.05+w()/2},Zl=function(Q,n,d,X){var S,g=Q.getEye();return Q.isOrtho()?(S=Em(Q.getCenter(),g),S[0]+=X[0],S[1]+=X[1],S[2]+=X[2]):S=g,xp(n,d,X,S)},xp=function($,W,z,Z){var R=Uq($,W),N=Em(Z,z,!0),I=Uq(N,W);if(q(I)<Jd)return Q;var T=(R-Uq(z,W))/I;return[z[0]+N[0]*T,z[1]+N[1]*T,z[2]+N[2]*T]},cl=function(i,J){return{x:2*i.x-J.x,y:2*i.y-J.y}},Lm=function(y,c,T,F){var U,n;if(!y)return U=N(c.y-T.y,T.x-c.x),{x:c.x+F*g(U),y:c.y+F*$(U)};if(!T)return U=N(y.y-c.y,c.x-y.x),{x:c.x+F*g(U),y:c.y+F*$(U)};var d=Em([y.x,y.y,0],[c.x,c.y,0],!0),G=Em([T.x,T.y,0],[c.x,c.y,0],!0),j=-(d[0]+G[0])/2,M=-(d[1]+G[1])/2,h=V(j*j+M*M);if(Jd>h)return U=N(y.y-c.y,c.x-y.x),{x:c.x+F*g(U),y:c.y+F*$(U)};var W=y.x-c.x,k=y.y-c.y,_=T.x-c.x,q=T.y-c.y,H=V(W*W+k*k),O=V(_*_+q*q);U=m(Uq(d,G))/2,n=d[1]*G[0]-d[0]*G[1]>0?-1:1,j/=h,M/=h;var J=F/g(U),b=x(H,O)/$(U);h=Math.min(J,b);var B={x:c.x+n*h*j,y:c.y+n*h*M};return T.b&&J>O/$(U)&&(B.adjust=!0),B},cs=function(e){var H=e[1],w=e[2],g=e[3],Q=e[6],k=e[7],L=e[11];e[1]=e[4],e[2]=e[8],e[3]=e[12],e[4]=H,e[6]=e[9],e[7]=e[13],e[8]=w,e[9]=Q,e[11]=e[14],e[12]=g,e[13]=k,e[14]=L},rk=function(l){var M=l[0],A=l[1],C=l[2],B=l[3],L=l[4],o=l[5],W=l[6],k=l[7],V=l[8],t=l[9],F=l[10],$=l[11],S=l[12],x=l[13],G=l[14],h=l[15],R=M*o-A*L,u=M*W-C*L,O=M*k-B*L,H=A*W-C*o,y=A*k-B*o,f=C*k-B*W,m=V*x-t*S,I=V*G-F*S,e=V*h-$*S,p=t*G-F*x,r=t*h-$*x,U=F*h-$*G,i=R*U-u*r+O*p+H*e-y*I+f*m;return i?(i=1/i,l[0]=(o*U-W*r+k*p)*i,l[1]=(C*r-A*U-B*p)*i,l[2]=(x*f-G*y+h*H)*i,l[3]=(F*y-t*f-$*H)*i,l[4]=(W*e-L*U-k*I)*i,l[5]=(M*U-C*e+B*I)*i,l[6]=(G*O-S*f-h*u)*i,l[7]=(V*f-F*O+$*u)*i,l[8]=(L*r-o*e+k*m)*i,l[9]=(A*e-M*r-B*m)*i,l[10]=(S*y-x*O+h*R)*i,l[11]=(t*O-V*y-$*R)*i,l[12]=(o*I-L*p-W*m)*i,l[13]=(M*p-A*I+C*m)*i,l[14]=(x*u-S*H-G*R)*i,l[15]=(V*H-t*u+F*R)*i,void 0):Q},Zq=function(W,H){if(H){var y=H[0],S=H[1],B=H[2];W[12]=W[0]*y+W[4]*S+W[8]*B+W[12],W[13]=W[1]*y+W[5]*S+W[9]*B+W[13],W[14]=W[2]*y+W[6]*S+W[10]*B+W[14],W[15]=W[3]*y+W[7]*S+W[11]*B+W[15]}},xd=function(z,T){if(T){var G=T[0],U=T[1],v=T[2];z[0]=z[0]*G,z[1]=z[1]*G,z[2]=z[2]*G,z[3]=z[3]*G,z[4]=z[4]*U,z[5]=z[5]*U,z[6]=z[6]*U,z[7]=z[7]*U,z[8]=z[8]*v,z[9]=z[9]*v,z[10]=z[10]*v,z[11]=z[11]*v}},rh=function(k,P,o){var v=P[0],h=P[1],r=P[2],H=P[3],T=P[4],l=P[5],m=P[6],$=P[7],R=P[8],N=P[9],u=P[10],Q=P[11],X=P[12],K=P[13],y=P[14],c=P[15],b=o[0],B=o[1],a=o[2],Z=o[3];return k[0]=b*v+B*T+a*R+Z*X,k[1]=b*h+B*l+a*N+Z*K,k[2]=b*r+B*m+a*u+Z*y,k[3]=b*H+B*$+a*Q+Z*c,b=o[4],B=o[5],a=o[6],Z=o[7],k[4]=b*v+B*T+a*R+Z*X,k[5]=b*h+B*l+a*N+Z*K,k[6]=b*r+B*m+a*u+Z*y,k[7]=b*H+B*$+a*Q+Z*c,b=o[8],B=o[9],a=o[10],Z=o[11],k[8]=b*v+B*T+a*R+Z*X,k[9]=b*h+B*l+a*N+Z*K,k[10]=b*r+B*m+a*u+Z*y,k[11]=b*H+B*$+a*Q+Z*c,b=o[12],B=o[13],a=o[14],Z=o[15],k[12]=b*v+B*T+a*R+Z*X,k[13]=b*h+B*l+a*N+Z*K,k[14]=b*r+B*m+a*u+Z*y,k[15]=b*H+B*$+a*Q+Z*c,k},Op=function(D,Z,W,X){var j,o,N,U,d,i,w,P,n,m,f=Z[0],u=Z[1],s=Z[2],Y=X[0],y=X[1],M=X[2],z=W[0],E=W[1],F=W[2];return q(f-z)<Jd&&q(u-E)<Jd&&q(s-F)<Jd?Ch(D):(w=f-z,P=u-E,n=s-F,m=1/V(w*w+P*P+n*n),w*=m,P*=m,n*=m,j=y*n-M*P,o=M*w-Y*n,N=Y*P-y*w,m=V(j*j+o*o+N*N),m?(m=1/m,j*=m,o*=m,N*=m):(j=0,o=0,N=0),U=P*N-n*o,d=n*j-w*N,i=w*o-P*j,m=V(U*U+d*d+i*i),m?(m=1/m,U*=m,d*=m,i*=m):(U=0,d=0,i=0),D[0]=j,D[1]=U,D[2]=w,D[3]=0,D[4]=o,D[5]=d,D[6]=P,D[7]=0,D[8]=N,D[9]=i,D[10]=n,D[11]=0,D[12]=-(j*f+o*u+N*s),D[13]=-(U*f+d*u+i*s),D[14]=-(w*f+P*u+n*s),D[15]=1,D)},ih=function(T,h,R,F,m){var I=1/O(h/2),G=1/(F-m);return T[0]=I/R,T[1]=0,T[2]=0,T[3]=0,T[4]=0,T[5]=I,T[6]=0,T[7]=0,T[8]=0,T[9]=0,T[10]=(m+F)*G,T[11]=-1,T[12]=0,T[13]=0,T[14]=2*m*F*G,T[15]=0,T},Am=function(z,l,s,k,B,r,U){var T=1/(l-s),t=1/(k-B),F=1/(r-U);return z[0]=-2*T,z[1]=0,z[2]=0,z[3]=0,z[4]=0,z[5]=-2*t,z[6]=0,z[7]=0,z[8]=0,z[9]=0,z[10]=2*F,z[11]=0,z[12]=(l+s)*T,z[13]=(B+k)*t,z[14]=(U+r)*F,z[15]=1,z},tc=function(v,B){var X=B[0],$=B[1],j=B[2],I=B[3],M=X*X+$*$+j*j+I*I,R=M?1/M:0;return v[0]=-X*R,v[1]=-$*R,v[2]=-j*R,v[3]=I*R,v},qr=function(e,s){var z=s[0]+s[5]+s[10],o=0;return z>0?(o=2*Math.sqrt(z+1),e[3]=.25*o,e[0]=(s[6]-s[9])/o,e[1]=(s[8]-s[2])/o,e[2]=(s[1]-s[4])/o):s[0]>s[5]&s[0]>s[10]?(o=2*Math.sqrt(1+s[0]-s[5]-s[10]),e[3]=(s[6]-s[9])/o,e[0]=.25*o,e[1]=(s[1]+s[4])/o,e[2]=(s[8]+s[2])/o):s[5]>s[10]?(o=2*Math.sqrt(1+s[5]-s[0]-s[10]),e[3]=(s[8]-s[2])/o,e[0]=(s[1]+s[4])/o,e[1]=.25*o,e[2]=(s[6]+s[9])/o):(o=2*Math.sqrt(1+s[10]-s[0]-s[5]),e[3]=(s[1]-s[4])/o,e[0]=(s[8]+s[2])/o,e[1]=(s[6]+s[9])/o,e[2]=.25*o),e},Ai=function(n,k,A){var v=k[0],j=k[1],G=k[2],W=k[3],T=v+v,h=j+j,J=G+G,l=v*T,x=v*h,a=v*J,M=j*h,i=j*J,V=G*J,Y=W*T,m=W*h,F=W*J;return n[0]=1-(M+V),n[1]=x+F,n[2]=a-m,n[3]=0,n[4]=x-F,n[5]=1-(l+V),n[6]=i+Y,n[7]=0,n[8]=a+m,n[9]=i-Y,n[10]=1-(l+M),n[11]=0,n[12]=A[0],n[13]=A[1],n[14]=A[2],n[15]=1,n},Dr=p.getRotationFromMatrix4,nm=function(){var B=[0,0,0],g=[0,0,0],o=[0,0,0],U=function(O,b,c){O[0]=b[1]*c[2]-b[2]*c[1],O[1]=b[2]*c[0]-b[0]*c[2],O[2]=b[0]*c[1]-b[1]*c[0]},X=function(A){return A[0]*A[0]+A[1]*A[1]+A[2]*A[2]},Z=function(I){var W=Math.sqrt(X(I));I[0]/=W,I[1]/=W,I[2]/=W},r=function(U,v,_){U[0]=v[0]-_[0],U[1]=v[1]-_[1],U[2]=v[2]-_[2]};return function(f,a,W){var c=jl();return r(o,f,a),0===X(o)&&(o[2]=1),Z(o),U(B,W,o),0===X(B)&&(1===Math.abs(W[2])?o[0]+=1e-4:o[2]+=1e-4,Z(o),U(B,W,o)),Z(B),U(g,o,B),c[0]=B[0],c[4]=g[0],c[8]=o[0],c[1]=B[1],c[5]=g[1],c[9]=o[1],c[2]=B[2],c[6]=g[2],c[10]=o[2],c}}(),ld=function(W,q){if(W.vr.enable){var g=W.vr.getViewMatrix(q);if(g)return g}return Op(q?q:jl(),W._eye,W._center,W._up)},Ud=function(t){if(t.vr.enable){var X=t.vr.getProjectMatrix();if(X)return X}var o=t.getAspect(),B=t._near,j=t._far,x=jl();if(t._ortho){var U=t._orthoWidth/2,$=U/o;Am(x,-U,U,-$,$,B,j)}else ih(x,t._fovy,o,B,j);return x},Tp=function(W,L){if(!W)return Q;var h=0,S=1,F=2,t=[],K=0,R=W.length,j=R/3;if(L){for(;R>K;K++)t[K]=0;for(K=0;K<L.length;K+=3){var e=[],M=[],P=[];e[h]=W[3*L[K+1]+h]-W[3*L[K]+h],e[S]=W[3*L[K+1]+S]-W[3*L[K]+S],e[F]=W[3*L[K+1]+F]-W[3*L[K]+F],M[h]=W[3*L[K+2]+h]-W[3*L[K+1]+h],M[S]=W[3*L[K+2]+S]-W[3*L[K+1]+S],M[F]=W[3*L[K+2]+F]-W[3*L[K+1]+F],P[h]=e[S]*M[F]-e[F]*M[S],P[S]=e[F]*M[h]-e[h]*M[F],P[F]=e[h]*M[S]-e[S]*M[h];for(var o=0;3>o;o++)t[3*L[K+o]+h]+=P[h],t[3*L[K+o]+S]+=P[S],t[3*L[K+o]+F]+=P[F]}}else for(K=0;j>K;K+=3){var e=[],M=[],P=[];e[h]=W[3*(K+1)+h]-W[3*K+h],e[S]=W[3*(K+1)+S]-W[3*K+S],e[F]=W[3*(K+1)+F]-W[3*K+F],M[h]=W[3*(K+2)+h]-W[3*(K+1)+h],M[S]=W[3*(K+2)+S]-W[3*(K+1)+S],M[F]=W[3*(K+2)+F]-W[3*(K+1)+F],P[h]=e[S]*M[F]-e[F]*M[S],P[S]=e[F]*M[h]-e[h]*M[F],P[F]=e[h]*M[S]-e[S]*M[h];for(var o=0;3>o;o++)t[3*(K+o)+h]=P[h],t[3*(K+o)+S]=P[S],t[3*(K+o)+F]=P[F]}for(K=0;R>K;K+=3){var x=[];x[h]=t[K+h],x[S]=t[K+S],x[F]=t[K+F];var b=V(x[h]*x[h]+x[S]*x[S]+x[F]*x[F]);0===b&&(b=Jd),x[h]=x[h]/b,x[S]=x[S]/b,x[F]=x[F]/b,t[K+h]=x[h],t[K+S]=x[S],t[K+F]=x[F]}return new Pg(t)},bp=function(P,B,G,U){if(G||(G=P.createTexture()),B){var $=P.TEXTURE_2D,D=P.REPEAT,y=P.CLAMP_TO_EDGE,M=P.TEXTURE_MIN_FILTER;U!==P.NEAREST&&(U=P.LINEAR),Be(P,G),P.texImage2D($,0,P.RGBA,P.RGBA,P.UNSIGNED_BYTE,B),Kf(P,P.TEXTURE_MAG_FILTER,U),Fe(B.width)&&Fe(B.height)&&!B.clampToEdge?(Kf(P,P.TEXTURE_WRAP_S,D),Kf(P,P.TEXTURE_WRAP_T,D),Kf(P,M,P.LINEAR_MIPMAP_LINEAR),P.generateMipmap($)):(Kf(P,P.TEXTURE_WRAP_S,y),Kf(P,P.TEXTURE_WRAP_T,y),Kf(P,M,U)),Be(P,Q)}return G},Qh=function(W,h){var v=new Uint8Array(3);return h=h||W.createTexture(),Be(W,h),Kf(W,W.TEXTURE_MIN_FILTER,W.LINEAR),W.texImage2D(W.TEXTURE_2D,0,W.RGB,1,1,0,W.RGB,W.UNSIGNED_BYTE,v),h},Sh=function(F){F._26I&&F._prg&&(F._26I.deleteProgram(F._prg),F._prg=Q)},Rn=function(K,L,z,R){var q=K.createShader(z);return K.shaderSource(q,R),K.compileShader(q),K.attachShader(L,q),q},te=function(p){return p.createBuffer()},Be=function(S,r){S.bindTexture(S.TEXTURE_2D,r)},Ui=function(G,B){G.bindFramebuffer(G.FRAMEBUFFER,B)},Kf=function(L,v,$){L.texParameteri(L.TEXTURE_2D,v,$)},iq=function(u,x){if(x){var x=bl(x);u.clearColor(x[0],x[1],x[2],x[3])}},sn=function(I,H){gl(I,H.uFix,!0),Mo(I,H.aNormal)},Zh=function(S,f){gl(S,f.uFix,!1),ys(S,f.aNormal)},Qe=function(d,n,R,A,j,E,B,N){d._picking||(R?(gl(d,n.uBlend,!0),gl(d,n.uBlendColor,R)):gl(d,n.uBlend,!1),gl(d,n.uLight,A==Q?!0:A),Nr(j)&&1!==j&&gl(d,n.uPartOpacity,j),gl(d,n.uReverseFlip,E==Q?!1:E),gl(d,n.uFixPickReverseColor,B||Wp)),N?d.enable(d.CULL_FACE):d.disable(d.CULL_FACE)},Rf=function(t,w){t._picking||gl(t,w.uPartOpacity,1)},Ql=function(E,t,g,p,l,R,V,i,Z){if(!g)return E.activeTexture(E.TEXTURE0),Be(E,E._emptyTexture),E.activeTexture(E.TEXTURE1),Be(E,E._emptyBlendTexture),void 0;gl(E,t.uTexture,!0),gl(E,t.uDiscardSelectable,dk(p)?p:!0),ys(E,t.aUv),Me(E,l,R,t.aUv,2),Z?(gl(E,t.uBlendTexture,!0),E.activeTexture(E.TEXTURE1),Be(E,Z),E.uniform1i(t.uBlendSampler,1)):(gl(E,t.uBlendTexture,!1),E.activeTexture(E.TEXTURE1),Be(E,E._emptyBlendTexture)),E.activeTexture(E.TEXTURE0),Be(E,g),E.uniform1i(t.uSampler,0);var e=[0,0,1,1];V&&(e[0]=V[0],e[1]=V[1]),i&&(e[2]=i[0],e[3]=i[1]),gl(E,t.uOffsetScale,e)},ms=function(i,s,G){i.activeTexture(i.TEXTURE0),Be(i,Q),i.activeTexture(i.TEXTURE1),Be(i,Q),G&&(Mo(i,s.aUv),gl(i,s.uTexture,!1),gl(i,s.uBlendTexture,!1))},Sf=function(n,a,Q,_,x,m){!Q||b||I||n.lineWidth(Q),_&&!n._picking&&gl(n,a.uFixPickReverseColor,_),x&&Me(n,x,m,a.aPosition)},kd=function(U,z,x,M){So&&(M=U[So]),U.drawArrays(M==Q?U.TRIANGLES:M,z,x);var S=U._renderInfo;S&&(S.calls++,S.vertices+=x,(M==Q||M===U.TRIANGLES)&&(S.faces+=x/3),M===U.LINES&&(S.lines+=x/2))},sc=function(W,a,l,X){So&&(X=W[So]),W.drawElements(X==Q?W.TRIANGLES:X,l,W.UNSIGNED_SHORT,a==Q?0:2*a);var J=W._renderInfo;J&&(J.calls++,J.vertices+=l,(X==Q||X===W.TRIANGLES)&&(J.faces+=l/3),X===W.LINES&&(J.lines+=l/2))},On=function(n,l,K,W,V){var C=n.ARRAY_BUFFER;n.bindBuffer(C,l),K&&n.bufferData(C,K,n.STATIC_DRAW),W!=Q&&n.vertexAttribPointer(W,V?V:3,n.FLOAT,!1,0,0)},Me=function(z,s,A,C,y){return A?(Pm(z,z.ARRAY_BUFFER,s,A),C!=Q&&z.vertexAttribPointer(C,y?y:3,z.FLOAT,!1,0,0),void 0):On(z,s,A,C,y)},kq=function(h,r,k){var f=h.ELEMENT_ARRAY_BUFFER;h.bindBuffer(f,r),k&&h.bufferData(f,k,h.STATIC_DRAW)},Ef=function(m,j,i){Pm(m,m.ELEMENT_ARRAY_BUFFER,j,i)},Pm=function(m,Q,K,l){var K,p=l.glBuf,N=m._id;p&&(K=p[N])&&K._buf?m.bindBuffer(Q,K._buf):(K={_buf:te(m)},m._bufPool.push(K),m.bindBuffer(Q,K._buf),m.bufferData(Q,l,m.STATIC_DRAW),p||(p=l.glBuf={}),p[N]=K),K._fid=m._renderInfo.frame},gl=function(W,P,o){if(o!=Q&&P!=Q){o=bl(o);var q=o.length;3===q?W.uniform3fv(P,o):4===q?W.uniform4fv(P,o):16===q?W.uniformMatrix4fv(P,!1,o):dk(o)?W.uniform1i(P,o?1:0):2===q?W.uniform2fv(P,o):W.uniform1f(P,o)}},ys=function(O,g){g!=Q&&g>=0&&O.enableVertexAttribArray(g)},Mo=function(r,H){H!=Q&&H>=0&&r.disableVertexAttribArray(H)},Lc=function(e,V){var l=e.getGL(),W=e._prg;e._7O=e._8O.pop(),V&&(gl(l,W.uMVMatrix,e._7O),e._6O=V,gl(l,W.uNMatrix,V))},Hf=function(_,m){return m||(m=jl()),Ad(m,_),rk(m),cs(m),m},Hi=function(T,y){var U=T.getGL(),A=T._prg,N=T._7O;y&&(T._8O.push(nr(N)),rh(N,N,y)),gl(U,A.uMVMatrix,N),gl(U,A.uNMatrix,Hf(N,T._6O))},Af=function(S,F,H,b,L,a){if(H){if(b){var k=H.value++,N=2147483648|k,I=[(255&N>>16)/255,(255&N>>8)/255,(255&N)/255,(255&N>>24)/255];H[k]={data:L,part:a}}else I=Mh;return gl(S,F.uFixPickReverseColor,I),I}},gh=function(){var u={center:function(y,h,b,d,B){var p=-h[1]/2,W={x:-h[0]/2,y:p,width:h[0],height:h[1]},P=zb(y,W,b);return[P.x+d,-P.y-B,hp()]},front:function(D,c,R,Z,v){var G=-c[1]/2,V={x:-c[0]/2,y:G,width:c[0],height:c[1]},O=zb(D,V,R);return[O.x+Z,-O.y-v,c[2]/2+hp()]},back:function(a,Z,S,T,q){var x=-Z[0]/2,W=-Z[1]/2,h={x:x,y:W,width:Z[0],height:Z[1]},u=zb(a,h,S);return[-u.x-T,-u.y-q,-Z[2]/2-hp()]},left:function(Q,P,i,U,Y){var T=-P[1]/2,x={x:-P[2]/2,y:T,width:P[2],height:P[1]},o=zb(Q,x,i);return[-P[0]/2-hp(),-o.y-Y,o.x+U]},right:function(i,l,D,w,c){var F=-l[2]/2,a=-l[1]/2,y={x:F,y:a,width:l[2],height:l[1]},u=zb(i,y,D);return[l[0]/2+hp(),-u.y-c,-u.x-w]},top:function(b,L,R,c,O){var t={x:-L[0]/2,y:-L[2]/2,width:L[0],height:L[2]},m=zb(b,t,R);return[m.x+c,L[1]/2+hp(),m.y+O]},bottom:function(m,D,o,X,R){var K=-D[2]/2,A={x:-D[0]/2,y:K,width:D[0],height:D[2]},N=zb(m,A,o);return[N.x+X,-D[1]/2-hp(),-N.y-R]}};return function(x,g,B,s,l,X){return u[s](x,g,B,l||0,X||0)}}(),gq=function(o,Q,H,b,R,c,F,I,t,k){if(R&&(Q[0]+=R[0],Q[1]+=R[1],Q[2]+=R[2]),Zq(o,H),I){var Y=jl();if(Tj(Y,t,k),Vi(Q,Y),Zq(o,Q),o.auto=I,o.pos=Vi([0,0,0],o),c){var h=o.mat2=jl();Tj(h,c,F)}}else Tj(o,t,k),Zq(o,Q),b===Um?ne(o,-y):b===Xl?ne(o,y):b===fk?Kb(o,-y):b===rp?Kb(o,y):b===nd&&ne(o,s),Tj(o,c,F);return o},Wb=function(M,O){var K=O.auto,C=O.mat2,Y=M.gv;if(K){var t,N=jl(),A=[0,0,0,0];t="string"==typeof K?[K.indexOf("x")<0?Y._eye[0]:Y._center[0],K.indexOf("y")<0?Y._eye[1]:Y._center[1],K.indexOf("z")<0?Y._eye[2]:Y._center[2]]:Y._eye,qr(A,Op(jl(),t,Y._center,Y._up)),Ai(N,tc(A,A),O.pos),C&&rh(N,N,C),Hi(Y,N)}else Hi(Y,O)},Ge=function(A,S,V,X,j){var s=A.s,p=A.gv,d=p.getGL(),q=p._prg,L=p._buffer,o=p._1O;bp(d,lk,o),Wb(A,V),Qe(d,q,s(S+".blend"),s(S+".light"),s(S+".opacity"),s(S+".reverse.flip"),s(S+".reverse.color"),s(S+".reverse.cull")),Ql(d,q,o,j,L.uv,ol),Me(d,L.vs,X,q.aPosition),Me(d,L.ns,pq,q.aNormal),Ef(d,L.is,Vd),sc(d,0,Vd.length),ms(d,q,o),Rf(d,q),Lc(p)},$d=function(k,f,j){var V=k.gv,R=k.data,s=k[f]={blend:V.getBodyColor(R)||V.getFaceBlend(R,f),light:V.getFaceLight(R,f),color:V.getFaceColor(R,f),opacity:V.getFaceOpacity(R,f),transparent:V.getFaceTransparent(R,f),reverseFlip:V.getFaceReverseFlip(R,f),reverseColor:V.getFaceReverseColor(R,f),reverseCull:V.getFaceReverseCull(R,f),texture:V.getFaceImage(R,f),blendTexture:V.getFaceBlendImage(R,f),discardSelectable:V.getFaceDiscardSelectable(R,f)};if("csg"!==f){s.uv=V.getFaceUv(R,f)||j&&j[f+"Uv"],s.uvScale=V.getFaceUvScale(R,f)||j&&j[f+"UvScale"],s.uvOffset=V.getFaceUvOffset(R,f)||j&&j[f+"UvOffset"];var i=V.getFaceMat(R,f);i&&(s.mat=pj(R,i))}return s},gi=function(f,k,X,r,M){if(r){if(!M(r.transparent))return;var s=f.data,S=f.gv,L=S._buffer,o=S.getTexture(r.texture,s),d=S.getTexture(r.blendTexture,s);Ql(k,X,o,r.discardSelectable,L.uv,r.tuv,r.uvOffset,r.uvScale,d),Qe(k,X,r.blend,r.light,r.opacity,r.reverseFlip,r.reverseColor,r.reverseCull),gl(k,X.uDiffuse,r.color),Me(k,L.vs,r.vs,X.aPosition),Me(k,L.ns,r.ns,X.aNormal),kd(k,0,r.vs.length/3),Rf(k,X),ms(k,X,o)}},Qr=function(D,h,Y,o,Q,K){var G,E,v,B,g,C,U,W,x,j,N,u=[o-h,Q-Y],L=D?D.length:0;for(v=0;L>v;v++){for(B=2,G=D[v],g=G[0],C=G[1];B+1<G.length;){if(U=G[B],W=G[B+1],E=Km(h,Y,o,Q,g,C,U,W,!0)){x=[U-g,W-C],j=Vc(x),x[0]/=j,x[1]/=j,j=Uq(u,x),j=j>0?K:-K,N=[x[0]*j,x[1]*j];break}g=U,C=W,B+=2}if(N)break}if(N)for(o=h+N[0],Q=Y+N[1],v=0;L>v;v++)for(B=2,G=D[v],g=G[0],C=G[1];B+1<G.length;){if(U=G[B],W=G[B+1],E=Km(h,Y,o,Q,g,C,U,W,!0))return[0,0];g=U,C=W,B+=2}return N?N:[o-h,Q-Y]},pk=R.graph3d={},Mq=function(e,m,x){jh(l+".graph3d."+e,m,x)},lq="~<yfusfw!+!yjsubNQv!>!opjujtpQ`mh!gjeof$!~<fdobutjEfojMb!>!fdobutjEfojMw|*itbEv)gj!ITBE!gfegj$!!gjeof$!~<ttfouihjsCidubCb!>!ttfouihjsCidubCw|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!~<eofmCidubCb!>!eofmCidubCw|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!!gjeof$!~<spmpDidubCb!>!spmpDidubCw|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!~<wVb!>!wVs|*fsvuyfUeofmCv)gj~<x{/fmbdTuftggPv!+!wVb!,!zy/fmbdTuftggPv!>!wVw|*fsvuyfUv)gj~<*yfusfw)4dfw!>!yfusfWw<**1/2!-mbnspOb)5dfw!+!yjsubNOv)4dfw!>!mbnspOw|*ldjQva!%%!yjGva)gj<*1/2!-opjujtpQb)5dfw!+!yjsubNWNv!>!yfusfw!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEfojMb!ubpmg!fuvcjsuub<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCb!4dfw!fuvcjsuub<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCb!ubpmg!fuvcjsuub<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCb!5dfw!fuvcjsuub<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<yjGv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjsubNxfjWv!5ubn!nspgjov<yjsubNOv!5ubn!nspgjov<yjsubNQv!5ubn!nspgjov<yjsubNWNv!5ubn!nspgjov<opjujtpQb!4dfw!fuvcjsuub<mbnspOb!4dfw!fuvcjsuub<wVs!3dfw!hojzsbw<wVw!3dfw!hojzsbw<wVb!3dfw!fuvcjsuub<fmbdTuftggPv!5dfw!nspgjov<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov!YJGFSQ^#CBRBEJxTT87hJFI,,bX1XrIwcn3UM{ZeZ,M6HEN6nLxe2Z72s2:3johr6foKrpqwxNKYkdbJ2CN[mBbf[wXU,T0oGuSEd190ohLZkEn8IuCe[OHoWeKz:Sf,VS7xdSLw23W1YJLU:jdv2{hiDbhDzNNEh9tp3xsuEp94Sl4c3wRzqwShMDRhCLRjCDEBOH5BBVRBCFRE4cJTHrTDH1BNgHJN",bh="~~<eJ!>!spmpDhbsG`mh~<spmpDsfmqnbTwv!>+!eJ<*wVs!-sfmqnbTeofmCv)E3fsvuyfu!>!spmpDsfmqnbTwv!5dfw|!*fsvuyfUeofmCv)!gj!!gjeof$!~<ttfouihjsCidubCw!>+!chs/eJ!!!|*ttfouihjsCidubCv)gj!TTFOUIHJSCIDUBC!gfegj$!~<ttfouihjsCv!>+!chs/eJ!!!|*1/2!>a!ttfouihjsCv)gj~~<zujdbqPusbQv!>+!b/eJ!!!|*1/2!>a!zujdbqPusbQv)gj~!gjeof$!<*spudbGhpg!-*x/eJ!-chs/spmpDhpGv)5dfw!-eJ)yjn!>!eJ<*iuqfe!-sbGhpGv!-sbfOhpGv)qfutiuppnt!>!spudbGhpg!ubpmg<x/esppDhbsG`mh0{/esppDhbsG`mh!>!iuqfe!ubpmg!HPG!gfegj$!!gjeof$!~~~~<chs/^j]spmpDupqTv!+!udfggFupqt!+!fhobSm!+!*1/1!-*mbnspOm.!-O)upe)ybn!>,!chs/eJ<*1/1!-*^j]uofopqyFupqTv!-udfggFupqt)xpq)ybn!>!udfggFupqt|*^j]fmhoBupqTv!?!udfggFupqt)gj<*mbnspOm!-^j]opjudfsjEupqTv)upe!>!udfggFupqt!ubpmg<*spudfWm)f{jmbnspo!>!mbnspOm!4dfw|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSupqTv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSupqTv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQupqTv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDupqTv)gj|!*,,j!<UPQT`YBN!=!j!<1>j!uoj)spg!1!?!UPQT`YBN!gj$!!gjeof$!~~~<chs/^j]spmpDuojpQv!+!fhobSm!+!*1/1!-**spudfWm)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!?!fhobSm)!gj~<*1/2!-*^j]fhobSuojpQv!0!*spudfWm)iuhofm))ojn!.!1/2!>!fhobSm|*1/1!?!^j]fhobSuojpQv)!gj<1/2!>!fhobSm!ubpmg<^j]opjujtpQuojpQv!.!yfusfWw!>!spudfWm!4dfw|*1/1!>>!x/^j]spmpDuojpQv)gj|!*,,j!<UOJPQ`YBN!=!j!<1>j!uoj)spg!1!?!UOJPQ`YBN!gj$!!gjeof$!~~<chs/^j]spmpDsjEv!+!*1/1!-**^j]opjudfsjEsjEv)f{jmbnspo.!-O)upe)ybn!>,!chs/eJ|*1/1!>>!x/^j]spmpDsjEv)gj|!*,,j!<SJE`YBN!=!j!<1>j!uoj)spg!1!?!SJE`YBN!gj$!~<chs/spmpDuihjmebfIv!+!nsfUusfcnbm!>+!chs/eJ~<*1/2!-fhobSuihjmebfIv0*yfusfWw)iuhofm)ojn!.!1/2!!>+!nsfUusfcnbm|*1/1!?!fhobSuihjmebfIv)gj<*1/1!-6/1!,!6/1!+!*M.!-O)upe)ybn!>!nsfUusfcnbm!ubpmg|*1/1!>>!x/spmpDuihjmebfIv)gj|*uihjMv)gj~!gjeof$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf$!~<spmpDeofmCv!>+!eJ|*eofmCv)gj!ftmf~<eofmCidubCw!>+!chs/eJ|*eofmCidubCv)gj!EOFMCIDUBC!gfegj$!~<spmpd!>!eJ|ftmf~<spmpDwv!>!eJ|*fsvuyfUv)gj|!ftmf~<spmpDftsfwfSldjQyjGv!>!eJ|*qjmGftsfwfSva!%%!ldbCtj)gj~<fvsu!>!ldbCtj<O.!>!O|*1/1!=!*O!-F)upe)gj<ftmbg!>!ldbCtj!mppc<F.!>!M!4dfw<*yfusfWw.)f{jmbnspo!>!F!4dfw<*mbnspOw)f{jmbnspo!>!O!4dfw!gjeof$!<ftvggjEv!>!spmpd!ftmf$!~<ftvggjEv!>!spmpd|ftmf~<spmpDidubCw!>!spmpd|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!<spmpd!5dfw|!ftmf~!gjeof$!~~<ftvggjEv!>!eJ|ftmf~<esbdtje|*1/1!>>!x/ftvggjEv)gj|!*!fdobutjEitbEv!?!*!fdobutjEqbHitbEv!-fdobutjEfojMw!)epn!%%!itbEv)!gj!ITBE!gfegj$!!gjeof$!<spmpDftsfwfSldjQyjGv!>!eJ!ftmf$!~<spmpDftsfwfSldjQyjGv!>!eJ|ftmf~<spmpDidubCw!>!eJ|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*yjGv)gj<eJ!5dfw|ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDhbsG`mh)!gj!gjeof$!<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh!ftmf$!~<spmpDftsfwfSldjQyjGv!>!spmpDhbsG`mh|ftmf~<spmpDidubCw!>!spmpDhbsG`mh|*spmpDidubCv)gj!SPMPDIDUBC!gfegj$!|*ldjQv)gj~~~!<esbdtje!|!*utfUbiqmBv!>=!b/spmpDwv)!gj!!!!|!ftmf~~!<esbdtje!|!*1/1!>>!b/spmpDwv)!gj!!!!|!*uofsbqtobsUv)!gj<*wVw!-sfmqnbTv)E3fsvuyfu!>!spmpDwv|**fmcbudfmfTesbdtjEv!%%!ldjQv)a!%%!fsvuyfUv)gj<spmpDwv!5dfw|!*ejpw)ojbn!ejpw!gjeof$!<fdobutjEfojMw!ubpmg!hojzsbw<fdobutjEqbHitbEv!ubpmg!nspgjov<fdobutjEitbEv!ubpmg!nspgjov<itbEv!mppc!nspgjov!ITBE!gfegj$!!gjeof$!<sbGhpGv!ubpmg!nspgjov<sbfOhpGv!ubpmg!nspgjov<spmpDhpGv!5dfw!nspgjov!HPG!gfegj$!!gjeof$!<^UPQT`YBN]opjudfsjEupqTv!4dfw!nspgjov<^UPQT`YBN]opjujtpQupqTv!4dfw!nspgjov<^UPQT`YBN]fhobSupqTv!ubpmg!nspgjov<^UPQT`YBN]fmhoBupqTv!ubpmg!nspgjov<^UPQT`YBN]uofopqyFupqTv!ubpmg!nspgjov<^UPQT`YBN]spmpDupqTv!5dfw!nspgjov!1!?!UPQT`YBN!gj$!!gjeof$!<^UOJPQ`YBN]opjujtpQuojpQv!4dfw!nspgjov<^UOJPQ`YBN]fhobSuojpQv!ubpmg!nspgjov<^UOJPQ`YBN]spmpDuojpQv!5dfw!nspgjov!1!?!UOJPQ`YBN!gj$!!gjeof$!<^SJE`YBN]opjudfsjEsjEv!4dfw!nspgjov<^SJE`YBN]spmpDsjEv!5dfw!nspgjov!1!?!SJE`YBN!gj$!!gjeof$!<eofmCidubCw!4dfw!hojzsbw<eofmCidubCv!mppc!nspgjov!EOFMCIDUBC!gfegj$!!gjeof$!<ttfouihjsCidubCw!ubpmg!hojzsbw<ttfouihjsCidubCv!mppc!nspgjov!TTFOUIHJSCIDUBC!gfegj$!!gjeof$!<spmpDidubCw!5dfw!hojzsbw<spmpDidubCv!mppc!nspgjov!SPMPDIDUBC!gfegj$!<spmpDuihjmebfIv!5dfw!nspgjov<fhobSuihjmebfIv!ubpmg!nspgjov<yfusfWw!4dfw!hojzsbw<mbnspOw!4dfw!hojzsbw<ftvggjEv!5dfw!nspgjov<zujdbqPusbQv!ubpmg!nspgjov<ttfouihjsCv!ubpmg!nspgjov<uihjMv!mppc!nspgjov<spmpDeofmCv!5dfw!nspgjov<eofmCv!mppc!nspgjov<wVs!3dfw!hojzsbw<sfmqnbTeofmCv!E3sfmqnbt!nspgjov<sfmqnbTv!E3sfmqnbt!nspgjov<wVw!3dfw!hojzsbw<fsvuyfUeofmCv!mppc!nspgjov<fsvuyfUv!mppc!nspgjov<uofsbqtobsUv!mppc!nspgjov<utfUbiqmBv!ubpmg!nspgjov<spmpDftsfwfSldjQyjGv!5dfw!nspgjov<qjmGftsfwfSv!mppc!nspgjov<ldjQv!mppc!nspgjov<yjGv!mppc!nspgjov<fmcbudfmfTesbdtjEv!mppc!nspgjov!YJGFSQ!gjeof$!!gjeof$!!<ubpmg!qnvjefn!opjtjdfsq!!ftmf$!!<ubpmg!qihji!opjtjdfsq!!IHJI`OPJTJDFSQ`UOFNHBSG`MH!gfegj$!!TF`MH!gfegj$!";Bm(p,{setBatchInfo:function(g,B){_f[g]=B},getBatchInfo:function($){return _f[$]}},!0);var Yi=[1,1,1],pc=[1,0,0,0,0,1,0,1,1,1,1,0],Uh=[-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5],gp=[.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5],Gg=[.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5],Ke=[.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5],kn=[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5],Vk=[-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5],bj=function(_,N){Ob(_,N,"_batchModelMap","_batchIndexMap"),Ic(_,N,"_wireframeModelMap","_wireframeIndexMap"),Ic(_,N,"_polylineModelMap","_polylineIndexMap"),Ic(_,N,"_wireframeModelMapSwap","_wireframeIndexMapSwap"),Ic(_,N,"_polylineModelMapSwap","_polylineIndexMapSwap")},Ob=function(o,G,O,N){if(!G)return o[O]={},o[N]={},void 0;var u=G._id,C=o[N],R=C[u];if(R){var z=o[O],E=R.batch,U=z[E],t=U.ds,d=R.index;if(U.invalidate=!0,delete C[u],t.splice(d,1),Yc(t))return delete z[E],void 0;for(var g=R.begin,V=R.size,L=3*g,T=3*V,l=4*g,D=4*V,n=U.vs,q=U.ps,B=U.uv,a=U.cs,j=U.bs,w=U.rs,i=U.ns,h=U.ls;d<t.length;d++)R=C[t[d]._id],R.index--,R.begin-=V;n.splice(L,T),q.splice(l,D),B&&B.splice(2*g,2*V),a&&a.splice(l,D),j&&j.splice(L,T),w&&w.splice(g,V),i&&i.splice(L,T),h&&h.splice(g,V)}},Ic=Ob,ff=function(P,_,T,S){if(!S)return Q;var F=_[S];if(!F){var J=_f[S]||Di,u=J.image?[]:Q;F=_[S]={vs:[],ns:[],uv:u,cs:u?Q:J.color?Q:[],bs:J.blend?[]:Q,ps:[],rs:J.brightness?[]:Q,ds:[]}}return F.invalidate=!0,P[T._id]={index:F.ds.length,begin:F.vs.length/3,batch:S},F.ds.push(T),F},lg=function(F,Z){return Z!=Q&&1!==Z?[F[0]*Z,F[1]*Z,F[2]*Z,F[3]]:F},Lk=function(Y,T,n){var D=Y.getBrightness(T),q=bl(n.color||"white"),j=q[3]<1,I=Math.ceil(n.width)||1,g=(j?"T":"O")+I,r=Y._wireframeIndexMap,N=Y._wireframeModelMap,$=N[g];$||($=N[g]={vs:[],cs:[],ps:[],ds:[],T:j,W:I});var A,Z=Y.getData3dUI(T),k=dq(Z);if(n.geometry){if(!k)return;if(A=Rc(k),!A)return}else A=n.short?Bi:df;$.invalidate=!0;var R=$.vs,u=$.cs,_=$.ds,B=r[T._id]={index:_.length,begin:R.length/3,batch:g};_.push(T);var J=pj(T,n.mat),m=Z._calcAnchorMat(T);m&&rh(J,J,m),Zn(R,J,A);var L=B.size=R.length/3-B.begin;Ij(u,lg(q,D),L)},cf=function(R,V,W,m,O,d,w,G,p){var F=R.getBrightness(V);F==Q&&(F=1);var r=lg(bl(m),F),X=r[3]<1;d=Math.ceil(d)||1;var j=(X?"T":"O")+d;if(w){var b=w[0],f=(w[1]||b)+b;j+="-"+b+"-"+f,p&&(j+="-"+se(p)+"-"+F,p=lg(bl(p),F))}var z=R._polylineIndexMap,L=R._polylineModelMap,l=L[j];l||(l=L[j]={vs:[],cs:[],ps:[],ds:[],ls:w?[]:Q,T:X,W:d},w&&(l.D=b,l.G=f,l.A=p)),l.invalidate=!0;var $,A=l.vs,i=l.cs,a=l.ds,g=l.ls,U=z[V._id]={index:a.length,begin:A.length/3,batch:j};a.push(V),Bd(A,W);var N,H=U.size=A.length/3-U.begin,s=W.length,q=0,o=[];if(w||O)for($=0;s>$;$+=6)N=Vc([W[$],W[$+1],W[$+2]],[W[$+3],W[$+4],W[$+5]]),o.push(N),q+=N;if(q&&O){var I,y=lg(bl(O),F),C=[y[0]-r[0],y[1]-r[1],y[2]-r[2],y[3]-r[3]],D=0;for($=0;s>$;$+=6)I=D/q,Ij(i,[r[0]+C[0]*I,r[1]+C[1]*I,r[2]+C[2]*I,r[3]+C[3]*I],1),D+=o[$/6],I=D/q,Ij(i,[r[0]+C[0]*I,r[1]+C[1]*I,r[2]+C[2]*I,r[3]+C[3]*I],1)}else Ij(i,r,H);if(w)for(D=G||0,$=0;s>$;$+=6)g.push(D),D+=o[$/6],g.push(D)},Qg=function(v,s,i){if(s)for(var c=4*s.begin,y=i[s.batch].ps,h=0;h<s.size;h++)y[c++]=v[0],y[c++]=v[1],y[c++]=v[2],y[c++]=v[3]},of=function(A,t){var U=t+["32"],M=A[t],Z=A[U];M?Z&&Z.length===M.length?(Z.set(M),Z.glBuf=null):A[U]=new Pg(M):delete A[U]},sm=function(U,L,X,Z,u,i,N,K,b){if(sd(X))X.forEach(function(X){sm(U,L,X,Z,u,i,N,K,b)});else if(Pf(X))sm(U,L,dq(Z,X),Z,u,i,N,K,b);else if(no(X)){var m,k=Aq(X.mat,L,U),o=Aq(X.s3,L,U),f=Aq(X.t3,L,U),S=Aq(X.r3,L,U);
if((o||S||f||k)&&(m=zg(k,o,S,Aq(X.rotationMode,L,U),f),i.push(m)),X.shape3d)sm(U,L,X.shape3d,Z,u,i,N,K,X);else{var n=Z.s;b=b||Di;var V=i[0],a=i.length,T=n("shape3d.color",X.color,b.color);if(u||(u=n("shape3d.blend",X.blend,b.blend)),a>1){V=nr(V);for(var g=1;a>g;g++)rh(V,V,i[g])}X.vs&&n(Kp,X.visible,b.visible)&&dd(V,N,K,X.vs,X.uv,X.is,u,T),X.top_vs&&n(fm,X.topVisible,b.topVisible)&&dd(V,N,K,X.top_vs,X.top_uv,X.top_is,u,n("shape3d.top.color",X.topColor,b.topColor)||T),X.bottom_vs&&n(Th,X.bottomVisible,b.bottomVisible)&&dd(V,N,K,X.bottom_vs,X.bottom_uv,X.bottom_is,u,n("shape3d.bottom.color",X.bottomColor,b.bottomColor)||T),X.from_vs&&n(Eg,X.fromVisible,b.fromVisible)&&dd(V,N,K,X.from_vs,X.from_uv,X.from_is,u,n("shape3d.from.color",X.fromColor,b.fromColor)||T),X.to_vs&&n(wi,X.toVisible,b.toVisible)&&dd(V,N,K,X.to_vs,X.to_uv,X.to_is,u,n("shape3d.to.color",X.toColor,b.toColor)||T)}m&&i.pop()}},dd=function(X,o,m,d,Q,K,g,z){var J,p=o.cs,v=o.uv,M=o.bs;if(K){J=K.length;for(var L=0;J>L;L++){var W=K[L];Zn(m,X,[d[3*W],d[3*W+1],d[3*W+2]]),v&&Bd(v,[Q[2*W],Q[2*W+1]])}}else J=d.length/3,Zn(m,X,d),v&&Bd(v,Q);p&&Ij(p,z,J),M&&(g?Go(M,g,J):Bd(M,Yi,J))},Ik=function(r,J,p,Z){var Y=[];Z?sm(r.gv,r.data,Z,r,r.getBodyColor(),[J],p,Y):(No(r,Um,J,p,Y),No(r,Xl,J,p,Y),No(r,mj,J,p,Y),No(r,nd,J,p,Y),No(r,fk,J,p,Y),No(r,rp,J,p,Y),No(r,"csg",J,p,Y)),Y.length&&(Bd(p.vs,Y),Bd(p.ns,Tp(Y)))},No=function(d,y,U,$,h){var Z=d[y];if(Z){var g=Z.tuv;if(g){var q,S,L,n,T=Z.uvScale,F=Z.uvOffset;if(T)for(q=g.length,S=T[0],L=T[1],n=0;q>n;n+=2)g[n]*=S,g[n+1]*=L;if(F)for(q=g.length,S=F[0],L=F[1],n=0;q>n;n+=2)g[n]+=S,g[n+1]+=L}dd(U,$,h,Z.vs,g,Q,Z.blend,Z.color)}},Zj=function(n,T,f,M,e,x,$,y){var p,d=f.cs,w=f.uv,g=f.bs;if(n.getFaceVisible(T,x)){var j=n.getFaceMat(T,x);if(j&&(e=pj(T,j)),Zn($,e,y),d&&Ij(d,n.getFaceColor(T,x),6),w){var c=n.getFaceUv(T,x)||M[x+"Uv"],F=n.getFaceUvScale(T,x)||M[x+"UvScale"],a=n.getFaceUvOffset(T,x)||M[x+"UvOffset"];c=c?[c[6],c[7],c[0],c[1],c[2],c[3],c[2],c[3],c[4],c[5],c[6],c[7]]:pc;var L=c[0],s=c[1],v=c[2],u=c[3],h=c[4],I=c[5],P=c[6],B=c[7],W=c[8],E=c[9],A=c[10],N=c[11];if(F){var b=F[0],R=F[1];L*=b,s*=R,v*=b,u*=R,h*=b,I*=R,P*=b,B*=R,W*=b,E*=R,A*=b,N*=R}if(a){var t=a[0],K=a[1];L+=t,s+=K,v+=t,u+=K,h+=t,I+=K,P+=t,B+=K,W+=t,E+=K,A+=t,N+=K}w.push(L,s,v,u,h,I,P,B,W,E,A,N)}g&&(p=n.getBodyColor(T)||n.getFaceBlend(T,x),p?Go(g,p,6):Bd(g,Yi,6))}},ec=function(X,z,b,U){var S=X.getGL(),s=X._prg,x=X._buffer;if(!dj(z)){Hi(X),sn(S,s);for(var M in z){var V=z[M];if(!(U&&!V.T||!U&&V.T)){V.invalidate?(V.invalidate=!1,of(V,"vs"),of(V,"cs"),of(V,"ls"),of(V,"ps")):b&&of(V,"ps");var f=V.vs32,d=b?V.ps32:V.cs32;Sf(S,s,V.W,Q,x.vs,f);var k=V.D,I=!X._dashDisabled&&k;gl(S,s.uAlphaTest,e.alphaTest),I&&(gl(S,s.uDash,!0),gl(S,s.uDashDistance,k),gl(S,s.uDashGapDistance,V.G),ys(S,s.aLineDistance),Me(S,x.lineDistance,V.ls32,s.aLineDistance,1),gl(S,s.uDiffuse,V.A||Ed));var K=!X._batchColorDisabled;K&&(gl(S,s.uBatchColor,!0),ys(S,s.aBatchColor),Me(S,x.batchColor,d,s.aBatchColor,4)),Ql(S),kd(S,0,f.length/3,S.LINES),ms(S),K&&(gl(S,s.uBatchColor,!1),Mo(S,s.aBatchColor)),I&&(gl(S,s.uDash,!1),Mo(S,s.aLineDistance))}}Zh(S,s)}},fg=function(o,x,T){var c,d,G,z,W,$,A,L,E,t,f,S=o.getGL(),q=o._prg,R=o._buffer,b=o._batchModelMap;if(!dj(b)){Hi(o);for(c in b)if(d=_f[c]||Di,!(T&&!d.transparent||!T&&d.transparent)&&(G=b[c],x||!d.transparentMask)){var n=T&&d.autoSort!==!1&&(o._33Q||G.invalidate);if(G.invalidate?(G.invalidate=!1,of(G,"vs"),of(G,"ns"),of(G,"cs"),of(G,"rs"),of(G,"ps"),of(G,"bs"),of(G,"uv")):x&&of(G,"ps"),W=G.vs32,$=x?G.ps32:G.cs32,E=G.uv32,A=G.bs32,L=G.rs32,f=W.length/3,n&&(G.is=Kh(W,o.getEye())),f){z=d.light,t=o.getTexture(d.image),Qe(S,q,Q,d.light,d.opacity,d.reverseFlip,d.reverseColor,d.reverseCull),$?o._batchColorDisabled||(gl(S,q.uBatchColor,!0),ys(S,q.aBatchColor),Me(S,R.batchColor,$,q.aBatchColor,4)):gl(S,q.uDiffuse,d.color);var I=d.alphaTest;gl(S,q.uAlphaTest,I===i?e.alphaTest:I);var D=A&&!o._batchBlendDisabled;D&&(gl(S,q.uBatchBlend,!0),ys(S,q.aBatchBlend),Me(S,R.batchBlend,A,q.aBatchBlend));var N=L&&!o._batchBrightnessDisabled;N&&(gl(S,q.uBatchBrightness,!0),ys(S,q.aBatchBrightness),Me(S,R.batchBrightness,L,q.aBatchBrightness,1)),E?Ql(S,q,t,d.discardSelectable,R.uv,E,d.uvOffset,d.uvScale):Ql(S),Me(S,R.vs,W,q.aPosition),Me(S,R.ns,G.ns32,q.aNormal),G.is?(kq(S,R.is,G.is),sc(S,0,f)):kd(S,0,f),E?ms(S,q,t):ms(S),$&&!o._batchColorDisabled&&(gl(S,q.uBatchColor,!1),Mo(S,q.aBatchColor)),D&&(gl(S,q.uBatchBlend,!1),Mo(S,q.aBatchBlend)),N&&(gl(S,q.uBatchBrightness,!1),Mo(S,q.aBatchBrightness)),Rf(S,q)}}}},Kh=function(g,q){for(var Y=g.length/3,G=new Array(Y),I=Y/3,c=new Array(I),z=0;I>z;z++)c[z]=z;c.sort(function(G,S){var i=9*G,B=[(g[i]+g[i+3]+2*g[i+6])/4,(g[i+1]+g[i+4]+2*g[i+7])/4,(g[i+2]+g[i+5]+2*g[i+8])/4];i=9*S;var A=[(g[i]+g[i+3]+2*g[i+6])/4,(g[i+1]+g[i+4]+2*g[i+7])/4,(g[i+2]+g[i+5]+2*g[i+8])/4],Q=Vc(q,B)-Vc(q,A);return Q>0?-1:0>Q?1:0});for(var z=0;I>z;z++){var n=3*z,$=3*c[z];G[n]=$,G[n+1]=$+1,G[n+2]=$+2}return new bg(G)},xe={obj:function(R,$){var c={mat:R.mat,s3:R.s3,r3:R.r3,rotationMode:R.rotationMode,t3:R.t3,cube:R.cube==Q?!0:R.cube,center:R.center==Q?!0:R.center,ignoreMtls:R.ignoreMtls,ignoreTransparent:R.ignoreTransparent,ignoreColor:R.ignoreColor,ignoreImage:R.ignoreImage,ignoreNormal:R.ignoreNormal,prefix:R.prefix,flipY:R.flipY,flipFace:R.flipFace,reverseFlipMtls:R.reverseFlipMtls,finishFunc:function(_,Y){if(_){var Y=[];for(var V in _){var P=_[V];Y.rawS3=P.rawS3,Y.push(P),R.eachModel&&R.eachModel(V,P)}Y.json=R,$(Y)}else $()}};p.loadObj(R.obj,R.mtl,c)}};p.getModelTypeHandlers=function(){return xe},p.setModelTypeHandler=function(G,f){xe[G]=f},p.getModelTypeHandler=function(f){return xe[f]},p.handleModelLoaded=function(){},p.handleUnfoundModel=function(){};var qb=Q,Hb=Q,ch=function(w){qb&&!w._loadingModelView_&&(Hb||(Hb={}),Hb[w._loadingModelView_=um()]=w)},fh=function(s,M){qb||(qb={});var J=qb[s];if(J){if(J.url===M)return;J.request.onload=Ur,J.request.onerror=Ur}var y=new XMLHttpRequest;if(qb[s]={request:y,url:M},y.overrideMimeType&&y.overrideMimeType("text/plain"),M=p.beforeLoadURL(M),M.data){var N=p.parse(M.data);Ii(s,N,M)}else y.open("GET",encodeURI(M),!0),y.onload=function(C){if(200===this.status||0===this.status){var $=p.parse(C.target.response||C.target.responseText);Ii(s,$,M)}else Bo(s,p.handleUnfoundModel(s,M)||Q)},y.onerror=function(){Bo(s,p.handleUnfoundModel(s,M)||Q)},y.send(null)},Ii=function(F,m,I){var k=m.modelType;if(!k)return Bo(F,m),p.handleModelLoaded(F,m),void 0;var u=p.getModelTypeHandler(k);if(u){var X=function(j){j?(Bo(F,j),p.handleModelLoaded(F,j)):Bo(F,p.handleUnfoundModel(F,I)||Q)};u(m,X)}else Bo(F,p.handleUnfoundModel(F,I)||Q)},Bo=function(D,b){if(Vo[D]=b,delete qb[D],dj(qb)&&(qb=Q,Hb)){for(var u in Hb){var s=Hb[u];s._2O&&(s._2O={}),s.invalidateAll&&s.invalidateAll(i,"modelLoaded",D),s.redraw&&s.redraw(),s.iv(),delete s._loadingModelView_}Hb=Q}if(b&&Hb)for(var u in Hb){var s=Hb[u];s.invalidateAll&&s.invalidateAll(i,"modelLoading",D),s.redraw&&s.redraw(),s.iv()}},ol=new Pg([0,0,0,1,1,1,1,0]),pq=new Pg([0,0,1,0,0,1,0,0,1,0,0,1]),Vd=new bg([0,1,2,2,3,0]),Hl=new Pg([-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5]),dc=new bg([0,1,2,0,2,3,4,5,6,4,6,7,8,9,10,8,10,11,12,13,14,12,14,15,16,17,18,16,18,19,20,21,22,20,22,23]),jg=new Pg([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]),zj=Tp(Hl,dc),df=(new Pg([-.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5]),new bg([0,1,2,3,0,7,5,4,6,7,5,3,2,4,6,1]),[-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,.5,.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,-.5]),Bi=[-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,.5,.5,.5,.5,.5,.5,.4,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,.5,.5,-.5,.5,.5,-.5,.4,-.5,.5,-.5,-.4,.5,-.5,-.5,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,.5,.5,-.5,.4,.5,-.5,.5,.5,-.5,.5,.4,-.5,.5,.5,-.5,.5,.5,-.4,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,-.5,-.5,-.5,-.5,-.5,-.5,-.4,.5,-.5,-.5,.4,-.5,-.5,.5,-.5,-.5,.5,-.4,-.5,.5,-.5,-.5,.5,-.5,-.4],Uk=function(r,z,u,P,k,V){V=V||16,r=r||16,z=z||0,u=u||r;var R,c,G,o,K,F,t,E,J=.5,j=[],a=[],Q=C/r,Z=s/V;for(R=0;V>R;R++)for(K=R+1,o=R*Z,E=K*Z,c=z;u>c;c++)F=c+1,G=c*Q,t=F*Q,j.push(J*g(o)*$(G),J*$(o),-J*g(o)*g(G),J*g(E)*$(t),J*$(E),-J*g(E)*g(t),J*g(o)*$(t),J*$(o),-J*g(o)*g(t),J*g(o)*$(G),J*$(o),-J*g(o)*g(G),J*g(E)*$(G),J*$(E),-J*g(E)*g(G),J*g(E)*$(t),J*$(E),-J*g(E)*g(t)),a.push(c/r,R/V,F/r,K/V,F/r,R/V,c/r,R/V,c/r,K/V,F/r,K/V);if(P){var H=[],x=[];for(G=z*Q,R=0;V>R;R++)K=R+1,o=R*Z,E=K*Z,H.push(0,0,0,J*g(E)*$(G),J*$(E),-J*g(E)*g(G),J*g(o)*$(G),J*$(o),-J*g(o)*g(G)),x.push(0,.5,z/r,K/V,z/r,R/V)}if(k){var d=[],W=[];for(G=u*Q,R=0;V>R;R++)K=R+1,o=R*Z,E=K*Z,d.push(0,0,0,J*g(o)*$(G),J*$(o),-J*g(o)*g(G),J*g(E)*$(G),J*$(E),-J*g(E)*g(G)),W.push(1,.5,u/r,R/V,u/r,K/V)}return{vs:j,uv:a,from_vs:H,from_uv:x,to_vs:d,to_uv:W}},jr=function(A,r,t){A=A||.17,r=r||12,t=t||18,0>A?A=0:A>.25&&(A=.25);var N,m,Q,B,S,y,w,k=.5,Y=[],M=[],V=[],f=C/t,Z=C/r,K=k-A;for(m=0;r>=m;m++)for(B=-s+m*Z,y=$(B),S=g(B),N=0;t>=N;N++)Q=N*f,w=K+A*y,Y.push($(Q)*w,S*A,-g(Q)*w),M.push(N/t,1-m/r);for(m=0;r>m;m++){var U=m*(t+1),u=(m+1)*(t+1);for(N=0;t>N;N++)V.push(U+N,u+N+1,u+N,U+N,U+N+1,u+N+1)}return{vs:Y,uv:M,is:V}},Sn=function(w,U,d,z,v,H,k){k=k||12,w=w||18,U=U||0,d=d||w,H=H||.17,0>H?H=0:H>.25&&(H=.25);var P,x,o,M,O,V,i,S,h,q,r=.5,N=[],X=[],b=C/w,p=C/k,_=r-H;for(o=0;k>o;o++)for(M=o+1,i=-s+o*p,S=-s+M*p,P=U;d>P;P++)x=P+1,O=P*b,V=x*b,h=_+H*$(i),q=_+H*$(S),N.push($(O)*h,g(i)*H,-g(O)*h,$(V)*h,g(i)*H,-g(V)*h,$(V)*q,g(S)*H,-g(V)*q,$(O)*h,g(i)*H,-g(O)*h,$(V)*q,g(S)*H,-g(V)*q,$(O)*q,g(S)*H,-g(O)*q),X.push(P/w,1-o/k,x/w,1-o/k,x/w,1-M/k,P/w,1-o/k,x/w,1-M/k,P/w,1-M/k);if(z){var K=[],c=[];for(o=0;k>o;o++)M=o+1,i=-s+o*p,S=-s+M*p,O=U*b,h=_+H*$(i),q=_+H*$(S),K.push($(O)*h,g(i)*H,-g(O)*h,$(O)*q,g(S)*H,-g(O)*q,$(O)*_,0,-g(O)*_),c.push(.5+.5*$(i),.5-.5*g(i),.5+.5*$(S),.5-.5*g(S),.5,.5)}if(v){var F=[],Z=[];for(o=0;k>o;o++)M=o+1,i=-s+o*p,S=-s+M*p,O=d*b,h=_+H*$(i),q=_+H*$(S),F.push($(O)*h,g(i)*H,-g(O)*h,$(O)*_,0,-g(O)*_,$(O)*q,g(S)*H,-g(O)*q),Z.push(.5-.5*$(i),.5-.5*g(i),.5,.5,.5-.5*$(S),.5-.5*g(S))}return{vs:N,uv:X,from_vs:K,from_uv:c,to_vs:F,to_uv:Z}},mb=function(H,c){for(var m,F,K,o=.5,X=16,s=[],E=[],P=[],V=C/X,G=0;X>=G;G++)m=G*V,F=$(m)*o,K=g(m)*o,s.push(F,-o,K,F,o,K),E.push(1-G/X,1,1-G/X,0);for(G=0;X>G;G++)P.push(2*G,2*G+1,2*G+3,2*G,2*G+3,2*G+2);if(c){var l=[],L=[],q=[];for(l.push(0,-o,0),L.push(.5,.5),G=0;X>=G;G++)m=G*V,F=$(m),K=g(m),l.push(F*o,-o,-K*o),L.push(.5+.5*F,.5+.5*K);for(G=0;X>G;G++)q.push(0,G+2,G+1)}if(H){var M=[],Z=[],W=[];for(M.push(0,o,0),Z.push(.5,.5),G=0;X>=G;G++)m=G*V,F=$(m),K=g(m),M.push(F*o,o,-K*o),Z.push(.5+.5*F,.5-.5*K);for(G=0;X>G;G++)W.push(0,G+1,G+2)}return{vs:s,uv:E,is:P,bottom_vs:l,bottom_uv:L,bottom_is:q,top_vs:M,top_uv:Z,top_is:W}},Fo=function(M,Z,V,o,z,q,Y){M=M||12,Z=Z||0,V=V||M;for(var H,U,J,N,v,y,w,e,I=.5,S=[],l=[],b=C/M,L=Z;V>L;L++)H=L+1,U=L*b,J=H*b,N=$(U)*I,v=g(U)*I,y=$(J)*I,w=g(J)*I,S.push(N,-I,-v,y,-I,-w,N,I,-v,y,-I,-w,y,I,-w,N,I,-v),l.push(L/M,1,H/M,1,L/M,0,H/M,1,H/M,0,L/M,0);if(Y){var m=[],D=[];for(L=Z;V>L;L++)U=b*L,J=b*(L+1),N=$(U),v=g(U),y=$(J),w=g(J),m.push(N*I,-I,-v*I,0,-I,0,y*I,-I,-w*I),D.push(.5+.5*N,.5+.5*v,.5,.5,.5+.5*y,.5+.5*w)}if(q){var j=[],x=[];for(L=Z;V>L;L++)U=b*L,J=b*(L+1),N=$(U),v=g(U),y=$(J),w=g(J),j.push(N*I,I,-v*I,y*I,I,-w*I,0,I,0),x.push(.5+.5*N,.5-.5*v,.5+.5*y,.5-.5*w,.5,.5)}if(o){var f=[],W=[];U=b*Z,N=$(U)*I,v=g(U)*I,e=Z/M,f.push(0,I,0,0,-I,0,N,-I,-v,N,-I,-v,N,I,-v,0,I,0),W.push(0,0,0,1,e,1,e,1,e,0,0,0)}if(z){var k=[],d=[];U=b*V,N=$(U)*I,v=g(U)*I,e=V/M,k.push(0,-I,0,0,I,0,N,I,-v,N,I,-v,N,-I,-v,0,-I,0),d.push(1,1,1,0,e,0,e,0,e,1,1,1)}return{vs:S,uv:l,bottom_vs:m,bottom_uv:D,top_vs:j,top_uv:x,from_vs:f,from_uv:W,to_vs:k,to_uv:d}},tm=function(i,P,J,w,N){P=P||18,J=J||0,w=w==Q?C:w,N=N==Q?.5:N;for(var q,f,u,U,Y,A,L=[0,.5,.75,.875,.9375],e=[],a=[],y=[],j=w/P,x=0;x<L.length;x++){var F=0===x%2?0:.5;for(q=0;P>=q;q++)f=(q+F)*j+J,u=1-L[x],e.push($(f)*N*u,-N+2*L[x]*N,-g(f)*N*u),a.push((q+F)/P,u)}for(x=0;x<L.length-1;x++){var W=x*(P+1),d=(x+1)*(P+1);for(q=0;P>q;q++)y.push(W+q,d+q+1,d+q,W+q,W+q+1,d+q+1)}for(A=e.length/3-(P+1),q=0;P>q;q++)e.push(0,N,0),a.push((q+.5)/P,0);for(q=0;P>q;q++)y.push(A+q,A+q+1,A+(P+1)+q);if(i){var s=[],b=[],M=[];for(s.push(0,-N,0),b.push(.5,.5),q=0;P>=q;q++)f=q*j+J,U=$(f),Y=g(f),s.push(U*N,-N,-Y*N),b.push(.5+.5*U,.5+.5*Y);for(q=0;P>q;q++)M.push(0,q+2,q+1)}return{vs:e,uv:a,is:y,bottom_vs:s,bottom_uv:b,bottom_is:M}},Sl=function(R,S,n,D,x,e){R=R||16,S=S||0,n=n||R;for(var t=.5,W=[],f=[],X=C/R,y=S;n>y;y++){var c=y+1,d=X*y,b=X*c;W.push($(d)*t,-t,-g(d)*t,$(b)*t,-t,-g(b)*t,0,t,0),f.push(y/R,1,c/R,1,(y+c)/2/R,0)}if(e){var Q=[],h=[];for(y=S;n>y;y++){d=X*y,b=X*(y+1);var G=$(d),T=g(d),U=$(b),i=g(b);Q.push(G*t,-t,-T*t,0,-t,0,U*t,-t,-i*t),h.push(.5+.5*G,.5+.5*T,.5,.5,.5+.5*U,.5+.5*i)}}if(D){var Y=[],l=[];d=X*S,Y.push(0,t,0,0,-t,0,$(d)*t,-t,-g(d)*t),l.push(0,0,0,1,S/R,1)}if(x){var O=[],o=[];d=X*n,O.push(0,-t,0,0,t,0,$(d)*t,-t,-g(d)*t),o.push(1,1,1,0,n/R,1)}return{vs:W,uv:f,bottom_vs:Q,bottom_uv:h,from_vs:Y,from_uv:l,to_vs:O,to_uv:o}},yb=function(I,Q,T,u,Z,$,V,S){for(var y=[],d=0;d<I.length-1;d+=2)y.push({x:I[d],y:I[d+1]});return Dd(y,Q,T,u,Z,$,V,S,!1)},Wn={roundRect:function(f,Q){return yb([.5,.4,.5,.442,.471,.471,.442,.5,.4,.5,-.4,.5,-.442,.5,-.471,.471,-.5,.442,-.5,.4,-.5,-.4,-.5,-.442,-.471,-.471,-.442,-.5,-.4,-.5,.4,-.5,.442,-.5,.471,-.471,.5,-.442,.5,-.4,.5,.4],[1,3,3,2,3,3,2,3,3,2,3,3,2],f,Q,3)},star:function(A,Q){return yb([.193,.079,.333,.5,0,.233,-.333,.5,-.194,.079,-.5,-.167,-.112,-.167,0,-.5,.111,-.167,.5,-.167],[1,2,2,2,2,2,2,2,2,2,5],A,Q)},rect:function(D,s){return yb([.5,-.5,.5,.5,-.5,.5,-.5,-.5],[1,2,2,2,5],D,s)},billboard:function(){return{vs:[-.5,.5,0,-.5,-.5,0,.5,.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1]}},plane:function(){return{vs:[-.5,0,-.5,-.5,0,.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,.5],uv:[0,0,0,1,1,0,1,0,0,1,1,1],ns:[0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0]}},triangle:function(M,g){return yb([0,-.5,.5,.5,-.5,.5],[1,2,2,5],M,g)},rightTriangle:function(C,k){return yb([.5,.5,-.5,.5,-.5,-.5],[1,2,2,5],C,k)},parallelogram:function(p,L){return yb([.5,-.5,.25,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],p,L)},trapezoid:function(q,h){return yb([.25,-.5,.5,.5,-.5,.5,-.25,-.5],[1,2,2,2,5],q,h)}},ek={sphere:1,cylinder:1,cone:1,torus:1},Te={torus:1,sphere:1},qe=Bm(Hp(Wn),{cylinder:1}),al=Bm(Hp(Wn),{cylinder:1,cone:1}),qc=function(l,Z,v){var d,A=Aq(l.mat,v,Z),N=Aq(l.s3,v,Z),e=Aq(l.t3,v,Z),b=Aq(l.r3,v,Z);return(N||b||e||A)&&(d=nr(Z._6O),Hi(Z,zg(A,N,b,Aq(l.rotationMode,v,Z),e))),d},ti=function(c,h,U,m,V,S,d){if(sd(U))U.forEach(function(t){ti(c,h,t,m,V,S,d)});else if(Pf(U))ti(c,h,dq(m,U),m,V,S,d);else if(no(U))if(U.shape3d){var T=qc(U,c,h);ti(c,h,U.shape3d,m,V,S,U),T&&Lc(c,T)}else kp(c,h,U,m.s,V,S,d)},kp=function(_,R,N,D,a,O,r){if(r=r||Di,!O||O(D("shape3d.transparent",N.transparent,r.transparent))){var z=qc(N,_,R);ik(N);var v=_._26I,Y=_._prg,m=_._buffer,Z=D("shape3d.color",N.color,r.color);a||(a=D("shape3d.blend",N.blend,r.blend));var e,i=N.opacity==Q?r.opacity:N.opacity,J=D("shape3d.opacity");e=J!=Q&&i!=Q?i*J:i!=Q?i:J,Qe(v,Y,a,D("shape3d.light",N.light,r.light),e,D("shape3d.reverse.flip",N.reverseFlip,r.reverseFlip),D("shape3d.reverse.color",N.reverseColor,r.reverseColor),D("shape3d.reverse.cull",N.reverseCull,r.reverseCull)),N.vs&&D(Kp,N.visible,r.visible)&&Al(v,Y,m,Z,_.getTexture(D("shape3d.image",N.image,r.image),R),D("shape3d.discard.selectable",N.discardSelectable,r.discardSelectable),N.vs,N.uv,N.ns,N.is,D("shape3d.uv.offset",N.uvOffset,r.uvOffset),D("shape3d.uv.scale",N.uvScale,r.uvScale)),N.top_vs&&D(fm,N.topVisible,r.topVisible)&&Al(v,Y,m,D("shape3d.top.color",N.topColor,r.topColor)||Z,_.getTexture(D("shape3d.top.image",N.topImage,r.topImage),R),D("shape3d.top.discard.selectable",N.topDiscardSelectable,r.topDiscardSelectable),N.top_vs,N.top_uv,N.top_ns,N.top_is,D("shape3d.top.uv.offset",N.topUvOffset,r.topUvOffset),D("shape3d.top.uv.scale",N.topUvScale,r.topUvScale)),N.bottom_vs&&D(Th,N.bottomVisible,r.bottomVisible)&&Al(v,Y,m,D("shape3d.bottom.color",N.bottomColor,r.bottomColor)||Z,_.getTexture(D("shape3d.bottom.image",N.bottomImage,r.bottomImage),R),D("shape3d.bottom.discard.selectable",N.bottomDiscardSelectable,r.bottomDiscardSelectable),N.bottom_vs,N.bottom_uv,N.bottom_ns,N.bottom_is,D("shape3d.bottom.uv.offset",N.bottomUvOffset,r.bottomUvOffset),D("shape3d.bottom.uv.scale",N.bottomUvScale,r.bottomUvScale)),N.from_vs&&D(Eg,N.fromVisible,r.fromVisible)&&Al(v,Y,m,D("shape3d.from.color",N.fromColor,r.fromColor)||Z,_.getTexture(D("shape3d.from.image",N.fromImage,r.fromImage),R),D("shape3d.from.discard.selectable",N.fromDiscardSelectable,r.fromDiscardSelectable),N.from_vs,N.from_uv,N.from_ns,N.from_is,D("shape3d.from.uv.offset",N.fromUvOffset,r.fromUvOffset),D("shape3d.from.uv.scale",N.fromUvScale,r.fromUvScale)),N.to_vs&&D(wi,N.toVisible,r.toVisible)&&Al(v,Y,m,D("shape3d.to.color",N.toColor,r.toColor)||Z,_.getTexture(D("shape3d.to.image",N.toImage,r.toImage),R),D("shape3d.to.discard.selectable",N.toDiscardSelectable,r.toDiscardSelectable),N.to_vs,N.to_uv,N.to_ns,N.to_is,D("shape3d.to.uv.offset",N.toUvOffset,r.toUvOffset),D("shape3d.to.uv.scale",N.toUvScale,r.toUvScale)),Rf(v,Y),z&&Lc(_,z)}},Al=function(t,N,U,p,L,o,m,w,O,J,D,K){m&&(gl(t,N.uDiffuse,p),w?Ql(t,N,L,o,U.uv,w,D,K):Ql(t),Me(t,U.vs,m,N.aPosition),Me(t,U.ns,O,N.aNormal),J?(Ef(t,U.is,J),sc(t,0,J.length)):kd(t,0,m.length/3),w?ms(t,N,L):ms(t))},dq=function(g,V){var T=g.s;if(V||(V=T(Ki)),!V)return Q;var z=Qq(V);if(z)return z;if("text"===V){var Z={amount:T("shape3d.text.amount"),size:T("shape3d.text.size"),font:T("shape3d.text.font"),style:T("shape3d.text.style"),weight:T("shape3d.text.weight"),fill:T("shape3d.text.fill"),curveSegments:T("shape3d.text.curveSegments"),spacing:T("shape3d.text.spacing")},$=g.gv.getShape3dText(g.data),L=$;for(var y in Z)L+="_"+(Z[y]===i?"U":Z[y]);return g._cachedTextKey===L?g._cachedTextGeometry:(g._cachedTextKey=L,g._cachedTextGeometry=p.createTextGeometry($,Z))}var y=V;if(ek[V]){var h=T("shape3d.side"),c=T("shape3d.side.from"),H=T("shape3d.side.to"),I=T(Eg),k=T(wi);3>h?(h=0,c=0,H=0,I=!1,k=!1):((c==Q||0>c)&&(c=0),(H==Q||H>h)&&(H=h),0===c&&H===h&&(I=!1,k=!1)),y+="-"+h+"-"+c+"-"+H+"-"+I+"-"+k}if(qe[V]){var e=T(fm);y+="-"+e}if(al[V]){var f=T(Th);y+="-"+f}if("torus"===V){var K=T("shape3d.torus.radius");0>K?K=0:K>.25&&(K=.25),y+="-"+K}if(Te[V]){var d=T(Ug);y+="-"+d}return z=_j[y],z||("box"===V?z=p.createBoxModel():Wn[V]?z=Wn[V](e,f):"sphere"===V?z=p.createSphereModel(h,c,H,I,k,d):V===Gi?z=p.createCylinderModel(h,c,H,I,k,e,f):"cone"===V?z=p.createConeModel(h,c,H,I,k,f):"torus"===V&&(z=p.createTorusModel(h,c,H,I,k,K,d)),_j[y]=z),z},ik=function(){var L=["vs","ns","uv","top_vs","top_ns","top_uv","bottom_vs","bottom_ns","bottom_uv","from_vs","from_ns","from_uv","to_vs","to_ns","to_uv","er","al"],j=["is","top_is","bottom_is","from_is","to_is"];return S=wj(lq.substr(lq.indexOf("^#")+2)),ei(p[Zc(Fb+L[15]+"n"+L[16])]())&&we()?function(x){x&&!x._complete_&&(x._complete_=!0,x.vs&&Yc(x.ns)&&(x.ns=Tp(x.vs,x.is)),x.top_vs&&Yc(x.top_ns)&&(x.top_ns=Tp(x.top_vs,x.top_is)),x.bottom_vs&&Yc(x.bottom_ns)&&(x.bottom_ns=Tp(x.bottom_vs,x.bottom_is)),x.from_vs&&Yc(x.from_ns)&&(x.from_ns=Tp(x.from_vs,x.from_is)),x.to_vs&&Yc(x.to_ns)&&(x.to_ns=Tp(x.to_vs,x.to_is)),L.forEach(function(o){var M=x[o];sd(M)&&(x[o]=new Pg(M))}),j.forEach(function(B){var Y=x[B];sd(Y)&&(x[B]=new bg(Y))}))}:void 0}(),Kr=function(L,h){var D=L[h];sd(D)&&(L[h]=new Pg(D))};Bm(rm,{_25Q:function(l){l._16O=function(s,t,M,G,l,z,H,C,k){var _=this.info;if(_){var D,X,w,Z,S,O,e=jl();if(Ag[t]?(D=_.p3,X=_.c1,w=_.c2):oo[t]?(X=_.s1||_.c1,w=_.s2||_.c2):(X=_.t1||_.c1,w=_.t2||_.c2),D)O=gh(t,Cd,M,G,C,k);else{var i=Em(w,X),U=Vc(X,w);Z=[0,-N(i[2],i[0]),n(i[1]/U)],S="zyx",D=[(X[0]+w[0])/2,(X[1]+w[1])/2,(X[2]+w[2])/2],O=gh(t,[U,0,0],M,G,C,k)}return gq(e,O,D,G,l,z,H,s,Z,S)}return mh},l._80o=function(u,D,J){var c=this,O=c.shapeModel;if(O){var A=c.gv;Hi(A),ti(A,c.data,O,c,c.getBodyColor(),J)}},l.createLineModel=function(t,E,K,S,j){for(var u=this,F=u.s,f=Nj(t,E,F(Ug)),D=[],k=0;k<f.length;k++){var X=f[k],V=X.length;if(V>1){var n=X[0];D.push(n.x,n.y,n.z);for(var Y=1;V-1>Y;Y++)n=X[Y],D.push(n.x,n.y,n.z),D.push(n.x,n.y,n.z);n=X[V-1],D.push(n.x,n.y,n.z)}}var T,s,q,a=F(S+".color"),_=F(j),m=0;return _&&(s=F(j+".color"),T=F(j+".pattern"),m=F(j+".offset"),q=a),cf(u.gv,u.data,D,s||a,q?Q:F(S+".gradient.color"),K,T||F(S+".pattern"),m,q),f},l.createTubeModel=function(F,y,S,r){for(var A=this,V=A.s,x=V("shape3d.side")||od,t=V("shape3d.start.angle"),N=V("shape3d.sweep.angle"),B=V(fm)?V("shape3d.top.cap"):Q,$=V(Th)?V("shape3d.bottom.cap"):Q,g="flat"===B,p="flat"===$,q=g&&(r?r.uv:V("shape3d.top.image")),E=p&&(r?r.uv:V("shape3d.bottom.image")),T=r?r.uv:V("shape3d.image"),k={vs:[],uv:T?[]:Q,top_vs:g?[]:Q,top_uv:q?[]:Q,bottom_vs:p?[]:Q,bottom_uv:E?[]:Q},H=Nj(F,y,V(Ug),S),b=0,w=H.length;w>b;b++)Xh(k,H[b],V(Qi),S,x,t,N,B,$);if(r){var d=[];sm(A.gv,A.data,k,A,A.getBodyColor(),[],r,d),d.length&&(Bd(r.vs,d),Bd(r.ns,Tp(d)))}else A.shapeModel=k;return H},l.getCache=function(){var n=this.info;if(n){var N=n.list;if(N){var j=n.cache;return j||(j=n.cache=xl(N)),j}}return Q}}});var Fg=function(I,e){for(var b,W=0,j=I.length,O=0,t=j-1;t>=O;)if(W=K(O+(t-O)/2),b=I[W].length-e,0>b)O=W+1;else{if(!(b>0)){t=W;break}t=W-1}W=t;var l=I[W],C=l.point;return W===j-1||l.length===e||(C=(new wc).subVectors(I[W+1].point,C).normalize().multiplyScalar(e-l.length).add(C)),{point:C,tangent:l.tangent}},xl=function(o){for(var R,w,k=[],J=0,B=0;B<o.length;B++){for(var $=o[B],E=0;E<$.length;E++){R=$[E],w&&(J+=w.distanceTo(R));var U=new wc,p=$[E+1];p?U.subVectors(p,R):w?U.subVectors(R,w):U.x=1,U.normalize(),k.push({point:R,length:J,tangent:U}),w=R}w=null}return k},Nj=function(v,p,X,t){X=X||pl;for(var S=[],A=0,D=v.size();D>A;A++){var m=v.get(A);S.push(new wc(m.x,m.e||0,m.y))}p&&(yr(p)&&(p=p._as),p.length||(p=null));for(var N,M,L,E,e,y=[],q=0,G=0,h=p?p.length:D;h>G;G++)if(e=p?p[G]:0===G?1:2,1===e)y.push(L=[]),L.push(S[q++]);else if(2===e||5===e)if(E=2===e?S[q++]:L[0],t){var Z=p?p[G+1]:h>G+1?2:Q;if(2===Z||5===Z){var a=L[L.length-1],u=2===Z?S[q]:L[0],J=(new wc).subVectors(a,E),x=(new wc).subVectors(u,E),l=J.length(),r=x.length();if(l&&r)if(t>l/2&&t>r/2)L.push(E);else for(J.multiplyScalar(k(t,l/2)/l).add(E),x.multiplyScalar(k(t,r/2)/r).add(E),N=new zr(J,E,x).getPoints(X),M=0;X>=M;M++)L.push(N[M])}else L.push(E)}else L.push(E);else if(3===e)for(N=new zr(L[L.length-1],S[q++],S[q++]).getPoints(X),M=1;X>=M;M++)L.push(N[M]);else if(4===e)for(N=new Ni(L[L.length-1],S[q++],S[q++],S[q++]).getPoints(X),M=1;X>=M;M++)L.push(N[M]);return y},wg=function(V){for(var I,U,d=new wc,B=[],y=[],H=[],L=0,g=V.length;g>L;L++)I=V[L],U=V[L+1],U?d.subVectors(U,I):d.subVectors(I,V[L-1]),B.push(d.normalize().clone());var E,T,k,x,f=new wc,z=new wc,N=new gk,G=1e-4,t=Number.MAX_VALUE,A=B[0],R=y[0]=new wc,p=H[0]=new wc;for(T=q(A.x),k=q(A.y),x=q(A.z),t>=T&&(t=T,f.set(1,0,0)),t>=k&&(t=k,f.set(0,1,0)),t>=x&&f.set(0,0,1),z.crossVectors(A,f).normalize(),R.crossVectors(A,z),p.crossVectors(A,R),L=1;g>L;L++)y[L]=y[L-1].clone(),H[L]=H[L-1].clone(),z.crossVectors(B[L-1],B[L]),z.length()>G&&(z.normalize(),E=m(ee(B[L-1].dot(B[L]),-1,1)),y[L].applyMatrix4(N.makeRotationAxis(z,E))),H[L].crossVectors(B[L],y[L]);return{B:H,T:B,N:y}},Xh=function(){var k=function(J){for(var z=1;z<arguments.length;z++){var l=arguments[z];J.push(l.x,l.y,l.z)}},j=function(H){for(var d=1;d<arguments.length;d++){var L=arguments[d].uv;H.push(L[0],L[1])}},x=function(F,y,m,_,b){var v=-_*$(b),Q=_*g(b);return new wc(F.x+v*m.x+Q*y.x,F.y+v*m.y+Q*y.y,F.z+v*m.z+Q*y.z)},M=function(z,q,l,v,h,V,N,P){N=N||C;for(var F=[],o=N/h,L=0;h>=L;L++){var S=x(z,q,l,v,L*o+V);F.push(S),P!=Q&&(S.uv=[P,L/h])}return F},v=function(d,y,N,a,Z,s,V,F,c){c=c||C;var L=y?d.top_vs:d.bottom_vs;if(L)for(var M=y?d.top_uv:d.bottom_uv,B=c/V,O=0;V>O;O++){var p,f;y?(p=O*B+F,f=(O+1)*B+F):(f=O*B+F,p=(O+1)*B+F),k(L,x(N,a,Z,s,p),x(N,a,Z,s,f),N),M&&M.push(.5-.5*$(p),.5-.5*g(p),.5-.5*$(f),.5-.5*g(f),.5,.5)}};return function(T,B,A,H,a,w,$,m,_){var O=B.length;if(O>1){var P,l,K,Y,f,F,r,I=wg(B),U=I.T,p=I.N,y=I.B;"flat"===m&&v(T,!0,B[0],y[0],p[0],H,a,w,$),"flat"===_&&v(T,!1,B[O-1],y[O-1],p[O-1],H,a,w,$);var S,c,q=[],Z=G(a/2),N="round"===m,u="round"===_,x=B[0],e=U[0],J=y[0],g=p[0],D=B[O-1],d=U[O-1],z=y[O-1],n=p[O-1];if(N){for(K=1;Z>=K;K++)p.splice(0,0,g),y.splice(0,0,J),U.splice(0,0,e),c=-K/Z*H,B.splice(0,0,e.clone().multiplyScalar(c).add(x)),q[Z-K]=V(H*H-c*c);O+=Z}if(u){for(K=1;Z>=K;K++)p.push(n),y.push(z),U.push(d),c=K/Z*H,B.push(d.clone().multiplyScalar(c).add(D)),q[B.length-1]=V(H*H-c*c);O+=Z}if(T.uv){var b=0,t=0,s=[];for(A&&(b=A),f=B[0],s[0]=0,K=1;O>K;K++)Y=B[K],s[K]=f.distanceTo(Y),f=Y,A||(b+=s[K]);for(S=[],K=0;O>K;K++)t+=s[K],S[K]=b?t/b:0}for(K=0;O>K;K++){if(Y=B[K],F=y[K],r=p[K],P=M(Y,F,r,q[K]===i?H:q[K],a,w,$,S?S[K]:Q),l)for(var C=0;a>C;C++){var o=l[C],X=l[C+1]||l[0],h=P[C],L=P[C+1]||P[0];k(T.vs,X,o,h,h,L,X),T.uv&&j(T.uv,X,o,h,h,L,X)}l=P}}}}();Bm(p,{getLineLength:function(T){return T[T.length-1].length},getLineOffset:function(i,G){return Fg(i,G)},getLineCacheInfo:function(O,x,E,d){return xl(Nj(O,x,E,d))}});var qf=R.Light=function(){ym(qf,this),this.s(ji,e[ji]),this.s(Ki,"sphere"),this.s3(20,20,20)};Ak("Light",hf,{_image:"light_icon",_icon:"light_icon",onStyleChanged:function(X,G,b){qf.superClass.onStyleChanged.apply(this,arguments),X===ji&&this.s("shape3d.color",b)}});var aj=pk.Graph3dView=function(_,l){var E=this;E._attributes=l||p.graph3dViewAttributes,E._25I={},E._view=Ro(1,E);var t=E._canvas=yk(E._view);t.addEventListener("webglcontextlost",function(d){d.preventDefault(),Sh(E),E._26I&&E._doBufferGC(E._26I,!0),E._26I=Q,E._1o.texture=Q,E._35O=!0},!1),t.addEventListener("webglcontextrestored",function(){E._35O=!1,E.iv()},!1),E._batchIndexMap={},E._batchModelMap={},E._wireframeIndexMap={},E._wireframeModelMap={},E._wireframeIndexMapSwap={},E._wireframeModelMapSwap={},E._polylineIndexMap={},E._polylineIndexMap={},E._polylineIndexMapSwap={},E._polylineIndexMapSwap={},E._8O=[],E._7O=jl(),E._6O=jl(),E._1o=new lo(E),E._30O=new Rp(E),E._31O=new Qd(E),E._32O=new dn(E),E._raycaster=new nh(E),E.vr=new Tb(E),E._33Q=!0,E._eye=Hp(p.graph3dViewEye),E._center=Hp(p.graph3dViewCenter),E._up=Hp(p.graph3dViewUp),E._lightChanged=!1,E._59O=[],E._spots=[],E._dirs=[],E._frameId=0,E.overlappingBox=new li(E),E.dm(_?_:new Se),E.setInteractors([new Mg(E)])},oq={fogDisabled:1,dashDisabled:1,batchColorDisabled:1,batchBlendDisabled:1,batchBrightnessDisabled:1},Mf=0;Mq("Graph3dView",_,{ms_v:1,ms_tip:1,ms_gv:1,ms_dm:1,ms_lp:1,ms_fire:1,ms_sm:1,_51o:1,ms_ac:["devicePixelRatio","boundaries","moveStep","rotateStep","editHelperDisabled","sizeEditableFunc","rotationEditableFunc","editableFunc","rotatable","zoomable","pannable","walkable","resettable","mouseRoamable",Bn,$m,"firstPersonMode",wl,"movableFunc","gridVisible","gridSize","gridGap","gridColor","originAxisVisible","centerAxisVisible","axisXColor","axisYColor","axisZColor","editSizeColor","rectSelectable","rectSelectBackground","headlightRange","headlightColor","headlightIntensity","headlightDisabled","ortho","orthoWidth","fovy","near","far",ud,Jn,"up","aspect","fogDisabled","fogColor","fogNear","fogFar","dashDisabled","batchColorDisabled","batchBlendDisabled","batchBrightnessDisabled"],_editable:!1,_editHelperDisabled:p.graph3dViewEditHelperDisabled,_devicePixelRatio:i,_boundaries:i,_moveStep:p.graph3dViewMoveStep,_rotateStep:p.graph3dViewRotateStep,_pannable:p.graph3dViewPannable,_rotatable:p.graph3dViewRotatable,_walkable:p.graph3dViewWalkable,_resettable:p.graph3dViewResettable,_zoomable:p.graph3dViewZoomable,_firstPersonMode:p.graph3dViewFirstPersonMode,_mouseRoamable:p.graph3dViewMouseRoamable,_gridVisible:p.graph3dViewGridVisible,_gridSize:p.graph3dViewGridSize,_gridGap:p.graph3dViewGridGap,_gridColor:p.graph3dViewGridColor,_originAxisVisible:p.graph3dViewOriginAxisVisible,_centerAxisVisible:p.graph3dViewCenterAxisVisible,_axisXColor:p.graph3dViewAxisXColor,_axisYColor:p.graph3dViewAxisYColor,_axisZColor:p.graph3dViewAxisZColor,_ortho:p.graph3dViewOrtho,_orthoWidth:p.graph3dViewOrthoWidth,_fovy:p.graph3dViewFovy,_near:p.graph3dViewNear,_far:p.graph3dViewFar,_headlightColor:p.graph3dViewHeadlightColor,_headlightIntensity:p.graph3dViewHeadlightIntensity,_headlightRange:p.graph3dViewHeadlightRange,_headlightDisabled:p.graph3dViewHeadlightDisabled,_rectSelectable:p.graph3dViewRectSelectable,_rectSelectBackground:p.graph3dViewRectSelectBackground,_editSizeColor:p.graph3dViewEditSizeColor,_autoMakeVisible:Jg,_fogDisabled:p.graph3dViewFogDisabled,_fogColor:p.graph3dViewFogColor,_fogNear:p.graph3dViewFogNear,_fogFar:p.graph3dViewFogFar,_dashDisabled:p.graph3dViewDashDisabled,_batchColorDisabled:p.graph3dViewBatchColorDisabled,_batchBlendDisabled:p.graph3dViewBatchBlendDisabled,_batchBrightnessDisabled:p.graph3dViewBatchBrightnessDisabled,setEye:function(Y,W,y){1===arguments.length&&(W=Y[1],y=Y[2],Y=Y[0]);var o=this._eye;o[0]=Y,o[1]=W,o[2]=y,this.fp(ud,Q,o)},setCenter:function(j,f,I){1===arguments.length&&(f=j[1],I=j[2],j=j[0]);var F=this._center;F[0]=j,F[1]=f,F[2]=I,this.fp(Jn,Q,F)},setUp:function(r,D,$){1===arguments.length&&(D=r[1],$=r[2],r=r[0]);var h=this._up;h[0]=r,h[1]=D,h[2]=$,this.fp("up",Q,h)},isTransparentMask:function(P){return P.s("transparent.mask")},getAspect:function(){var C=this,B=C._aspect;return B?B:C.getWidth()/C.getHeight()},getCanvas:function(){return this._canvas},setDataModel:function(z){var V=this,l=V._dataModel,K=V._selectionModel;l!==z&&(l&&(l.ump(V.handleDataModelPropertyChange,V),l.umm(V.handleDataModelChange,V),l.umd(V.handleDataPropertyChange,V),K||l.sm().ums(V.handleSelectionChange,V)),V._dataModel=z,z.mp(V.handleDataModelPropertyChange,V),z.mm(V.handleDataModelChange,V),z.md(V.handleDataPropertyChange,V),K?K._21I(z):z.sm().ms(V.handleSelectionChange,V),V.invalidateAll(!0),V.invalidateLight(),V.fp(ag,l,z),V._canvas.style.background=z.getBackground()||"")},handleDataModelPropertyChange:function(O){if("background"===O.property){var o=this._canvas.style.background,L=O.newValue||"";this._canvas.style.background=L,this.fp("canvasBackground",o,L)}},handleDataPropertyChange:function(V){var L=V.data;this.invalidateData(L),$o(L)&&"s:light.type"===V.property&&this.invalidateLight()},invalidateLight:function(){this._lightChanged||(this._lightChanged=!0,this.iv())},onPropertyChanged:function(e){var W=this,c=e.property;W.iv(),W._18Q=Q,"eye"===c?W._33Q=!0:"devicePixelRatio"===c?W._42(Q,W._devicePixelRatio||Cc):oq[c]&&Sh(W)},_5O:function(v){var M=v._22Q();return M?new M(this,v):Q},getData3dUI:function(o){var M=this._25I[o._id];return M===i&&(M=this._5O(o),this._25I[o._id]=M),M},invalidateAll:function(_){var J=this;if(_){for(var f in J._25I){var g=J._25I[f];g&&g.dispose()}J._25I={},J.iv(),bj(J)}else J.dm().each(function(g){J.invalidateData(g)})},invalidateSelection:function(){var v=this;v.sm().each(function($){v.invalidateData($)})},invalidateData:function(i){var G=this,_=G.getData3dUI(i);_&&(_.iv(),G.iv()),bj(G,i)},getShape3dText:function(L){return L.getStyle("shape3d.text")||this.getLabel(L)},invalidateBatch:function(b){var h=this,E=h._batchModelMap,m=E[b],S=[],Q={};if(m){m.ds.forEach(function(Q){var N=h.getData3dUI(Q);N&&N.iv(),delete h._batchIndexMap[Q._id],S.push(Q._id)}),delete E[b];for(var C,k,g,T,D,R,p,y,n,B=["_wireframeModelMap","_polylineModelMap","_wireframeModelMapSwap","_polylineModelMapSwap"],u=["_wireframeIndexMap","_polylineIndexMap","_wireframeIndexMapSwap","_polylineIndexMapSwap"],J=0;J<B.length;J++){var c=h[B[J]],X=h[u[J]];for(Q={},y=0;y<S.length;y++){var t=X[S[y]];if(t){delete X[S[y]],n=t.batch,C=c[n];
var l=t.begin,v=t.size,j=3*l,M=3*v,q=4*l,A=4*v;for(k=C.ds,g=C.vs,T=C.cs,D=C.ps,R=C.ls,p=t.index,C.invalidate=!0,k[p]=i,p=j;j+M>p;p++)g[p]=i;for(p=q;q+A>p;p++)T[p]=i;for(p=q;q+A>p;p++)D[p]=i;if(R)for(p=j;j+M>p;p++)R[p]=i;Q[n]=!0}}for(n in Q){C=c[n],k=C.ds,g=C.vs,T=C.cs,D=C.ps,R=C.ls;var P=[];for(p=0;p<k.length;p++)k[p]!==i&&P.push(k[p]);if(0===P.length)delete c[n];else{for(C.ds=P,P=[],p=0;p<g.length;p++)g[p]!==i&&P.push(g[p]);for(C.vs=P,P=[],p=0;p<T.length;p++)T[p]!==i&&P.push(T[p]);for(C.cs=P,P=[],p=0;p<D.length;p++)D[p]!==i&&P.push(D[p]);if(C.ps=P,R){for(P=[],p=0;p<R.length;p++)R[p]!==i&&P.push(R[p]);C.ls=P}}}}h.iv()}},handleDataModelChange:function(Z){var o=this,v=Z.kind,d=Z.data;if("add"===v)o.invalidateData(d),Wr(d)&&d.getEdgeGroup()&&d.getEdgeGroup().eachSiblingEdge(o.invalidateData,o),$o(d)&&o.invalidateLight();else if(v===Qn){var I=d._id,x=o._25I[I];x&&(x.dispose(),delete o._25I[I],o.iv()),d===o._currentSubGraph&&o.setCurrentSubGraph(Q),bj(o,d),$o(d)&&o.invalidateLight()}else v===Kg&&(o.invalidateAll(!0),o.setCurrentSubGraph(Q),bj(o),o.invalidateLight())},toCanvas:function(w){var J=this,E=J.getGL();if(J.validate(),w){var u=E.getParameter(E.COLOR_CLEAR_VALUE);iq(E,w)}J._42(Q,1);var W=J.getWidth(),H=J.getHeight(),Y=new Uint8Array(4*W*H),$=yk(),F=$.getContext("2d");E.readPixels(0,0,W,H,E.RGBA,E.UNSIGNED_BYTE,Y),vh($,W,H,1);for(var m=F.getImageData(0,0,W,H),I=m.data,G=0;G<I.length;G+=4){var V=G/4,C=K(V/W),L=V-C*W;V=4*((H-1-C)*W+L),I[V]=Y[G],I[V+1]=Y[G+1],I[V+2]=Y[G+2],I[V+3]=Y[G+3]}return F.putImageData(m,0,0),w&&iq(E,u),J._42(Q,J._devicePixelRatio||Cc),$},toDataURL:function(Z,T){var r=this,i=r.getGL();if(r.validate(),Z){var $=i.getParameter(i.COLOR_CLEAR_VALUE);iq(i,Z)}r._42(Q,1);var p=r._canvas.toDataURL(T||"image/png",1);return Z&&iq(i,$),r._42(Q,r._devicePixelRatio||Cc),p},getGL:function(){var M=this,D=M._26I,L=M._prg;if(!D)try{M._2O={},D=M._26I=M._canvas.getContext("webgl",M._attributes)||M._canvas.getContext("experimental-webgl",M._attributes),D._emptyTexture=Qh(D),D._emptyBlendTexture=Qh(D),D._bufPool=[],D._id=++Mf,M._buffer={vs:te(D),ns:te(D),is:te(D),uv:te(D),batchColor:te(D),batchBlend:te(D),batchBrightness:te(D),lineDistance:te(D)},M._1O=bp(D);var U=M._cube={vs:te(D),ns:te(D),is:te(D),uv:te(D)};On(D,U.vs,Hl),On(D,U.ns,zj),On(D,U.uv,jg),kq(D,U.is,dc)}catch(E){}if(D&&!L){if(L=M._prg=D.createProgram(),!L)return Q;var a=M._dirs.length,P=M._spots.length,g=M._59O.length,F=["uPMatrix","uMVMatrix","uNMatrix","uViewMatrix","aNormal","aUv","uOffsetScale","uDiffuse","uBlend","uBlendColor","uBrightness","uPartOpacity","uAlphaTest","uTransparent","uTexture","uBlendTexture","uSampler","uBlendSampler","uDiscardSelectable","uFix","uPick","uReverseFlip","uFixPickReverseColor","uBatchBrightness","aBatchBrightness","uBatchColor","aBatchColor","uBatchBlend","aBatchBlend","uDash","aLineDistance","uDashDistance","uDashGapDistance","uLight","uHeadlightRange","uHeadlightColor","uFogColor","uFogNear","uFogFar"];a&&F.push("uDirColor","uDirDirection"),P&&F.push("uSpotColor","uSpotRange","uSpotAngle","uSpotExponent","uSpotPosition","uSpotDirection"),g&&F.push("uPointColor","uPointRange","uPointPosition"),iq(D,[0,0,0,0]),D.clearDepth(1),D.enable(D.DEPTH_TEST),D.depthFunc(D.LEQUAL),D.enable(D.BLEND),D.blendFuncSeparate(D.SRC_ALPHA,D.ONE_MINUS_SRC_ALPHA,D.ONE,D.ONE_MINUS_SRC_ALPHA),We||(lq=wj(lq.substring(0,lq.indexOf("^#"))),bh=wj(bh),We=!0);var y=["#define MAX_DIR "+a,"#define MAX_SPOT "+P,"#define MAX_POINT "+g,M._fogDisabled?"":"#define FOG",M._dashDisabled?"":"#define DASH",M._batchColorDisabled?"":"#define BATCHCOLOR",M._batchBlendDisabled?"":"#define BATCHBLEND",M._batchBrightnessDisabled?"":"#define BATCHBRIGHTNESS",""].join("\n"),S=Rn(D,L,D.VERTEX_SHADER,lq.replace("PREFIX",y)),q=Rn(D,L,D.FRAGMENT_SHADER,bh.replace("PREFIX",y));b?F.push("aPosition"):(L.aPosition=0,D.bindAttribLocation(L,0,"aPosition")),D.linkProgram(L),F.forEach(function(i){L[i]=/^u/.test(i)?D.getUniformLocation(L,i):D.getAttribLocation(L,i)}),D.useProgram(L),D.deleteShader(S),D.deleteShader(q)}return D},getBrightness:function(i){var y=i.s("brightness"),J=this.isSelected(i)?i.s("select.brightness"):Q;return y==Q?J:J==Q?y:y*J},getWireframe:function(s){var q=s.s("wf.visible"),A=s.s("wf.width");return q===!0||A>0&&"selected"===q&&this.isSelected(s)?{color:s.s("wf.color"),width:A,"short":s.s("wf.short"),mat:s.s("wf.mat")}:void 0},_transformPointToViewSpace:function(A){var x=[A[0],A[1],A[2]];return Vi(x,this._viewMatrix),x},_transformDirectionToViewSpace:function(u,l){var J=[u[0],u[1],u[2]];Vi(J,this._viewMatrix);var W=l?[l[0],l[1],l[2]]:[0,0,0];Vi(W,this._viewMatrix);var P=W[0]-J[0],Q=W[1]-J[1],d=W[2]-J[2],x=Math.sqrt(P*P+Q*Q+d*d);return x?[P/x,Q/x,d/x]:[P,Q,d]},getWireframeGeometry:function(p){return p.s("wf.geometry")?{color:p.s("wf.color"),width:p.s("wf.width"),mat:p.s("wf.mat"),geometry:!0}:void 0},getBodyColor:function(k){return k.s("body.color")},getMat:function(i){return i.getMat?i.getMat():i.s("mat")},getFaceMat:function(w,K){return w.getFaceMat?w.getFaceMat(K):w.s(K+".mat")},getFaceBlend:function(h,K){return h.s(K+".blend")||h.s("all.blend")},getFaceColor:function(x,J){return x.s(J+".color")||x.s("all.color")},getFaceImage:function(I,h){return I.s(h+".image")||I.s("all.image")},getFaceBlendImage:function(X,c){return X.s(c+".blend.image")||X.s("all.blend.image")},getFaceDiscardSelectable:function(n,B){var W=n.s(B+".discard.selectable");return W==Q?n.s("all.discard.selectable"):W},getFaceUv:function(u,d){return u.s(d+".uv")||u.s("all.uv")},getFaceUvOffset:function(g,h){return g.s(h+".uv.offset")||g.s("all.uv.offset")},getFaceUvScale:function(A,Q){return A.s(Q+".uv.scale")||A.s("all.uv.scale")},getFaceLight:function(h,Y){var E=h.s(Y+".light");return E==Q?h.s("all.light"):E},getFaceVisible:function(C,P){var F=C.s(P+".visible");return F==Q?C.s("all.visible"):F},getFaceOpacity:function(L,p){var m=L.s(p+".opacity");return m==Q?L.s("all.opacity"):m},getFaceTransparent:function(f,R){var P=f.s(R+".transparent");return P==Q?f.s("all.transparent"):P},getFaceReverseColor:function(U,P){return U.s(P+".reverse.color")||U.s("all.reverse.color")},getFaceReverseFlip:function(n,z){var y=n.s(z+".reverse.flip");return y==Q?n.s("all.reverse.flip"):y},getFaceReverseCull:function(Z,z){var B=Z.s(z+".reverse.cull");return B==Q?Z.s("all.reverse.cull"):B},getTextureMap:function(){return this._2O},deleteTexture:function(N){var r=this,y=r._2O[N];y&&(delete r._2O[N],r.getGL().deleteTexture(y))},invalidateShape3dCachedImage:function(Y){var k=this.getData3dUI(Y);k.invalidateCachedTexture(this.getGL())},getTexture:function(Y,O){if(!Y)return Q;var W=this,x=W.getGL(),M=W._2O[Y];if(!M){var l=Lq(Y);if(l)if(l.tagName){if(l.dynamic)return bp(x,l,W._1O);M=W._2O[Y]=bp(x,l)}else{var o,i=O&&O.s("shape3d.image.cache");if(i&&(o=W.getData3dUI(O),M=o.getCachedTexture()),!M){var P=O&&O.s("shape3d.fixSizeOnScreen"),D=P?x.NEAREST:x.LINEAR;P||O&&O.s("shape3d.vector.dynamic")&&(o||(o=W.getData3dUI(O)),P=o.getVectorDynamicSize());var z=O&&O.s("shape3d.texture.scale")||1,J=P&&P[0]>0?P[0]:z*ki(l,O),L=P&&P[1]>0?P[1]:z*Xe(l,O);if(J>=1&&L>=1){J*=devicePixelRatio,L*=devicePixelRatio;var U=tp(J,L);Df(U,l,0,0,J,L,O,W),U.restore(),i&&Vh(l,O)?(M=bp(x,lk,null,D),o.setCachedTexture(M),lk=null):M=bp(x,lk,W._1O,D)}}}}return M},redraw:function(){this.iv()},validateImpl:function(){var x=this;if(x._lightChanged){x._lightChanged=!1;var y=[],T=[],R=[];x.dm().each(function(w){if($o(w)){var D=w.s("light.type");D===zi?y.push(w):D===ll?T.push(w):D===us&&R.push(w)}}),(y.length!==x._59O.length||T.length!==x._spots.length||R.length!==x._dirs.length)&&Sh(x),x._59O=y,x._spots=T,x._dirs=R}x._42(),x._1o.iv()},getRenderInfo:function(){var J=this.getGL();return J?J._renderInfo:void 0},showDebugTip:function(){var U=this,d=U._debugDiv;if(!d){d=U._debugDiv=J.createElement("div"),d.style.position="absolute",d.style.overflow="hidden",d.style.backgroundColor="white",d.style.color="black";var l=U.getView();U._79O?l.insertBefore(d,U._79O):l.appendChild(d),U._debugTipTimerId=setInterval(function(){var M=U.getRenderInfo();if(M){var I=U.getGL()._bufPool,z=I.length-(I._ivCount||0),S="Draw Calls: "+M.calls+"<br/>"+"Vertices: "+M.vertices+"<br/>"+"Faces: "+M.faces+"<br/>"+"Lines: "+M.lines+"<br/>"+"Buffer Count: "+z;d.innerHTML=S}},10)}},hideDebugTip:function(){var L=this,l=L._debugDiv;l&&(delete L._debugDiv,cancelAnimationFrame(L._debugTipTimerId),delete L._debugTipTimerId,L.getView().removeChild(l))},_42:function(Y,M){var c=this;if(!c._35O&&(!lr||Lo(lr))){var V,B;Y&&(Y instanceof hf?B=Y:V=Y);var v=c._canvas,N=c.getWidth(),r=c.getHeight(),C=c.getGL(),R=c._prg;if(C){M?Y||vh(v,N,r,M):(M=c._devicePixelRatio||Cc,Y||N===v.clientWidth&&r===v.clientHeight||vh(v,N,r,M)),C.clear(C.COLOR_BUFFER_BIT);var m=function(){if(C._renderInfo={calls:0,vertices:0,faces:0,lines:0,frame:++c._frameId},c.overlappingBox.clear(),c._81O=Q,C.clear(C.DEPTH_BUFFER_BIT),gl(C,R.uBrightness,1),gl(C,R.uOpacity,1),gl(C,R.uPartOpacity,1),C._picking=!!Y,gl(C,R.uPick,!!Y),gl(C,R.uTexture,!1),gl(C,R.uBlendTexture,!1),gl(C,R.uAlphaTest,e.alphaTest),gl(C,R.uTransparent,!1),gl(C,R.uFix,!1),gl(C,R.uBatchColor,!1),gl(C,R.uBatchBlend,!1),gl(C,R.uBatchBrightness,!1),gl(C,R.uPMatrix,c._projectMatrix=Ud(c)),gl(C,R.uViewMatrix,ld(c,c._7O)),c._viewMatrix=nr(c._7O),Y||(Bq(c,C,R),c._fogDisabled||(gl(C,R.uFogColor,c._fogColor),gl(C,R.uFogNear,c._fogNear),gl(C,R.uFogFar,c._fogFar))),ys(C,R.aPosition),ys(C,R.aNormal),Mo(C,R.aUv),Mo(C,R.aBatchColor),Mo(C,R.aBatchBlend),Mo(C,R.aBatchBrightness),Mo(C,R.aLineDistance),B){var S=C.getParameter(C.COLOR_CLEAR_VALUE);C.clearColor(0,0,0,0),C.disable(C.BLEND),Mo(C,R.aNormal),On(C,c._cube.vs,Q,R.aPosition),kq(C,c._cube.is),zh(B,c,Um,0),zh(B,c,mj,6),zh(B,c,Xl,12),zh(B,c,nd,18),zh(B,c,fk,24),zh(B,c,rp,30),ys(C,R.aNormal),iq(C,S)}else if(V){V.value=2;var S=C.getParameter(C.COLOR_CLEAR_VALUE);C.clearColor(0,0,0,0),C.disable(C.BLEND),c._95I(C,R,V),fg(c,V),ec(c,c._polylineModelMap,V),ec(c,c._wireframeModelMap,V),gl(C,R.uTransparent,!0),c._95I(C,R,V,!0),fg(c,V,!0),ec(c,c._polylineModelMap,V,!0),ec(c,c._wireframeModelMap,V,!0),gl(C,R.uTransparent,!1),C.clear(C.DEPTH_BUFFER_BIT),c._swapLineMap(),c._95I(C,R,V,!1,!0),ec(c,c._polylineModelMap,V),ec(c,c._wireframeModelMap,V),c._swapLineMap(),C.disable(C.DEPTH_TEST),c._30O._42(C,R,V),C.enable(C.DEPTH_TEST),iq(C,S)}else C.disable(C.BLEND),c.drawSky(C,R),c._31O._42(C,R),c._95I(C,R),fg(c),ec(c,c._polylineModelMap),ec(c,c._wireframeModelMap),C.enable(C.BLEND),gl(C,R.uTransparent,!0),C.depthMask(!1),c._95I(C,R,Q,!0),fg(c,Q,!0),ec(c,c._polylineModelMap,Q,!0),ec(c,c._wireframeModelMap,Q,!0),C.depthMask(!0),gl(C,R.uTransparent,!1),C.clear(C.DEPTH_BUFFER_BIT),c._swapLineMap(),c._95I(C,R,Q,!1,!0),ec(c,c._polylineModelMap),ec(c,c._wireframeModelMap),c._swapLineMap(),C.disable(C.DEPTH_TEST),C.disable(C.BLEND),c._32O._42(C,R),c._30O._42(C,R),C.enable(C.DEPTH_TEST);On(C,Q),kq(C,Q)},L=!1,$=N*M,t=r*M,p=c.vr;p.enable&&p._42(C,$,t,m)&&(L=!0);var E=c.envRenderer;E&&E.enable&&E._42(C,$,t,m)&&(L=!0),L||(C.viewport(0,0,N*M,r*M),m()),c._33Q=!1,c._doBufferGC(C)}}},setBufferGCInterval:function(B){this._bufferGCInterval=B},_doBufferGC:function(U,f){var M=U._bufPool,D=M.length;if(D){var j,C,F=U._renderInfo.frame,b=this._bufferGCInterval||10,i=0;for(j=0;D>j;j++)C=M[j],C?(f||F-C._fid>b)&&(i++,U.deleteBuffer(C._buf),C._buf=null,M[j]=null):i++;if(i>D/2&&i>128){var c=[];for(j=0;D>j;j++)M[j]&&c.push(M[j]);U._bufPool=c}else M._ivCount=i}},_swapLineMap:function(){var N=this;T=N._polylineModelMap,N._polylineModelMap=N._polylineModelMapSwap,N._polylineModelMapSwap=T,T=N._wireframeModelMap,N._wireframeModelMap=N._wireframeModelMapSwap,N._wireframeModelMapSwap=T,T=N._polylineIndexMap,N._polylineIndexMap=N._polylineIndexMapSwap,N._polylineIndexMapSwap=T,T=N._wireframeIndexMap,N._wireframeIndexMap=N._wireframeIndexMapSwap,N._wireframeIndexMapSwap=T},_updateSkyBoxPosition:function(S){if(this._skyBox&&S&&"eye"===S.property){var v=S.newValue;this._skyBox.p3(v[0],v[1],v[2]),this.invalidateData(this._skyBox)}},setSkyBox:function(n){this._skyBox=n,this.ump(this._updateSkyBoxPosition,this),this.invalidateAll(),n&&(this.mp(this._updateSkyBoxPosition,this),this._updateSkyBoxPosition())},drawSky:function(k,c,f){var v=this,R=v._skyBox;if(R){var y=v._headlightIntensity,Z=bl(v._headlightColor),c=v._prg;1!==y&&(Z=[Z[0]*y,Z[1]*y,Z[2]*y]),gl(k,c.uHeadlightColor,[Z[0],Z[1],Z[2],1]);var U=v.getData3dUI(R);U&&U._42(k,c,f,function(){return!0}),k.clear(k.DEPTH_BUFFER_BIT),gl(k,c.uHeadlightColor,[Z[0],Z[1],Z[2],v._headlightDisabled?1:0])}},_95I:function(J,u,k,X,N){function L(e){if(!!e.s("shape3d.alwaysOnTop")==!!N&&Y.isVisible(e)&&(!a||Z)){if(!k&&Y.isTransparentMask(e))return;var O=Y.getData3dUI(e);O&&O._42(J,u,k,i)}}var Y=this,i=function(Z){return X?Z:!Z};Y.sky&&J.clear(J.DEPTH_BUFFER_BIT),Y.dm().each(L)},getLogicalPoint:function(i){return xs(i,this._canvas)},isRectOverlapping:function(k){var y=this.getData3dUI(k);return y._rectOverlapping},getHitFaceInfo:function(V){V.target&&(V=this.lp(V));var $=this.getDataInfoAt(V);if($){var J=this._1o.face($.data,Vb(V.x,V.y));if(J)return{data:$.data,face:J}}return Q},unproject:function(_,p){var K=this,z=K.getWidth(),o=K.getHeight(),V=_.target?K.lp(_):_,S=V.x-z/2,D=V.y-o/2,k=2*(S/z),u=2*(-1*D/o);p=p||0;var R=jl(),n=Ud(K),f=ld(K);rh(R,n,f),rk(R);var I=Xp([k,u,p,1],R);return[I[0]/I[3],I[1]/I[3],I[2]/I[3]]},getDataAt:function(a){var x=this.getDataInfoAt(a);return x?x.data:Q},getDataInfoAt:function(s,X){return s.target&&(s=this.lp(s)),this._1o.get(Vb(s.x,s.y,X),!0)},getDatasInRect:function(W){return this._1o.get(W)},setEditable:function(T){var L=this,y=L._editable;L._editable=T,this.fp(ar,y,T)},isEditable:function(f){var V=this;return V._editable?ph(f)?f.s("3d.editable")?V._editableFunc?V._editableFunc(f):!0:!1:!1:!1},isSelectable:function($){return $.s("3d.selectable")&&this.sm().isSelectable($)},isMovable:function(W){var f=this;return Wr(W)&&W.getStyle(kr)!==Ir?!1:W.s("3d.movable")?f._movableFunc?f._movableFunc(W):!0:!1},isSizeEditable:function(n){return ph(n)?this._sizeEditableFunc?this._sizeEditableFunc(n):!0:!1},isRotationEditable:function(n){return ph(n)&&n.IRotatable!==!1?this._rotationEditableFunc?this._rotationEditableFunc(n):!0:!1},handleDelete:function(){this._editable&&this.removeSelection()},zoomIn:function(f){this.setZoom(Jl,f)},zoomOut:function(t){this.setZoom(1/Jl,t)},setZoom:function(U,P){if(1!==U){var d=this;if(d._ortho)return d.setOrthoZoom(U,P),void 0;d._14o&&d._14o.stop(!0);var B=1/U,A=d._eye,j=d._center,h=j[0]+(A[0]-j[0])*B-A[0],r=j[1]+(A[1]-j[1])*B-A[1],L=j[2]+(A[2]-j[2])*B-A[2];if(!(Vc(A,j)<d._moveStep&&1>B)){if(P=fl(P)){var o=Hp(A);return P.action=function(m){d.fi({kind:d._zooming?"betweenZoom":"beginZoom"}),d._zooming=1,A[0]=o[0]+h*m,A[1]=o[1]+r*m,A[2]=o[2]+L*m,d.fp(ud,Q,A)},P._37o=function(){delete d._14o,delete d._zooming,d.fi({kind:"endZoom"}),d.onZoomEnded()},d._14o=Gk(P)}A[0]+=h,A[1]+=r,A[2]+=L,d.fp(ud,Q,A)}}},setOrthoZoom:function(f,r){if(1!==f){var t=this;t._14o&&t._14o.stop(!0);var J=t._orthoWidth,q=J/f-J;if(!(J<t._moveStep&&f>1))return(r=fl(r))?(r.action=function(U){t.fi({kind:t._zooming?"betweenZoom":"beginZoom"}),t._zooming=1,t.setOrthoWidth(J+q*U)},r._37o=function(){delete t._14o,delete t._zooming,t.fi({kind:"endZoom"}),t.onZoomEnded()},t._14o=Gk(r)):(t.setOrthoWidth(J/f),void 0)}},getPositionInfo:function(w){var E=this,j=E._eye,M=E._center,Z=E.getAspect(),Y=w?Uq(Em(M,j,!0),Em(w,j)):Vc(j,M);if(E._ortho){var x=E._orthoWidth;return{length:Y,height:x/Z,width:x}}var S=2*O(E._fovy/2)*Y;return{length:Y,height:S,width:S*Z}},getCenterInfo:function(){var w=this;return w._81O||(w._81O=w.getPositionInfo()),Hp(w._81O)},rotate:function(W,F,_,L){var p=this;if(W||F){L==Q&&(L=p._firstPersonMode),p._88O&&p._88O.stop(!0);var u=p._center,R=p._eye,P=p.getCenterInfo().length,l=L?u:R,C=L?R:u,r=Em(l,C),d=N(r[0],r[2]),q=N(V(r[0]*r[0]+r[2]*r[2]),r[1]),I=L?Jn:ud;return L&&(F=-F),(_=fl(_))?(_.action=function(H){p.fi({kind:p._rotating?"betweenRotate":"beginRotate"}),p._rotating=1;var O=d+W*H,s=q+F*H;s=Vn(s),r[0]=P*g(s)*g(O),r[1]=P*$(s),r[2]=P*g(s)*$(O),l[0]=C[0]+r[0],l[1]=C[1]+r[1],l[2]=C[2]+r[2],p.fp(I,Q,l)},_._37o=function(){delete p._88O,delete p._rotating,p.fi({kind:"endRotate"}),p.onRotateEnded()},p._88O=Gk(_)):(d+=W,q+=F,q=Vn(q),r[0]=P*g(q)*g(d),r[1]=P*$(q),r[2]=P*g(q)*$(d),l[0]=C[0]+r[0],l[1]=C[1]+r[1],l[2]=C[2]+r[2],p.fp(I,Q,l),void 0)}},pan:function(B,F,P,o){if(B||F){var G=this;o==Q&&(o=G._firstPersonMode),G._89O&&G._89O.stop(!0);var J=ld(G),i=[J[0]*B,J[4]*B,J[8]*B],C=[J[1]*F,J[5]*F,J[9]*F],O=i[0]+C[0],p=i[1]+C[1],f=i[2]+C[2],R=G._center,Y=G._eye;if(o){var s=Qr(G.getBoundaries(),Y[0],Y[2],Y[0]+O,Y[2]+f,V(O*O+f*f));O=s[0],f=s[1]}if(P=fl(P)){var e=Hp(Y),$=Hp(R);return P.action=function(S){G.fi({kind:G._panning?"betweenPan":"beginPan"}),G._panning=1,R[0]=$[0]+O*S,R[1]=$[1]+p*S,R[2]=$[2]+f*S,Y[0]=e[0]+O*S,Y[1]=e[1]+p*S,Y[2]=e[2]+f*S,G.fp(ud,Q,Y),G.fp(Jn,Q,R)},P._37o=function(){delete G._89O,delete G._panning,G.fi({kind:"endPan"}),G.onPanEnded()},G._89O=Gk(P)}R[0]+=O,R[1]+=p,R[2]+=f,Y[0]+=O,Y[1]+=p,Y[2]+=f,G.fp(ud,Q,Y),G.fp(Jn,Q,R)}},walk:function(R,d,V){if(R){var e=this;V==Q&&(V=e._firstPersonMode),e._90O&&e._90O.stop(!0);var M=e._center,X=e._eye,A=Em(M,X,!0);if(V){var h=Qr(e.getBoundaries(),X[0],X[2],X[0]+A[0]*R,X[2]+A[2]*R,q(R));if(R=Vc(h),!R)return;A=[h[0]/R,0,h[1]/R]}if(d=fl(d)){var $=Hp(X),f=Hp(M);return d.action=function(y){e.fi({kind:e._walking?"betweenWalk":"beginWalk"}),e._walking=1;var p=R*y;X[0]=$[0]+A[0]*p,X[1]=$[1]+A[1]*p,X[2]=$[2]+A[2]*p,M[0]=f[0]+A[0]*p,M[1]=f[1]+A[1]*p,M[2]=f[2]+A[2]*p,e.fp(ud,Q,X),e.fp(Jn,Q,M)},d._37o=function(){delete e._90O,delete e._walking,e.fi({kind:"endWalk"}),e.onWalkEnded()},e._90O=Gk(d)}X[0]+=A[0]*R,X[1]+=A[1]*R,X[2]+=A[2]*R,M[0]+=A[0]*R,M[1]+=A[1]*R,M[2]+=A[2]*R,e.fp(ud,Q,X),e.fp(Jn,Q,M)}},handleScroll:function(e,y){e.preventDefault();var d=this,J=d._moveStep;d.isFirstPersonMode()?d.isPannable()&&d.pan(0,y>0?J:-J):d.isZoomable()&&d.setZoom(0>y?1/Vj:Vj)},handlePinch:function(z,r){this.isZoomable()&&this.setZoom(r>z?1/$f:$f)},reset:function(){this.setCenter(p.graph3dViewCenter),this.setEye(p.graph3dViewEye),this.setUp(p.graph3dViewUp)},moveSelection:function(p,v,Y){var o=this;o.dm().beginTransaction(),ip(this.sm().toSelection(this.isMovable,this),p,v,Y),o.dm().endTransaction()},getMoveMode:function(P,V){var g=V.s("3d.move.mode");if(g)return g;var Y="88",$="89",s="90";return sb(P)||ds[Y]&&ds[$]&&ds[s]?"xyz":ds[Y]&&ds[$]?"xy":ds[Y]&&ds[s]?"xz":ds[$]&&ds[s]?"yz":ds[Y]?"x":ds[$]?"y":ds[s]?"z":"xz"},handleTick:function(){var A=this,k=!1,d=A._moveStep,V=d,W=!1,D=!0,F=A._rotateStep*(D?-1:1);if(A.isWalkable()||(V=0),A.isPannable()||(d=0),A.isRotatable()||(F=0),A._32Q){var n=(ql()-A._32Q)/50;V*=n,d*=n,F*=n}A._31Q&&(rj(A._31Q),delete A._31Q,delete A._32Q),Ih()&&(k=!0,A.pan(-d,0,W,D)),rs()&&(k=!0,A.pan(d,0,W,D)),Hn()&&(k=!0,sb()?A.pan(0,d,W,D):A.walk(V,W,D)),Nq()&&(k=!0,sb()?A.pan(0,-d,W,D):A.walk(-V,W,D)),Ao()&&(k=!0,A.rotate(-F,0,W,D)),ts()&&(k=!0,A.rotate(F,0,W,D)),Yf()&&(k=!0,A.rotate(0,-F/2,W,D)),en()&&(k=!0,A.rotate(0,F/2,W,D)),k&&(A._32Q=ql(),A._31Q=Sq(A.handleTick,A))},handleKeyDown:function(x){var t=this;!Ub(x)&&Gn[x.keyCode]?t.handleTick():Fp(x)?t.selectAll():Zm(x)?t.handleDelete(x):mo(x)&&this.isResettable()&&t.reset()},checkDoubleClickOnNote:function(m,t,M){var Z=this;if(M===Fr){if(t.s("note.toggleable"))return t.s($i,!t.s($i)),Z.fi({kind:"toggleNote",event:m,data:t,part:M}),!0}else if(M===eg&&t.s("note2.toggleable"))return t.s(dm,!t.s(dm)),Z.fi({kind:"toggleNote2",event:m,data:t,part:M}),!0;return!1},checkDoubleClickOnRotation:function(G,b,O){return O===yh?(b.setRotationX(0),!0):O===ss?(b.setRotationY(0),!0):O===_h?(b.setRotationZ(0),!0):!1},onRotateEnded:function(){},onWalkEnded:function(){},toViewPosition:function(d){var T=this,l=T.getWidth()/2,m=T.getHeight()/2,L=T._18Q;return L&&L._wh===l/m||(L=Ud(T),T._18Q=rh(L,L,ld(T)),T._18Q._wh!==l/m),d=Xp([d[0],d[1],d[2],1],L),{x:l+l*d[0]/d[3],y:m-m*d[1]/d[3]}},getHitPosition:function(y,G,X){var W=this,k=W.getWidth(),n=W.getHeight(),b=y.target?W.lp(y):y,U=b.x-k/2,r=b.y-n/2,x=W.getCenterInfo(),p=ld(W);G=G?G:[0,0,0],X=X?X:[0,1,0],U=U/k*x.width,r=-1*r/n*x.height;var s=[p[0]*U,p[4]*U,p[8]*U],h=[p[1]*r,p[5]*r,p[9]*r],L=[s[0]+h[0],s[1]+h[1],s[2]+h[2]],T=W.getCenter(),K=Zl(W,G,X,[L[0]+T[0],L[1]+T[1],L[2]+T[2]]);return K?K:[0,0,0]},intersectObject:function(X,b){return this._raycaster.intersectObject(X,b)},getLineLength:function(o){this.validate();var L=this.getData3dUI(o);if(L&&L.getCache){var I=L.getCache();if(I)return I[I.length-1].length}return 0},getLineOffset:function(u,e){var $=this.getData3dUI(u);if($&&$.getCache){var Y=$.getCache();if(Y)return Fg(Y,e)}return Q},isLabelVisible:function(){return!0},isNoteVisible:function(){return!0},flyTo:function(){function B(f,A,e){r.fromArray(pj(e,A.getMat(e)));var L=e.getAnchor3d();f.push((new hd).set(0-L.x,0-L.y,0-L.z).applyMatrix4(r)),f.push((new hd).set(0-L.x,0-L.y,1-L.z).applyMatrix4(r)),f.push((new hd).set(0-L.x,1-L.y,0-L.z).applyMatrix4(r)),f.push((new hd).set(0-L.x,1-L.y,1-L.z).applyMatrix4(r)),f.push((new hd).set(1-L.x,0-L.y,0-L.z).applyMatrix4(r)),f.push((new hd).set(1-L.x,0-L.y,1-L.z).applyMatrix4(r)),f.push((new hd).set(1-L.x,1-L.y,0-L.z).applyMatrix4(r)),f.push((new hd).set(1-L.x,1-L.y,1-L.z).applyMatrix4(r))}var l=new hd,p=new hd,n=new hd,X=new hd,r=new Oh;return function(f,c,C){var r=this;l.fromArray(r.getEye()),p.fromArray(r.getCenter());var h,O,y=[];if(f instanceof R.Node)n.fromArray(f.p3()),B(y,r,f),h=y.length;else{if(!f.length)return;for(y=[],f.forEach(function(I){B(y,r,I)}),n.set(0,0,0),h=y.length,O=0;h>O;O++)n.add(y[O]);n.multiplyScalar(1/h)}r.setCenter(n.x,n.y,n.z);var L,g=r.getNear();X.subVectors(l,n),C||(C=.8);for(var A,q,x,t,b=10;b--;){for(L=Ud(r),rh(L,L,ld(r)),x=!0,t=-1/0,O=0;h>O;O++){if(q=y[O],A=Xp([q.x,q.y,q.z,1],L),A[3]<g&&b){X.multiplyScalar(2),r._eye[0]=X.x,r._eye[1]=X.y,r._eye[2]=X.z,x=!1;break}t=Math.max(t,Math.max(Math.abs(A[0]),Math.abs(A[1]))/C-A[3])}if(x)break}if(X.setLength(t+X.length()).add(n),r._flyAnim&&r._flyAnim.stop(!0),c=fl(c)){r.setEye(l.x,l.y,l.z),r.setCenter(p.x,p.y,p.z);var s=(new hd).subVectors(X,l),m=(new hd).subVectors(n,p),P=new hd,_=new hd;return c.action=function(n){P.copy(l).addScaledVector(s,n),_.copy(p).addScaledVector(m,n),r.setCenter(_.x,_.y,_.z),r.setEye(P.x,P.y,P.z)},c._37o=function(){delete r._flyAnim},{lastEye:l,lastCenter:p,eye:X,center:n,animation:r._flyAnim=Gk(c)}}return r.setEye(X.x,X.y,X.z),{lastEye:l,lastCenter:p,eye:X,center:n}}}()}),pk.RenderEnv=function(k){this.gv=k,this.enable=!1},_.defineProperties(pk.RenderEnv.prototype,{debugOn:{get:function(){return this._debugOn},set:function(w){this._debugOn=w,this.capture&&this.capture()}}}),_.assign(pk.RenderEnv.prototype,{renderEnvToCube:function(o,d,b,t){var B=this,U=B.gv;if(!o||!d||!b)return B.enable=!1,B._42=null,void 0;B.enable=!0;var r=Math.floor(t/o*d),$=U.getGL(),k=B._renderTargets;k?k.length<b&&(k=B._renderTargets=k.concat(new Array(b-k.length))):k=B._renderTargets=new Array(b);for(var a=0;b>a;a++)k[a]?k[a].setSize($,t,r):k[a]=new pk.RenderTarget(U,$,t,r);var O=!1;B.capture=function(){O=!0,U._42(),O=!1};var D=new hd,h=new hd,W=new hd,f=new hd,m=(new hd).setY(0),g=2*Math.PI/b,e=o/2/Math.tan(Math.PI/b),N=2*Math.atan2(d/2,e),H=o/d;B._42=function(l,E,P,d){var v=B._debugOn;if(!O&&!v)return!1;D.copy(U.getEye()),f.copy(U.getCenter()).sub(D);var R=Math.atan2(f.z,f.x),y=U.getNear(),V=U.getFovy(),j=U.getAspect();h.copy(U.getCenter());for(var r,n=0;b>n;n++)if(r=k[n],m.setZ(Math.cos(R)).setX(Math.sin(R)).multiplyScalar(e),R-=g,W.addVectors(D,m),U.setNear(e),U.setCenter([W.x,W.y,W.z]),U.setFovy(N),U.setAspect(H),v){var u=Math.round(E/b);l.viewport(u*n,0,u,P),d()}else Ui(l,r.frame),l.viewport(0,0,r.width,r.height),l.clear(l.COLOR_BUFFER_BIT),d(),Ui(l,Q),r.assureTexture();return U.setNear(y),U.setCenter([h.x,h.y,h.z]),U.setFovy(V),U.setAspect(j),!0},B.capture()},getTextureInfo:function(x){var E=this._renderTargets;if(!E)return null;var w=this._renderTargets[x];return w?{index:x,texture:w.texture,textureName:w.uuid}:null}}),_.assign(pk.Graph3dView.prototype,{renderEnvToCube:function(I,z,C,G){var g=this;g.envRenderer||(g.envRenderer=new pk.RenderEnv(g)),g.envRenderer.renderEnvToCube(I,z,C,G)}}),pk.RenderTarget=function(p,I,X,Y){var d=this;d.uuid=R.Math.generateUUID(),d.gv=p,d.init(p,I),d.setSize(I,X,Y)},_.assign(pk.RenderTarget.prototype,{init:function(e,r){var l=this,W=l.texture=r.createTexture();r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,W),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.NEAREST),r.bindTexture(r.TEXTURE_2D,null),l.render=r.createRenderbuffer(),l.frame=r.createFramebuffer(),e._2O[l.uuid]=W},assureTexture:function(){var H=this,s=H.uuid,X=H.gv._2O;X[s]||(X[s]=H.texture)},setSize:function(g,n,M){var S=this;if(S.width!==n||S.height!==M){var K=g.RGBA,W=g.TEXTURE_2D,d=g.RENDERBUFFER,x=g.FRAMEBUFFER;Be(g,S.texture),g.texImage2D(W,0,K,n,M,0,K,g.UNSIGNED_BYTE,Q),Kf(g,g.TEXTURE_MIN_FILTER,g.LINEAR),g.bindRenderbuffer(d,S.render),g.renderbufferStorage(d,g.DEPTH_COMPONENT16,n,M),Ui(g,S.frame),g.framebufferTexture2D(x,g.COLOR_ATTACHMENT0,W,S.texture,0),g.framebufferRenderbuffer(x,g.DEPTH_ATTACHMENT,d,S.render),Be(g,Q),g.bindRenderbuffer(d,Q),Ui(g,Q),S.width=n,S.height=M}},toCanvas:function(){var s=this,g=s.gv.getGL();g.bindFramebuffer(g.FRAMEBUFFER,s.frame);var d=s.width,H=s.height,S=new Uint8Array(4*d*H);g.readPixels(0,0,d,H,g.RGBA,g.UNSIGNED_BYTE,S),g.bindFramebuffer(g.FRAMEBUFFER,null);var L=J.createElement("canvas");L.width=d,L.height=H;var F=L.getContext("2d"),R=F.createImageData(d,H);return R.data.set(S),F.putImageData(R,0,0),L}});var Ok=pk.Interactor=function(K){this.gv=K};Mq("Interactor",_,{ms_listener:1,getView:function(){return this.gv.getView()},setUp:function(){this.addListeners()},tearDown:function(){this.removeListeners()}});var Mg=pk.DefaultInteractor=function(h){ym(Mg,this,[h])};Mq("DefaultInteractor",Ok,{handle_contextmenu:function(o){Hm(o)},handle_mousewheel:function(E){this.gv.handleScroll(E,E.wheelDelta/40)},handle_DOMMouseScroll:function(g){2===g.axis&&this.gv.handleScroll(g,-g.detail)},handle_keydown:function(d){this.gv.handleKeyDown(d)},handle_mousedown:function(W){this.handle_touchstart(W)},handle_touchstart:function(H){Hm(H);var E=this,Y=E.gv,O=gf(H),P=Y.getDataInfoAt(H),B=P?P.data:Q,T=P?P.part:Q,U=Y.sm(),u=ur(H),b=vj(H);Y.setFocus(H)&&(E._62O=Q,E._57I=Q,B?Ub(H)?U.co(B)?U.rs(B):U.as(B):U.co(B)||U.ss(B):O&&(Ub(H)?Y.isRectSelectable()&&(E._62O=Cm):E._57I=ko(H)),E._31Q&&(rj(E._31Q),delete E._31Q,delete E._32Q),E._62O||(Y.isFirstPersonMode()&&(sb(H)||b>2?E._62O="pan":Y.isMouseRoamable()||sg?(E._62O="roaming",E.foward=u&&gf(H),E._32Q=ql(),E._31Q=Sq(E.tick,E)):O||(E._62O="roaming")),E._62O||(O&&u&&Gr[T]?(E._62O=T,E.p3=B.p3()):O&&u&&ph(B)&&Y.isSelected(B)&&Y.isMovable(B)?(E._62O="move",E.p3=B.p3(),E.movedata=B):sg&&(b>2?E._62O="pan":2===b&&(E.dist=Dp(H),E._62O="pinch")))),E.point=Y.lp(H),ep(E,H),pg(H)?Y.handleDoubleClick(H,B,T):Y.handleClick(H,B,T))},tick:function(){var x=this,Y=x.gv,m=Y._moveStep;x.point&&Y.isWalkable()&&(x._32Q&&(m*=(ql()-x._32Q)/50),Y.walk(x.foward?m:-m),x._32Q=ql(),x._31Q=Sq(x.tick,x))},handle_mouseup:function(y){this.handle_touchend(y)},handle_touchend:function(S){var L=this._57I;L&&(Vc(L,ko(S))<=1&&this.gv.sm().cs(),this._57I=Q)},handleWindowMouseMove:function(v){this.handleWindowTouchMove(v)},handleWindowTouchMove:function(k){var M,Q,p=this,V=p.gv,w=p._62O,W=p.point,c=V.dm(),l=V.lp(k),X=l.x-W.x,A=l.y-W.y,P=-C*X/V.getWidth(),L=-C*A/V.getHeight();if("roaming"===w)p.rotate(k,P/2,L/2);else if(w===yh||w===ss||w===_h)V._86O||c.beginTransaction(),V.fi({kind:V._86O?"betweenEditRotation":"beginEditRotation",event:k}),V._86O=1,V.sm().each(function(H){if(ph(H)&&V.isRotationEditable(H)){var E=q(P)>q(L)?P:L;w===yh?H.setRotationX(H.getRotationX()+E):w===ss?H.setRotationY(H.getRotationY()+E):w===_h&&H.setRotationZ(H.getRotationZ()+E)}});else if("move"===w||Gr[w]){w===Ff||w===so||w===Mc?(V._87O||c.beginTransaction(),V.fi({kind:V._87O?"betweenEditSize":"beginEditSize",event:k}),V._87O=1):(V._moving||c.beginTransaction(),V.fi({kind:V._moving?"betweenMove":"beginMove",event:k}),V._moving=1);var d,g=p.p3,Y=V.getPositionInfo(g),h=ld(V);d=w===Tq?"x":w===gs?"y":w===Rj?"z":w===Ff?"sx":w===so?"sy":w===Mc?"sz":V.getMoveMode(k,p.movedata),X=X/V.getWidth()*Y.width,A=-1*A/V.getHeight()*Y.height;var o,O,a=[h[0]*X,h[4]*X,h[8]*X],D=[h[1]*A,h[5]*A,h[9]*A],$=a[0]+D[0],E=a[1]+D[1],Z=a[2]+D[2],n=[g[0]+$,g[1]+E,g[2]+Z],N=Em(V.getEye(),n,!0);if("xyz"===d?(o=n,V.moveSelection($,E,Z)):"xz"===d?(o=Zl(V,g,[0,1,0],n),o&&V.moveSelection(o[0]-g[0],0,o[2]-g[2])):"xy"===d?(o=Zl(V,g,[0,0,1],n),o&&V.moveSelection(o[0]-g[0],o[1]-g[1],0)):"yz"===d?(o=Zl(V,g,[1,0,0],n),o&&V.moveSelection(0,o[1]-g[1],o[2]-g[2])):"x"===d||"sx"===d?(N[0]=0,o=Zl(V,g,N,n),o&&(O=o[0]-g[0],"x"===d?V.moveSelection(O,0,0):V.sm().each(function(P){ph(P)&&V.isSizeEditable(P)&&(M=x(Jd,P.getWidth()+O),Q=M/P.getWidth(),P.setWidth(M),sb(k)&&(P.setHeight(P.getHeight()*Q),P.setTall(P.getTall()*Q)))}))):"y"===d||"sy"===d?(N[1]=0,o=Zl(V,g,N,n),o&&(O=o[1]-g[1],"y"===d?V.moveSelection(0,O,0):V.sm().each(function(m){ph(m)&&V.isSizeEditable(m)&&(M=x(Jd,m.getTall()+O),Q=M/m.getTall(),m.setTall(M),sb(k)&&(m.setHeight(m.getHeight()*Q),m.setWidth(m.getWidth()*Q)))}))):("z"===d||"sz"===d)&&(N[2]=0,o=Zl(V,g,N,n),o&&(O=o[2]-g[2],"z"===d?V.moveSelection(0,0,O):V.sm().each(function(v){ph(v)&&V.isSizeEditable(v)&&(M=x(Jd,v.getHeight()+O),Q=M/v.getHeight(),v.setHeight(M),sb(k)&&(v.setTall(v.getTall()*Q),v.setWidth(v.getWidth()*Q)))}))),!o)return;p.p3=o}else if(w===Cm){var _=p.div;_||(_=p.div=xq(),Pe(p.getView(),_),_.op=W,_.style.background=V.getRectSelectBackground()),V.fi({kind:V._rectSelecting?"betweenRectSelect":"beginRectSelect",event:k}),V._rectSelecting=1,_.rect=mc(_.op,l),Ae(_,_.rect)}else if("pinch"===w&&2===vj(k)){V.fi({kind:V._pinching?"betweenPinch":"beginPinch",event:k}),V._pinching=1;var O=Dp(k);V.handlePinch(O,p.dist),p.dist=O}else"pan"===w||sb(k)?p.pan(k,X,A):V.isFirstPersonMode()||(gf(k)?p.rotate(k,P,L):(p.pan(k,X,0),V.isWalkable()&&(V.fi({kind:V._walking?"betweenWalk":"beginWalk",event:k}),V._walking=1,V.walk(A/V.getHeight()*V.getCenterInfo().height))));p.point=l},pan:function(e,q,_){var L=this.gv;if(L.isPannable()){var d=L.getCenterInfo(),t=q/L.getWidth()*d.width,B=-1*_/L.getHeight()*d.height;L.fi({kind:L._panning?"betweenPan":"beginPan",event:e}),L._panning=1,L.pan(-t,-B)}},rotate:function(Z,Q,S){var N=this.gv;N.isRotatable()&&(N.fi({kind:N._rotating?"betweenRotate":"beginRotate",event:Z}),N._rotating=1,N.rotate(Q,S))},handleWindowMouseUp:function(v){this.handleWindowTouchEnd(v)},handleWindowTouchEnd:function(z){var g=this,O=g.gv,Y=O.dm(),t=g.div;if(t){var o=O.getDatasInRect(t.rect);if(!o.isEmpty()){var n=O.sm(),r=n.toSelection();o.each(function(E){n.co(E)?r.remove(E):r.add(E)}),n.ss(r)}qh(t)}O._moving&&(delete O._moving,O.fi({kind:"endMove",event:z}),O.onMoveEnded(),Y.endTransaction()),O._panning&&(delete O._panning,O.fi({kind:"endPan",event:z}),O.onPanEnded()),O._rotating&&(delete O._rotating,O.fi({kind:"endRotate",event:z}),O.onRotateEnded()),O._86O&&(delete O._86O,O.fi({kind:"endEditRotation",event:z}),Y.endTransaction()),O._87O&&(delete O._87O,O.fi({kind:"endEditSize",event:z}),Y.endTransaction()),O._pinching&&(delete O._pinching,O.fi({kind:"endPinch",event:z}),O.onPinchEnded()),O._rectSelecting&&(delete O._rectSelecting,O.fi({kind:"endRectSelect",event:z}),O.onRectSelectEnded()),O._walking&&(delete O._walking,O.fi({kind:"endWalk",event:z}),O.onWalkEnded()),g.dist=g.point=g._62O=g.p3=g.movedata=g.div=g._57I=g._32Q=g._31Q=g.foward=Q}});var ge=pk.MapInteractor=function(j){ym(ge,this,[j]),this._minPhi=0,this._maxPhi=5*s/12,this._keepHorizon=!0,this._threshold=2,this._touchScaleThreshold=.05,this._touchRotateThreshold=.03,this._touchScaleCheckAccuracy=.01};Mq("MapInteractor",Ok,{handle_contextmenu:function(d){Hm(d)},handle_mousewheel:function(T){this.gv.handleScroll(T,T.wheelDelta/40)
},handle_DOMMouseScroll:function(v){2===v.axis&&this.gv.handleScroll(v,-v.detail)},handle_keydown:function(F){this.gv.handleKeyDown(F)},handle_mousedown:function(N){this.handle_touchstart(N)},handle_touchstart:function(D){Hm(D);var j=this,C=j.gv;if(C.setFocus(D)){C.lp(D);var u=j.editing={point:C.lp(D)};sg?u.touch=!0:(u.touch=!1,u.pan=gf(D)),ep(j,D)}},handle_mouseup:function(A){this.handle_touchend(A)},handle_touchend:function(){},handleWindowMouseMove:function(M){this.handleWindowTouchMove(M)},handleWindowTouchMove:function(_){var u=this,x=u.gv,T=u.editing;if(T){var G=x.lp(_),S=T.point,g=G.x-S.x,Y=G.y-S.y;if(!T.moved){if(Math.abs(g)<u.threshold&&Math.abs(Y)<u.threshold&&!(_.touches&&_.touches.length>1))return;T.moved=!0}if(T.point=G,T.touch){var E=_.touches.length;if(2!==E)u.pan(_,g,Y);else{if(1>=E)return;var d=_.touches,w={x:d[0].clientX,y:d[0].clientY},h={x:d[1].clientX,y:d[1].clientY},b={x:h.x-w.x,y:h.y-w.y},K=T.lastCenter,v=Math.atan2(b.y,b.x),$=T.theta,f=0;$==Q?$=T.theta=v:(f=v-$,T.thetaStarted||Math.abs(f)>u.touchRotateThreshold?(T.thetaStarted=!0,T.theta=v):f=0);var B=s*(w.y+h.y)/2/x.getHeight(),e=T.phi,L=0;e==Q?e=T.phi=B:(L=B-e,T.phiStarted||Math.abs(L)>u.touchRotateThreshold?(T.phiStarted=!0,T.phi=B):L=0);var o,a=Math.sqrt(b.x*b.x+b.y*b.y),D=T.vlen;if(D){var I=w.x-K.x,c=w.y-K.y,F=h.x-K.x,q=h.y-K.y,i=Math.sqrt(I*I+c*c),p=Math.sqrt(F*F+q*q),P=D/2,m=u._sign2(i-P),J=u._sign2(p-P);0>m*J||0===m&&0===J?(o=1,T.vlen=a):(o||(o=a/D),T.scaleStarted||Math.abs(o-1)>u.touchScaleThreshold?(T.vlen=a,T.scaleStarted=!0):o=1)}else D=T.vlen=a,o=1;1!==o&&x.setZoom(o),(L||f)&&u.rotate(_,f,-L),T.lastCenter={x:(h.x+w.x)/2,y:(h.y+w.y)/2}}}else if(T.pan)u.pan(_,g,Y);else{var n=-C*g/x.getWidth(),y=-C*Y/x.getHeight();u.rotate(_,n,y)}}},_sign2:function(V){return Math.abs(V)<this._touchScaleCheckAccuracy?0:V>0?1:-1},handleWindowMouseUp:function(A){this.handleWindowTouchEnd(A)},handleWindowTouchEnd:function(N){var g=this,R=g.editing;if(g.editing=null,R&&!R.moved&&R.pan){var _=g.gv,W=_.getDataAt(N);W?_.sm().setSelection([W]):_.sm().clearSelection()}},pan:function(B,L,D){var b=this,s=b.gv;if(s.isPannable()){var i=s.getCenterInfo(),N=-L/s.getWidth()*i.width,$=1*D/s.getHeight()*i.height;s.fi({kind:s._panning?"betweenPan":"beginPan",event:B}),s._panning=1;var W=b.keepHorizon,U=b.editing.touch;if((U&&B.touches&&B.touches.length>1||!U&&sb(B))&&(W=!W),!W)return s.pan(N,$);if(N||$){var h=ld(s),X=[h[0]*N,h[4]*N,h[8]*N],k=[h[1],0,h[9]],Y=Math.sqrt(k[0]*k[0]+k[2]*k[2]);k=[k[0]/Y*$,0,k[2]/Y*$];var K=X[0]+k[0],m=X[1]+k[1],C=X[2]+k[2],V=s._center,E=s._eye;V[0]+=K,V[1]+=m,V[2]+=C,E[0]+=K,E[1]+=m,E[2]+=C,s.fp(ud,Q,E),s.fp(Jn,Q,V)}}},rotate:function(O,U,f){var t=this,o=t.gv;if(o.isRotatable()){var T=o._center,m=o._eye,p=Em(m,T),L=N(V(p[0]*p[0]+p[2]*p[2]),p[1]),u=L+f;u=Math.max(t.minPhi,Math.min(t.maxPhi,u)),f=u-L,o.fi({kind:o._rotating?"betweenRotate":"beginRotate",event:O}),o._rotating=1,o.rotate(U,f)}}}),_.defineProperties(ge.prototype,{minPhi:{get:function(){return this._minPhi},set:function(t){this._minPhi=t}},maxPhi:{get:function(){return this._maxPhi},set:function(c){this._maxPhi=c}},keepHorizon:{get:function(){return this._keepHorizon},set:function(y){this._keepHorizon=y}},threshold:{get:function(){return this._threshold},set:function(O){this._threshold=O}},touchScaleThreshold:{get:function(){return this._touchScaleThreshold},set:function(d){this._touchScaleThreshold=d}},touchRotateThreshold:{get:function(){return this._touchRotateThreshold},set:function(t){this._touchRotateThreshold=t}}});var lo=function(X){this.gv=X};jh(lo,_,{_iv:!0,iv:function(){this._iv=!0},face:function(s,g){var H=this,r=H.gv.getGL();if(!r||!ph(s))return Q;var M=g.x,R=g.width,T=g.height,F=H.height-g.y-T,U=K(R/2),L=new Uint8Array(4*R*T),N=0;for(H.iv(),H.validate(s),Ui(r,H.frame),r.readPixels(M,F,R,T,r.RGBA,r.UNSIGNED_BYTE,L),Ui(r,Q),H.iv();U>=N;N++)for(var m=U-N,k=U+N,l=m;k>=l;l++)for(var W=m;k>=W;W++)if(l===m||l===k||W===m||W===k){var D=nq.m[L[4*(l*R+W)]];if(D)return D}},get:function(J,B){this.validate();var i=this,U=i.gv.getGL();if(!U)return Q;var F,d,M=J.x,R=J.width,Z=J.height,W=i.height-J.y-Z,H=K(R/2),b=new Uint8Array(4*R*Z),C=0,t=b.length,j=B?Q:new xg,x=B?Q:{};if(Ui(U,i.frame),U.readPixels(M,W,R,Z,U.RGBA,U.UNSIGNED_BYTE,b),Ui(U,Q),B){for(;H>=C;C++)for(var $=H-C,c=H+C,k=$;c>=k;k++)for(var p=$;c>=p;p++)if((k===$||k===c||p===$||p===c)&&(F=i.info(b,4*(k*R+p))))return F}else for(;t>C;C+=4)F=i.info(b,C),F&&(d=F.data,x[d._id]||(j.add(d),x[d._id]=d));return j},info:function(d,E){return this.colorMap[(d[E]<<16)+(d[E+1]<<8)+d[E+2]+((127&d[E+3])<<24)]},validate:function(D){var c=this,B=c.gv,l=B.getGL();if(l){var Y=B.getWidth(),u=B.getHeight(),j=l.RGBA,s=l.TEXTURE_2D,i=l.RENDERBUFFER,e=l.FRAMEBUFFER;c.texture||(c.texture=bp(l),c.render=l.createRenderbuffer(),c.frame=l.createFramebuffer()),(c.width!==Y||c.height!==u)&&(Be(l,c.texture),l.texImage2D(s,0,j,Y,u,0,j,l.UNSIGNED_BYTE,Q),Kf(l,l.TEXTURE_MIN_FILTER,l.LINEAR),l.bindRenderbuffer(i,c.render),l.renderbufferStorage(i,l.DEPTH_COMPONENT16,Y,u),Ui(l,c.frame),l.framebufferTexture2D(e,l.COLOR_ATTACHMENT0,s,c.texture,0),l.framebufferRenderbuffer(e,l.DEPTH_ATTACHMENT,i,c.render),Be(l,Q),l.bindRenderbuffer(i,Q),Ui(l,Q),c.width=Y,c.height=u),c._iv&&(c._iv=!1,Ui(l,c.frame),B._42(D||(c.colorMap={}),1),Ui(l,Q))}}});var Qd=function(M){this.gv=M};jh(Qd,_,{gap:0,size:0,_42:function(v,X){var W=this,N=W.gv,q=N._gridGap,c=N._gridSize;if(N._gridVisible){if(W.gap!==q||W.size!==c){for(var b=[],T=N._gridSize/2,d=q*T,l=0;2*T+1>l;l++){var o=6*l,g=6*(2*T+1)+o;b[o]=-d,b[o+1]=0,b[o+2]=-d+l*q,b[o+3]=d,b[o+4]=0,b[o+5]=-d+l*q,b[g]=-d+l*q,b[g+1]=0,b[g+2]=-d,b[g+3]=-d+l*q,b[g+4]=0,b[g+5]=d}W.vs=new Pg(b),W.gap=q,W.size=c}Hi(N),sn(v,X),Ql(v),Sf(v,X,1,N._gridColor,N._buffer.vs,W.vs),kd(v,0,W.vs.length/3,v.LINES),ms(v),Zh(v,X)}else W.vs=W.gap=W.size=Q}});var dn=function(Z){this.gv=Z};jh(dn,_,{_42:function(y,F){var E=this.gv,i=E._buffer.vs,T=E._axisXColor,s=E._axisYColor,g=E._axisZColor,W=E._originAxisVisible,S=E._centerAxisVisible;if(W||S){var m=b?y.TRIANGLES:y.TRIANGLE_FAN,j=y.LINES;if(Hi(E),sn(y,F),Ql(y),W){var t=E.getCenterInfo(),Y=k(t.width,t.height)/5,H=.8*Y,z=.05*Y;Sf(y,F,1.5,T,i,new Pg([0,0,0,Y,0,0,H,z,0,H,0,z,H,-z,0,H,0,-z,H,z,0,0,0,0,0,Y,0,z,H,0,0,H,z,-z,H,0,0,H,-z,z,H,0,0,0,0,0,0,Y,z,0,H,0,z,H,-z,0,H,0,-z,H,z,0,H])),kd(y,0,2,j),kd(y,1,6,m),Sf(y,F,Q,s),kd(y,7,2,j),kd(y,8,6,m),Sf(y,F,Q,g),kd(y,14,2,j),kd(y,15,6,m)}if(S){var L=E._center,D=L[0],q=L[1],J=L[2],t=E.getPositionInfo(L);Y=k(t.width,t.height)/20,Sf(y,F,1.5,T,i,new Pg([D,q,J,D+Y,q,J,D,q,J,D,q+Y,J,D,q,J,D,q,J+Y])),kd(y,0,2,j),Sf(y,F,Q,s),kd(y,2,2,j),Sf(y,F,Q,g),kd(y,4,2,j)}ms(y),Zh(y,F)}}});var Rp=function(n){this.gv=n},Tq="edit_tx",gs="edit_ty",Rj="edit_tz",yh="edit_rx",ss="edit_ry",_h="edit_rz",Ff="edit_sx",so="edit_sy",Mc="edit_sz",Gr={};Gr[Tq]=1,Gr[gs]=1,Gr[Rj]=1,Gr[yh]=1,Gr[ss]=1,Gr[_h]=1,Gr[Ff]=1,Gr[so]=1,Gr[Mc]=1,jh(Rp,_,{_42:function(b,f,c){var $=this,d=$.gv,e=d.sm().ld();if(d.isEditable(e)&&!d.isEditHelperDisabled()&&ph(e)&&(!d.isFirstPersonMode()||!d.isMouseRoamable()&&!sg)){Hi(d);var j,h,l=d.isMovable(e),w=d.isRotationEditable(e),g=d.isSizeEditable(e),Q=d._axisXColor,t=d._axisYColor,O=d._axisZColor,s=d._editSizeColor,L=d.getCenterInfo(),m=k(L.width,L.height)/10,J=m/(c?5:10),R=.7*m,M=.4*R,n=e.p3(),r=n[0],F=n[1],D=n[2];j=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],l&&$._17O(b,f,e,c,Tq,Q,j,[r,F-J,D,r+R,F-J,D,r+R,F,D,r+R,F,D,r,F,D,r,F-J,D,r,F-J,D+J,r+R,F-J,D+J,r+R,F-J,D,r+R,F-J,D,r,F-J,D,r,F-J,D+J]),h=r+R,g&&$._17O(b,f,e,c,Ff,s,j,[h,F-J,D,h+M,F-J,D,h+M,F,D,h+M,F,D,h,F,D,h,F-J,D,h,F-J,D+J,h+M,F-J,D+J,h+M,F-J,D,h+M,F-J,D,h,F-J,D,h,F-J,D+J]),h+=M,w&&$._17O(b,f,e,c,yh,Q,j,[h,F-J,D,h+M,F-J,D,h+M,F,D,h+M,F,D,h,F,D,h,F-J,D,h,F-J,D+J,h+M,F-J,D+J,h+M,F-J,D,h+M,F-J,D,h,F-J,D,h,F-J,D+J]),j=[0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0],l&&$._17O(b,f,e,c,gs,t,j,[r,F,D,r,F+R,D,r-J,F+R,D,r-J,F+R,D,r-J,F,D,r,F,D,r,F,D,r,F,D-J,r,F+R,D-J,r,F+R,D-J,r,F+R,D,r,F,D]),h=F+R,g&&$._17O(b,f,e,c,so,s,j,[r,h,D,r,h+M,D,r-J,h+M,D,r-J,h+M,D,r-J,h,D,r,h,D,r,h,D,r,h,D-J,r,h+M,D-J,r,h+M,D-J,r,h+M,D,r,h,D]),h+=M,w&&$._17O(b,f,e,c,ss,t,j,[r,h,D,r,h+M,D,r-J,h+M,D,r-J,h+M,D,r-J,h,D,r,h,D,r,h,D,r,h,D-J,r,h+M,D-J,r,h+M,D-J,r,h+M,D,r,h,D]),j=[1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0],l&&$._17O(b,f,e,c,Rj,O,j,[r,F,D,r,F,D+R,r,F-J,D+R,r,F-J,D+R,r,F-J,D,r,F,D,r,F-J,D,r-J,F-J,D,r-J,F-J,D+R,r-J,F-J,D+R,r,F-J,D+R,r,F-J,D]),h=D+R,g&&$._17O(b,f,e,c,Mc,s,j,[r,F,h,r,F,h+M,r,F-J,h+M,r,F-J,h+M,r,F-J,h,r,F,h,r,F-J,h,r-J,F-J,h,r-J,F-J,h+M,r-J,F-J,h+M,r,F-J,h+M,r,F-J,h]),h+=M,w&&$._17O(b,f,e,c,_h,O,j,[r,F,h,r,F,h+M,r,F-J,h+M,r,F-J,h+M,r,F-J,h,r,F,h,r,F-J,h,r-J,F-J,h,r-J,F-J,h+M,r-J,F-J,h+M,r,F-J,h+M,r,F-J,h])}},_17O:function(b,X,o,p,u,J,C,M){var k=this.gv._buffer;Af(b,X,p,!0,o,u),Qe(b,X,Q,!0,Q,!0,Q,!1),gl(b,X.uDiffuse,J),On(b,k.vs,new Pg(M),X.aPosition),On(b,k.ns,new Pg(C),X.aNormal),Ql(b),kd(b,0,12),ms(b),Rf(b,X)}});var nh=R.Raycaster=function(Q){this.gv=Q};Ak("Raycaster",_,{intersect:function(I){var o=this,z=o.gv,m=z.getDataAt(I);return m?o.intersectObject(I,m):null},intersectObject:function(f,S){if(f instanceof oe)return this._intersectObjectImpl(f,S);var s,U,c=this,M=c.gv;U=M.unproject(f);var j=M.getEye();M.isOrtho()?(s=Em(M.getCenter(),j),s[0]+=s[0],s[1]+=s[1],s[2]+=s[2]):s=j,s=new hd(s);var u=new hd(U).sub(s).normalize(),X=new R.Math.Ray(s,u);return c._intersectObjectImpl(X,S)},_intersectObjectImpl:function(){var x=new Oh,n=new Oh,Z=new oe,m=new hd,A=new hd,u=new hd,Q=new hd,c=new hd,P=new hd,K=new hd,L=new hd,f=new hd;return function(D,Y){var W=this.gv.getData3dUI(Y),k=Y.mat||W.mat;if(k){x.fromArray(k),n.getInverse(x),Z.copy(D).applyMatrix4(n);var o=W.shapeModel;if(o||(o=dq(W)),o||(o=Y instanceof R.Node&&!(Y instanceof R.Shape)?{vs:Hl,is:dc}:[W.left,W.front,W.right,W.back,W.top,W.bottom]),!o)return console.log("Can not find shape model."),null;sd(o)||(o=[o]);var z,T,V,r,b,G,J,$,p,s,g,O=1/0,X=["","top_","bottom_"];for(z=0,T=o.length;T>z;z++)if(g=o[z])for(V=0,r=X.length;r>V;V++)if(J=o[z][X[V]+"vs"],$=o[z][X[V]+"is"],J)for(b=0,G=$?$.length:J.length/3;G>b;b+=3)$?(A.fromArray(J,3*$[b]),u.fromArray(J,3*$[b+1]),Q.fromArray(J,3*$[b+2])):(A.fromArray(J,3*b),u.fromArray(J,3*(b+1)),Q.fromArray(J,3*(b+2))),p=Z.intersectTriangle(A,u,Q,!1,m),p&&(s=Z.origin.distanceTo(p),O>s&&(O=s,c.copy(p),P.copy(A),K.copy(u),L.copy(Q)));if(!isFinite(O))return null;var U=new hd;U.subVectors(L,K),f.subVectors(P,K),U.cross(f).normalize();var d=c.clone().applyMatrix4(x),y=U.clone().applyMatrix4(x).normalize();return{world:d,local:c.clone(),worldNormal:y,normal:U}}}}()});var sr=function(H,q){this.gv=H,this.s=function(I,J,G){return J==Q&&(J=G),J==Q?q.getStyle(I):Aq(J,q,H)},this.data=q};jh(sr,_,{I3d:!0,ms_icons:1,_iv:!0,iv:function(){this._iv=!0},_42:function(D,G,p,L){var R=this,N=R.data;if(!(N instanceof Wf)){var u,b,l,k,$,_,X,d=R.gv,w=N._id,Z=R.s("shape3d.alwaysOnTop")?null:R.s("batch"),F=d._batchIndexMap,y=d._batchModelMap,A=d.isSelectable(N),V=d.getBrightness(N),s=V!=Q&&1!==V;if(R.needValidate(D)){if(l=ff(F,y,N,Z),R.validate(l,Z?_f[Z]||Di:Q),l&&(k=F[w],$=k.size=l.vs.length/3-k.begin,X=l.rs))for(V=s?V:1,_=0;$>_;_++)X.push(V);if(ph(N)){var S=d.getWireframeGeometry(N);if(S)Lk(d,N,S);else{var n=d.getWireframe(N);n&&Lk(d,N,n)}}R.labelInfo=R.label2Info=R.noteInfo=R.note2Info=R._38o=Q,R._24O(rq,"getLabel"),R._24O(tj,"getLabel2"),R._26O(Fr,"getNote"),R._26O(eg,"getNote2"),R._15O(),R._iv=!1}s&&gl(D,G.uBrightness,V),gl(D,G.uAlphaTest,R.s("alphaTest")),b=Af(D,G,p,A,N,uj),b&&(Qg(b,F[w],y),Qg(b,d._polylineIndexMap[w],d._polylineModelMap),Qg(b,d._wireframeIndexMap[w],d._wireframeModelMap)),F[w]||R._80o(D,G,L),d.isLabelVisible(N)&&((u=R.labelInfo)&&(Af(D,G,p,A,N,rq),R._28O(u,rq,L)),(u=R.label2Info)&&(Af(D,G,p,A,N,tj),R._28O(u,tj,L))),d.isNoteVisible(N)&&((u=R.noteInfo)&&(Af(D,G,p,A,N,Fr),R._29O(u,Fr,L)),(u=R.note2Info)&&(Af(D,G,p,A,N,eg),R._29O(u,eg,L))),(u=R._38o)&&R._99O(D,G,u,p,A,L),s&&gl(D,G.uBrightness,1)}},needValidate:function(){return this._iv},validate:function(){},_16O:function(){return mh},_80o:function(){},dispose:function(){},_calcAnchorMat:function(G){if(G.hasOwnProperty("_anchor")||G.hasOwnProperty("_anchorElevation")){var z=G.getAnchor3d(),N={x:z.x-.5,y:z.y-.5,z:z.z-.5},c=jl();return Zq(c,[-N.x,-N.y,-N.z]),c}},getBodyColor:function(F){var G=this.data,S=this.gv.getBodyColor(G);return S?S:F?G.getStyle(F):Q},_24O:function(i,j){var z=this,C=z.data,u=z.gv,J=z.s,x=u[j](C);if(x!=Q){var o=J(i+".scale"),V=J(i+".max"),E=z[i+"Info"]={label:x,textureScale:J(i+".texture.scale"),color:u[j+"Color"](C),font:J(i+".font"),align:J(i+".align"),background:u[j+"Background"](C)},G=E.rect=Mr(E,x);V>0&&V<G.width&&(E.labelWidth=G.width,G.width=V),G.x=G.y=0,G.width*=o,G.height*=o,E.mat=z._16O(J(i+".autorotate"),J(i+".position"),G,J(i+".face"),J(i+".t3"),J(i+".r3"),J(i+".rotationMode"));var $=G.width/2,w=G.height/2;E.vs=new Pg([-$,w,0,-$,-w,0,$,-w,0,$,w,0]),G.width/=o,G.height/=o}},_26O:function(v,w){var R=this,t=R.data,N=R.gv,P=R.s,b=N[w](t);if(b!=Q){var O=P(v+".scale"),$=this[v+"Info"]={note:b,textureScale:P(v+".texture.scale"),expanded:P(v+".expanded"),font:P(v+".font"),color:P(v+".color"),align:P(v+".align"),borderWidth:P(v+".border.width"),borderColor:P(v+".border.color"),background:N[w+"Background"](t)};if($.expanded){var U=P(v+".max"),o=Mr($,b);o.width+=6,o.height+=2,U>0&&U<o.width&&($.labelWidth=o.width,o.width=U);var i={x:-o.width/2,y:-8-o.height,width:o.width,height:o.height+8}}else i={x:-6,y:-18,width:12,height:18};$.mat=R._16O(P(v+".autorotate"),P(v+".position"),Q,P(v+".face"),P(v+".t3"),P(v+".r3"),P(v+".rotationMode")),$.rect=i,1!==O&&(i=Hp(i),i.x*=O,i.height*=O,i.y=-i.height,i.width*=O);var p=i.x,T=i.y,A=i.width,e=i.height;$.vs=new Pg([p,-T,0,p,-T-e,0,p+A,-T-e,0,p+A,-T,0])}},_28O:function(U,B,d){if(d(this.s(B+".transparent"))){var D=U.rect,o=U.textureScale,w=D.width*o,l=D.height*o;if(w>=1&&l>=1){var Q=tp(w,l);1!==o&&(Q.translate(Q,D.x,D.y),Q.scale(o,o),Q.translate(Q,-D.x,-D.y)),ao(Q,U),Q.restore(),Ge(this,B,U.mat,U.vs,!0)}}},_29O:function(j,o,W){if(W(this.s(o+".transparent"))){var g=j.rect,w=j.textureScale,P=g.x,h=g.y,X=g.width*w,v=g.height*w;if(X>=1&&v>=1){g.x=g.y=0;var B=tp(X,v);1!==w&&B.scale(w,w),io(B,j),B.restore(),g.x=P,g.y=h,Ge(this,o,j.mat,j.vs,!1)}}},_99O:function(k,I,p,g,s,i){if(p){var H=this,z=H.gv,q=H.data,G=z._buffer,x=z._1O,_=p.icons;for(var U in _){var Y=_[U],B=p.rects[U];if(B&&i(Aq(Y.transparent,q,z))){Af(k,I,g,s,q,U);var L=Aq(Y.shape3d,q,z),F=L?[L]:Aq(Y.names,q,z),K=F?F.length:0,b=Aq(Y.textureScale,q,z)||1,T=Aq(Y.light,q,z);T==Q&&(T=L?!0:!1),Qe(k,I,Aq(Y.blend,q,z),T,Aq(Y.opacity,q,z),Aq(Y.reverseFlip,q,z),Aq(Y.reverseColor,q,z),Aq(Y.reverseCull,q,z));for(var d=0;K>d;d++){var J=F[d],R=B[d];if(Wb(H,R.mat),L)ti(z,q,dq(H,L),H);else{var f=Lq(J);if(f){var l=R.width*b,y=R.height*b;if(l>=1&&y>=1){var w=tp(l,y);Cq(w,f,Aq(Y.stretch,q,z),0,0,l,y,q,z),w.restore(),bp(k,lk,x),Ql(k,I,x,Aq(Y.discardSelectable,q,z),G.uv,ol),On(k,G.vs,R.vs,I.aPosition),Me(k,G.ns,pq,I.aNormal),Ef(k,G.is,Vd),sc(k,0,Vd.length),ms(k,I,x)}}}Lc(z)}Rf(k,I)}}}}});var zk=function(y,u){ym(zk,this,[y,u])};jh(zk,sr,{_16O:function(L,q,o,D,n,v,Z,A,b){var K=this.data,d=K.getFinalScale3d(),x=gh(q,d,o,D,A,b);if(K.hasOwnProperty("_anchor")||K.hasOwnProperty("_anchorElevation")){var U=K.getAnchor3d();x[0]-=(U.x-.5)*d[0],x[1]-=(U.y-.5)*d[1],x[2]-=(U.z-.5)*d[2]}return gq(jl(),x,K.p3(),D,n,v,Z,L,K.r3(),K.getRotationMode())},clear:function(){var T=this;T.faceMat=T.mat=T.shapeModel=T.left=T.right=T.front=T.back=T.top=T.bottom=T.csg=Q},needValidate:function(y){if(this._iv)return this._validateFrameId=y._renderInfo.frame,!0;if(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen")||this.s("hide.overlapping.group")){var A=y._renderInfo.frame;if(this._validateFrameId!==A)return this._validateFrameId=A,!0}return!1},validate:function(T,N){var J=this,H=J.gv,r=J.data,i=dq(J);J._updateAutoRotation(),J._updateFixSize2d(),J._updateOverlapping(),(this.s("shape3d.autorotate")||this.s("shape3d.fixSizeOnScreen"))&&(Ic(H,r,"_wireframeModelMap","_wireframeIndexMap"),Ic(H,r,"_wireframeModelMapSwap","_wireframeIndexMapSwap"));var t=pj(r,H.getMat(r),i?J.s("shape3d.scaleable"):!0),s=J._calcAnchorMat(r);if(s&&rh(t,t,s),r.mat=t,J.clear(),T){var y=[];i?sm(H,r,i,J,J.getBodyColor(),[t],T,y):(Zj(H,r,T,N,t,Um,y,Uh),Zj(H,r,T,N,t,Xl,y,gp),Zj(H,r,T,N,t,fk,y,Gg),Zj(H,r,T,N,t,rp,y,Ke),Zj(H,r,T,N,t,mj,y,kn),Zj(H,r,T,N,t,nd,y,Vk)),y.length&&(Bd(T.vs,y),Bd(T.ns,Tp(y)))}else J.mat=t,(J.shapeModel=i)||(J._cubeUvs=null,J.vf(Um,0),J.vf(Xl,16),J.vf(mj,8),J.vf(nd,24),J.vf(fk,32),J.vf(rp,40))},_updateAutoRotation:function(){var q=this,d=q.s("shape3d.autorotate");if(d){var Z,e=q.gv,P=q.data;Z="string"==typeof d?[d.indexOf("x")<0?e._eye[0]:e._center[0],d.indexOf("y")<0?e._eye[1]:e._center[1],d.indexOf("z")<0?e._eye[2]:e._center[2]]:e._eye;var S=e._center,f=[Z[0]-S[0],Z[1]-S[1],Z[2]-S[2]],L=P.p3(),N=nm([L[0]+f[0],L[1]+f[1],L[2]+f[2]],L,e._up),J=P.r3(),i=Dr(N,P.getRotationMode());Math.abs(J[0]-i[0])<1e-5&&Math.abs(J[1]-i[1])<1e-5&&Math.abs(J[2]-i[2])<1e-5||P.r3(i)}},_updateFixSize2d:function(){var F=this,C=F.data,B=F.s("shape3d.fixSizeOnScreen");if(!B)return C._dynamicScale3d&&delete C._dynamicScale3d,void 0;var j=F.gv;C.getFinalScale3d();var z=pj(C,j.getMat(C)),y=Vi([0,0,0],z),J=j.toViewPosition(y);if(!isNaN(J.x)&&!isNaN(J.y)){var D=Vi([1,0,0],z),E=j.toViewPosition(D),V=Vi([0,1,0],z),S=j.toViewPosition(V),r=E.x-J.x,g=S.y-J.y,G=C._dynamicScale3d||[1,1,1],A=Lq(C.s("shape3d.image")),M=B[0]>0?B[0]:A?ki(A,F):20,s=B[1]>0?B[1]:A?Xe(A,F):20,n=Math.abs(r/M),W=Math.abs(g/s);Math.abs(n-1)<.001&&Math.abs(W-1)<.001||(C._dynamicScale3d=[G[0]/n,G[1]/W,G[2]])}},_updateOverlapping:function(){var R=this,c=R.s("hide.overlapping.group");if(!c)return R._rectOverlapping&&(R._rectOverlapping=i),void 0;var b,l,T,U=R.gv,y=R.data,f=pj(y,U.getMat(y)),H=1/0,u=1/0,J=-1/0,j=-1/0,Q=y.getAnchor3d(),A=Q.x,h=Q.y,O=Q.z;for(b=0;8>b;b++){if(l=Vi([(b>>2)-A,(1&b>>1)-h,(1&b)-O],f),T=U.toViewPosition(l),isNaN(T.x)||isNaN(T.y))return;H=Math.min(H,T.x),J=Math.max(J,T.x),u=Math.min(u,T.y),j=Math.max(j,T.y)}var D={x:H,y:u,w:J-H,h:j-u};R._rectOverlapping=U.overlappingBox.isOverlapping(c,D)},getVectorDynamicSize:function(){var X,n=this,L=n.s("shape3d"),Z=n.data;if("billboard"===L||"plane"===L||(X=Z._currentCubeElementId)!=Q){var e,k,K=n.gv,R=pj(Z,K.getMat(Z)),c=function(r,X){var S=K.toViewPosition(Vi(r,R)),l=K.toViewPosition(Vi(X,R)),d=S.x-l.x,U=S.y-l.y;return Math.min(2048,Math.sqrt(d*d+U*U))};if("billboard"===L)e=c([-.5,0,0],[.5,0,0]),k=c([0,-.5,0],[0,.5,0]);else if("plane"===L)e=c([-.5,0,0],[.5,0,0]),k=c([0,0,-.5],[0,0,.5]);else if(Z._currentCubeElementId!=Q){var J=3*dc[X+1],O=3*dc[X],A=3*dc[X+2];e=c([Hl[J],Hl[J+1],Hl[J+2]],[Hl[A],Hl[A+1],Hl[A+2]]),k=c([Hl[J],Hl[J+1],Hl[J+2]],[Hl[O],Hl[O+1],Hl[O+2]])}return[e,k]}},getCachedTexture:function(){var V=this,D=V.data,T=D._currentCubeElementId;return T!=Q?V._cubeCachedImage?V._cubeCachedImage[T]:null:V._shape3dCachedImage},setCachedTexture:function(r){var W=this,b=W.data,R=b._currentCubeElementId;if(R!=Q){if(!W._cubeCachedImage)return W._cubeCachedImage={};W._cubeCachedImage[R]=r}else W._shape3dCachedImage=r},invalidateCachedTexture:function(e){var b,E,W,g=this;if((W=g._shape3dCachedImage)&&(e.deleteTexture(W),g._shape3dCachedImage=null),E=g._cubeCachedImage){for(b in E)e.deleteTexture(E[b]);g._cubeCachedImage=null}},vf:function(Z,U){var O=this;if(O.gv.getFaceVisible(O.data,Z)){var f=$d(O,Z);f.mat&&(O.faceMat=!0);var K=f.uv;if(K){var h=O._cubeUvs;h||(h=O._cubeUvs=new Pg([0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0]));for(var C=0;8>C;C++)h[U+C]=K[C]}return f}},_80o:function(h,s,u){var T=this;if(T._rectOverlapping)return!0;var l=T.gv,$=T.data,O=l._cube,E=T.shapeModel;Hi(l,T.mat),E?ti(l,$,E,T,T.getBodyColor(),u):(On(h,O.vs,Q,s.aPosition),On(h,O.ns,Q,s.aNormal),kq(h,O.is),T._18O(h,s,T.left,0,u),T._18O(h,s,T.front,6,u),T._18O(h,s,T.right,12,u),T._18O(h,s,T.back,18,u),T._18O(h,s,T.top,24,u),T._18O(h,s,T.bottom,30,u)),Lc(l),T.faceMat&&(T._18O(h,s,T.left,0,u,!0),T._18O(h,s,T.front,6,u,!0),T._18O(h,s,T.right,12,u,!0),T._18O(h,s,T.back,18,u,!0),T._18O(h,s,T.top,24,u,!0),T._18O(h,s,T.bottom,30,u,!0))},_18O:function(s,$,R,r,B,k){if(R){if(!B(R.transparent))return;if(k&&!R.mat||!k&&R.mat)return;k&&Hi(this.gv,R.mat);var J=this,T=J.data;T._currentCubeElementId=r;var j=J.gv,Z=j.getTexture(R.texture,T),p=R.uv,h=R.uvScale,u=R.uvOffset,W=R.discardSelectable;Z?p?Ql(s,$,Z,W,j._buffer.uv,J._cubeUvs,u,h):Ql(s,$,Z,W,j._cube.uv,Q,u,h):Ql(s),Qe(s,$,R.blend,R.light,R.opacity,R.reverseFlip,R.reverseColor,R.reverseCull),gl(s,$.uDiffuse,R.color),sc(s,r,6),Rf(s,$),ms(s,$,Z),k&&Lc(j),T._currentCubeElementId=null}}});var xf=function(e,T){ym(xf,this,[e,T])};jh(xf,sr,{_25Q:1,validate:function(T){var z=this,j=z.gv,O=z.data,m=z.s,Z=m("edge.width"),l=O._40I,h=O._41I;if(z.shapeModel=z.info=Q,l&&h){var n,y,D,P,F,K,e,V,J,R,o=O.isLooped(),W=m(kr),C=p.getEdgeType(W);if(C){var q=C(O,Aj(z,j,O,o,W),j,z._19Q);if(!q.points||q.points.isEmpty())return;K=z.info={},e=q.segments,F=q.points,V=F.size();for(var U=l.getElevation(),G=h.getElevation(),s=0;V>s;s++){var $=F.get(s);$.e==Q&&($.e=U+(G-U)*s/(V-1))}J=js(F.get(0)),R=js(F.get(V-1));var x=V%2;0===x?(K.c1=js(F.get(V/2-1)),K.c2=js(F.get(V/2))):K.p3=js(F.get((V-x)/2)),K.s1=J,K.s2=js(F.get(1)),K.t1=js(F.get(V-2)),K.t2=R}else{F=new xg,K=z.info={};var A=m("edge.offset"),B=m("edge.center"),g=m("edge.source.t3"),L=m("edge.target.t3"),H=l.p3(),f=h.p3();if(g&&(H[0]+=g[0],H[1]+=g[1],H[2]+=g[2]),L&&(f[0]+=L[0],f[1]+=L[1],f[2]+=L[2]),W===Ir){e=m("edge.segments");var r=K.points=m(Dc)||os;if(V=r.size()){J=js(r.get(0)),R=js(r.get(V-1)),!B&&A&&(D=Em(J,H,!0),A=k(A,Vc(H,J)),H=[H[0]+D[0]*A,H[1]+D[1]*A,H[2]+D[2]*A],D=Em(f,R,!0),A=k(A,Vc(R,f)),f=[f[0]-D[0]*A,f[1]-D[1]*A,f[2]-D[2]*A]);var x=V%2;0===x?(n=js(r.get(V/2-1)),y=js(r.get(V/2))):K.p3=js(r.get((V-x)/2)),K.s1=H,K.s2=J,K.t1=R,K.t2=f}else!B&&A&&(D=Em(f,H,!0),P=Vc(H,f),A=_q(A,P),H=[H[0]+D[0]*A,H[1]+D[1]*A,H[2]+D[2]*A],f=[f[0]-D[0]*A,f[1]-D[1]*A,f[2]-D[2]*A]),n=H,y=f;F.add({x:H[0],y:H[2],e:H[1]}),F.addAll(r),F.add({x:f[0],y:f[2],e:f[1]})}else{var Y=Aj(z,j,O,o,W);if(z._19Q||(Y=-Y),o){var i=H[0],S=H[1],d=H[2],M=l.getTall()/2+Y;n=[i-Y,S+M,d],y=[i+Y,S+M,d],F.add({x:i-Y,y:d,e:S}),F.add({x:i-Y,y:d,e:S+M}),F.add({x:i+Y,y:d,e:S+M}),F.add({x:i+Y,y:d,e:S})}else{D=Em(f,H,!0),P=Vc(H,f);var E={x:H[0],y:H[2]},v={x:f[0],y:f[2]},I=Lm(Q,E,v,Y),t=I.x-E.x,X=I.y-E.y;A=_q(A,P),D[0]*=A,D[1]*=A,D[2]*=A,n=[H[0]+D[0]+t,H[1]+D[1],H[2]+D[2]+X],y=[f[0]-D[0]+t,f[1]-D[1],f[2]-D[2]+X],B?(F.add({x:H[0],y:H[2],e:H[1]}),F.add({x:n[0],y:n[2],e:n[1]}),F.add({x:y[0],y:y[2],e:y[1]}),F.add({x:f[0],y:f[2],e:f[1]})):(F.add({x:n[0],y:n[2],e:n[1]}),F.add({x:y[0],y:y[2],e:y[1]}))}}K.c1=n,K.c2=y}K.list=m(Ki)===Gi?z.createTubeModel(F,e,Z/2,T):z.createLineModel(F,e,Z,"edge","edge.dash")}}});var Ln=function(O,r){ym(Ln,this,[O,r])};jh(Ln,zk,{_80o:function(b,w,g){var E=this,p=E.gv,c=E.shapeModel;Hi(p,E.mat),c?ti(p,E.data,c,E,E.getBodyColor(),g):(gi(E,b,w,E.left,g),gi(E,b,w,E.front,g),gi(E,b,w,E.right,g),gi(E,b,w,E.back,g),gi(E,b,w,E.top,g),gi(E,b,w,E.bottom,g)),Lc(p)},validate:function(L,N){var j,r,D=this,$=D.s,U=D.data,S=U.p3(),P=U._thickness/2,_=U.isClosePath(),V=U.getPoints(),m=U.getSegments(),s=$(Ug),h=L&&L.uv;if(D.clear(),0>P)r=D.shapeModel=Dd(V,m,$(fm),$(Th),s,$(Qi),U.getTall(),U.getShapeElevation(),_),$(Kp)?$("shape3d.image")||delete r.uv:(delete r.vs,delete r.ns,delete r.uv),$("shape3d.top.image")||delete r.top_uv,$("shape3d.bottom.image")||delete r.bottom_uv;else if($(Ki)===Gi)j=fb(V,m,s,_),r=D.shapeModel={vs:[]},$("shape3d.image")&&(r.uv=[],r.sum=$(Qi)||Ol(j)||1,r.len=0),$(fm)&&!_&&(r.top_vs=[],$("shape3d.top.image")&&(r.top_uv=[])),$(Th)&&!_&&(r.bottom_vs=[],$("shape3d.bottom.image")&&(r.bottom_uv=[])),D._12O(j,P);else{var q,M,J,W,x,G,H,b,f,v;if(j=fb(V,m,s,_),x=D.vf(mj,h,!1,N),P&&(G=D.vf(nd,h,!1,N),H=_?Q:D.vf(Um,h,!1,N),b=_?Q:D.vf(Xl,h,!1,N),f=D.vf(fk,h,!1,N),v=D.vf(rp,h,!1,N)),P){for(var t=0,g=j.length;g>t;t++)j[t]=D._tryRemoveBezierPoints(j[t],P);D._12O(j,P)}else x&&j.forEach(function(R){if(W=R.length,W>0)for(q=R[0],J=1;W>J;J++)M=R[J],D.addV(x.vs,q,M),q=M});D._20Q(j),L||(x&&(x.ns=Tp(x.vs),Kr(x,"vs"),Kr(x,vb)),P&&(G&&(G.ns=Tp(G.vs),Kr(G,"vs"),Kr(G,vb)),H&&(H.ns=Tp(H.vs),Kr(H,"vs"),Kr(H,vb)),b&&(b.ns=Tp(b.vs),Kr(b,"vs"),Kr(b,vb)),f&&(f.ns=Tp(f.vs),Kr(f,"vs"),Kr(f,vb)),v&&(v.ns=Tp(v.vs),Kr(v,"vs"),Kr(v,vb))))}var y=D.mat=jl();Zq(y,S),Tj(y,U.r3(),U.getRotationMode());var n=U.getScale3d(),u=U._dynamicScale3d;u&&(n[0]*=u[0],n[1]*=u[1],n[2]*=u[2]),xd(y,n),Zq(y,ie(S)),L&&(Ik(D,y,L,r),D.clear())},_20Q:function(q){var L,T,k,j,z,F,M,H=this,R=H.front,$=H.back,m=H.top,X=H.bottom,O=R?R.tuv:Q,g=$?$.tuv:Q,C=m?m.tuv:Q,y=X?X.tuv:Q,p=0;(O||g||C||y)&&(L=H.s(Qi)||Ol(q)||1,q.forEach(function(G){if(T=G.length,T>0)for(F=G[0],k=1;T>k;k++)M=G[k],j=p/L,p+=Vc(F,M),z=p/L,H._14O(R,j,z),H._14O($,1-z,1-j),H._14O(m,j,z),H._14O(X,j,z),F=M}))},_14O:function(L,K,v){if(L){var n=L.uv,q=L.tuv;if(q){if(n)var G=n[0]+(n[6]-n[0])*K,d=n[1]+(n[7]-n[1])*K,y=n[2]+(n[4]-n[2])*K,P=n[3]+(n[5]-n[3])*K,o=n[2]+(n[4]-n[2])*v,g=n[3]+(n[5]-n[3])*v,t=n[0]+(n[6]-n[0])*v,m=n[1]+(n[7]-n[1])*v;else G=K,d=0,y=K,P=1,o=v,g=1,t=v,m=0;q.push(y,P,o,g,t,m,t,m,G,d,y,P)}}},_13O:function(Y){var K=Y.uv,A=Y.tuv;A&&(K?A.push(K[2],K[3],K[4],K[5],K[6],K[7],K[6],K[7],K[0],K[1],K[2],K[3]):A.push(0,1,1,1,1,0,1,0,0,0,0,1))},_tryRemoveBezierPoints:function(p,q){var M=p.length;if(4>M)return p;var y,b,n,U,X,c,Q=!1,z=function(v){return p[v]},R=function(S){return p[M-1-S]};for(X=0;1>=X;X++)for(c=X?R:z,b=c(0),n=c(1),y=2;M-1>y;y++)if(U=c(y),!U.remove)if(U.b){var H=Lm(b,n,U,q);H.adjust?(U.remove=!0,Q=!0):(b=n,n=U)}else b=n,n=U;if(!Q)return p;var w=[];for(y=0;M>y;y++)p[y].remove||w.push(p[y]);return w},_12O:function(G,C){var I,W,f,x,v,P=this;G.forEach(function(d){if(v=d.length,v>0)for(I={p:d[0],n:!0},x=1;v>x;x++)W=d[x],f=v-1>x?d[x+1]:Q,P.addPoint(I,W,f,C,d)})},addPoint:function(H,M,C,x,l){var R,A,$,D,e,B,o,S,w,i=this,c=H.p,d=H.f,I=H.b,r=i.s("shape3d.side")||od,F=i.s("shape3d.start.angle"),V=i.s("shape3d.sweep.angle"),a=i.shapeModel,q=i.data.isClosePath();if(H.n&&(H.n=!1,d=q&&l.length>2?Lm(l[l.length-2],c,M,x):Lm(Q,c,M,x),I=cl(c,d),a?a.top_vs&&i._10O(I,d,r,F,V,a.top_vs,a.top_uv):(R=i.left)&&(i.addV(R.vs,I,d),i._13O(R))),A=C?Lm(c,M,C,x):q&&l.length>2?Lm(c,M,l[1],x):Lm(c,M,Q,x),$=cl(M,A),a){var p,G,O=a.vs,E=a.uv,J=a.sum;for(E&&(p=a.len/J,a.len+=Vc(c,M),G=a.len/J),B=i._9O(I,d,r,F,V),o=i._9O($,A,r,F,V),S=0;r>S;S++)w=S+1,Bd(O,B[w]),Bd(O,o[S]),Bd(O,B[S]),Bd(O,o[S]),Bd(O,B[w]),Bd(O,o[w]),E&&(D=S/r,e=w/r,E.push(p,e,G,D,p,D,G,D,p,e,G,e));!C&&a.bottom_vs&&i._10O($,A,r,F,V,a.bottom_vs,a.bottom_uv,!0)}else!C&&(R=i.right)&&(i.addV(R.vs,A,$),i._13O(R)),(R=i.front)&&i.addV(R.vs,d,A),(R=i.back)&&i.addV(R.vs,$,I),(R=i.top)&&i.addH(R.vs,d,A,$,I,!0),(R=i.bottom)&&i.addH(R.vs,I,$,A,d);H.p=M,H.f=A,H.b=$},_10O:function(x,y,G,N,d,v,Z,s){var t,u,U=this,S=U.data,B=U._9O(x,y,G,N,d),M=(x.x+y.x)/2,Y=(x.y+y.y)/2,R=S.getShapeElevation(),b=0;for(b=0;G>b;b++)s?(Bd(v,B[b]),Bd(v,B[b+1])):(Bd(v,B[b+1]),Bd(v,B[b])),Bd(v,[M,R,Y]),Z&&(s?(t=C*(b+1)/G+N,u=C*b/G+N):(t=C*b/G+N,u=C*(b+1)/G+N),Z.push(.5-.5*$(u),.5-.5*g(u),.5-.5*$(t),.5-.5*g(t),.5,.5))},_9O:function(n,L,K,A,H){var P,X,E=this,k=E.data,G=[],R=(n.x+L.x)/2,Z=(n.y+L.y)/2,D=k.getTall()/2,M=k.getShapeElevation(),w=0;for(H=H||C;K>=w;w++)P=H*w/K+A,X=$(P),G.push([R+(n.x-R)*X,M+D*g(P),Z+(n.y-Z)*X]);return G},addV:function(j,x,G){var W=x.x,a=x.y,J=G.x,i=G.y,M=this.data,v=M.getShapeElevation(),K=M.getTall()/2;j.push(W,v-K,a,J,v-K,i,J,v+K,i,J,v+K,i,W,v+K,a,W,v-K,a)},addH:function(G,B,M,X,p,q){var W=this.data,o=W.getTall()/2,k=W.getShapeElevation()+(q?o:-o);G.push(B.x,k,B.y,M.x,k,M.y,X.x,k,X.y,X.x,k,X.y,p.x,k,p.y,B.x,k,B.y)},vf:function(Z,p,G,P){var u,d=this,X=d.gv.getFaceVisible(d.data,Z);return(G||X)&&(u=$d(d,Z,P),u.vs=[],u.tuv=X&&(u.texture||p)?[]:Q,u.visible=X),u}});var Db=function(G,l){ym(Db,this,[G,l])};jh(Db,sr,{_25Q:1,validate:function(B){var l=this,D=l.data,K=l.s,o=D.getPoints(),F=o.size();if(l.shapeModel=l.info=Q,F>1){var y=l.info={},Z=D.getSegments(),J=D.getThickness(),h=js(o.get(0)),A=js(o.get(F-1)),j=F%2;0===j?(y.c1=js(o.get(F/2-1)),y.c2=js(o.get(F/2))):y.p3=js(o.get((F-j)/2)),y.s1=h,y.s2=js(o.get(1)),y.t1=js(o.get(F-2)),y.t2=A,y.list=K(Ki)===Gi?l.createTubeModel(o,Z,J/2,B):l.createLineModel(o,Z,J,"shape.border","shape.dash")}var V=D.p3(),n=l.mat=jl();Zq(n,V),Tj(n,D.r3(),D.getRotationMode());var R=D.getScale3d(),i=D._dynamicScale3d;i&&(R[0]*=i[0],R[1]*=i[1],R[2]*=i[2]),xd(n,R),Zq(n,ie(V))},_80o:function(g,n,b){var w=this,H=w.shapeModel;if(H){var k=w.gv;Hi(k,w.mat),ti(k,w.data,H,w,w.getBodyColor(),b),Lc(k)}}});var Tb=R.graph3d.VR=function(j){var Q=this;Q.gv=j,Q._controllers=[],Q.switch=new dh(Q),Q._enable=!1,Q._defaultCallLater=R.Default.callLater,"undefined"!=typeof u&&"VRFrameData"in u&&(Q._frameData=new u.VRFrameData),Q.measureOflength=1,Q.eyesOffset=[0,0,0]};jh(Tb,_,{ms_fire:!0,_42:function(v,i,B,o){var Q=this,c=Q.gv,d=Q._device;if(d){var l=Q._measureOflength;if(d.depthNear=c.getNear()*l,d.depthFar=c.getFar()*l,Q._controllers.forEach(function(w){w&&w.update()}),d.isPresenting===!1)return c.iv(),!1;var g=Q._frameData;d.getFrameData(g);var x=g.pose.position;return x&&c.setEye(Q.toViewPosition(x)),v.viewport(0,0,i/2,B),Q._viewMatrix=Q._copyViewMatrix(g.leftViewMatrix),Q._projectMatrix=Q._copyProjectMatrix(g.leftProjectionMatrix),o(),v.viewport(i/2,0,i/2,B),Q._viewMatrix=Q._copyViewMatrix(g.rightViewMatrix),Q._projectMatrix=Q._copyProjectMatrix(g.rightProjectionMatrix),o(),Q._lastViewMatrix=Q._viewMatrix,Q._lastProjectMatrix=Q._projectMatrix,Q._viewMatrix=null,Q._projectMatrix=null,Q.submitFrame(),!0}},addController:function(B){B=B||0;var S=this,I=S.getController(B);return I?I:(I=new jo(S,B),S._controllers.push(I),I)},getController:function(K){K=K||0;for(var d=this._controllers,y=0,B=d.length;B>y;y++)if(d[y]&&d[y].id===K)return d[y];return null},removeController:function(c){c=c||0;for(var Z=this._controllers,G=0,W=Z.length;W>G;G++)if(Z[G]&&Z[G].id===c)return Z.splice(G,1),!0;return!1},toViewPosition:function(W,k){var H=this,p=H._scaleFactor,N=H._eyesOffset;return k?(k[0]=W[0]*p+N[0],k[1]=W[1]*p+N[1],k[2]=W[2]*p+N[2],k):[W[0]*p+N[0],W[1]*p+N[1],W[2]*p+N[2]]},_copyViewMatrix:function(R){var r=this.dup(R),v=this._scaleFactor;r[12]*=v,r[13]*=v,r[14]*=v;var B=this._eyesOffset;if(B&&(B[0]||B[1]||B[2])){var y=B[0],s=B[1],h=B[2];r[12]-=r[0]*y+r[4]*s+r[8]*h,r[13]-=r[1]*y+r[5]*s+r[9]*h,r[14]-=r[2]*y+r[6]*s+r[10]*h}return r},shutdown:function(){var a=this._device;a&&a.isPresenting&&a.exitPresent()},isPresenting:function(){var m=this._device;return m&&m.isPresenting},_copyProjectMatrix:function(e){var g=this.dup(e),k=this._scaleFactor;return g[14]*=k,g},dup:function(O,n){for(var j=O.length,M=n||new Array(j);j--;)M[j]=O[j];return M},getViewMatrix:function(Y){var N=this._viewMatrix;return N?this.dup(N,Y):void 0},getProjectMatrix:function(){var H=this._projectMatrix;return H?this.dup(H):void 0},submitFrame:function(){var I=this;if(I._enable&&I._deviceInAction){var w=I._device;w&&w.isPresenting&&(w.submitFrame(),I.gv.iv())}},setDevice:function(z){var v=this;v._device=z},_injectCallLaterFunc:function(h){var d=this;if(!h)return Sq=R.Default.callLater=d._defaultCallLater,void 0;var d=this;Sq=R.Default.callLater=function(Z,U,e,o){var t=d._device;return t&&t.isPresenting?o?E(function(){Sq(Z,U,e)},o):t.requestAnimationFrame(function(){d._deviceInAction=!0,Z.apply(U,e),d._deviceInAction=!1}):(d._defaultCallLater(Z,U,e,e),void 0)}}}),_.defineProperties(Tb.prototype,{enable:{get:function(){return this._enable},set:function(L){var Q=this;Q._enable!==L&&(Q._enable=L,L?(Q.switch.showButton(),Q._injectCallLaterFunc(!0)):(Q.shutdown(),Q.switch.hideButton(),Q._injectCallLaterFunc(!1)))}},measureOflength:{get:function(){return this._measureOflength},set:function(N){this._measureOflength=N;var g=this._scaleFactor=1/N;this._controllers.forEach(function(E){E&&E._setScaleFactor(g)})}},eyesOffset:{get:function(){return this._eyesOffset},set:function(F){this._eyesOffset=F}}});var jo=function(F,B){function t(y){var M=navigator.getGamepads&&navigator.getGamepads();
if(M)for(var V=0,A=0,b=M.length;b>V;V++){var v=M[V];if(v){var B=v.id;if("OpenVR Gamepad"===B||"OpenVR Controller"===B||0===B.indexOf("Oculus Touch")||0===B.indexOf("Spatial Controller")){if(A===y)return v;A++}}}}function e(m,G,j){return Math.abs(m[0]-G[0])<j&&Math.abs(m[1]-G[1])<j&&Math.abs(m[2]-G[2])<j?!0:!1}var P=this;P.vr=F,P.id=B;var q,N,o=[0,0],p=[{id:"thumbpad",pressed:!1},{id:"trigger",pressed:!1},{id:"grips",pressed:!1},{id:"menu",pressed:!1}],l=new hf;P.getGamepad=function(){return N},P.getButtonState=function(k){p.forEach(function(y){return y.id===k?y.pressed:void 0})},P.getNode=function(){return l};var D=.003;P.setRotationEpsilon=function(e){D=e};var y=5e-4,C=y;P.setPositionEpsilon=function(c){y=c,C=c*P.vr._scaleFactor},P._setScaleFactor=function(b){l.s3(b,b,b),C=y*b};var L,z=new sf,s=new Oh,c=[0,0,0],Q=[0,0,0],n=new hd,k=new oe;P.getRay=function(){return L?(k.origin.fromArray(c),k.direction.copy(n),L=!1,k):k},P.update=function(){if(q=N,N=t(B),q!==N&&console.log("gamepad changed",N),!N||N.pose===i)return N=null,l.s("shape3d.visible",!1),void 0;l.dm()||F.gv.dm().add(l),l.s("shape3d.visible",!0);var r=N.pose;if(null!==r){r.position&&(P.vr.toViewPosition(r.position,c),e(l.p3(),c,C)||(L=!0,l.p3(c))),r.orientation&&(z.fromArray(r.orientation),n.set(0,0,-1).applyQuaternion(z).normalize(),s.makeRotationFromQuaternion(z),Dr(s.el,l.getRotationMode(),Q),e(l.r3(),Q,D)||(L=!0,l.r3(Q))),L&&F.fp("gamepad.pose",null,{position:c,rotation:Q,id:B});var G=N.axes;(o[0]!==G[0]||o[1]!==G[1])&&(o=[G[0],G[1]],F.fp("gamepad.axes",null,{id:B,axes:o}));var y,Z,f,S,d=N.buttons;for(y=0,Z=d.length;Z>y;y++)f=d[y],S=f.pressed,S!==p[y].pressed&&(p[y].pressed=S,F.fp("gamepad.button."+p[y].id,null,{id:B,_62O:S?"down":"up"}))}}},dh=function(L){this.vr=L,this._button=null};jh(dh,_,{showButton:function(){var R=this.assureButton();if(!R.parentNode){var _=this.vr.gv,e=_.getView();_._79O?e.insertBefore(R,_._79O):e.appendChild(R)}},hideButton:function(){var P=this._button;P&&P.parentNode&&P.parentNode.removeChild(P)},assureButton:function(){var p=this._button;return p?p:this._button=this.createButton(this.vr.gv)},createButton:function(b){function R(n,J){n.textContent=J&&J.isPresenting?" VR ":" VR "}function s(X){L.style.display="",L.style.cursor="pointer",L.style.left="calc(50% - 50px)",L.style.width="100px",R(L,X),L.onmouseenter=function(){L.style.opacity="1.0"},L.onmouseleave=function(){L.style.opacity="0.5"},L.onclick=function(){X.isPresenting?X.exitPresent():X.requestPresent([{source:b.getCanvas()}])},b.vr.setDevice(X)}function y(){L.style.display="",L.style.cursor="auto",L.style.left="calc(50% - 75px)",L.style.width="150px",R(L,null),L.onmouseenter=null,L.onmouseleave=null,L.onclick=null,b.vr.setDevice(null)}function _(D){D.style.position="absolute",D.style.bottom="20px",D.style.padding="12px 6px",D.style.border="1px solid #fff",D.style.borderRadius="4px",D.style.color="#000",D.style.font="normal 13px sans-serif",D.style.textAlign="center",D.style.opacity="0.5",D.style.outline="none",D.style.zIndex="999"}if("getVRDisplays"in navigator){var L=this._button=J.createElement("button");return L.style.display="none",_(L),u.addEventListener("vrdisplayconnect",function(w){s(w.display)},!1),u.addEventListener("vrdisplaydisconnect",function(){y()},!1),u.addEventListener("vrdisplaypresentchange",function(Z){R(L,Z.display)},!1),navigator.getVRDisplays().then(function(d){d.length>0?s(d[0]):y()}),L}var d=J.createElement("a");return d.href="https://webvr.info",d.innerHTML=" webvr",d.style.left="calc(50% - 90px)",d.style.width="180px",d.style.textDecoration="none",_(d),d}}),_.defineProperties(dh.prototype,{}),Bm(p,{accordionViewExpandIcon:bn(Yp),accordionViewCollapseIcon:bn(Yp,!0),accordionViewLabelColor:sk,accordionViewLabelFont:bs,accordionViewTitleBackground:vg,accordionViewSelectBackground:hk,accordionViewSelectWidth:3,accordionViewSeparatorColor:i,splitViewDividerSize:1,splitViewDividerBackground:vg,splitViewDragOpacity:.5,splitViewToggleIcon:{width:16,height:16,comps:[{type:Wh,rect:[2,2,12,12],background:Yp}]},propertyViewLabelColor:ln,propertyViewLabelSelectColor:sk,propertyViewLabelFont:bs,propertyViewExpandIcon:bn(If),propertyViewCollapseIcon:bn(If,!0),propertyViewBackground:Pk,propertyViewRowLineVisible:!0,propertyViewColumnLineVisible:!0,propertyViewRowLineColor:Hj,propertyViewColumnLineColor:Hj,propertyViewSelectBackground:hk,listViewLabelColor:ln,listViewLabelSelectColor:sk,listViewLabelFont:bs,listViewRowLineVisible:!1,listViewRowLineColor:Hj,listViewSelectBackground:hk,treeViewLabelColor:ln,treeViewLabelSelectColor:sk,treeViewLabelFont:bs,treeViewExpandIcon:bn(Lh),treeViewCollapseIcon:bn(Lh,!0),treeViewRowLineVisible:!1,treeViewRowLineColor:Hj,treeViewSelectBackground:hk,treeViewDoubleClickToToggle:!0,tableViewLabelColor:ln,tableViewLabelSelectColor:sk,tableViewLabelFont:bs,tableViewRowLineVisible:!0,tableViewColumnLineVisible:!0,tableViewRowLineColor:Hj,tableViewColumnLineColor:Hj,tableViewSelectBackground:hk,treeTableViewLabelColor:ln,treeTableViewLabelSelectColor:sk,treeTableViewLabelFont:bs,treeTableViewExpandIcon:bn(Lh),treeTableViewCollapseIcon:bn(Lh,!0),treeTableViewRowLineVisible:!0,treeTableViewColumnLineVisible:!0,treeTableViewRowLineColor:Hj,treeTableViewColumnLineColor:Hj,treeTableViewSelectBackground:hk,tableHeaderLabelColor:ln,tableHeaderLabelFont:bs,tableHeaderColumnLineVisible:!0,tableHeaderColumnLineColor:Bc,tableHeaderBackground:Pk,tableHeaderMoveBackground:sp,tableHeaderInsertColor:hk,tableHeaderSortDescIcon:As(If,!0),tableHeaderSortAscIcon:As(If),tabViewTabGap:1,tabViewLabelColor:sk,tabViewLabelFont:bs,tabViewTabBackground:vg,tabViewSelectWidth:3,tabViewSelectBackground:hk,tabViewMoveBackground:sp,tabViewInsertColor:hk,toolbarLabelColor:ln,toolbarLabelSelectColor:sk,toolbarLabelFont:bs,toolbarBackground:Pk,toolbarSelectBackground:hk,toolbarItemGap:8,toolbarSeparatorColor:Un},!0);var Zd={translateX:1,sortColumn:1},ah={sortable:1,sortOrder:1,sortFunc:1},uk={focusData:1},Co={dataModel:1,sortColumn:1,sortFunc:1,visibleFunc:1,rootData:1,rootVisible:1},aq={dataModel:1,sortFunc:1,visibleFunc:1,categorizable:1},wr=function(W,A){A.add(W),W.hasChildren()&&W.eachChild(function(v){wr(v,A)})},Ie=function(r,C,N,n,x,F,U,D,M,k,b){var S,Z=N.getValueType(k),R=N.getAlign(k);if(N.getEnumValues(k)){var P=N.toEnumLabel(C,k),H=Dh||0,$=0,j=F,J=p.getTextSize(n,P).width;return S=Lq(N.toEnumIcon(C,k)),S&&($=F+Dh/2,"center"===R?$+=(D-(H+J))/2:"right"===R&&($=$+D-(H+J)),as(r,S,$,U+M/2,k,b),j=$+Dh/2),P!=Q&&(S?re(r,P,n,x,j,U,D-(j-F),M):re(r,P,n,x,F,U,D,M,R)),void 0}return C=N.formatValue(C),C!=Q?Z===tr?(nl(r,F,U,D,M,C),void 0):Z===xo||!Z&&dk(C)?(S=Lq(C?Jo:Ec),as(r,S,F+D/2,U+M/2,k,b),void 0):(re(r,C,n,x,F,U,D,M,R),void 0):void 0},bi=function(g,w){var Q=w.view,j=Tr(g),W=w.column||w.property;Q.getDataModel().beginTransaction(),w.editor=g,g.info=w,Q.setCurrentEditor(g),Q.getView().insertBefore(j,Q._79O),Ae(g,w.editorRect),g.setFocus?g.setFocus():Oj(g),g.commitValue=function(z,k){g._17Q&&(g=g._17Q),k||Q.setValue(w.data,W,g.getValue?g.getValue():g.value),g.close&&g.close(),qh(j)},W.onEditorCreated&&W.onEditorCreated(w)},qg=function(y,v,z,C,b){var j=Yl(y,z),B=v.value,F=v.view,U=b.getValueType(v.data);return j.onblur=j.onchange=function(){F.endEditing()},"input"===y?(B=b.formatValue(B),B!=Q&&(j.value=B),j.onkeydown=function(o){Cj(o)?F.endEditing():Wq(o)&&F.endEditing(!0)},(U===Fb||U===Mp)&&j.addEventListener(Or,p.numberListener,!1)):y===Cm&&C.forEach(function(f){var O=J.createElement("option");O.innerHTML=b.toEnumLabel(f),O.value=f,b.isEnumEqual(B,f)&&(O.selected=!0),Pe(j,O)}),bi(j,v),j},yo=R.widget={},Dm=function(K,U,i){jh(l+".widget."+K,U,i)};Bm(rm,{ms_value:function(c){c.getValue=function(x){var z=this.getItemById(x),I=z.element;return Pf(I)?I:I?I.getValue?I.getValue():I.value:z.selected},c.setValue=function(H,X){var S=this.getItemById(H);if(S){var A=S.element;A&&!Pf(A)?A.setValue?A.setValue(X):A.value=X:dk(X)?(S.selected=X,this.iv()):(S.element=X,this.iv())}},c.v=function(t,T){var m=this;if(2===arguments.length)m.setValue(t,T);else{if(!no(t))return m.getValue(t);for(var L in t)m.setValue(L,t[L])}return m}},_46o:function(V){V._icon=Q,V._accessType=Q,V._valueType=Q,V._editable=!1,V._batchEditable=!0,V._align=Um,V._nullable=!0,V._emptiable=!1,V.setParent=_d,V.formatValue=function(O){var B=this,l=B._valueType;return B.getEnumValues()?B.toEnumLabel(O):l===xo?!!O:O!=Q&&l===Fb?U(O):O},V.setEnum=function(b,M,J,g,P,n,i){var W=this;b&&!sd(b)&&b.values&&(g=b.editable,J=b.icons,M=b.labels,P=b.strict,n=b.maxHeight,i=b.dropDownWidth,b=b.values),yr(b)&&(b=b._as),yr(M)&&(M=M._as),yr(J)&&(J=J._as),W._enumValues=b,W._enumLabels=M,W._enumIcons=J,W._enumEditable=g,W._enumStrict=P==Q?!0:P,W._enumMaxHeight=n,W._enumDropDownWidth=i,b&&b.length&&Nr(b[0])&&(W._valueType=Mp),W.fp("enum",!1,!0)},V.getEnumDropDownWidth=function(){return this._enumDropDownWidth},V.getEnumMaxHeight=function(){return this._enumMaxHeight},V.isEnumEditable=function(){return this._enumEditable},V.getEnumValues=function(){return this._enumValues},V.getEnumLabels=function(){return this._enumLabels},V.getEnumIcons=function(){return this._enumIcons},V.isEnumStrict=function(){return this._enumStrict},V.isEnumEqual=function(Q,l){return this._enumStrict?Q===l:Q==l},V.toEnumLabel=function(A,b){var R=this,w=R.getEnumValues(b),j=R.getEnumLabels(b);if(w&&j)for(var x=0;x<w.length;x++)if(R.isEnumEqual(A,w[x]))return j[x];return A},V.toEnumIcon=function(T,c){var p=this,P=p.getEnumValues(c),u=p.getEnumIcons(c);if(P&&u)for(var E=0;E<P.length;E++)if(p.isEnumEqual(T,P[E]))return u[E];return i}},_45o:function(i){i._87o=function($,A,p,_,e,Q){if($){var b=this,J=b._90I,o=xq(1);b._columnLineVisible&&(e-=1),b._rowLineVisible&&(Q-=1),0>=e||0>=Q||(b._90I||(J=b._90I={}),J[A]||(J[A]=new xg),Ae(o,b.tx()+p,b.ty()+_,e,Q),Pe(o,$),b._view.insertBefore(o,b._79O),$.onParentAdded&&$.onParentAdded(o),J[A].add(o))}},i._76o=function(){var C=this,o=C._90I;if(o){for(var r in o)o[r].each(function(y){qh(y)});delete C._90I}},i._77o=function(x){var K=this;if(K._90I){var D=K._90I[x];D&&(D.each(function(t){qh(t)}),delete K._90I[x])}}},_47o:function(U){U.getValue=function(X,A){return A.getValue?A.getValue(X,A,this):Qp(X,A.getAccessType(),A.getName())},U.setValue=function(N,B,Y){if(B.isEmptiable(N)||""!==Y||(Y=i),B.isNullable(N)||Y!=Q){var X=this,k=B.getName(N),m=B.getAccessType(N),T=B.getValueType(N);T===Fb&&Pf(Y)?Y=z(Y):T===Mp&&Pf(Y)?Y=parseFloat(Y):T===xo&&Pf(Y)&&(Y="true"===Y),X._batchEditable&&B._batchEditable&&X.isSelected(N)?X.sm().each(function($){B.setValue?B.setValue($,B,Y,X):Ee($,m,k,Y)}):B.setValue?B.setValue(N,B,Y,X):Ee(N,m,k,Y)}},U.setCurrentEditor=function(c){this.endEditing(),this._currentEditor=c,this.redraw()},U.isEditing=function($,m){var g=this,y=g._currentEditor;if(!y)return!1;if(m){var M=y.info;return M?(M.column||M.property)===m&&M.data===$:!1}return!0},U.endEditing=function(u){var M=this,l=M._currentEditor;l&&(delete M._currentEditor,l.commitValue&&l.commitValue(l.info,u),M.redraw(),M.getDataModel().endTransaction())},U.beginEditing=function(m){this.endEditing();var n=this,K=m.column||m.property;if(K.beginEditing)K.beginEditing(m);else{var Z=m.data,f=m.value,p=n.getSelectBackground(Z),P=K.getEnumValues(Z),o=K.getSlider(Z),M=K.getColorPicker(Z);if(o){var u=yq(yo.Slider,o);return u.setValue(f),u.getView().onblur=function(){n.endEditing()},u.isInstant()&&(u.onValueChanged=function(){n.setValue(Z,K,u.getValue())}),bi(u,m),void 0}if(M||K.getValueType(Z)===tr){var g=yq(yo.ColorPicker,M);return g.setValue(f),g.onClosed=function(){n.endEditing()},g.isInstant()&&(g.onValueChanged=function(_,C){n.setValue(Z,K,C)}),bi(g,m),g.open(),void 0}if(P){if(yo.ComboBox){var k=new yo.ComboBox;k.setValue(f),k.setValues(P),k.setLabels(K.getEnumLabels(Z)),k.setIcons(K.getEnumIcons(Z)),k.setEditable(K.isEnumEditable(Z)),k.setStrict(K.isEnumStrict(Z)),k.setMaxHeight(K.getEnumMaxHeight(Z)),k.setDropDownWidth(K.getEnumDropDownWidth(Z)),k.onClosed=function(){n.endEditing()},bi(k,m),k.open()}else qg(Cm,m,p,P,K);return}var H=K.getValueType(Z);if(H===xo||dk(f))return n.setValue(Z,K,!f),void 0;if(K.getItemEditor(Z)){var O=Tg(K.getItemEditor(Z)),E=new O(Z,K,n,m),r=E.getView();return r._17Q=E,E.setValue(f),tn(r),bi(r,m),E.editBeginning&&E.editBeginning(),void 0}qg("input",m,p,Q,K)}}},_44o:function(T){T.init=function(G){var X=this,I=X.th=new xc(G),o=X._view=Ro(1,X);X.tv=X._tableView=G,Pe(o,I.getView()),Pe(o,G.getView()),I.mp(function(v){v.property===Gh&&X.iv()}),X.iv()},T.getTableView=function(){return this.tv},T.getTableHeader=function(){return this.th},T.getDataModel=function(){return this.tv.dm()},T.getColumnModel=function(){return this.tv.getColumnModel()},T.setColumns=function(S){this.tv.setColumns(S)},T.addColumns=function(j){this.tv.addColumns(j)},T.endEditing=function(){this.tv.endEditing()},T.validateImpl=function(){var K=this,n=K.th,f=Iq(n),D={x:0,y:0,width:K.getWidth(),height:f};Ae(n,D),D.y=f,D.height=x(0,K.getHeight()-f),Ae(K.tv,D)}},ms_vs:function(h){h._41o=function(){return this._29I.height<this._59I},h._43o=function(){var P=this;P._41o()&&(P._58I||(E(function(){P._94O()},Lr),P.iv()),P._58I=new Date)},h._94O=function(){var e=this;if(e._58I){var A=new Date;A.getTime()-e._58I.getTime()>=Lr?(delete e._58I,e.iv()):E(function(){e._94O()},Lr)}},h._93I=function(){var F=this,J=F._27I;if(F._58I||!F._autoHideScrollBar){J||Pe(F._79O,J=F._27I=xq());var n=F._29I,U=n.height,E=F._59I,Q=F.getScrollBarSize(),b=n.width-Q-2,l=U*(-F.ty()/E),C=U*(U/E),c=J.style;E>U?(Nd>C&&(l=l+C/2-Nd/2,0>l&&(l=0),l+Nd>U&&(l=U-Nd),C=Nd),c.visibility=ws,c.background=F.getScrollBarColor(),c.borderRadius=Q/2+ib,Ae(J,b,l,Q,C)):c.visibility=Kl}else J&&(J.style.visibility=Kl)}},ms_hs:function(Q){Q._40o=function(){return this._29I.width<this._91I},Q._42o=function(){var N=this;N._40o()&&(N._95O||(E(function(){N._94I()},Lr),N.iv()),N._95O=new Date)},Q._94I=function(){var v=this;if(v._95O){var I=new Date;I.getTime()-v._95O.getTime()>=Lr?(delete v._95O,v.iv()):E(function(){v._94I()},Lr)}},Q._92I=function(){var L=this,w=L._28I;if(L._95O||!L._autoHideScrollBar){w||Pe(L._79O,w=L._28I=xq());var v=L._29I,O=v.width,T=L._91I,y=L.getScrollBarSize(),S=v.height-y-2,o=O*(-L.tx()/T),_=O*(O/T),e=w.style;T>O?(Nd>_&&(o=o+_/2-Nd/2,0>o&&(o=0),o+Nd>O&&(o=O-Nd),_=Nd),e.visibility=ws,e.background=L.getScrollBarColor(),e.borderRadius=y/2+ib,Ae(w,o,S,_,y)):e.visibility=Kl}else w&&(w.style.visibility=Kl)}}}),Uj(Jo,jp(16,16,[{type:qo,rect:[1,1,14,14],background:hk},{type:$g,rect:[1,1,14,14],width:1,color:yd},{type:$r,points:[13,3,7,12,4,8],borderWidth:2,borderColor:"#FFF"}])),Uj(Ec,jp(16,16,{type:$g,rect:[1,1,14,14],width:1,color:yd})),Uj(Oe,jp(16,16,[{type:td,rect:[2,2,12,12],borderWidth:1,borderColor:yd,background:"#FFF"},{type:td,rect:[4,4,8,8],background:hk}])),Uj(Yb,jp(16,16,{type:td,rect:[2,2,12,12],borderWidth:1,borderColor:yd})),rm._15Q=function(n){n._29I=kg,n._59I=0,n._91I=0,n._5o=function(T){var y=this;y._30I=new xg,y._rows=new xg,y._rowMap={},y._31I=0,y._14I=0,y._view=Ro(1,y),y._canvas=yk(y._view),Pe(y._view,y._79O=xq()),y.dm(T?T:new Se)},n.getCheckIcon=function(h){var M=this.sm(),j=M.co(h);return M.sg()?Lq(j?Oe:Yb):Lq(j?Jo:Ec)},n.checkData=function(t){var U=this.sm(),Q=U.co(t);U.sg()&&Q||(this._32o=1,Q?U.rs(t):U.as(t),delete this._32o)},n.getDataAt=function(m){m.target&&(m=this.lp(m));var H=K(m.y/this._rowHeight),a=this._rows;return 0>H||H>=a.size()?Q:a.get(H)},n.onDataDoubleClicked=function(){},n.onDataClicked=function(){},n.adjustTranslateX=function(){return 0},n.adjustTranslateY=function(M){var K=this.getHeight()-this._59I;return K>M&&(M=K),M>0?0:U(M)},n.onPropertyChanged=function(C){var j=this,c=C.property;Co[c]?j.ivm():uk[c]||j.redraw(),c===tb?j._42o():c===zl&&j._43o()},n.getLabel=function(u){return u.toLabel()},n.getLabelFont=function(){return this._labelFont},n.getLabelColor=function(t){var B=this;if(B.isCheckMode()){if(B._focusData===t)return B._labelSelectColor}else if(B.isSelected(t))return B._labelSelectColor;return B._labelColor},n.getStartRowIndex=function(){return this._31I},n.getEndRowIndex=function(){return this._14I},n.getRowDatas=function(){return this._rows},n.getRowIndex=function(U){return this._rowMap[U._id]},n.getRowSize=function(){return this._rows.size()},n.getViewRect=function(){return Hp(this._29I)},n.isVisible=function(E){return this._visibleFunc?this._visibleFunc(E):!0},n.getCurrentSortFunc=function(){return this._sortFunc},n.setDataModel=function(b){var r=this,U=r._dataModel,A=r._selectionModel;U!==b&&(U&&(U.umm(r.handleDataModelChange,r),U.umd(r.handleDataPropertyChange,r),U.umh(r.handleHierarchyChange,r),A||U.sm().ums(r.handleSelectionChange,r)),r._dataModel=b,b.mm(r.handleDataModelChange,r),b.md(r.handleDataPropertyChange,r),b.mh(r.handleHierarchyChange,r),A?A._21I(b):b.sm().ms(r.handleSelectionChange,r),r.fp("dataModel",U,b))},n.validateModel=function(){var $=this;$._rows.clear(),$._rowMap={},$.buildChildren($._dataModel._roots);var d=$._rows=$._rows.toList($.isVisible,$),i=0,z=$.getCurrentSortFunc(),a=d.size();for(z&&d.sort(z);a>i;i++)$._rowMap[d.get(i)._id]=i},n.buildChildren=function(c){var F=this;c.each(function(t){F._rows.add(t),F.buildChildren(t._children)})},n.handleDataModelChange=function(){this.ivm()},n.handleDataPropertyChange=function(a){"parent"===a.property?this.ivm():this.invalidateData(a.data)},n.handleHierarchyChange=function(){this.ivm()},n.handleSelectionChange=function(n){n.datas.each(this.invalidateData,this),this.onSelectionChanged(n)},n.onSelectionChanged=function(m){var X=this,n=X.sm();!X.isAutoMakeVisible()||1!==n.size()||"set"!==m.kind&&"append"!==m.kind||X._32o||X.makeVisible(n.ld())},n.handleBackgroundClick=function(A){gf(A)&&!this.isCheckMode()&&this.sm().cs()},n.makeVisible=function(r){r&&(this._23I=r,this.iv())},n.scrollToIndex=function(X){var u=this,F=u._29I,W=F.height,K=u._rowHeight,b=K*X;X>=0&&X<u._rows.size()&&W>0&&(b+K>F.y+W?u.ty(-b+W-K):b<F.y&&u.ty(-b))},n.autoScroll=function(R,W){var j=this,m=j._rowHeight,B=m,o=m/4,C=j._29I,c=j.lp(R),M={x:j.tx(),y:j.ty()};return m>0&&C&&(c.x-C.x<B?j.translate(o,0):C.x+C.width-c.x<B&&j.translate(-o,0),c.y-C.y<B?j.translate(0,o):C.y+C.height-c.y<B&&j.translate(0,-o)),M.x=j.tx()-M.x,M.y=j.ty()-M.y,W&&(W.x+=M.x,W.y+=M.y),M},n.getTopRowOrderSelection=function(){var j=this.sm().getTopSelection(),X={},H=new xg;return j.each(function(x){X[x._id]=x}),this._rows.each(function(p){X[p._id]&&H.add(p)}),H},n.getRowOrderSelection=function(){var h=new xg;return this._rows.each(function(Q){this.isSelected(Q)&&h.add(Q)},this),h},n.ivm=function(){this.invalidateModel()},n.invalidateModel=function(){var R=this;R._96I||(R._96I=1,R._32I=1,delete R._24I),R.iv()},n.redraw=function(){var W=this;W._32I||(W._32I=1,delete W._24I,W.iv())},n.invalidateData=function(M){var P=this;W?P.redraw():P._32I||(P._24I||(P._24I={}),P._24I[M._id]=M,P.iv())},n.getFocusData=function(){return this._focusData},n.setFocusDataById=function($){this.setFocusData(this.dm().getDataById($))},n.setFocusData=function(A){var K=this,y=K._focusData;y!==A&&(K._focusData=A,K.fp("focusData",y,A),y&&K.invalidateData(y),A&&(K.invalidateData(A),K.isAutoMakeVisible()&&K.makeVisible(A)))},n.drawRowBackground=function(a,I,d,O,q,P,X){var j=this,Q=j.isCheckMode();(I===j._focusData&&Q||d&&!Q)&&nl(a,O,q,P,X,j.getSelectBackground(I))},n.drawData=function(v,p,b){var t=this,e=t._rowHeight,Q=e*b,f=t._29I,$=f.x,R=f.width;v.save(),v.beginPath(),v.rect($,Q,R,e),v.clip(),t._87o(t.drawRow(v,p,t.isSelected(p),$,Q,R,e),b,$,Q,R,e),v.restore(),t._rowLineVisible&&nl(v,$,Q+e-1,R,1,t._rowLineColor)},n._12I=function(a){var z=this,y=z._31I,n=z._29I,R=n.x,r=n.y,D=n.width,d=n.height;for(a.beginPath(),a.rect(R,r,D,d),a.clip(),a.clearRect(R,r,D,d),z._76o(),z._93db(a);y<z._14I;y++)z.drawData(a,z._rows.get(y),y);z._92db(a)},n._13I=function(S){for(var t,E=this,U=E._rowHeight,N=E._29I,v=N.x,y=N.width,m=E._31I,V=E._30I;m<E._14I;m++)t=E._rows.get(m),E._24I[t._id]&&V.add({data:t,index:m});V.isEmpty()||(S.beginPath(),V.each(function(s){S.rect(v,s.index*U,y,U)}),S.clip(),V.each(function(n){S.clearRect(v,n.index*U,y,U)}),V.each(function(q){E._77o(q.index)}),E._93db(S),V.each(function(j){E.drawData(S,j.data,j.index)}),E._92db(S),V.clear())},n.validateImpl=function(){var _=this,X=_._canvas,V=_.getWidth(),W=_.getHeight(),l=_._rowHeight,D=_._32I;(V!==X.clientWidth||W!==X.clientHeight)&&(vh(X,V,W),D=1);var h=a&&!Z;_._96I&&!h&&_.validateModel();var Y=_._29I,R={x:-_.tx(),y:-_.ty(),width:V,height:W},y=_._rows.size(),e=ro(X),E=_._23I;D||zm(R,Y)||(D=1),_._29I=R,_._59I=y*l,_._31I=K(R.y/l),_._14I=G((R.y+R.height)/l),_._31I<0&&(_._31I=0),_._14I>y&&(_._14I=y),_._99I&&D&&_._99I(),Hd(e,_.tx(),_.ty(),1),D?_._12I(e):_._24I&&_._13I(e),_._93I(),_._92I(),e.restore(),_._32I=_._24I=_._96I=Q,E&&(_.scrollToIndex(_.getRowIndex(E)),delete _._23I),_.tx(_.tx()),_.ty(_.ty())}},rm._48o=function(I){I._rootVisible=!0,I._rootData=Q,I._35o=function(){this._expandMap={},this._levelMap={}},I.validateModel=function(){var x=this,W=x._rootData;x._rows.clear(),x._levelMap={},x._rowMap={},x._currentLevel=0,W?x._rootVisible?x.isVisible(W)&&x.buildData(W):x.buildChildren(W):x.buildChildren(),delete x._currentLevel},I.buildData=function(y){var W=this,v=y._id,d=W._rows;W._rowMap[v]=d.size(),d.add(y),W._levelMap[v]=W._currentLevel,W.isExpanded(y)&&(W._currentLevel++,W.buildChildren(y),W._currentLevel--)},I.buildChildren=function(P){var q=this,n=P?P._children:q._dataModel._roots,D=q.getCurrentSortFunc();D&&q.isChildrenSortable(P)?n.toList(q.isVisible,q).sort(D).each(q.buildData,q):n.each(function(L){q.isVisible(L)&&q.buildData(L)})},I.getLevel=function(G){return this._levelMap[G._id]},I.getToggleIcon=function(e){var I=this,N=I._loader,Z=I._collapseIcon;return N&&!N.isLoaded(e)?Z:e.hasChildren()?I.isExpanded(e)?I._expandIcon:Z:Q},I.isCheckMode=function(){return this._checkMode!=Q},I.isChildrenSortable=function(){return!0},I.handleDataModelChange=function(x){var y=this;x.kind===Qn?delete y._expandMap[x.data._id]:x.kind===Kg&&(y._expandMap={}),y.ivm()},I.toggle=function(Y){var F=this;F.isExpanded(Y)?F.collapse(Y):F.expand(Y)},I.isExpanded=function(M){return 1===this._expandMap[M._id]},I.expand=function(z){var S=this,m=S._loader;S.isExpanded(z)||(m&&!m.isLoaded(z)&&m.load(z),S._expandMap[z._id]=1,S.ivm(),S.onExpanded(z))},I.onExpanded=function(){},I.collapse=function(W){var n=this;n.isExpanded(W)&&(delete n._expandMap[W._id],n.ivm(),n.onCollapsed(W))},I.onCollapsed=function(){},I.expandAll=function(X){if(X)this.expand(X),X.eachChild(function(L){this.expandAll(L)},this);else{var l=this;l._dataModel.each(function(L){L.hasChildren()&&(l._expandMap[L._id]=1)}),l.ivm()}},I.collapseAll=function(){this._expandMap={},this.ivm()},I.makeVisible=function(V){if(V){var O=this;if(!O._rootData||V.isDescendantOf(O._rootData)){for(var t=V._parent;t;)O.expand(t),t=t._parent;O._23I=V,O.iv()}}},I.checkData=function(x){var q,R=this,k=R._checkMode,K=R.sm(),e=K.co(x);if(!K.sg()||!e){if(R._32o=1,k===Eq)e?K.rs(x):K.as(x);else if(k===Jm)q=new xg(x),q.addAll(x._children);else if("descendant"===k)q=new xg,wr(x,q);else if("all"===k&&(q=new xg,wr(x,q),!e))for(var U=x._parent;U;)q.add(U),U=U._parent;q&&(e?K.rs(q):K.as(q)),delete R._32o}},I._97I=function(z,T,K,W,E,v,o){var p=this,f=p._indent,H=p._levelMap[T._id],R=p.getIconWidth(T),C=Lq(p.getToggleIcon(T));C?(W+=f*H,as(z,C,W+f/2,E+o/2,T,p),W+=f):W+=f*(H+1),p._checkMode&&(as(z,p.getCheckIcon(T),W+f/2,E+o/2,T,p),W+=f),p.drawIcon(z,T,W,E,R,o),p.drawLabel(z,T,W+R,E,o)}},rm._14Q=function(d){d.getIcon=function(B){return B.getIcon()},d.getIconWidth=function(i){return this.getIcon(i)?this._indent:0},d.drawIcon=function(G,A,x,i,H,y){if(H){var N=this,P=N.getBodyColor(A),L=Lq(N.getIcon(A),P);L&&(y-=N.isRowLineVisible()?1:0,Cq(G,L,xn,x,i,H,y,A,N,P),zd(G,N.getBorderColor(A),x,i,H,y))}},d.drawLabel=function(W,i,$,b,n){var E=this;re(W,E.getLabel(i),E.getLabelFont(i),E.getLabelColor(i),$,b,0,n)}},rm._50o=function(I){I._98I=function(){var m=this,s=m._39o=new Se;m._60I=new xg,s.mm(m._17o,m),s.md(m._18o,m),s.mh(m._19o,m)},I.setColumns=function(d){this._39o.clear(),this.addColumns(d)},I.addColumns=function(P){var I=this._39o;P.forEach(function(e){if(!(e instanceof oi)){var f=Tg(e.className);e=yq(f?f:oi,e)}I.add(e)})},I.onColumnClicked=function(){},I.onCheckColumnClicked=function(){},I._3Q=function(i){for(var P,V=0,n=this._60I,p=n.size();p>V;V++)if(P=n.get(V),P.column===i)return P;return Q},I.getColumnAt=function(t){var j=this._4Q(t);return j?j.column:Q},I._4Q=function(U){for(var R=this,V=U.target?R.lp(U).x:U.x,e=R._60I,w=0;w<e.size();w++){var Z=e.get(w),F=Z.startX;if(V>=F&&V<F+Z.column.getWidth())return Z}return Q},I.getToolTip=function(m){var J=this,b=J.getDataAt(m),p=J.getColumnAt(m);return b&&p?p.getToolTip(b,J):Q},I.adjustTranslateX=function(Q){var z=this.getWidth()-this._91I;return z>Q&&(Q=z),Q>0?0:U(Q)},I._99I=function(){var k=this,z=k._29I,m=k._60I;m.clear(),k._91I=0,k._39o._roots.each(function(s){if(s.isVisible()){var O=k._91I+s.getWidth();k._91I<=z.x+z.width&&O>=z.x&&m.add({column:s,startX:k._91I}),k._91I=O}})},I.drawData=function(O,v,L){var c=this,Y=c._rowHeight,p=Y*L,i=c.isSelected(v),X=c._29I,Q=X.x,W=X.width;c.drawRowBackground(O,v,i,Q,p,W,Y),c._60I.each(function(E){var U=E.column,k=E.startX,s=U.getWidth();s>0&&!c.isEditing(v,U)&&(O.save(),O.beginPath(),O.rect(k,p,s,Y),O.clip(),c._87o(c.drawCell(O,v,i,U,k,p,s,Y),L,k,p,s,Y),c._columnLineVisible&&nl(O,k+s-1,p,1,Y,c._columnLineColor),O.restore())}),c._rowLineVisible&&nl(O,Q,p+Y-1,W,1,c._rowLineColor)},I.drawCell=function(g,u,T,B,n,L,I,S){var k=this;if(B.drawCell)return B.drawCell(g,u,T,B,n,L,I,S,k);var h=k.getValue(u,B);Ie(g,h,B,k.getLabelFont(u,B,h),k.getLabelColor(u,B,h),n,L,I,S,u,k)},I.getColumnModel=function(){return this._39o},I._17o=function(){this.redraw()},I._18o=function(T){var m=this;T.data===m._sortColumn&&ah[T.property]?m.ivm():(m._42o(),m.redraw())},I._19o=function(){this.redraw()},I.getCurrentSortFunc=function(){var U=this,u=U._sortColumn;if(u&&u.isSortable()){var Z=u.getSortFunc(),x=Fn===u.getSortOrder()?1:-1;return Z||(Z=br),function(i,K){return Z.call(U,U.getValue(i,u),U.getValue(K,u),i,K)*x}}return U._sortFunc},I.isCellEditable=function(v,p,W){return(!this.isCheckMode()&&this.isSelected(v)||this.isCheckMode()&&v===this._focusData)&&p.isEditable()&&this.isEditable()?p.isCellEditable?p.isCellEditable(v,p,W,this):!0:!1},I._37O=function(x,t){if(gf(t))for(var p=this,u=p.lp(t),y=p._60I,s=p._rowHeight,Y=p._29I,M=Y.x,w=Y.y,U=Y.width,Z=Y.height,N=0;N<y.size();N++){var _=y.get(N),e=_.startX,j=_.column,$=j.getWidth();if(j!==p._31o&&j!==p._4o&&u.x>=e&&u.x<e+$&&p.isCellEditable(x,j,t)){var H={x:e,y:p.getRowIndex(x)*s,width:$,height:s},l={x:H.x+p.tx(),y:H.y+p.ty(),width:H.width,height:H.height},o=0,X=0;return H.x<M?o=H.x-M:H.x+H.width>M+U&&(o=H.x+H.width-M-U),o&&(p.tx(p.tx()-o),l.x-=o),H.y<w?X=H.y-w:H.y+s>w+Z&&(X=H.y+s-w-Z),X&&(p.ty(p.ty()-X),l.y-=X),p.beginEditing({data:x,column:j,value:p.getValue(x,j),event:t,rect:H,editorRect:l,view:p}),void 0}}}},yo.BaseItemEditor=function(U,l,F,z){this._data=U,this._column=l,this._master=F,this._editInfo=z},Dm("BaseItemEditor",_,{ms_ac:["data","column","master","editInfo"],editBeginning:function(){},getView:function(){},getValue:function(){},setValue:function(){}});var ij=R.Tab=function(){ym(ij,this)};Ak("Tab",Sc,{ms_ac:["view","closable","disabled"],_icon:Q,_closable:!1,_disabled:!1,setParent:_d});var oi=R.Column=function(){ym(oi,this)};Ak("Column",Sc,{_46o:1,ms_ac:["accessType","valueType",ws,ar,Hk,Eb,"align",tr,"sortOrder",fj,"sortable","clickable","nullable","emptiable","slider","colorPicker","itemEditor"],_visible:!0,_width:80,_sortOrder:Fn,_sortFunc:Q,_sortable:!0,_clickable:!0,setWidth:function(j){16>j&&(j=16);var D=this._width;this._width=j,this.fp(Eb,D,j)},getToolTip:function(z,D){return this.formatValue(D.getValue(z,this))}});var jc=R.Property=function(){ym(jc,this)};Ak("Property",Sc,{_46o:1,ms_ac:["accessType","valueType",ar,Hk,"categoryName",tr,"align","nullable","emptiable","slider","itemEditor","colorPicker"],_categoryName:Q,getToolTip:function(X,E,R){var Y=this;return E?Y.formatValue(R.getValue(X,Y)):R.getPropertyName(Y)}}),yo.AccordionView=function(){var h=this;h._20o={},h._21o=new xg,h._10o=Q,h._9o=Q,h._11o=Q,h._view=Ro(0,h),h.iv()},Dm("AccordionView",_,{ms_v:1,ms_fire:1,ms_ac:[Wl,Wg,"titleHeight",En,Cf,"titleBackground","selectWidth",Hq,"orientation","separatorColor"],_expandIcon:p.accordionViewExpandIcon,_collapseIcon:p.accordionViewCollapseIcon,_titleHeight:Wk,_labelColor:p.accordionViewLabelColor,_labelFont:p.accordionViewLabelFont,_titleBackground:p.accordionViewTitleBackground,_selectBackground:p.accordionViewSelectBackground,_selectWidth:p.accordionViewSelectWidth,_orientation:"v",_separatorColor:p.accordionViewSeparatorColor,onPropertyChanged:function(){this.iv()},getView:function(){return this._view},getTitles:function(){return this._21o},getCurrentTitle:function(){return this._10o},add:function(n,c,V,S){var Z=this,O=xq();if(Z._20o[n])throw n+" already exists";O.onmousedown=Hm,O.style.cursor=Fl,O.addEventListener(sg?mk:vc,function(X){Hm(X)},!1),O.addEventListener(sg?$n:ii,function(U){Hm(U),gf(U)&&(Z._10o===n?Z.collapse():Z.expand(n))},!1),Pe(Z._view,O),Z._20o[n]={content:c,div:O,canvas:yk(O),icon:S},Z._21o.add(n),V&&Z.expand(n),Z.iv()},remove:function(i){var E=this,z=E._20o[i];z&&(qh(z.div),delete E._20o[i],E._21o.remove(i),E.iv())},clear:function(){var y=this;y._20o={},y._21o.clear(),y.iv()},isExpanded:function(t){return this._10o===t},expand:function(E){var d=this;d._20o[E]&&d._10o!==E&&(d._10o=E,d.onExpanded(E),d.iv())},onExpanded:function(){},collapse:function(){var I=this;I._10o&&(I.onCollapsed(I._10o),delete I._10o,I.iv())},onCollapsed:function(){},initCanvas:function(w,R,a){vh(w,R,a);var y=ro(w);return Hd(y,0,0,1),y.clearRect(0,0,R,a),y},drawTitle:function(Z,q,o,M,r){var k=this,Y=Lq(r.icon),S=k.isExpanded(q),g=k._titleHeight,D=k._titleBackground,x=k._selectWidth,d=k._separatorColor,y=Lq(S?k._expandIcon:k._collapseIcon),W=x+4;nl(Z,0,0,o,M,D),S&&x&&nl(Z,0,0,x,M,k._selectBackground),(S||k._21o.get(k._21o.size()-1)!==q)&&nl(Z,0,M-1,o,1,d?d:ae(D)),Y&&(as(Z,Y,W+ki(Y)/2,g/2),W+=ki(Y)+2),re(Z,q,k.getLabelFont(q),k.getLabelColor(q),W,0,0,g),y&&as(Z,y,o-ki(y)/2-4,g/2)},validateImpl:function(){var N=this,l=N._view,d=0,I=0,T=N.getWidth(),p=N.getHeight(),U=N._titleHeight,B=N._21o.size()*U,J=N._11o,V=N._9o;delete N._11o,delete N._9o,N._21o.each(function(s){var o,M,l=N._20o[s],j=l.content,w=N._10o===s;wf(N)?(Ae(l.div,d,0,U,p),o=N.initCanvas(l.canvas,U,p),Np(o,0,p),ef(o,-y),N.drawTitle(o,s,p,U,l),o.restore(),w?(M=x(0,T-B),j&&(N._11o=j,N._9o=Tr(j),Ae(j,d+U,0,M,p)),d+=U+M):d+=U):(Ae(l.div,0,I,T,U),o=N.initCanvas(l.canvas,T,U),N.drawTitle(o,s,T,U,l),o.restore(),w?(M=x(0,p-B),j&&(N._11o=j,N._9o=Tr(j),Ae(j,0,I+U,T,M)),I+=U+M):I+=U)});var q=N._9o;J&&J!==N._11o&&J.endEditing&&J.endEditing(),q&&q!==V&&Pe(l,q),V&&V!==q&&qh(V)}}),yo.SplitView=function(f,x,V,t){var s=this,N=s._dividerDiv=xq(),p=s._60O=yk(),J=s._61O=yk(),F=p.style,X=J.style;s._view=Ro(1,s),Pe(s._view,N),F.msTouchAction=Up,F.pointerEvents=Up,F.cursor=Fl,X.msTouchAction=Up,X.pointerEvents=Up,X.cursor=Fl,f&&s.setLeftView(f),x&&s.setRightView(x),V&&s.setOrientation(V),t!=Q&&s.setPosition(t),s.setStatus(er),new hj(s)},Dm("SplitView",_,{ms_v:1,ms_fire:1,ms_ac:["continuousLayout","dividerSize","dividerBackground","toggleIcon","togglable","dragOpacity","orientation","draggable","status"],_continuousLayout:!1,_position:.5,_togglable:!0,_orientation:"h",_draggable:!0,_dividerSize:p.splitViewDividerSize,_dividerBackground:p.splitViewDividerBackground,_dragOpacity:p.splitViewDragOpacity,_toggleIcon:p.splitViewToggleIcon,onPropertyChanged:function(){this.iv()},getDividerDiv:function(){return this._dividerDiv},getPosition:function(){return this._position},setPosition:function(z,s){var Y=this,w=Y._position;isNaN(z)||(s||(Y._82O=0>z?-1:z>1?1:0),Y._position=z,Y.fp(Ip,w,z))},getLeftView:function(){return this._leftView},setLeftView:function(C){var I=this,z=I._leftView,A=I._view;if(I._leftView!==C){if(z&&z!==I._rightView){var k=Tr(z);k.parentNode===A&&qh(k)}if(I._leftView=C,C){var Q=Tr(C);
Q.parentNode!==A&&A.insertBefore(Q,I._dividerDiv)}I.fp("leftView",z,C)}},getRightView:function(){return this._rightView},setRightView:function(j){var g=this,d=g._rightView,K=g._view;if(g._rightView!==j){if(d&&d!==g._leftView){var k=Tr(d);k.parentNode===K&&qh(k)}if(g._rightView=j,j){var W=Tr(j);W.parentNode!==K&&K.insertBefore(W,g._dividerDiv)}g.fp("rightView",d,j)}},validateImpl:function(){var M=this,v=M._draggable,z=M._position,u=M.getWidth(),D=M.getHeight(),G=M._dividerSize,c=M._dividerBackground,g=sg?18:8,o=M._dividerDiv,A=M._82O,C=M._60O,j=M._61O,a=M._toggleIcon,N=M._status,w=o.style,q=null,$=sg?20:4,Q=a.comps[0];G>=g||0===G?M._coverDiv&&(qh(M._coverDiv),delete M._coverDiv):M._coverDiv||(M._coverDiv=xq(),b&&(M._coverDiv.style.background=_i),Pe(o,M._coverDiv)),M._togglable?C.parentNode||(Pe(o,C),Pe(o,j)):(qh(C),qh(j));var l=M._coverDiv,T=M._leftView,h=M._rightView;if(wf(M)){if(G>u&&(G=u),N===er)if(1===A)var W=k(z,u),P=x(0,u-G-W);else-1===A?(P=k(-z,u),W=x(0,u-G-P)):(W=U((u-G)*z),P=x(0,u-G-W));else"cl"===N?(W=0,P=x(0,u-G)):"cr"===N&&(P=0,W=x(0,u-G));T&&Ae(T,0,0,W,D),h&&Ae(h,W+G,0,P,D),Ae(o,W,0,G,D),M._22o=W,l&&(Ae(l,G/2-g/2,0,g,D),l.style.cursor=v?kf:""),o.style.cursor=v?kf:"";var p=o.clientHeight/2,Z=o.clientWidth;vh(C,Z,Z),Ae(C,0,p-Z-$,Z,Z),q=ro(C),Hd(q,0,0,1),Q.rotation=-y,Df(q,a,0,0,Z,Z),q.restore(),vh(j,Z,Z),Ae(j,0,p+$,Z,Z),q=ro(j),Hd(q,0,0,1),Q.rotation=y,Df(q,a,0,0,Z,Z),q.restore()}else{if(G>D&&(G=D),N===er)if(1===A)var V=k(z,D),R=x(0,D-G-V);else-1===A?(R=k(-z,D),V=x(0,D-G-R)):(V=U((D-G)*z),R=x(0,D-G-V));else"cl"===N?(V=0,R=x(0,D-G)):"cr"===N&&(R=0,V=x(0,D-G));T&&Ae(T,0,0,u,V),h&&Ae(h,0,V+G,u,R),Ae(o,0,V,u,G),M._22o=V,l&&(Ae(l,0,G/2-g/2,u,g),l.style.cursor=v?Xm:""),w.cursor=v?Xm:"";var O=o.clientWidth/2,Z=o.clientHeight;vh(C,Z,Z),Ae(C,O-Z-$,0,Z,Z),q=ro(C),Hd(q,0,0,1),Q.rotation=0,Df(q,a,0,0,Z,Z),q.restore(),vh(j,Z,Z),Ae(j,O+$,0,Z,Z),q=ro(j),Hd(q,0,0,1),Q.rotation=s,Df(q,a,0,0,Z,Z),q.restore()}w.background=c}});var hj=function(s){this.sv=s,this.addListeners()};jh(hj,_,{ms_listener:1,getView:function(){return this.sv.getView()},handle_touchstart:function(D){var U=this,m=U.sv,$=m._dividerDiv,p=m._60O,R=m._61O,L=m._status,j=D.target;if(j===p)L===er?m.setStatus("cl"):"cr"===L&&m.setStatus(er);else if(j===R)L===er?m.setStatus("cr"):"cl"===L&&m.setStatus(er);else if(ur(D)&&(j===$||j===m._coverDiv)&&(Hm(D),m.isDraggable())){m.getLeftView(),m.getRightView();var d=U.maskDiv=xq();if(d.style.left=0,d.style.top=0,d.style.width=m.getWidth()+"px",d.style.height=m.getHeight()+"px",m.getView().appendChild(d),!m.isContinuousLayout()){var e=U.resizeDiv=xq();e.style.left=$.style.left,e.style.top=$.style.top,e.style.width=$.style.width,e.style.height=$.style.height,e.style.opacity=m.getDragOpacity(),e.style.background=m.getDividerBackground(),Pe(U.getView(),e)}U._lastAbsPosition=m._22o,U._86o=wf(m)?ko(D).x:ko(D).y,ep(U,D)}},handleWindowTouchMove:function(Y){ur(Y)&&this.update(Y,this.sv.isContinuousLayout())},handleWindowTouchEnd:function(z){var p=this;p.update(z,!0),p.sv.setStatus(er),p.maskDiv&&qh(p.maskDiv),p.resizeDiv&&qh(p.resizeDiv),p.maskDiv=p.resizeDiv=Q},handle_mousedown:function(q){gf(q)&&this.handle_touchstart(q)},handleWindowMouseMove:function(k){this.handleWindowTouchMove(k)},handleWindowMouseUp:function(Y){this.handleWindowTouchEnd(Y)},update:function(X,e){var P=this,R=P.sv,N=wf(R)?R.getWidth():R.getHeight(),g=R._dividerSize,K=P._lastAbsPosition-P._86o;wf(R)?(K+=ko(X).x,K>N-g&&(K=N-g),0>K&&(K=0),P.resizeDiv&&(P.resizeDiv.style.left=K+ib)):(K+=ko(X).y,K>N-g&&(K=N-g),0>K&&(K=0),P.resizeDiv&&(P.resizeDiv.style.top=K+ib)),e&&N!==g&&(1===R._82O?R.setPosition(K,1):-1===R._82O?R.setPosition(K-N+g,1):R.setPosition(K/(N-g),1))}}),yo.TabView=function(){var U=this,N=U._view=Ro(1,U),S=U._91O=xq(1),X=U._tabModel=new Se,L=X.sm(),z=U.invalidate;U._7o=new xg,U._canvas=yk(S),Pe(N,S),Pe(N,U._92O=xq(1)),L.setSelectionMode(pb),L.ms(z,U),X.mm(z,U),X.md(z,U),X.mh(z,U),new Tf(U),U.iv()},Dm("TabView",_,{ms_v:1,ms_fire:1,ms_tx:1,ms_ty:1,ms_lp:1,ms_ac:["movable","tabGap","tabHeight","tabPosition",En,Cf,"tabBackground","selectWidth",Hq,"moveBackground","insertColor"],_tabPosition:fk,_tabHeight:Wk,_tabGap:p.tabViewTabGap,_labelColor:p.tabViewLabelColor,_labelFont:p.tabViewLabelFont,_tabBackground:p.tabViewTabBackground,_selectWidth:p.tabViewSelectWidth,_selectBackground:p.tabViewSelectBackground,_moveBackground:p.tabViewMoveBackground,_insertColor:p.tabViewInsertColor,_movable:!0,getContentDiv:function(){return this._92O},getTitleDiv:function(){return this._91O},getTabModel:function(){return this._tabModel},add:function(k,W,b){var U=new ij,B=this._tabModel;return U.setName(k),U.setView(W),B.add(U),b&&B.sm().ss(U),U},getLabel:function(x){return x.toLabel()},onPropertyChanged:function(){this.iv()},_7Q:function(c){this._23o=c,this.iv()},get:function(S){var T=this,M=T._tabModel;if(Nr(S))return M._roots.get(S);if(Pf(S)){var x;return M.each(function(I){S===T.getLabel(I)&&(x=I)}),x}return S instanceof ij?S:Q},select:function(c){this._tabModel.sm().ss(this.get(c))},remove:function(t){var p=this;if(t=p.get(t)){var a=p._tabModel,i=a._roots.indexOf(t);p._tabModel.remove(t),p._12Q(--i)}},getCurrentTab:function(){return this._8o},hideTabView:function(m,S){S.parentNode===this._92O&&(Pq(S)?(S.style.display=lp,S._tab_=m):qh(S),Ek())},showTabView:function(i,K){Pq(K)&&(K.style.display="block",K._tab_=i),K.parentNode!==this._92O&&(Pe(this._92O,K),Ek())},_24o:function(){var s,Q=this,I=Q._8o,X=Q._9o,z=Q._tabModel.sm().ld();z&&(s=Tr(z.getView())),s!==X&&(X&&(I.getView()&&I.getView().endEditing&&I.getView().endEditing(),Q.hideTabView(I,X)),s&&Q.showTabView(z,s)),Q._8o=z,Q._9o=s,I!==z&&Q.onTabChanged(I,z)},onTabClosing:function(){return!0},onTabChanged:function(){},onTabClosed:function(j,b){this._12Q(--b)},_12Q:function(n){var W=this,K=W._tabModel,k=K.size();if(k&&!K.sm().ld()){n==Q&&(n=0),n>=k&&(n=k-1),0>n&&(n=0);for(var d=n;d>=0;d--){var j=W.get(d);if(!j.isDisabled())return W.select(j),j}for(d=n+1;k>d;d++)if(j=W.get(d),!j.isDisabled())return W.select(j),j}},getTabWidth:function(v){var Y=4,$=Lq(v.getIcon());$&&(Y+=ki($,v)+4);var e=this.getLabel(v);return e&&(Y+=vr(this.getLabelFont(v),e).width+4),v.isClosable()&&(Y+=10),Y},drawTab:function(f,i,L,z,c,d,p){var _,q=this,m=q._tabPosition,t=L+4,D=q._selectWidth,e=Lq(i.getIcon()),H=i.isDisabled(),W=q.getLabelColor(i),G=q.getLabelFont(i),r=q.getLabel(i),O=q._selectBackground,v=m===Um+"-vertical",C=m===Xl+"-vertical";(v||C)&&(t=z+4),H&&(f.globalAlpha=Bs),nl(f,L,z,c,d,p),i===q._8o&&D&&(m===fk?nl(f,L,z+d-D,c,D,O):m===Um?nl(f,L+c-D,z,D,d,O):m===Xl?nl(f,L,z,D,d,O):v?nl(f,L+c-D,z,D,d,O):C?nl(f,L,z,D,d,O):nl(f,L,z,c,D,O));var F=c/2;if(v&&(Np(f,F,z+d/2),ef(f,s),Np(f,-F,-z-d/2)),e){var P=Xe(e,i),n=ki(e,i);if(v||C){var U=L+c/2,u=t+P/2;Np(f,U,u),ef(f,y),Np(f,-U,-u),as(f,e,L+c/2,t+P/2,i,q),Np(f,U,u),ef(f,-y),Np(f,-U,-u),t+=P+4}else as(f,e,t+n/2,z+d/2,i,q),t+=n+4}return v||C?(Np(f,c/2,t+c/2),ef(f,y),Np(f,-c/2,-t-c/2),re(f,r,G,W,L,t,d,c),Np(f,c/2,t+c/2),ef(f,-y),Np(f,-c/2,-t-c/2)):re(f,r,G,W,t,z,c,d),v&&(Np(f,F,z+d/2),ef(f,-s),Np(f,-F,-z-d/2)),i.isClosable()&&(_=C?{x:L+c-12,y:z+d-12,width:12,height:12}:{x:L+c-12,y:z+2,width:12,height:12},this.drawCloseIcon(i,f,W,_)),H&&(f.globalAlpha=1),_},drawCloseIcon:function(b,s,S,M){var R=M.x,Y=M.y;s.strokeStyle=S,s.lineWidth=1,s.beginPath(),s.moveTo(R+2,Y+8),s.lineTo(R+8,Y+2),s.moveTo(R+8,Y+8),s.lineTo(R+2,Y+2),s.stroke()},validateImpl:function(){var g=this;g._24o();var K,T=g._canvas,s=g._tabPosition,E=g._91O,H=g._92O,p=g._tabModel,c=g.getWidth(),r=g.getHeight(),k=g._tabHeight,f=g._7o,A=g._tabGap,U=s===fk,X=s===Um,B=s===Xl,j=s===Um+"-vertical",q=s===Xl+"-vertical",N=g._23o,Z=0;if((X||B)&&p._roots.each(function(A){Z=x(g.getTabWidth(A),Z)}),U?(Ae(E,0,0,c,k),K={x:0,y:k,width:c,height:x(0,r-k)}):X?(Ae(E,0,0,Z,r),K={x:Z,y:0,width:x(0,c-Z),height:r}):B?(Ae(E,c-Z,0,Z,r),K={x:0,y:0,width:x(0,c-Z),height:r}):j?(Ae(E,0,0,k,r),K={x:k,y:0,width:x(0,c-k),height:r}):q?(Ae(E,c-k,0,k,r),K={x:0,y:0,width:x(0,c-k),height:r}):(Ae(E,0,r-k,c,k),K={x:0,y:0,width:c,height:x(0,r-k)}),Ae(H,K),j||q){g._9o&&(K.x=0,Ae(g._8o.getView(),K)),vh(T,k,r);var u=ro(T),M=0;if(Hd(u,0,g.ty(),1),u.clearRect(0,0,k,r),f.clear(),p._roots.each(function(s){var F,w=g.getTabWidth(s);N&&N.tab===s||(F=g.drawTab(u,s,0,M,k,w,g._tabBackground)),f.add({_75o:F,tab:s,startY:M,endY:M+w,height:w}),M+=w+A}),g._23Q=x(0,M-A),N){var w=N.position;g.drawTab(u,N.tab,0,N.startY,k,N.height,g._moveBackground),nl(u,0,w,k,1,g._insertColor)}u.restore(),g.ty(g.ty())}else if(X||B){g._9o&&(K.x=0,Ae(g._8o.getView(),K)),vh(T,Z,r);var u=ro(T),M=0;if(Hd(u,0,g.ty(),1),u.clearRect(0,0,Z,r),f.clear(),p._roots.each(function(h){var I;N&&N.tab===h||(I=g.drawTab(u,h,0,M,Z,k,g._tabBackground)),f.add({_75o:I,tab:h,startY:M,endY:M+k,height:k}),M+=k+A}),g._23Q=x(0,M-A),N){var w=N.position;g.drawTab(u,N.tab,0,N.startY,Z,N.height,g._moveBackground),nl(u,0,w,Z,1,g._insertColor)}u.restore(),g.ty(g.ty())}else{g._9o&&(K.y=0,Ae(g._8o.getView(),K)),vh(T,c,k);var u=ro(T),m=0;if(Hd(u,g.tx(),0,1),u.clearRect(0,0,c,k),f.clear(),p._roots.each(function(y){var O,W=g.getTabWidth(y);N&&N.tab===y||(O=g.drawTab(u,y,m,0,W,k,g._tabBackground)),f.add({_75o:O,tab:y,startX:m,endX:m+W,width:W}),m+=W+A}),g._64I=x(0,m-A),N){var w=N.position;g.drawTab(u,N.tab,N.startX,0,N.width,k,g._moveBackground),Rd(u,g._insertColor,w,0,k)}u.restore(),g.tx(g.tx())}for(var i=[],F=H.children,S=0;S<F.length;S++){var $=F[S],P=$._tab_;P&&!p.contains(P)&&i.push($)}i.forEach(function(v){H.removeChild(v)})}});var Tf=function(N){this.tv=N,this.addListeners()};jh(Tf,_,{ms_listener:1,getView:function(){return this.tv._91O},handle_mousewheel:function(A){this.handleScroll(A,10*(A.wheelDelta/40))},handle_DOMMouseScroll:function(K){this.handleScroll(K,10*-K.detail)},handleScroll:function(I,N){Hm(I);var t=this.tv,P=t._tabPosition;!t._40o()||P!==fk&&P!==rp||t.tx(this.tv.tx()+N),!t._41o()||P!==Um&&P!==Xl&&P!==Um+"-vertical"&&P!==Xl+"-vertical"||t.ty(this.tv.ty()+N)},_8Q:function(E){var k,p,c=this.tv,G=c._tabPosition,X=c._7o;if(G===fk||G===rp){var x=c.lp(E).x;for(k=0;k<X.size();k++)if(p=X.get(k),p.startX<=x&&x<=p.endX)return p}else if(G===Um||G===Xl||G===Um+"-vertical"||G===Xl+"-vertical"){var v=c.lp(E).y;for(k=0;k<X.size();k++)if(p=X.get(k),p.startY<=v&&v<=p.endY)return p}return Q},isClickable:function(E){var I=this.tv,z=I._tabPosition,e=this._73o=this._8Q(E);return!I._40o()||z!==fk&&z!==rp?!I._41o()||z!==Um&&z!==Xl&&z!==Um+"-vertical"&&z!==Xl+"-vertical"?e&&(!e.tab.isDisabled()||I.isMovable()):!0:!0},handle_mousemove:function(c){var F=this;gd?F._74o=F._8Q(c):F.getView().style.cursor=F.isClickable(c)?Fl:""},handle_mousedown:function(H){this.handle_mousemove(H),this.handle_touchstart(H)},handle_touchstart:function($){var N=this,H=N.tv,T=H._tabPosition;Hm($),gf($)&&N.isClickable($)&&(T===fk||T===rp?(N.x=ko($).x,N.lp=H.lp($),N.tx=H.tx()):(N.y=ko($).y,N.lp=H.lp($),N.ty=H.ty()),ep(N,$))},handleWindowMouseMove:function(b){this.handleWindowTouchMove(b)},handleWindowTouchMove:function(r){var e,u=this,j=u.tv,m=j._tabPosition,B=u._73o;if(m===fk||m===rp){if(e=ko(r).x-u.x,!u._25o&&!u.moving&&q(e)>2&&(j._40o()&&!Ub(r)?u._25o=1:B&&j.isMovable()&&(u.moving=1)),u._25o)j.tx(u.tx+e);else if(u.moving){var R=u.lp.x+e,t=j._tabGap/2;j._7o.each(function(P){var I=P.endX,$=R-P.startX<I-R;R>=P.startX&&I>=R&&j._7Q({tab:B.tab,startX:B.startX+e,width:B.width,front:$,insertTab:P.tab,position:$?x(0,P.startX-t):k(j._64I,I+t)})})}}else if(e=ko(r).y-u.y,!u._25o&&!u.moving&&q(e)>2&&(j._41o()&&!Ub(r)?u._25o=1:B&&j.isMovable()&&(u.moving=1)),u._25o)j.ty(u.ty+e);else if(u.moving){var C=u.lp.y+e,t=j._tabGap/2;j._7o.each(function(z){var Z=z.endY,s=C-z.startY<Z-C;C>=z.startY&&Z>=C&&j._7Q({tab:B.tab,startY:B.startY+e,height:B.height,front:s,insertTab:z.tab,position:s?x(0,z.startY-t):k(j._23Q,Z+t)})})}},handleWindowMouseUp:function(R){this.handleWindowTouchEnd(R)},handleWindowTouchEnd:function(){var X=this,Z=X.tv,w=Z._tabPosition,n=Z.getTabModel(),k=n._roots,W=X._73o;if(X.moving){var q=Z._23o;if(q&&q.insertTab!==q.tab){var r=q.tab,t=k.remove(r),N=k.indexOf(q.insertTab);N>=0&&(q.front||N++,N<=k.size()&&(k.add(r,N),n._38I(r,t,N)))}Z._7Q(Q),delete X.moving}else if(!X._25o&&W){r=W.tab;var d=X._74o;if(!d||d.tab===r)if(!r.isDisabled()&&An(W._75o,X.lp)){var K=function(){var Y=k.indexOf(r);n.remove(r),Z.onTabClosed(r,Y)};Z.onTabClosing(r,K)&&K()}else r.isDisabled()||Z._8o===r||n.sm().ss(r)}X._25o=X._73o=X._74o=w===fk||w===rp?X.x=X.lp=X.tx=Q:X.y=X.lp=X.ty=Q}}),yo.PropertyView=function(Z){var R=this;R._view=Ro(1,R),R._canvas=yk(R._view),Pe(R._view,R._79O=xq()),R._rows=new xg,R._28o=new xg,R._26o={},R._26Q={};var F=R._propertyModel=new Se,P=R.ivm;F.mm(P,R),F.md(P,R),F.mh(P,R),R.dm(Z?Z:new Se),new Rq(R)},Dm("PropertyView",_,{ms_ac:[En,ok,Cf,ar,Hk,"categorizable",Gf,fj,wl,Wl,Wg,_m,jd,Xf,"selectRowIndex",Hq,"background",jb,qn,Hh,uq,uh],ms_v:1,ms_dm:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,_45o:1,_47o:1,ms_tip:1,_29I:kg,_59I:0,_9I:0,_selectRowIndex:-1,_editable:!0,_batchEditable:!0,_categorizable:!0,_indent:Dh,_background:p.propertyViewBackground,_expandIcon:p.propertyViewExpandIcon,_collapseIcon:p.propertyViewCollapseIcon,_scrollBarColor:Ul,_scrollBarSize:Ko,_autoHideScrollBar:Vq,_selectBackground:p.propertyViewSelectBackground,_rowHeight:Sr,_rowLineVisible:p.propertyViewRowLineVisible,_rowLineColor:p.propertyViewRowLineColor,_10I:.5,_columnLineVisible:p.propertyViewColumnLineVisible,_columnLineColor:p.propertyViewColumnLineColor,_labelColor:p.propertyViewLabelColor,_labelSelectColor:p.propertyViewLabelSelectColor,_labelFont:p.propertyViewLabelFont,getRows:function(){return this._rows},getColumnPosition:function(){return this._10I},setColumnPosition:function(L){0>L&&(L=0),L>1&&(L=1);var w=this,x=w._10I;w._10I=L,w.fp("columnPosition",x,L)},getPropertyName:function(z){return z.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(Y,N,k){return k===this._selectRowIndex?this._labelSelectColor:this._labelColor},getPropertyFont:function(){return this._labelFont},getPropertyColor:function(e,H){return H===this._selectRowIndex?this._labelSelectColor:e.getColor()||this._labelColor},getCategoryFont:function(){return this._labelFont},getCategoryColor:function(){return this._labelColor},adjustTranslateX:function(){return 0},adjustTranslateY:function(Z){var P=this.getHeight()-this._59I;return P>Z&&(Z=P),Z>0?0:U(Z)},isExpanded:function(I){if(!I)return!0;var l=this._26o[I];return l?l.isExpanded:!(this._26Q[I]===!1)},toggle:function(D){var _=this;_.isExpanded(D)?_.collapse(D):_.expand(D)},expandAll:function(){this.validate();for(var f in this._26o)this.expand(f)},expand:function(s){if(s&&s!==lp){var q=this,H=q._26o[s];H&&!H.isExpanded&&(H.isExpanded=!0,q.onExpanded(s),q.ivm())}},onExpanded:function(){},collapseAll:function(){this.validate();for(var Z in this._26o)this.collapse(Z)},collapse:function(e){if(e&&e!==lp){var h=this,r=h._26o[e];r&&r.isExpanded&&(r.isExpanded=!1,h.onCollapsed(e),h.ivm())}},onCollapsed:function(){},getCategoryName:function(L){if(!this.isCategorizable())return lp;var y=L.getCategoryName();return y?y:lp},getPropertyModel:function(){return this._propertyModel},handleSelectionChange:function(){this.ivm()},setDataModel:function(E){var z=this,N=z._dataModel;N!==E&&(N&&(N.umd(z.handlePropertyChange,z),z._selectionModel||N.sm().ums(z.handleSelectionChange,z)),z._dataModel=E,E.md(z.handlePropertyChange,z),z._selectionModel?z._selectionModel._21I(E):E.sm().ms(z.handleSelectionChange,z),z.fp(ag,N,E))},isVisible:function(R){return this._visibleFunc?this._visibleFunc(R):!0},onPropertyChanged:function(c){var X=this,J=c.property;aq[J]?X.ivm():X.iv(),J===zl&&X._43o()},getCurrentData:function(){return this._27o},updateCurrentData:function(){this._27o=this.sm().ld()},getRawProperties:function(){return this._27o?this._propertyModel._roots:os},handlePropertyChange:function(g){this._27o===g.data&&this.iv()},ivm:function(){this.invalidateModel()},invalidateModel:function(){var $=this;$._96I||($.setSelectRowIndex(-1),$._96I=1,$.iv())},redraw:function(){this.iv()},validateModel:function(){var I=this,O=I._rows,K=I._28o,D={},h=new xg,F=I._27o;I.updateCurrentData(),F!==I._27o&&I.endEditing(),O.clear(),K.clear(),I.getRawProperties().each(function(z){if(I.isVisible(z)){h.add(z);var L=I.getCategoryName(z);D[L]||(K.add(L,L===lp?0:i),D[L]={isExpanded:I.isExpanded(L),properties:new xg})}}),I._sortFunc&&h.sort(I._sortFunc);for(var W in I._26o)I._26Q[W]=I.isExpanded(W);I._26o=D,K.each(function(m){m!==lp&&O.add(m);var e=D[m];e.isExpanded&&h.each(function(y){I.getCategoryName(y)===m&&(e.properties.add(y),O.add({property:y,data:I._27o}))},I)})},validateImpl:function(){var r=this;r._76o(),r._96I&&(r.validateModel(),delete r._96I);var k=r._canvas,F=r.getWidth(),q=r.getHeight(),g=-r.ty(),D=r._rowHeight,a=r._indent,C=F-a,e=r._rows,n=e.size(),y=r._9I=a+C*r._10I,h=r._59I=n*D;vh(k,F,q),r._29I={x:0,y:g,width:F,height:q},r._31I=K(g/D),r._14I=G((g+q)/D),r._31I<0&&(r._31I=0),r._14I>n&&(r._14I=n);var H,N=ro(k),z=r._background;Hd(N,0,-g,1),N.beginPath(),N.rect(0,g,F,q),N.clip(),N.clearRect(0,g,F,q),r._93db(N),z&&nl(N,0,0,a,h,z);for(var L=r._31I;L<r._14I;L++){var t=e.get(L),g=D*L;if(Pf(t))z&&nl(N,a,g,C,D,z),H=Lq(r.isExpanded(t)?r._expandIcon:r._collapseIcon),H&&Cq(N,H,xn,0,g,a,D),N.save(),N.beginPath(),N.rect(a,g,C,D),N.clip(),r.drawCategoryName(N,t,L,a,g,C,D),N.restore();else{var J=t.property,m=t.data,H=Lq(J.getIcon()),I=r._selectRowIndex===L?r.getSelectBackground():Q;if(H&&Cq(N,H,xn,0,g,a,D),I&&nl(N,a,g,C,D,I),N.save(),N.beginPath(),N.rect(a,g,y-a,D),N.clip(),r.drawPropertyName(N,J,L,a,g,y-a,D),N.restore(),!r.isEditing(m,J)){var $=y+1,p=F-y-1;N.save(),N.beginPath(),N.rect($,g,p,D),N.clip(),r._87o(r.drawPropertyValue(N,J,r.getValue(m,J),L,$,g,p,D,m),L,$,g,p,D),N.restore()}}r._rowLineVisible&&nl(N,a,g+D-1,C,1,r._rowLineColor)}r._columnLineVisible&&(nl(N,y,0,1,h,r._columnLineColor),nl(N,F-1,0,1,h)),r._92db(N),r._93I(),N.restore(),r.ty(r.ty())},drawCategoryName:function(T,R,V,D,L,J,U){re(T,R,this.getCategoryFont(R),this.getCategoryColor(R),D,L,J,U)},drawPropertyName:function(P,v,d,H,y,q,Y){return v.drawPropertyName?(v.drawPropertyName(P,v,d,H,y,q,Y,this),void 0):(re(P,this.getPropertyName(v),this.getPropertyFont(v,d),this.getPropertyColor(v,d),H,y,q,Y),void 0)},drawPropertyValue:function(D,J,a,z,F,I,$,w,W){return J.drawPropertyValue?J.drawPropertyValue(D,J,a,z,F,I,$,w,W,this):(Ie(D,a,J,this.getLabelFont(J,a,z),this.getLabelColor(J,a,z),F,I,$,w,W,this),void 0)},isPropertyEditable:function(R){return R.isEditable()&&this.isEditable()},setProperties:function(t){this._propertyModel.clear(),this.addProperties(t)},addProperties:function(k){if(k){var b=this._propertyModel;k.forEach(function(I){if(!(I instanceof jc)){var c=Tg(I.className);I=yq(c?c:jc,I)}b.add(I)})}},getRowIndexAt:function(E){var f=this,R=K(f.lp(E).y/f._rowHeight);return R>=0&&R<f._rows.size()?R:-1},getPropertyAt:function(U){var N=this,B=N.getRowIndexAt(U);return B>=0?N._rows.get(B).property:Q},getToolTip:function($){var U=this,G=U.getPropertyAt($),t=U._27o;return G&&t?G.getToolTip(t,U._9I<U.lp($).x,U):Q}});var Rq=function(C){this.pv=C,this.addListeners()};jh(Rq,_,{ms_listener:1,getView:function(){return this.pv._view},setCursor:function(q){this.getView().style.cursor=q},clear:function(){var n=this;n._62O=n.cp=n.ty=n.p=Q,n.setCursor(Eq)},handle_mousedown:function(h){this.handle_touchstart(h)},handle_touchstart:function(b){var H=this,E=H.pv;Hm(b),E.setFocus(b)&&(gf(b)?(H.cp=ko(b),H.ty=E.ty(),H.p=E.getColumnPosition(),H.handle_touchmove(b)):E.setSelectRowIndex(E.getRowIndexAt(b)))},handleWindowMouseUp:function(){this.clear()},handleWindowTouchEnd:function(){this.clear()},handle_mouseup:function(s){this.handle_touchend(s)},handle_touchend:function(K){var d=this;if(d.cp&&!d._62O){var T=d.pv,n=T.lp(K),k=n.x,r=n.y,L=T._indent,X=T.getRowIndexAt(K),G=T._9I;if(X>=0){var y=T._rowHeight,U=y*X,A=T._rows.get(X),l=A.property;if(Pf(A))Lq(T.isExpanded(A)?T._expandIcon:T._collapseIcon)&&k>=0&&L>=k&&r>=U&&U+y>=r?T.toggle(A):pg(K)&&T.toggle(A);else if(k>G&&T.isPropertyEditable(l,K)){var Y={x:G+1,y:U,width:T.getWidth()-G-1,height:y},Z={x:Y.x+T.tx(),y:Y.y+T.ty(),width:Y.width,height:Y.height},v=0,p=T._29I;Y.y<p.y?v=Y.y-p.y:Y.y+y>p.y+p.height&&(v=Y.y+y-p.y-p.height),v&&(T.ty(T.ty()-v),Z.y-=v),T.beginEditing({data:A.data,property:l,value:T.getValue(A.data,l),event:K,rect:Y,editorRect:Z,view:T})}}T.setSelectRowIndex(X)}d.clear()},handleWindowMouseMove:function($){this.handleWindowTouchMove($)},handleWindowTouchMove:function(v){var W=this,T=W.pv,i=W.ty,f=W.cp,r=ko(v),d=W._62O;if("p"===d)T.setTranslateY(i+r.y-f.y);else if("c"===d){var w=T.getWidth()-T._indent;if(w>16){var k=W.p-(f.x-r.x)/w,H=16/w;H>k&&(k=H),k>1-H&&(k=1-H),T.setColumnPosition(k)}}else"s"===d&&T.setTranslateY(i+(f.y-r.y)*T._59I/T._29I.height)},handle_mousemove:function(A){this.handle_touchmove(A)},handle_touchmove:function(s){if(!gd&&gf(s)){var o=this,w=o.pv,D=q(w.lp(s).x-w._9I)<=(sg?8:3);o.cp?o._62O||(D?(o._62O="c",ep(o)):q(ko(s).y-o.cp.y)>=2&&(o._62O=o.isV(s)?"s":"p",ep(o))):(D?o.setCursor(kf):o.setCursor(Eq),o.isV(s)&&w._43o())}},isV:function(E){var Y=this.pv,X=Y._29I;return Y._41o()&&X.x+X.width-Y.lp(E).x<Fq},handle_mousewheel:function(U){this.handleScroll(U,U.wheelDelta/40)},handle_DOMMouseScroll:function(V){2===V.axis&&this.handleScroll(V,-V.detail)},handleScroll:function(m,$){var O=this.pv;Hm(m),O.endEditing(),O.translate(0,$*O.getRowHeight())},handle_keydown:function(G){var K=this.pv,Z=K._rows.size(),s=K._selectRowIndex+(Yf(G)?-1:1);(Yf(G)||en(G))&&(0>s&&(s=0),s>=Z&&(s=Z-1),K.setSelectRowIndex(s))}}),yo.ListView=function(J){this._5o(J),new ej(this)},Dm("ListView",_,{ms_ac:[En,ok,Cf,jb,Gf,qn,Hh,fj,wl,_m,jd,Xf,$m,Hq],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,_14Q:1,ms_dm:1,_45o:1,_checkMode:!1,_indent:Dh,_rowHeight:Sr,_rowLineVisible:p.listViewRowLineVisible,_rowLineColor:p.listViewRowLineColor,_scrollBarColor:Ul,_scrollBarSize:Ko,_autoMakeVisible:Jg,_autoHideScrollBar:Vq,_selectBackground:p.listViewSelectBackground,_labelColor:p.listViewLabelColor,_labelSelectColor:p.listViewLabelSelectColor,_labelFont:p.listViewLabelFont,isCheckMode:function(){return this._checkMode},setCheckMode:function(M){var C=this,Y=C._checkMode;C._checkMode=M,C.fp($l,Y,M)},drawRow:function(Y,e,u,m,w,N,S){var Q=this,r=0,i=Q._indent,g=Q.getIconWidth(e);Q.drawRowBackground(Y,e,u,m,w,N,S),Q._checkMode&&(as(Y,Lq(Q.getCheckIcon(e)),r+i/2,w+S/2,e,Q),r+=i),Q.drawIcon(Y,e,r,w,g,S),Q.drawLabel(Y,e,r+g,w,S)}});var ej=function(M){this.list=M,this._lastSelectDataTime=ql(),this.addListeners()};jh(ej,_,{ms_listener:1,getView:function(){return this.list._view},clear:function(t){var s=this,x=s.list;t&&"d"===s._62O&&!s.dragCancel&&x.handleDragAndDrop(t,"end"),x.draggingData&&(x.draggingData=null,x.redraw()),s.dragCancel=s._62O=s._isV=s._isH=s.cp=s.tx=s.ty=Q},handle_mousedown:function(Y){this.handle_touchstart(Y)},handle_touchstart:function(J){var B=this,R=B.list;if(Hm(J),R.setFocus(J)){var s=R.getDataAt(J);B.cp=ko(J),B.tx=R.tx(),B.ty=R.ty(),gf(J)?s&&R.handleDragAndDrop&&!B.isV(J)&&!B.isH(J)&&(R.draggingData=s,R.redraw(),R.handleDragAndDrop(J,"prepare")):(s&&B._33o(J,s),B.clear(J))}},handleWindowMouseUp:function(Z){this.clear(Z)},handleWindowTouchEnd:function(W){this.clear(W)},handle_mouseup:function(g){this.handle_touchend(g)},handle_touchend:function(C){var y=this,T=y.list;if(!y._isV&&!y._isH&&y.cp&&!y._62O){var z=T.getDataAt(C);z?(T.isCheckMode()?y._34o(C,z):y._33o(C,z),pg(C)?T.onDataDoubleClicked(z,C):T.onDataClicked(z,C)):T.handleBackgroundClick(C)}y.clear(C)},handleWindowMouseMove:function(B){this.handleWindowTouchMove(B)},handleWindowTouchMove:function(j){var K=this,d=K.list,x=K._62O,w=K.tx,S=K.ty,u=K.cp,G=ko(j),i=d._29I;"p"===x?d.setTranslate(w+G.x-u.x,S+G.y-u.y):"v"===x?d.ty(S+(u.y-G.y)*d._59I/i.height):"h"===x?d.tx(w+(u.x-G.x)*d._91I/i.width):"d"===x&&(K.dragCancel||d.handleDragAndDrop(j,"between"))},handle_mousemove:function(R){this.handle_touchmove(R)},handle_touchmove:function(A){if(!gd&&gf(A)){var i=this,_=i.list;if(i._isV=i.isV(A),i._isH=i.isH(A),i.cp){if(!i._62O){if(Vc(ko(A),i.cp)<2)return;i._isV?i._62O="v":i._isH?i._62O="h":_.draggingData&&!this.dragCancel?(i._62O="d",_.handleDragAndDrop(A,"begin")):i._62O="p",i._62O&&"d"!==i._62O&&_.draggingData&&(_.draggingData=null,_.redraw()),ep(i)}}else i._isV&&_._43o(),i._isH&&_._42o()}},isV:function(D){var T=this.list,d=T._29I;return T._41o()&&d.x+d.width-T.lp(D).x<Fq},isH:function(g){var J=this.list,p=J._29I;return J._40o()&&p.y+p.height-J.lp(g).y<Fq},handle_mousewheel:function(Y){this.handleScroll(Y,Y.wheelDelta/40,Y.wheelDelta!==Y.wheelDeltaX)},handle_DOMMouseScroll:function(g){this.handleScroll(g,-g.detail,1)},handleScroll:function(x,B,m){var o=this.list;Hm(x),o.endEditing&&o.endEditing(),m&&o._41o()?o.translate(0,B*o.getRowHeight()):o._40o()&&o.translate(10*B,0)},handle_keydown:function(Y){if(!p.isInput(Y.target)){var Q,j=this.list,X=j.sm(),C=j._rows,b=C.size();if(Fp(Y))j.selectAll();else if(Zm(Y))j.handleDelete&&j.handleDelete(Y);else if(Wq(Y))"d"!==this._62O||this.dragCancel||(j.handleDragAndDrop(Y,"cancel"),this.dragCancel=!0);else if(mo(Y))j.isCheckMode()&&(Q=j.getFocusData(),Q&&j.checkData(Q));else if(Yf(Y)||en(Y)){var l=j.isCheckMode();if(Q=l?j.getFocusData():X.ld()){var T=j.getRowIndex(Q);T>=0&&(Yf(Y)?0!==T&&(Q=C.get(T-1),l?j.setFocusData(Q):X.ss(Q)):T!==b-1&&(Q=C.get(T+1),l?j.setFocusData(Q):X.ss(Q)))}else b>0&&(Q=C.get(0),l?j.setFocusData(Q):X.ss(Q))}}},_34o:function(R,L){var M=this.list,r=M.lp(R).x;return r>=0&&r<=M._indent?(M.checkData(L),void 0):(M.setFocusData(L),void 0)},_33o:function(r,g){var Q=this.list,h=Q.sm(),c=h.ld();if(Ub(r))Q.isSelected(g)?h.rs(g):h.as(g);else if(sb(r))if(c)for(var s=Q.getRowIndex(c),L=Q.getRowIndex(g);s!==L;)s+=L>s?1:-1,h.as(Q._rows.get(s));else h.ss(g);else if(gf(r)){var K=ql();if(h.contains(g)){var e=K-this._lastSelectDataTime;Q.handleDataDoubleSelect&&e>500&&1500>e&&Q.handleDataDoubleSelect(r,g)}h.ss(g),this._lastSelectDataTime=K}else h.contains(g)||h.ss(g)}}),yo.TreeView=function(r){var w=this;w._35o(),w._5o(r),new id(w)},Dm("TreeView",_,{ms_ac:[En,ok,Cf,"rootVisible",$l,"rootData",fj,wl,_m,jd,Xf,Gf,jb,qn,Hh,Wl,Wg,$m,Hq,"loader","doubleClickToToggle"],ms_v:1,ms_bnb:1,ms_tip:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,_48o:1,_14Q:1,_45o:1,_checkMode:Q,_indent:Dh,_rowHeight:Sr,_rowLineVisible:p.treeViewRowLineVisible,_rowLineColor:p.treeViewRowLineColor,_scrollBarColor:Ul,_scrollBarSize:Ko,_autoHideScrollBar:Vq,_expandIcon:p.treeViewExpandIcon,_collapseIcon:p.treeViewCollapseIcon,_autoMakeVisible:Jg,_selectBackground:p.treeViewSelectBackground,_labelColor:p.treeViewLabelColor,_labelSelectColor:p.treeViewLabelSelectColor,_labelFont:p.treeViewLabelFont,_doubleClickToToggle:p.treeViewDoubleClickToToggle,drawRow:function(Z,v,N,V,J,G,w){var _=this;_.drawRowBackground(Z,v,N,V,J,G,w),_._97I(Z,v,N,0,J,G,w)},isOnToggleIcon:function(s){var e=this.getDataAt(s);if(e){var i=this.getIndent(),c=this.lp(s).x;if(Lq(this.getToggleIcon(e))){var q=i*this.getLevel(e);if(c>=q&&q+i>=c)return!0}}return!1}});var id=function(X){ym(id,this,[X])};jh(id,ej,{toggle:function(L,C,i,l){var N=this.list,A=N.lp(L).x;if(Lq(N.getToggleIcon(C))){var _=i*l;if(A>=_&&_+i>=A)return N.toggle(C),!0}return N.isDoubleClickToToggle()&&pg(L)?(N.toggle(C),!0):!1},_34o:function(S,F){var c=this.list,Z=c.lp(S).x,N=c._levelMap[F._id],k=c._indent,s=k*(N+1);return Z>=s&&s+k>=Z?(c.checkData(F),void 0):(this.toggle(S,F,k,N)||c.setFocusData(F),void 0)},_33o:function(r,j){var R=this,A=R.list;R.toggle(r,j,A._indent,A.getLevel(j))||id.superClass._33o.call(R,r,j)},handle_keydown:function(L){if(Ao(L)||ts(L)){var I=this.list,o=I._rows,h=I.isCheckMode(),R=I.sm(),$=h?I.getFocusData():R.ld();$?$.hasChildren()&&(Ao(L)?I.collapse($):I.expand($)):o.size()>0&&($=o.get(0),h?I.setFocusData($):R.ss($))}else id.superClass.handle_keydown.call(this,L)}});var Dl=yo.TableView=function(N){this._98I(),this._5o(N),new Tn(this)};Dm("TableView",_,{ms_ac:[En,ok,Cf,"sortMode",ar,Hk,jb,qn,Hh,uq,uh,"sortColumn",fj,wl,_m,jd,Xf,$m,Hq],ms_v:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_45o:1,_47o:1,_sortMode:Lf,_editable:!0,_batchEditable:!1,_rowHeight:Sr,_rowLineVisible:p.tableViewRowLineVisible,_rowLineColor:p.tableViewRowLineColor,_columnLineVisible:p.tableViewColumnLineVisible,_columnLineColor:p.tableViewColumnLineColor,_scrollBarColor:Ul,_scrollBarSize:Ko,_autoHideScrollBar:Vq,_autoMakeVisible:Jg,_selectBackground:p.tableViewSelectBackground,_labelColor:p.tableViewLabelColor,_labelSelectColor:p.tableViewLabelSelectColor,_labelFont:p.tableViewLabelFont,getCheckColumn:function(){var t=this;if(!t._31o){var L=t._31o=new oi;L.setEditable(!0),L.setWidth(40),L.getValue=t.getCheckColumValue,L.drawCell=t.drawCheckColumnCell}return t._31o},isCheckMode:function(){return this._39o.contains(this._31o)},setCheckMode:function(R){var z=this,r=z._39o,c=z.getCheckColumn();R!==z.isCheckMode()&&(R?r.add(c,0):r.remove(c),z.fp($l,!R,R))},getCheckColumValue:function(d,X,J){return J.isSelected(d)},drawCheckColumnCell:function(u,d,f,F,k,G,t,h,X){as(u,X.getCheckIcon(d),k+t/2,G+h/2,d,X)}});var Tn=function(b){ym(Tn,this,[b])};jh(Tn,ej,{_34o:function(Q,i){var V=this.list,O=V._31o;if(V.isCellEditable(i,O,Q)){var C=V._3Q(O),$=V.lp(Q).x;if(C&&$>=C.startX&&$<C.startX+O.getWidth())return V.checkData(i),void 0}V._37O(i,Q),V.setFocusData(i)},_33o:function(f,E){this.list._37O(E,f),Tn.superClass._33o.apply(this,arguments)}});var rr=yo.TreeTableView=function(f){var T=this,P=T._4o=new oi;T._35o(),T._98I(),T._5o(f),P.setDisplayName("Name"),P.setEditable(!0),P.setWidth(180),P.drawCell=wm,P.getValue=Ti,T._39o.add(P),new Ei(T)},wm=function(o,W,v,R,d,a,h,Y,G){G._97I(o,W,v,d,a,h,Y)},Ti=function(h,i,x){return x.getLabel(h)};Dm("TreeTableView",_,{ms_ac:[En,ok,Cf,"sortMode",ar,Hk,Gf,$l,"rootData","rootVisible",fj,wl,"sortColumn",Wl,Wg,_m,jd,Xf,$m,Hh,jb,qn,uq,uh,Hq,"loader"],ms_v:1,ms_bnb:1,ms_fire:1,ms_sm:1,_49o:1,ms_txy:1,ms_lp:1,ms_vs:1,ms_hs:1,_15Q:1,ms_dm:1,ms_tip:1,_50o:1,_48o:1,_14Q:1,_45o:1,_47o:1,_sortMode:Lf,_checkMode:Q,_editable:!0,_batchEditable:!1,_indent:Dh,_rowHeight:Sr,_rowLineVisible:p.treeTableViewRowLineVisible,_rowLineColor:p.treeTableViewRowLineColor,_columnLineVisible:p.treeTableViewColumnLineVisible,_columnLineColor:p.treeTableViewColumnLineColor,_expandIcon:p.treeTableViewExpandIcon,_collapseIcon:p.treeTableViewCollapseIcon,_scrollBarColor:Ul,_scrollBarSize:Ko,_autoHideScrollBar:Vq,_autoMakeVisible:Jg,_selectBackground:p.treeTableViewSelectBackground,_labelColor:p.treeTableViewLabelColor,_labelSelectColor:p.treeTableViewLabelSelectColor,_labelFont:p.treeTableViewLabelFont,getTreeColumn:function(){return this._4o}});var Ei=function(i){ym(Ei,this,[i])};jh(Ei,ej,{_34o:function(p,i){var s=this.list,l=s._4o,n=s._3Q(l),M=s.lp(p).x;if(n){var D=s._indent,N=n.startX+D*s.getLevel(i);if(Lq(s.getToggleIcon(i))&&M>=N&&N+D>=M)return s.toggle(i),void 0;if(s.isCellEditable(i,l)&&(N+=D,M>=N&&N+D>=M))return s.checkData(i),void 0}s._37O(i,p),s.setFocusData(i)},_33o:function(O,D){var I=this.list,S=I.lp(O).x;if(Lq(I.getToggleIcon(D))){var N=I._3Q(I._4o);if(N){var n=I._indent,F=N.startX+n*I.getLevel(D);if(S>=F&&F+n>=S)return I.toggle(D),void 0}}I._37O(D,O),Ei.superClass._33o.apply(this,arguments)}});var xc=yo.TableHeader=function(k){var m=this,R=m._view=Ro(1,m),c=m._39o=k.getColumnModel(),a=m.iv;m.tv=m._tableView=k,m._60I=new xg,m._canvas=yk(R),R.style.background=p.tableHeaderBackground||"",R.style.height=Sb+ib,c.mm(a,m),c.md(a,m),c.mh(a,m),k.mp(function(g){Zd[g.property]&&m.iv()},m),new Yh(m),m.iv()};Dm("TableHeader",_,{ms_v:1,ms_lp:1,ms_fire:1,ms_ac:["checkIcon","sortDescIcon","sortAscIcon",En,Cf,Gf,"moveBackground","insertColor",uq,uh,"resizable","movable"],_checkIcon:Ec,_movable:!0,_resizable:!0,_labelColor:p.tableHeaderLabelColor,_labelFont:p.tableHeaderLabelFont,_columnLineColor:p.tableHeaderColumnLineColor,_columnLineVisible:p.tableHeaderColumnLineVisible,_sortDescIcon:p.tableHeaderSortDescIcon,_sortAscIcon:p.tableHeaderSortAscIcon,_moveBackground:p.tableHeaderMoveBackground,_insertColor:p.tableHeaderInsertColor,_indent:Dh,getCheckIcon:function(){return this._checkIcon
},getTableView:function(){return this.tv},getLabel:function(M){return M.toLabel()},getLabelFont:function(){return this._labelFont},getLabelColor:function(d){return d.getColor()||this._labelColor},getLabelAlign:function(W){return W._align},onPropertyChanged:function(){this.iv()},_5Q:function(O){this._61I=O,this.iv()},getLogicalPoint:function(P){return xs(P,this._canvas,this.tv.tx())},validateImpl:function(){var q=this,k=q._canvas,S=q.getWidth(),o=q.getHeight(),e=q.tv,y=q._60I,z=q._61I,O=-e.tx(),I=0;(S!==k.clientWidth||o!==k.clientHeight)&&vh(k,S,o),y.clear(),q._39o._roots.each(function(b){if(b.isVisible()){var H=I+b.getWidth();O+S>=I&&H>=O&&y.add({column:b,startX:I}),I=H}});var l=ro(k);if(Hd(l,-O,0,1),l.beginPath(),l.rect(O,0,S,o),l.clip(),l.clearRect(O,0,S,o),y.each(function(e){var g=e.column,k=e.startX,B=g.getWidth();B>0&&(l.save(),l.beginPath(),l.rect(k,0,B,o),l.clip(),z&&z.column===g||q.drawColumn(l,g,k,0,B,o),q._columnLineVisible&&nl(l,k+B-1,0,1,o,q._columnLineColor),l.restore())}),z){var h=z.column,I=z.startX,r=z.position,L=h.getWidth();l.save(),l.beginPath(),l.rect(I,0,L,o),l.clip(),l.fillStyle=q._moveBackground,l.fill(),q.drawColumn(l,h,I,0,L,o),l.restore(),Rd(l,q._insertColor,r,0,o)}l.restore()},_6Q:function(G){var H=this.tv;return H._31o===G&&H.sm().getSelectionMode()===Jp},drawColumn:function(F,l,G,x,W,f){var j=this,r=j.tv,$=Lq(l.getIcon()),m=j.getLabelAlign(l);if(j._6Q(l)){var N=Lq(j._checkIcon);as(F,N,G+W/2,x+f/2,l,j)}else{var U=j.getLabel(l),n=j.getLabelFont(l),i=j.getLabelColor(l),L=vr(n,U).width,p=$?j._indent:0;m===Um?($&&Cq(F,$,xn,G,x,p,f),re(F,U,n,i,G+p,x,W,f,Um)):m===Xl?($&&Cq(F,$,xn,G+W-L-p,x,p,f),re(F,U,n,i,G,x,W,f,Xl)):($&&Cq(F,$,xn,G+(W-L-p)/2,x,p,f),re(F,U,n,i,G+(W-L+p)/2,x,0,f,Um))}if(l.isSortable()&&r.getSortColumn()===l&&($=Lq(l.getSortOrder()===Fn?j._sortAscIcon:j._sortDescIcon))){var z=ki($,l)/2+2;as(F,$,m===Xl?G+z:G+W-z,x+f/2,l,r)}}});var Yh=function($){var g=this;g.th=$,g.tv=$._tableView,g.addListeners()};jh(Yh,_,{ms_listener:1,getView:function(){return this.th.getView()},setCursor:function(T){this.getView().style.cursor=T},handle_mousemove:function(Q){if(!gd){var T=this;delete T._29o,T.setCursor(Eq);for(var K=T.th,Z=K._60I,b=K.lp(Q).x,V=Z.size()-1;V>=0;V--){var p=Z.get(V),F=p.column,e=p.startX+F.getWidth();if(K.isResizable()&&q(e-b)<=(sg?10:3))return T._29o=p,T.setCursor(kf),void 0;b>p.startX&&e>b&&(T._29o=p),(F.isClickable()||F.isSortable()||K.isMovable()||T.tv.getCheckColumn&&F===T.tv.getCheckColumn())&&b>p.startX&&e>b&&T.setCursor(Fl)}}},handle_mousedown:function(E){this.handle_touchstart(E)},handle_touchstart:function(b){var T=this;Hm(b),T.tv.endEditing(),T.handle_mousemove(b),T._29o&&(T.x=ko(b).x,T.lx=T.th.lp(b).x,T.w=T._29o.column.getWidth(),ep(T,b))},handleWindowMouseMove:function(O){this.handleWindowTouchMove(O)},handleWindowTouchMove:function(o){var L=this,W=L.th,U=L.getView().style.cursor,N=L._29o,F=ko(o).x-L.x;if(L.resizing||L.moving||(U===kf?L.resizing=1:W.isMovable()&&U===Fl&&q(F)>2&&(L.moving=1)),L.resizing)N.column.setWidth(L.w+F);else if(L.moving){var u=L.lx+F;W._60I.each(function(X){var C=X.startX,l=C+X.column.getWidth();if(u>=C&&l>=u){var O={column:N.column,startX:N.startX+F,front:l-u>u-C,insertColumn:X.column};O.position=O.front?C:l,W._5Q(O)}})}},_16Q:function(I,Q){var n=this,T=n.tv,J=n.th,x=J._checkIcon;if(J._6Q(I)){var y=Lq(x),c=n.lx,j=I.getWidth(),B=ki(y,I);if(c>=Q+j/2-B&&Q+j/2+B>=c){J.setCheckIcon(x===Jo?Ec:Jo);var U=T.sm(),D=T._rows;return x===Jo?U.rs(D):U.ss(D),T.onCheckColumnClicked(I),!0}}return!1},handleWindowMouseUp:function(u){this.handleWindowTouchEnd(u)},handleWindowTouchEnd:function(f){var C=this,W=C.tv,G=C.th,u=C._29o;if(C.moving){var i=G._61I;if(i&&i.insertColumn!==i.column){var r=i.column,g=W.getColumnModel()._roots,k=g.remove(r),A=g.indexOf(i.insertColumn);A>=0&&(i.front||A++,A<=g.size()&&(g.add(r,A),W.getColumnModel()._38I(r,k,A)))}G._5Q(Q),delete C.moving}else if(!C.resizing&&u){r=u.column;var L=G.lp(f).x,J=u.startX,N=!0;if(G.onColumnClicked){var O=G.onColumnClicked(r,f,J);O===!1&&(N=!1)}if(N&&L>=J&&L<=J+r.getWidth()&&!C._16Q(r,J)){if(r.isSortable()){var b=W.getSortMode(),e=r.getSortOrder();b===Lf?W.getSortColumn()===r?(e===gr&&W.setSortColumn(Q),r.setSortOrder(e===Fn?gr:Fn)):W.setSortColumn(r):"bistate"===b&&(W.getSortColumn()===r?r.setSortOrder(e===Fn?gr:Fn):W.setSortColumn(r))}W.onColumnClicked(r,f,J)}}C._29o=C.resizing=C.x=C.lx=C.w=Q}}),yo.TablePane=function(z){this.init(new Dl(z))},Dm("TablePane",_,{ms_v:1,_44o:1}),yo.TreeTablePane=function(f){this.init(new rr(f))},Dm("TreeTablePane",_,{ms_v:1,_44o:1}),yo.Toolbar=function($){var m=this,u=m._view=Ro(1,m),Q=u.style;Q.background=p.toolbarBackground||"",Q.height=Wk+ib,m._canvas=yk(u),m._30o=new xg,m._90I=new xg,m.setItems($||[]),u.handleGroupSelectedChanged=function(V){if(V.isSelected()){var l=V.getGroupId();null!=l&&m._items.forEach(function(u){var J=u.element;J&&J!==V&&J.setSelected&&J.getGroupId&&J.getGroupId()===l&&J.setSelected(!1)})}},new Uc(m)},Dm("Toolbar",_,{ms_v:1,ms_fire:1,ms_tx:1,ms_lp:1,ms_tip:1,ms_value:1,ms_ac:[wd,En,Cf,ok,Hq,"itemGap","separatorColor","currentItem","stickToRight"],_labelColor:p.toolbarLabelColor,_labelSelectColor:p.toolbarLabelSelectColor,_labelFont:p.toolbarLabelFont,_selectBackground:p.toolbarSelectBackground,_itemGap:p.toolbarItemGap,_separatorColor:p.toolbarSeparatorColor,_stickToRight:!1,getSumWidth:function(){return this._64I},getToolTip:function(P){var N=this.getItemInfoAt(P);return N?N.item.toolTip:Q},getLabelColor:function(n){return n&&n.selected&&n.type!==Jo&&n.type!==Qk?this._labelSelectColor:this._labelColor},onPropertyChanged:function(U){this.iv(),U.property===wd&&this._items.forEach(function(z){Fd(z)})},redraw:function(){this.iv()},addItem:function($,j){var u=this._items;j==Q?u.push($):u.splice(j,0,$),this.fp(wd,Q,u)},removeItem:function(K){if(K)for(var p=this._items,O=0;O<p.length;O++)K===p[O]&&(p.splice(O,1),this.fp(wd,Q,p))},removeItemById:function(d){if(d!=Q)for(var b=this._items,l=0;l<b.length;l++)if(d===b[l].id){var F=b.splice(l,1)[0];return this.fp(wd,Q,b),F}},getItemById:function(Z){if(Z!=Q)for(var m=this._items,Y=0;Y<m.length;Y++){var g=m[Y];if(Z===g.id)return g}},setItemVisible:function(f,T){var P=this.getItemById(f);P&&(P.visible=T)},getItemInfos:function(){return this._30o},getItemInfoAt:function(S){var X=this,A=0,_=X._30o,x=X.lp(S),c=x.x,n=x.y;if(n>=0&&n<=X.getHeight())for(;A<_.size();A++){var G=_.get(A);if(G.startX<=c&&c<=G.endX)return G}return Q},drawItem:function(G,a,C,f,_){if(a.visible===!1)return 0;if(bb(a.visible)&&!a.visible())return 0;var R=this,z=a.disabled;z&&(G.globalAlpha=Bs);var d=R.drawItemImpl(G,a,C,f,_),Y=R._itemGap;return z&&(G.globalAlpha=1),this._currentItem!==a||"separator"===a||a.separator===!0||a.unfocusable||zd(G,R._separatorColor,C-Y/2,0,d+Y,f),d},drawItemImpl:function(C,A,R,H,L){var Z=this,g=Z._view,v=Z._itemGap,O=H/2,u=A.type,G=A.element,M=A.label;Pf(G)&&(M=G,G=Q);var J,f=Z.getLabelFont(A),w=Z.getLabelColor(A),N=A.selected,s=Lq(A.icon),r=ki(s,A),U=0,k=r+(M?vr(f,M).width:0);if("separator"===A||A.separator===!0)return Rd(C,Z._separatorColor,R,H/4,O),1;if(G){s&&as(C,s,R+r/2,O,A,Z),re(C,M,f,w,R+r,0,0,H);var m=Tr(G);L||Z._90I.add(m),m.parentNode!==g&&Pe(g,m),G.iv&&G.iv(),G.validate&&G.validate();var l=m.getBoundingClientRect(),q=l.width,P=m.style;return tn(m),P.left=Z.tx()+R+k+ib,P.top=(H-l.height)/2+ib,k+q}return u===Qk?J=Lq(N?Oe:Yb):u===Jo&&(J=Lq(N?Jo:Ec)),J?(U=ki(J,A),as(C,J,R+U/2,O,A,Z),R+=U,k+=U):N&&nl(C,R-v/2,0,k+v,H,Z.getSelectBackground(A)),s&&as(C,s,R+r/2,O,A,Z),re(C,M,f,w,R+r,0,0,H),k},validateImpl:function(){var T=this,e=T._canvas,w=T.getWidth(),H=T.getHeight(),n=T._30o,W=T._items;vh(e,w,H);var F=ro(e),g=T._itemGap,D=g/2;Hd(F,T.tx(),0,1),F.clearRect(0,0,w,H);var m=T._90I;T._90I=new xg,n.clear(),W.forEach(function(l){var C=T.drawItem(F,l,D,H);n.add({item:l,startX:D,endX:D+C,width:C}),C&&(D+=C+g)}),m.each(function(K){T._90I.contains(K)||qh(K)});var Q=T._64I;T._64I=x(0,D),F.restore(),T._stickToRight?(T._65O=0,F=ro(e),D=w-T._64I+g,Hd(F,0,0,1),F.clearRect(0,0,w,H),n.clear(),W.forEach(function(K){var B=T.drawItem(F,K,D,H,!0);n.add({item:K,startX:D,endX:D+B,width:B}),B&&(D+=B+g)}),F.restore()):T.tx(T.tx()),Q!==T._64I&&T.onSumWidthChanged(Q,T._64I)},onSumWidthChanged:function(){},handleClick:function(e,F){var L=this,d=e.type,Z=e.action,p=e.groupId,V=e.selected;e.disabled||(p!=Q?V||(e.selected=!0,this._items.forEach(function(d){d.groupId===p&&e!==d&&(d.selected=!1)}),Z&&e.action(e,L,F)):d===Jo||"toggle"===d?(e.selected=!V,Z&&e.action(e,L,F)):Z&&e.action(e,L,F)),Ek(),L.iv()}});var Uc=function(I){this.tb=I,this.addListeners()};jh(Uc,_,{ms_listener:1,getView:function(){return this.tb._view},handle_mousewheel:function(R){this.handleScroll(R,10*(R.wheelDelta/40))},handle_DOMMouseScroll:function(d){this.handleScroll(d,10*-d.detail)},handleScroll:function(D,z){Hm(D);var s=this.tb;s.isScrollable()&&!s._stickToRight&&(s.tx(s.tx()+z),Ho())},handle_mousemove:function(A){var g=this;gd||g.setItem(A)},handle_mouseout:function(a){var s=this;a.target===s.getView()?s.tb.setCurrentItem(Q):s.handle_mousemove(a)},handle_mousedown:function(p){this.handle_mousemove(p),this.handle_touchstart(p)},handle_touchstart:function(D){var T=this,l=T.tb,o=D.target;gf(D)&&(o===T.getView()||o===l._canvas)&&(Hm(D),l.setFocus(D)&&(this.setItem(D,!0),(l.isScrollable()||T.info&&!T.info.item.disabled)&&(T.x=ko(D).x,T.tx=l.tx(),ep(T,D))))},handleWindowMouseMove:function(K){this.handleWindowTouchMove(K)},handleWindowTouchMove:function(R){var U=this,t=U.tb;if(!t._stickToRight){var H=ko(R).x-U.x;!U._25o&&q(H)>2&&t.isScrollable()&&(U._25o=1),U._25o&&t.tx(U.tx+H)}},handleWindowMouseUp:function(r){this.handleWindowTouchEnd(r)},handleWindowTouchEnd:function(E){var s=this,D=s.tb,l=s.info,y=s.tb.getItemInfoAt(E);if(!s._25o&&l){var W=l.item;y&&y.item===W&&D.handleClick(W,E)}s._25o=s.x=s.tx=Q,s.setItem()},setItem:function(b,G){var V=this,j=V.tb,e=V.info=b?j.getItemInfoAt(b):Q,B=e?e.item:Q;j.setCurrentItem(B),G&&B&&bb(B.onDown)&&B.onDown(b)}}),yo.BorderPane=function(){this._view=Ro(1,this),this.iv()},Dm("BorderPane",_,{ms_v:1,ms_ac:["topHeight","bottomHeight","leftWidth","rightWidth"],ms_fire:1,getLeftView:function(){return this._leftView},setLeftView:function(N,e){this._12o("leftView",N),e!=Q&&this.setLeftWidth(e)},getRightView:function(){return this._rightView},setRightView:function(Z,X){this._12o("rightView",Z),X!=Q&&this.setRightWidth(X)},getTopView:function(){return this._topView},setTopView:function(M,U){this._12o("topView",M),U!=Q&&this.setTopHeight(U)},getBottomView:function(){return this._bottomView},setBottomView:function(M,i){this._12o("bottomView",M),i!=Q&&this.setBottomHeight(i)},getCenterView:function(){return this._centerView},setCenterView:function(J){this._12o("centerView",J)},_12o:function(I,h){var Q=this,q="_"+I,G=Q._view,e=Q[q];e!==h&&(e&&(e.getView?qh(e.getView()):qh(e)),Q[q]=h,h&&(h.getView?Pe(G,h.getView(),1):Pe(G,h,1)),Q.fp(I,e,h))},onPropertyChanged:function(){this.iv()},validateImpl:function(){var J=this,p=J._topView,h=J._bottomView,D=J._leftView,A=J._rightView,b=J._centerView,w=J.getWidth(),l=J.getHeight(),Y=0,P=0,m=w,c=l,t=0,C=0,f=0,K=0;p&&(t=J._topHeight==Q?Iq(p):J._topHeight,P=t),h&&(C=J._bottomHeight==Q?Iq(h):J._bottomHeight,c=l-C),D&&(f=J._leftWidth==Q?vd(D):J._leftWidth,Y=f),A&&(K=J._rightWidth==Q?vd(A):J._rightWidth,m=w-K);var u=x(0,m-Y),s=x(0,c-P);p&&Ae(p,0,0,w,t),h&&Ae(h,0,c,w,C),D&&Ae(D,0,P,f,s),A&&Ae(A,m,P,K,s),b&&Ae(b,Y,P,u,s)}})}}("undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:(0,eval)("this"),Object);